/*! For license information please see oneuplightspeedwebpack.js.LICENSE.txt */
var __webpack_result__;(()=>{var e=[,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("appPageContext")}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{$:()=>te,$b:()=>Qe,A:()=>_,Ab:()=>lt,B:()=>G,Bb:()=>Je,C:()=>B,Cb:()=>ge,D:()=>j,Db:()=>He,E:()=>V,Eb:()=>ve,F:()=>R,Fb:()=>Me,G:()=>M,Gb:()=>mt,H:()=>A,Hb:()=>_e,I:()=>E,Ib:()=>ke,J:()=>U,Jb:()=>Ae,K:()=>T,Kb:()=>Oe,L:()=>H,Lb:()=>et,M:()=>P,Mb:()=>xe,N:()=>F,Nb:()=>_t,O:()=>x,Ob:()=>Te,P:()=>ue,Pb:()=>be,Q:()=>z,Qb:()=>qe,R:()=>g,Rb:()=>it,S:()=>s,Sb:()=>he,T:()=>$,Tb:()=>ft,U:()=>re,Ub:()=>Ue,V:()=>K,Vb:()=>Ce,W:()=>N,Wb:()=>Ee,X:()=>o,Xb:()=>De,Y:()=>tt,Yb:()=>Le,Z:()=>ae,Zb:()=>Se,_:()=>ie,_b:()=>at,a:()=>y,ab:()=>Be,ac:()=>ze,b:()=>J,bb:()=>Pe,c:()=>Y,cb:()=>Ne,cc:()=>oe,d:()=>I,db:()=>Ke,e:()=>S,eb:()=>ne,ec:()=>me,f:()=>D,fb:()=>Ze,g:()=>C,gb:()=>$e,h:()=>d,hb:()=>Ie,i:()=>f,ib:()=>fe,ic:()=>we,j:()=>X,jb:()=>pe,k:()=>de,kb:()=>Z,l:()=>le,lb:()=>nt,m:()=>u,mb:()=>je,n:()=>m,nb:()=>Xe,nc:()=>Re,o:()=>L,ob:()=>ot,oc:()=>Ge,p:()=>k,pb:()=>st,q:()=>h,qb:()=>ye,r:()=>O,rb:()=>We,rc:()=>ct,s:()=>w,sb:()=>Ve,sc:()=>se,t:()=>b,tb:()=>dt,tc:()=>ce,u:()=>l,ub:()=>Ye,v:()=>v,vb:()=>rt,w:()=>p,wb:()=>r,x:()=>q,xb:()=>pt,y:()=>W,yb:()=>ut,z:()=>c,zb:()=>Fe});var a=n("odsp.util_152"),i=n(358),r=a.ov.isFeatureEnabled,o={ODB:817,ODC:!0,OneDrive:!0},s={ODB:60124,ODC:!0,Fallback:!1},c={ODB:60358},d={ODB:1655,ODC:!1,Fallback:!1},l={ODB:61828,ODC:!1,Fallback:!1},u={ODB:61978,ODC:!1,Fallback:!1},f={ODB:60839,ODC:!1,Fallback:!1},p={ODB:62087,ODC:"PdfProgressiveLoading",Fallback:!1},m={ODB:37387,ODC:!1,Fallback:!1},_={ODB:62271,ODC:!1,Fallback:!1},h={ODB:62117,ODC:!1,Fallback:!1},b={ODB:62325,ODC:!1,Fallback:!1},g={ECS:1071224},v={ECS:1538945},y={ECS:1082725},S={ECS:1111474},D={ECS:1266897},I={ECS:1534310},x={ODB:!0,Fallback:!0},C={ODB:1614,ODC:!1,Fallback:!1},O={ODB:1063,ODC:!1,Fallback:!1},w={ODB:61719,ODC:!1,Fallback:!1},E={ODB:1513,ODC:!1,Fallback:!1},A={ODB:62343,ODC:!1,Fallback:!1},L={ODB:62071,ODC:"PdfCacheDisplayInfo",Fallback:!1},k={ODB:61561,ODC:!1,Fallback:!1},M={ODB:61332,ODC:!1,Fallback:!1},P={ECS:1551255},T={ODB:61881,ODC:"PdfDeprecateTempAuth",Fallback:!1},U={ODB:61973,ODC:!1,Fallback:!1},F={ODB:61982,ODC:!1,Fallback:!1},H={ODB:62242,ODC:!1,Fallback:!1},R={ODB:61403},N={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},B={ODB:61890,ODC:!1,OneDrive:!1,Fallback:!1},j={ODB:62164,ODC:!1,OneDrive:!1,Fallback:!1},V={ODB:62154,ODC:!1,OneDrive:!1,Fallback:!1},z={ODB:61709,ODC:!0,OneDrive:!0,Fallback:!0},G={ODB:62143,ODC:!1,OneDrive:!1,Fallback:!1},K={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},W={ODB:61649},q={ODB:62312},Q={ODB:61953,ODC:!1,OneDrive:!1,Fallback:!1},Y={ODB:61920,ODC:!1,OneDrive:!1,Fallback:!1},J={ODB:62290,ODC:!1,OneDrive:!1,Fallback:!1},X={ODB:60091,ODC:!1,OneDrive:!1,Fallback:!1};function Z(e){return a.x9.isActivated("5d22fad5-86b3-40a8-9fee-2e13934de07d","08/21/2024","kifraint - consolidate custom copilot flights")?r(Q):(0,i.d)({pageContextForEAPCheck:e})}var $={ODB:!a.x9.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},ee={ODB:1698};function te(){return!a.x9.isActivated("d9c17c13-cdd6-4c12-aec1-e636d97e7a9c","09/25/2023","Scoping context work for copilot pane in oneup")}function ne(){return!a.x9.isActivated("ae9f64ca-76b3-4a80-acc7-17d05476cd05","04/09/2024","Let copilot chat work with shared files as well")}function ae(){return!a.x9.isActivated("e238e075-eded-47d1-acae-71a7830856e1","01/27/2025","Add file metadata (extension) for oneup copilot telemetry")}function ie(){return!a.x9.isActivated("75589528-9502-4766-af7e-ea81c45d9c58","02/10/2025","Add more file metadata (createTime, modifyTime, size) for oneup copilot telemetry")}var re={ODB:!0,OneDrive:!0},oe={ODB:61113},se={ODB:61686};function ce(){return!a.x9.isActivated("8829b122-25f1-497b-889d-18046e90cdb4","05/23/2024","Update oneupitem processing to exclude unsupported files from officebundle generation, to prevent unsupported wac viewer usage")}var de={ODB:61210},le={ODB:61338},ue={ODB:61220},fe={ODB:61356};function pe(){return r(ee)}function me(){return!a.x9.isActivated("6b3d3f79-542e-416d-a2d5-df4c81a10a67","04/19/2024","Update 3d viewer to support gltf csl")}function _e(){return!a.x9.isActivated("5904d91a-f2d9-492f-809a-0628008a7395","01/18/2024","Refactor UA and Esign for PDF perf improvement")}function he(){return!a.x9.isActivated("a57daca8-0ab6-44bc-85da-ad7ef0256836","02/01/2024","Default OneNote file to other viewer no matter if it contains thumbnail url")}function be(){return!a.x9.isActivated("ca112383-8d78-4a73-8406-2825ad372646","02/06/2024","useMemo in oneupSlide to avoid unnecessary re-rendering")}function ge(){return!a.x9.isActivated("5DB864CD-C8C0-412B-BDCF-7B1D19DC6408","02/07/2024","Refactor eSignature for perf improvement")}function ve(){return!a.x9.isActivated("2786c500-79af-45d2-a8bc-9e24bba711dc","02/14/2024","set accessToken to undefined for file handler")}function ye(){return!a.x9.isActivated("878753ca-7dc4-4e78-9149-0385365eb96e","02/28/2024","update the file type check for thumbnail")}function Se(){return!a.x9.isActivated("a647a6fc-3e82-4662-9c1c-7fe30dc1c1ed","03/05/2024","update the file picker to use webDavUrl")}function De(){return!a.x9.isActivated("83825E35-490E-43D8-941D-0B315F472C7F","03/20/2024","use previewer for large files for new oneup by default")}function Ie(){return!a.x9.isActivated("d64008af-a8a9-4552-b0b4-b1ea01c39f05","03/19/2024","update fast oneup render logic to check parent first")}function xe(){return!a.x9.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","04/05/2024","log experiment data for oneup")}function Ce(){return!a.x9.isActivated("ba334243-6ae7-47f8-b998-b7d40e2b1a5f","04/22/2024","display right pane with error message")}function Oe(){return!a.x9.isActivated("59dd68f8-625d-4d16-b841-b507c7cae5ba","04/24/2024","enable show presence for current single client")}function we(){return a.x9.isActivated("59599a46-3c86-46b4-b44e-8e9836b0c8cc","05/13/2024","refactor command bar styles")}function Ee(){return!a.x9.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","05/15/2024","use onedrive/sharepoint for filehandler client name")}function Ae(){return!a.x9.isActivated("27ee7a45-8265-4d6e-a9c8-5c375f656b8b","05/14/2024","enable od3 style for info pane iframe")}function Le(){return!a.x9.isActivated("dfafd001-d599-49cf-b756-f64d5614b6c7","05/23/2024","use first focusable target")}function ke(){return!a.x9.isActivated("6884f3e1-f7e7-429c-829d-de15202d7086","05/29/2024","disable FRE for WAC and Video")}function Me(){return!a.x9.isActivated("83b9c996-3090-4417-ad53-fc565729550b","06/14/2024","Enable override to other viewer for specific extensions")}function Pe(){return!a.x9.isActivated("bddb1b44-54d7-4d9e-8c35-6e6f1eae7f08","06/18/2024","validate item info correctness disregard casing")}function Te(){return!a.x9.isActivated("2fc93384-9c5a-45c4-a1d7-5938985af39e","07/18/2024","fast one up error handling for no access scenarios")}function Ue(){return!a.x9.isActivated("21df4421-5b42-4f02-b214-c13002058ff0","07/11/2024","suppress web keyboard shortcuts while oneup is open")}function Fe(){return!a.x9.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/03/2024","send oauth token over in crosslist scenario for info pane")}function He(){return!a.x9.isActivated("4439e66f-5028-47c6-a785-33ccd584aee6","07/25/2024","Check ODB info pane status and auto launch in oneup on boot if open")}function Re(){return!a.x9.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/10/2024","load wac viewer when offset is 0")}var Ne={ODB:62047};function Be(){return!a.x9.isActivated("02071577-5f64-4528-af85-232e917aecb5","08/27/2024","aterentiev - enable builder for copilot viewer")}function je(){return!a.x9.isActivated("bf73f6e4-c9d8-4ee6-bbbe-8b594bc274c1","10/30/2024","haonwan - enable show default badge for oneup")}function Ve(){return!a.x9.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")}function ze(){return!a.x9.isActivated("438f44e6-9109-48e0-ad63-1422c7a65475","09/04/2024","aterentiev - pass token provider to copilot data source")}var Ge={ODB:62044};function Ke(){return!a.x9.isActivated("cfbff67e-09b8-486e-a4b8-ed7c9434ae22","09/13/2024","allow commandbar set updates when file handler api returns")}function We(){return!a.x9.isActivated("213aa271-e7bd-4b53-a38c-cca367b9508f","09/26/2024","request currentPageContext to get the pageContext in view")}function qe(){return!a.x9.isActivated("2f6e0461-222d-4d79-a39f-831d09809081","10/18/2024","use updated path to check other viewer override extensions")}function Qe(){return!a.x9.isActivated("9284827c-56e3-4243-8ef5-5afecfb65666","10/16/2024","Enable Vroom API fallback for image loading")}function Ye(){return!a.x9.isActivated("b642e08a-06ad-49e9-bf39-0db7e490a0a3","10/21/2024","sanitize all sent telemetry data")}function Je(){return!a.x9.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/24/2024","expose resource key for host theme")}function Xe(){return!a.x9.isActivated("0d37f72d-8169-41fe-b594-8452db7e28c0","10/28/2024","Enable Add to Teams for Copilot Agents")&&r({ODB:62053})}function Ze(){return!a.x9.isActivated("b2902a63-6dd3-4cff-8876-baf38b666016","10/29/2024","azbanduk - add set approved header menu button in oneup")}function $e(){return!a.x9.isActivated("a8acfa41-b1ed-4798-835c-6f0965cd5977")}function et(){return!a.x9.isActivated("ca96046d-3322-4be7-84f5-9ca5281a9a99","11/12/2024","HTML viewer access expiration retry")}function tt(){return!a.x9.isActivated("c3e8b8a9-6ea6-4e5d-88f9-ff5c5eaffc95","11/07/2024","Add vroom fallback for empty thumbnail url")}function nt(){return!a.x9.isActivated("23ae7f68-d8f8-41af-bd93-08123269995e","11/7/2024","rename OOB title")}function at(){return!a.x9.isActivated("bebfa662-8fc2-451d-acd7-081ede84bf39","11/7/2024","updateBadgeAndTooltips")}function it(){return a.x9.isActivated("b4362959-a64e-47f8-b124-8312b5aacaa7","11/11/2024","Enable pages scoped copilot")}function rt(){return a.x9.isActivated("eabab543-51da-4bca-a685-2542f0fa7b51","11/11/2024","contextual chat input")}function ot(){return!a.x9.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable log flight data for fast oneup")}function st(){return!a.x9.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable shorten cxp timeout")}function ct(){return a.x9.isActivated("6F22857B-5848-4E9E-8624-15642948563C")}function dt(){return a.x9.isActivated("c366b91c-69a1-4cdd-be4f-1c5eedb168f2")}function lt(){return!a.x9.isActivated("de59bdac-1542-4bb7-9c1c-7a880892c286")}function ut(){return a.x9.isActivated("5fc1ded9-c576-4bf6-b8ab-457eddd55bd2")}function ft(){return a.x9.isActivated("0aeb81cf-c6e7-4d6b-b198-cd0e194f6dde")}function pt(){return a.x9.isActivated("264c573a-03eb-4282-be9c-c88d19d1eb09")}function mt(){return a.x9.isActivated("e6b8f0a6-7e0a-4f5c-9e1a-1d0f7c1c7a0d")}function _t(){return a.x9.isActivated("a708bde5-cb00-40e4-a756-3e986734603b")}}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i.a,b:()=>i.d,c:()=>o});var a=n(5),i=n(11),r=n(42),o=(0,n("odsp.util_152")._y)("ItemUrlHelper",r.a,{pageContext:a.a})}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("odsp.util_152"),i=window._spPageContextInfo,r=function(e){var t=function(e){if(i&&i.farmSettings)return i.farmSettings[e]}(e);return!!t&&(1===Number(t)||"true"===t.toLowerCase())},o=function(e){return e.serviceSetting?r(e.serviceSetting):a.ov.isFeatureEnabled(e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_538"),i=n(101),r=function(){function e(){}return e.setAll=function(e){var t=e.workerSrc,n=e.pdfJsWorkerSrc,a=e.wasmModuleInit,i=e.fontConfigs,r=e.pdfJsCMapUrl,o=e.enableLogging,s=e.disableExternalWasmCache,c=e.globalVarNameForWorkerVer,d=e.features;this.workerSrc=t,this.pdfJsWorkerSrc=n,this.wasmModuleInit=a,this.fontConfigs=i,this.pdfJsCmapUrl=r,this.enableLogging=o,this.disableExternalWasmCache=s,this.globalVarNameForWorkerVer=c,this.features=d},Object.defineProperty(e,"workerSrc",{get:function(){return this.value.workerSrc},set:function(e){this.value.workerSrc=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pdfJsWorkerSrc",{get:function(){return this.value.pdfJsWorkerSrc},set:function(e){this.value.pdfJsWorkerSrc=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pdfJsCmapUrl",{get:function(){return this.value.pdfJsCMapUrl},set:function(e){this.value.pdfJsCMapUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"wasmModuleInit",{get:function(){return this.value.wasmModuleInit},set:function(e){this.value.wasmModuleInit=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fontConfigs",{get:function(){return this.value.fontConfigs},set:function(e){this.value.fontConfigs=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableLogging",{get:function(){return this.value.enableLogging},set:function(e){i.a.enabled=this.value.enableLogging=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"disableExternalWasmCache",{get:function(){return this.value.disableExternalWasmCache},set:function(e){this.value.disableExternalWasmCache=!!e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalVarNameForWorkerVer",{get:function(){return this.value.globalVarNameForWorkerVer},set:function(e){this.value.globalVarNameForWorkerVer=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"features",{get:function(){return this.value.features},set:function(e){this.value.features=e},enumerable:!1,configurable:!0}),e.setMessengerOptions=function(e){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return e?[4,n.e(27).then(n.bind(n,396))]:[2];case 1:return t.sent().setMessengerOptions(e),this.value.messengerOptions=e,[2]}})})},Object.defineProperty(e,"messengerOptions",{get:function(){return this.value.messengerOptions},enumerable:!1,configurable:!0}),e.value={workerSrc:"index.worker.js",wasmModuleInit:[]},e}()}
,,,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>q,resourceKey:()=>Q});var a=n("tslib_538"),i=n(463),r=n(5),o=n(6),s=n("odsp.util_152"),c=n(7),d=n(183),l=n(748),u=n(50),f=n(203),p=n(3);function m(e){var t,n=e.tokenName,i=e.resource,r=e.tokenType,o=e.scopes;return o&&(t=(0,a.lt)([],o,!0).sort().join("-")),"".concat(n,"|").concat(i,"|").concat(r||"","|").concat(t||"").toUpperCase()}var _=new Map,h=new s.aF({name:"".concat("PrefetchPromiseCache.key",".prefetchPromiseCache"),factory:new s.KS(_)}),b=n(372),g=n(259),v=n(260),y=n(69),S=s.x9.isActivated("E58A29DA-C08C-4B37-A3A1-EFF2159A162E"),D=function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new y.a("Identity.OAuth.".concat(t),n)}return e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(S){if(n&&t<n.expiration)return n}else if((null==n?void 0:n.expiration)&&t<n.expiration)return n;this._store.remove(e)},e.prototype.setValue=function(e,t){if(t){if(!(S||t.expiration&&t.value))return;this._store.setValue(e,t)}else this._store.remove(e)},e}(),I=n(52).a.local,x=new s.aF({name:"".concat("CachingType.key",".cachingType"),factory:new s.KS(I)}),C=new s.aF({name:"IdentityCache.key",factory:{dependencies:{pageContext:r.a,identityDataStoreCachingType:x},create:function(e){var t=e.pageContext,n=e.identityDataStoreCachingType;return{instance:new D({userId:t.systemUserKey,cachingType:n})}}}}),O=n(86),w=n(67),E=n(204),A=n(97),L=s.x9.isActivated("59BE7123-7F10-442B-A492-3EF5A368512A");function k(e){var t=e.access_token,n=e.expires_on;if(L)return 1e3*(Number(n||(0,A.b)(t).exp)-300);var a=void 0;return n&&(a=1e3*Number(n),isNaN(a)&&(a=new Date(n).getTime())),a&&!isNaN(a)||(a=1e3*Number((0,A.b)(t).exp)),isNaN(a)?void 0:a-3e5}var M=s.x9.isActivated("6E96910A-7B10-4A8A-9819-9DF87D60005D"),P=function(){function e(e,t){this._tokenFetcher=t.tokenFetcher,this._cache=t.cache,this._prefetchPromiseCache=t.prefetchPromiseCache,this._promiseCache=new Map}return e.prototype.getToken=function(e){var t,n;return(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,u,f,_,h,b,g,v,y,S,D,I,x,C=this;return(0,a.SO)(this,function(O){switch(O.label){case 0:return i=e.resource,r=e.tokenType,o=e.claimsChallenge,s=e.scopes,c=e.expiration,d=e.apiQosName,l=e.name,u=m((0,a.q5)({tokenName:l,resource:i,tokenType:r},M?{}:{scopes:s})),f=this._promiseCache.get(u),_=null===(t=this._prefetchPromiseCache)||void 0===t?void 0:t.get(u),h=function(e){var t=k(e),n=e.access_token,a=e.correlationId;return C._cache.setValue(u,{value:n,expiration:t,correlationId:a}),{accessToken:n,tokenExpiry:t,correlationId:a}},o||c?[4,Promise.all((0,a.lt)((0,a.lt)([],f?[f.catch(function(e){})]:[],!0),_?[_.catch(function(e){})]:[],!0))]:[3,2];case 1:return O.sent(),this._cache.setValue(u,void 0),[3,6];case 2:return(b=this._cache.getValue(u,Date.now()))?[2,{access_token:b.value,expires_on:"".concat(b.expiration),correlationId:b.correlationId}]:f?[4,f]:[3,4];case 3:if(g=O.sent())return[2,{access_token:g.accessToken,expires_on:"".concat(g.tokenExpiry),correlationId:g.correlationId}];O.label=4;case 4:return _?(null===(n=this._prefetchPromiseCache)||void 0===n||n.delete(u),v=function(){return(0,a.yv)(C,void 0,void 0,function(){var e,t,n;return(0,a.SO)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,_];case 1:return e=i.sent(),new p.a(e.qos.start).end((0,a.q5)((0,a.q5)({},e.qos.end),{resultType:e.qos.success?p.b.Success:p.b.Failure})),t=void 0,e.response?e.response.ok?[4,e.response.json()]:[2,void 0]:[3,3];case 2:n=i.sent(),t=h((0,a.q5)((0,a.q5)({},n),{correlationId:e.response.headers.get("SPRequestGuid")||""})),i.label=3;case 3:return[2,t];case 4:return i.sent(),[2,void 0];case 5:return[2]}})})},y=v(),this._promiseCache.set(u,y),[4,y]):[3,6];case 5:if(S=O.sent(),this._promiseCache.delete(u),S)return[2,{access_token:S.accessToken,correlationId:S.correlationId,expires_on:"".concat(S.tokenExpiry)}];O.label=6;case 6:return D=function(){return(0,a.yv)(C,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,this._tokenFetcher.getToken({name:l,resource:i,tokenType:r,claimsChallenge:o,scopes:s,apiQosName:d})];case 1:return[2,e.sent()]}})})},I=D().then(function(e){var t=h(e);return C._promiseCache.delete(u),t},function(e){return C._promiseCache.delete(u),Promise.reject(e)}),this._promiseCache.set(u,I),[4,I];case 7:return[2,{access_token:(x=O.sent()).accessToken,correlationId:x.correlationId,expires_on:"".concat(x.tokenExpiry)}]}})})},e}(),T=new s.aF({name:"cachingTokenFetcher",factory:new s.Rj(P,{tokenFetcher:b.a,cache:C,prefetchPromiseCache:h})}),U=s.x9.isActivated("EAFC78CF-880E-49EE-B4BB-4EC0F8D62A61"),F=s.x9.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),H=s.x9.isActivated("6E96910A-7B10-4A8A-9819-9DF87D60005D"),R=!s.x9.isActivated("646D58EC-51E4-4C3E-9B03-EC9E3174625D"),N=!s.x9.isActivated("a7484c4e-8121-4906-9a28-6611d11e8e64"),B=!s.x9.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32"),j=s.x9.isActivated("86BED981-A863-454E-AB43-39EDF6968CE1"),V="https://graph.microsoft.com",z="https://substrate.office.com",G="api://63c9fecc-99c2-4c4c-878f-84685641aa94",K=["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",d.a],W=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageContext=n.pageContext,a._dataRequestor=new l.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:a._pageContext}),a._cache=n.identityCache,a._promiseCache=new Map,a._prefetchPromiseCache=n.prefetchPromiseCache,a._apiUrlHelper=new u.a({webAbsoluteUrl:a._pageContext.webAbsoluteUrl}),a._tokenFetcher=n.tokenFetcher,a._cachingTokenFetcher=n.cachingTokenFetcher,a._offlineDetection=n.offlineDetection,a._isSubstrateAcquireDisabled=n.isSubstrateAcquireDisabled,a}return(0,a.e2)(t,e),t.prototype.getIdentity=function(){return t=(e={pageContext:this._pageContext}).pageContext,n=function(e){var t=e.pageContext,n=null==t?void 0:t.systemUserKey;return n&&n.substring(n.lastIndexOf("|")+1).replace("@live.com","")||""}(e),a=!0===t.isAnonymousGuestUser||!0===t.isEmailAuthenticationGuestUser?g.a.anonymous:g.a.aad,i=t.userLoginName,r=t.webPermMasks,{email:t.userEmail,id:n,loginName:i,type:a,sessionState:"",webPermMasks:r};var e,t,n,a,i,r},t.prototype.getSignInUrl=function(){throw new Error("Not Implemented")},t.prototype.getGraphToken=function(e){var t=e.resource,n=e.scopes,i=e.claimsChallenge,r=e.apiQosName,s=e.forceSpHttpClient;return t&&!this._isGraphEndpoint(t)?this.getSharePointToken(t,!!i||void 0,i?{claims:i.claims,access_token:i.access_token,error:i.error}:void 0,{apiQosName:r}):n&&(n.indexOf("InformationProtection.Read.All")>-1||n.indexOf("InformationProtectionPolicy.Read")>-1||n.indexOf("Calendars.Read")>-1)?F?o.c.resolve(this.resources.consumeAsync(f.a.bypass)).then(function(e){return e.fetchToken({resource:t,tokenName:B?"ms-graph":void 0,claims:null==i?void 0:i.claims,apiQosName:r})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("ms-graph",(0,a.q5)((0,a.q5)({resource:t&&new c.a(t).authority||V,claimsChallenge:i,scopes:n},U||s?{useSpHttpDataSource:(0,w.h)(w.c)||N&&s}:{}),{apiQosName:r})):this._getTokenForResource("ms-graph",(0,a.q5)((0,a.q5)({resource:t&&new c.a(t).authority||V,claimsChallenge:i},U||s?{useSpHttpDataSource:(0,w.h)(w.c)||N&&s}:{}),{apiQosName:r}))},t.prototype.getStrongAuthToken=function(e){return this._getTokenForResource("oAuth-SA",{resource:new c.a(this._pageContext.webAbsoluteUrl).authority,apiQosName:e.apiQosName||"MSAStrong",scopes:["onedrive_implicit_forceSA.access"]})},t.prototype.getLokiToken=function(){return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com"})},t.prototype.getPushChannelToken=function(){return this._getTokenForResource("pushchannel",(0,a.q5)({resource:"https://pushchannel.1drv.ms"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getTeamsCMDToken=function(){return this._getTokenForResource("teams-cmd",(0,a.q5)({resource:"6bc3b958-689b-49f5-9006-36d165f30e00"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getMeetingCatchupToken=function(){return this._getTokenForResource("ms-mcu",(0,a.q5)({resource:"https://MeetingCatchup.substrate.office.com"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getFormsToken=function(){return this._getTokenForResource("ms-forms",(0,a.q5)({resource:"https://forms.office.com"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getOCPSToken=function(){return this._getTokenForResource("ocps",(0,a.q5)({resource:"https://clients.config.office.net"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getSPHomeToken=function(e){return this._getTokenForResource("SPHome",{resource:e.resource})},t.prototype.getOfficeToken=function(){return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com"})},t.prototype.getSubstrateToken=function(e){var t,n,i;void 0===e&&(e={tokenType:d.c.Default,resourceType:d.b.Default});var r=e.tokenType,o=e.skipCache,s=e.resourceType,c=e.apiQosName;if(r===d.c.STI)return this._getTokenForResource("ms-substrate-sti",{resource:z,tokenType:"STI",skipCache:o,apiQosName:c});var l=(0,v.i)(null===(t=this._pageContext)||void 0===t?void 0:t.env2),u=(null===(n=this._pageContext)||void 0===n?void 0:n.substrateEndpointUrl)||z,f="ms-substrate";return s===d.b.Search&&l&&(u="".concat((null===(i=this._pageContext)||void 0===i?void 0:i.substrateEndpointUrl)||"https://partner.outlook.cn","/search"),f="ms-substrate-search"),this._getTokenForResource(f,(0,a.q5)((0,a.q5)({resource:u,skipCache:o},U?{useSpHttpDataSource:this._isSubstrateAcquireDisabled()}:{}),{apiQosName:c}))},t.prototype.getSubstrateTenantFeedbackToken=function(){return this._getTokenForResource("ms-substrate-tenant-feedback",(0,a.q5)({resource:"https://substrate.office.com/tenantfeedback"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getMediaTAToken=function(e){return this._getTokenForResource("SharePoint-media",{resource:e})},t.prototype.getMediaTAGptToken=function(e,t){return F?o.c.resolve(this.resources.consumeAsync(f.a)).then(function(n){return n.fetchToken({resource:e,claims:null==t?void 0:t.claims})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("SharePoint-mediaGPT",{resource:e,claimsChallenge:t})},t.prototype.getAugloopToken=function(e){return void 0===e&&(e="https://augloop.office.com/v2"),this._getTokenForResource("ms-augloop",(0,a.q5)({resource:e},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getSharePointToken=function(e,t,n,a){var i=a||{},r=i.apiQosName,s=i.disallowSelfIssuedToken,d=/https:\/\/(.*).svc.ms/.test(e);if(this._isGraphEndpoint(e))return this._getTokenForResource("ms-graph",{resource:new c.a(e).authority,forceRefresh:t,claimsChallenge:n,apiQosName:r});if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||d){if(this._isGraphEndpoint(e)||d){var l=this._isGraphEndpoint(e)?"SharePoint-graph":d?"SharePoint-media":"SharePoint";return this._getTokenForResource(l,{resource:new c.a(e).authority,forceRefresh:t,claimsChallenge:n,apiQosName:r})}return F?o.c.resolve(this.resources.consumeAsync(f.a.bypass)).then(function(t){return t.fetchToken({tokenName:B?"SharePoint-bypass":void 0,resource:new c.a(e).authority,claims:null==n?void 0:n.claims,apiQosName:r})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("SharePoint_MSAL",{resource:new c.a(e).authority,apiQosName:r,claimsChallenge:n})}return s?this._getTokenForResource("SharePoint_MSAL",{resource:new c.a(e).authority,forceRefresh:t,tokenType:"SPO",claimsChallenge:n,apiQosName:r}):this._getTokenForResource("SharePoint_SelfIssued",{resource:new c.a(e).authority,forceRefresh:t,tokenType:"SPO",claimsChallenge:n,apiQosName:r})},t.prototype.getPowerBIToken=function(e){return this._getTokenForResource("power-bi",{resource:e})},t.prototype.getPowerPlatformToken=function(e){return this._getTokenForResource("power-platform",(0,a.q5)({resource:e},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getPhoneLinkToken=function(e){return U?o.c.resolve(this.resources.consumeAsync(f.a.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"PhoneLink"})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("your-phone",{resource:e})},t.prototype.getYammerToken=function(e){return this._getTokenForResource("yammer",{resource:e})},t.prototype.getAzNBToken=function(){return F?o.c.resolve(this.resources.consumeAsync(f.a.bypass)).then(function(e){return e.fetchToken({resource:G})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("az-nb",{resource:G})},t.prototype.getOfficeHomeToken=function(e){return F?o.c.resolve(this.resources.consumeAsync(f.a.bypass)).then(function(t){return t.fetchToken({resource:e,tokenName:"OfficeHome"})}).then(function(e){return{accessToken:e}}):this._getTokenForResource("office-home",{resource:e})},t.prototype.getAzRMSToken=function(){return this._getTokenForResource("az-rms",(0,a.q5)({resource:"https://aadrm.com"},U?{useSpHttpDataSource:!0}:{}))},t.prototype.getOAuthSessionToken=function(e,t){return this._getTokenForResource("oAuth",(0,a.q5)({resource:e,claimsChallenge:t},F?{}:{useSpHttpDataSource:K.indexOf(e)>=0}))},t.prototype.getFormDigest=function(e){var t;return t=e?e.split("/_api")[0]+"/_api/contextInfo":this._getContextInfoUrl(),this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})},t.prototype._getTokenForResource=function(e,t){var n,i;return(0,a.yv)(this,void 0,o.c,function(){var r,s,c,d,l,u,_,h,b,g,v,y,S,D,I,x,C,O,w=this;return(0,a.SO)(this,function(E){switch(E.label){case 0:return!j&&this._cachingTokenFetcher?[2,this._getTokenForResourceWithDelegatedCaching(e,t)]:(r=t.resource,s=t.tokenType,c=t.claimsChallenge,d=t.scopes,l=t.forceRefresh,u=t.apiQosName,_=m((0,a.q5)({tokenName:e,resource:r,tokenType:s},H?{}:{scopes:d})),h=this._promiseCache.get(_),b=null===(n=this._prefetchPromiseCache)||void 0===n?void 0:n.get(_),g=function(e){var n=k(e),a=e.access_token,i=e.correlationId;return t.skipCache||w._cache.setValue(_,{value:a,expiration:n,correlationId:i}),{accessToken:a,tokenExpiry:n,correlationId:i}},c||l?[4,Promise.all((0,a.lt)((0,a.lt)([],h?[h.catch(function(e){})]:[],!0),b?[b.catch(function(e){})]:[],!0))]:[3,2]);case 1:return E.sent(),this._cache.setValue(_,void 0),[3,6];case 2:return(v=this._cache.getValue(_,Date.now()))?[2,{accessToken:v.value,tokenExpiry:v.expiration,correlationId:v.correlationId}]:h?[4,h]:[3,4];case 3:if(y=E.sent())return[2,y];E.label=4;case 4:return b?(null===(i=this._prefetchPromiseCache)||void 0===i||i.delete(_),S=function(){return(0,a.yv)(w,void 0,o.c,function(){var e,t,n;return(0,a.SO)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,b];case 1:return e=i.sent(),new p.a(e.qos.start).end((0,a.q5)((0,a.q5)({},e.qos.end),{resultType:e.qos.success?p.b.Success:p.b.Failure})),t=void 0,e.response?e.response.ok?[4,e.response.json()]:[2,void 0]:[3,3];case 2:n=i.sent(),t=g((0,a.q5)((0,a.q5)({},n),{correlationId:e.response.headers.get("SPRequestGuid")||""})),i.label=3;case 3:return[2,t];case 4:return i.sent(),[2,void 0];case 5:return[2]}})})},D=S(),this._promiseCache.set(_,D),[4,D]):[3,6];case 5:if(I=E.sent(),this._promiseCache.delete(_),I)return[2,I];E.label=6;case 6:return R&&this._offlineDetection.offline?[2,o.c.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5})]:(x=function(){return(0,a.yv)(w,void 0,o.c,function(){var t,n,i,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.resources.consumeAsync(f.a.bypass)];case 1:return[4,a.sent().fetchTokenData({resource:r,tokenName:B?e:void 0,claims:null==c?void 0:c.claims,scopes:d,apiQosName:u})];case 2:return t=a.sent(),n=void 0,(i=null===(o=t.expiresOn)||void 0===o?void 0:o.getTime())&&(n=(i/1e3).toString()),[2,{access_token:t.accessToken,expires_on:n}]}})})},C=function(){return(0,a.yv)(w,void 0,o.c,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return t.useSpHttpDataSource?[4,x()]:[3,2];case 1:case 3:return[2,n.sent()];case 2:return[4,this._tokenFetcher.getToken({name:e,resource:r,tokenType:s,claimsChallenge:c,scopes:d,apiQosName:u})]}})})},O=C().then(function(e){var t=g(e);return w._promiseCache.delete(_),t},function(e){return w._promiseCache.delete(_),o.c.reject(e)}),this._promiseCache.set(_,O),[4,O]);case 7:return[2,E.sent()]}})})},t.prototype._getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()},t.prototype._isGraphEndpoint=function(e){var t="".concat(this._pageContext.msGraphEndpointUrl,"/");return"".concat(e,"/").slice(0,t.length)===t},t.prototype._getTokenForResourceWithDelegatedCaching=function(e,t){return(0,a.yv)(this,void 0,o.c,function(){var n,i,r,c,d,l,u,f;return(0,a.SO)(this,function(a){switch(a.label){case 0:return R&&this._offlineDetection.offline?[2,o.c.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5})]:(n=t.resource,i=t.apiQosName,r=t.claimsChallenge,c=t.forceRefresh,d=t.scopes,l=t.skipCache,u=t.tokenType,[4,(!l&&this._cachingTokenFetcher||this._tokenFetcher).getToken({name:e,resource:n,apiQosName:i,claimsChallenge:r,expiration:c?{error:new s.qt({code:"ForceRefresh "})}:void 0,scopes:d,tokenType:u})]);case 1:return[2,{accessToken:(f=a.sent()).access_token,correlationId:f.correlationId,tokenExpiry:k({access_token:f.access_token,expires_on:f.expires_on})}]}})})},t.dependencies=(0,a.q5)((0,a.q5)({},i.a.dependencies),{pageContext:r.a,tokenFetcher:b.a,cachingTokenFetcher:j?void 0:T,prefetchPromiseCache:h.optional,identityCache:C,offlineDetection:O.a,isSubstrateAcquireDisabled:E.a}),t}(i.a);const q=W;var Q=(0,s._y)("IdentityDataSource",W)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l,c:()=>c});var a=n(233),i=n(234),r=n(235),o=n(436),s=n(236),c=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/,d={idParamKey:a.b,parentIdParamKey:r.a,driveIdParamKey:"driveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:s.b,pageParamKey:"p",parentQueryTypeParamKey:s.a,windowNameJsonKey:"ODBParams",queryParamKey:a.g,conversationIdParamKey:"cvid",metadataSearchIdKey:a.f,uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:a.i,userFiltersKey:"userFilters",viewIdKey:a.j,viewPathKey:a.k,isPowerAppView:"isPowerAppView",listIdKey:a.d,listUrlKey:a.e,sortFieldKey:a.h,isAscendingKey:a.c,policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",openShare:"openShare",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:a.a,errorTypeKey:"type",correlationIdKey:"correlation",approvalItemVersion:"approvalItemVersion",commentIdKey:"commentId",emailCTRParamKey:"e",useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:i.a,stateParamKey:"state",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",hostName:"hostName",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",action:"action",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",referrer:"referrer",referrerScenario:"referrerScenario",viewerKey:"viewer",personIdKey:"personId",emailIdKey:"emailId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",noAuthRedirect:"noAuthRedirect",appParamKey:"app",scenarioParamKey:"scenario",loadFormWithNucleus:"loadFormWithNucleus",referringClientKey:"referringClient",localKey:"local",shareTokenKey:o.a,cid:"cid",sortBy:"sb",sortDirection:"sd",mid:"mid",mcid:"mcid",contextualFilter:"ft",extensionFilter:"ext",searchConversationId:"searchsessionid",dateFilterType:"df",beginDate:"beginDate",endDate:"endDate",scope:"scope",authKey:"authkey"};const l=d}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a.a});var a=n(386)}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>o,c:()=>r,d:()=>i,e:()=>_,f:()=>h});var a,i,r,o,s=n("tslib_538"),c=n(123),d=n("odsp.util_152"),l=n(402),u=n(81),f=n("react-lib"),p=n(12);!function(e){e[e.Off=0]="Off",e[e.On=1]="On"}(a||(a={})),function(e){e[e.none=0]="none",e[e.detailPane=1]="detailPane",e[e.versionHistory=2]="versionHistory",e[e.copilotPane=3]="copilotPane",e[e.commentsPane=4]="commentsPane",e[e.copilotDetailPane=5]="copilotDetailPane"}(i||(i={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(r||(r={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(o||(o={}));var m=function(e){function t(){return e.call(this,{currentState:{publisher:"init",rightPane:{type:i.none},modal:{showModal:!1},eSignData:{isCreateSidePanelActive:!1},annotationViewerState:{viewerVisiblity:t._defaultAnnotationVisibility,isActive:!1},isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,isPerfButtonOpen:(0,p.wb)(p.cc),isOneUpFreOpen:!1,isPrecenseFacepileVisible:!1}})||this}return(0,s.e2)(t,e),t.prototype.getViewerState=function(e){var t=this.state.currentState.viewerStates;return null==t?void 0:t.get(e)},t.prototype.getAnnotationViewerState=function(){return this.state.currentState.annotationViewerState},t.prototype.getESignData=function(){return this.state.currentState.eSignData},t.prototype.getFileHandlerOptions=function(){return this.state.currentState.fileHandlerOptions},t.prototype.updateViewerState=function(e,t){var n=this.state.currentState.viewerStates||new Map,a=null==n?void 0:n.get(t.key);t.options=(0,s.q5)((0,s.q5)((0,s.q5)({},a),t.options),{pdfViewerStates:(0,s.q5)((0,s.q5)({},null==a?void 0:a.pdfViewerStates),t.options.pdfViewerStates)}),n.set(t.key,t.options),this.update("currentState",{publisher:e,viewerStates:new Map(n)})},t.prototype.updateRightPaneError=function(e,t){(0,p.Vb)()&&this.update("currentState",{publisher:e,rightPane:(0,s.q5)((0,s.q5)({},t),{hasError:!0})})},t.prototype.updateRightPaneState=function(e,t){t.type!==i.none&&this.updateESignDataState(e,{isCreateSidePanelActive:!1}),this.update("currentState",{publisher:e,rightPane:(0,s.q5)((0,s.q5)({},t),{hasError:void 0,error:void 0})})},Object.defineProperty(t.prototype,"rightPaneType",{get:function(){return this.currentAppState.rightPane.type},enumerable:!1,configurable:!0}),t.prototype.updateModalState=function(e,t){this.update("currentState",{publisher:e,modal:t})},t.prototype.updateParentPermissionValidity=function(e,t){this.update("currentState",{publisher:e,hasValidPermissionToParent:t})},t.prototype.updateFileHandlerOptions=function(e,t){this.update("currentState",{publisher:e,fileHandlerOptions:t})},t.prototype.updatePerfButtonState=function(e,t){this.update("currentState",{publisher:e,perfDataReported:t})},t.prototype.updatePerfButtonIsVisible=function(e,t){this.update("currentState",{publisher:e,isPerfButtonOpen:t})},t.prototype.updateIsPresenceFacepileVisible=function(e,t){this.state.currentState.isPrecenseFacepileVisible!==t&&this.update("currentState",{publisher:e,isPrecenseFacepileVisible:t})},t.prototype.updateOneUpShellFreIsOpen=function(e,t){this.update("currentState",{publisher:e,isOneUpFreOpen:t})},t.prototype.updateImageState=function(e,t){this.update("currentState",{publisher:e,imageMode:t})},t.prototype.updatePdfEncryptDialogVisibleState=function(e,t){this.update("currentState",{publisher:e,pdfEncryptDialogVisible:t})},t.prototype.updatePdfState=function(e,t){this.update("currentState",{publisher:e,pdfAppMode:t})},t.prototype.updateToastState=function(e,t){var n=this.state.currentState.toast;t.timeStamp=Date.now();var a=t.toastKey?t.toastKey:"defaultKeyToDisplayOnlyOneToast";if(n?n.set(a,t):(n=new Map).set(a,t),!1===t.visible&&n.delete(a),n.size>2){var i="",r=1/0;n.forEach(function(e,t){e.timeStamp&&e.timeStamp<r&&(i=t,r=e.timeStamp)}),n.delete(i)}var o=new Map(n);this.update("currentState",{publisher:e,toast:o})},t.prototype.updateErrorState=function(e,t){this.update("currentState",{publisher:e,errorState:t})},t.prototype.setIsFocusItemFavorited=function(e,t){this.update("currentState",{publisher:e,isFocusItemFavorited:t})},t.prototype.setIsFeedbackEnabled=function(e,t){this.update("currentState",{publisher:e,isFeedbackEnabled:t})},t.prototype.toggleAnnotationViewerVisiblity=function(e){var t=this.state.currentState.annotationViewerState,n=t.viewerVisiblity,i=n===a.Off||void 0===n?a.On:a.Off,r=(0,s.q5)((0,s.q5)({},t),{viewerVisiblity:i,isActive:!t.isActive});this.update("currentState",{publisher:e,annotationViewerState:r}),(0,p.wb)(p.C)&&this.hideUACommentsPane(i,e)},t.prototype.hideUACommentsPane=function(e,t){e===a.Off&&this.state.currentState.rightPane.type===i.commentsPane&&this.updateRightPaneState(t,{type:i.none})},t.prototype.setSiteHidePeoplePreviewingFiles=function(e,t){this.update("currentState",{publisher:e,siteHidePeoplePreviewingFiles:t})},t.prototype.setAnnotationViewerPreloadSucceeded=function(e,t){var n=this.state.currentState.annotationViewerState;this.update("currentState",{publisher:e,annotationViewerState:(0,s.q5)((0,s.q5)({},n),{hasPreloadSucceeded:t})})},t.prototype.updateDeletedKeysState=function(e,t){this.update("currentState",{publisher:e,deletedKeys:t})},t.prototype.updateRenamedKeyInFastOneUpState=function(e,t){this.update("currentState",{publisher:e,renamedKeyInFastOneUp:t})},t.prototype.updateIsUniversalPrintLicenseValidState=function(e,t){this.update("currentState",{publisher:e,isUniversalPrintLicenseValid:t})},t.prototype.updateIsNoAccessScenarioState=function(e,t){this.update("currentState",{publisher:e,isNoAccessScenario:t})},t.prototype.updateESignDataState=function(e,t){t.isCreateSidePanelActive&&this.updateRightPaneState(e,{type:i.none}),this.update("currentState",{publisher:e,eSignData:t})},Object.defineProperty(t.prototype,"currentAppState",{get:function(){return this.state.currentState},enumerable:!1,configurable:!0}),t.prototype.clean=function(){this.update("currentState",{publisher:"close",rightPane:{type:i.none},errorState:void 0,viewerStates:void 0,imageMode:r.view,annotationViewerState:{viewerVisiblity:t._defaultAnnotationVisibility,hasPreloadSucceeded:!1,isActive:!1},pdfAppMode:c.a.View,toast:void 0,modal:{showModal:!1,content:void 0},eSignData:{isCreateSidePanelActive:!1},perfDataReported:void 0,isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,renamedKeyInFastOneUp:void 0})},t.prototype.navClean=function(){this.update("currentState",{publisher:"nav",eSignData:{isCreateSidePanelActive:!1}})},t._defaultAnnotationVisibility=a.Off,t}(l.a),_=new d.aF({name:"OneUpStateStore",factory:new d.In(m)});function h(e,t){return function(e,t,n){var a=(0,f.useState)(),i=a[0],r=a[1],o=(0,f.useState)(function(){var a=e.state[t],i=n?n(a):a;if(!(0,d.Xw)(i))return i;i.then(function(e){return c(e)}).catch(function(e){return r(e)})}),s=o[0],c=o[1];return(0,f.useLayoutEffect)(function(){return e.onUpdate(t,function(e){var t=n?n(e.detail):e.detail;(0,d.Xw)(t)?t.then(function(e){return c(e)}).catch(function(e){return r(e)}):c(t)})},[]),[s,i]}((0,u.c)().consume(_),e,t)}}
,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e.Start="start",e.Succeed="succeed",e.Fail="fail"}(a||(a={})),function(e){e.DocumentPreviewDone="DocumentPreviewDone",e.DocumentLoad="DocumentLoad",e.DocumentSave="DocumentSave",e.DocumentExtract="DocumentExtract",e.DocumentMerge="DocumentMerge",e.DocumentEncrypt="DocumentEncrypt",e.DocumentProgressiveLoad="DocumentProgressiveLoad",e.DocumentProgressiveLoadDownloadFullDocument="DocumentProgressiveLoadDownloadFullDocument",e.MipDocumentLoad="MipDocumentLoad"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>a,c:()=>d,d:()=>i,e:()=>u});var a,i,r=n("tslib_538");!function(e){e.EventHandleFailed="EventHandleFailed",e.FileDownloadFailed="FileDownloadFailed",e.RangeDownloadSizeMismatch="RangeDownloadSizeMismatch",e.FontLoadFailed="FontLoadFailed",e.PrintFailed="PrintFailed",e.ShowThumbnailFailed="ShowThumbnailFailed",e.Unknown="Unknown",e.WasmModuleInitFailed="WasmModuleInitFailed",e.WasmModuleNotFound="WasmModuleNotFound",e.WasmRuntimeError="WasmRuntimeError",e.WasmCacheFailed="WasmCacheFailed",e.AnnotationAddFailed="AnnotationAddFailed",e.PdfJsPreviewFailed="PdfJsPreviewFailed",e.InvalidPDF="InvalidPDF",e.PDFWorkerMismatch="PDFWorkerMismatch",e.PreviewerFailToLoadTask="PreviewerFailToLoadTask",e.PreviewerFailToLoadPage="PreviewerFailToLoadPage",e.PreviewerFailToFetchFile="PreviewerFailToFetchFile",e.PreviewerUnmounted="PreviewerUnmounted",e.PdfLoadCanceled="PdfLoadCanceled",e.ViewContextNotInitialized="ViewContextNotInitialized",e.PreRenderError="PreRenderError",e.GetPdfStreamFailed="GetPdfStreamFailed",e.UploadFileDataFailed="UploadFileDataFailed",e.RangeDownLoadFailed="RangeDownLoadFailed",e.RangeDownloadFileSizeMismatch="RangeDownloadFileSizeMismatch",e.ProgressiveLoadFailed="ProgressiveLoadFailed",e.ProgressiveLoadFetchRangeFailed="ProgressiveLoadFetchRangeFailed",e.ProgressiveLoadParsingFailed="ProgressiveLoadParsingFailed",e.ProgressiveLoadFetchByStreamFailed="ProgressiveLoadFetchByStreamFailed"}(a||(a={})),function(e){e.PDFError="PDFError",e.PdfOpenError="PdfOpenError",e.PdfWorkerMismatchError="PdfWorkerMismatchError",e.NetworkError="NetworkError"}(i||(i={}));var o,s="MsPdfViewer",c=function(e,t,n,a){return{error:{name:e,message:t,stack:n},extraData:{location:s,code:a}}},d=(o=Error,(0,r.e2)(function e(t,n){var a=o.call(this,n)||this;return a.toCaughtError=function(){return c(a.name,a.message,a.stack)},Object.setPrototypeOf(a,e.prototype),a.name=t,a},o),function(e){function t(n,a,r){void 0===r&&(r=!1);var o=e.call(this,a)||this;return o.toString=function(){return"[".concat(o.name,"] code: ").concat(o.code,", message: ").concat(o.message,", stack: ").concat(o.stack)},o.toCaughtError=function(){return c(o.name,o.message,o.stack,o.code)},Object.setPrototypeOf(o,t.prototype),o.name=i.PDFError,o.code=n,o.isExpected=r,o}return(0,r.e2)(t,e),t.prototype.toQosError=function(){return{isExpected:this.isExpected,code:this.code||this.name,error:{name:this.name,message:this.message,stack:this.stack},extraData:{location:s}}},t}(Error)),l=function(e){function t(n,a,o,c,d,l){var u=e.call(this,"".concat(n||a,".").concat(o||"GetFile"),c,l)||this;return u.toQosError=function(){return(0,r.q5)((0,r.q5)({},e.prototype.toQosError.call(u)),{extraData:{location:s,status:u.status,responseHeaders:u.responseHeaders}})},Object.setPrototypeOf(u,t.prototype),u.name=i.NetworkError,u.status=n,u.statusText=a,u.where=o,u.responseHeaders=d,u}return(0,r.e2)(t,e),t}(d),u=(function(e){(0,r.e2)(function t(n){var r=e.call(this,a.InvalidPDF,n,!0)||this;return Object.setPrototypeOf(r,t.prototype),r.name=i.PdfOpenError,r},e)}(d),function(e){function t(n){var r=e.call(this,a.PDFWorkerMismatch,n,!1)||this;return Object.setPrototypeOf(r,t.prototype),r.name=i.PdfWorkerMismatchError,r}return(0,r.e2)(t,e),t}(d))}
,,,,,,(e,t,n)=>{"use strict";var a,i,r,o,s,c,d,l;n.d(t,{a:()=>d,b:()=>r,c:()=>c,d:()=>o,e:()=>a,f:()=>s,g:()=>i}),function(e){e.HighlightLink="HighlightLink",e.ClearHighlightLink="ClearHighlightLink",e.InkStrokesAdded="InkStrokesAdded",e.InkAdded="InkAdded",e.InkUpdated="InkUpdated",e.DocumentDirty="DocumentDirty",e.DocumentSaved="DocumentSaved",e.InvalidateRect="InvalidateRect",e.InvalidateRectForAnnot="InvalidateRectForAnnot",e.ShowFreeText="ShowFreeText",e.ShowTextField="ShowTextField",e.ScaleChanged="ScaleChanged",e.ResponsiveResize="ResponsiveResize",e.RotationChanged="RotationChanged",e.AnnotationChanged="AnnotationChanged",e.Scrolling="Scrolling",e.ZoomStart="ZoomStart",e.ZoomEnd="ZoomEnd",e.Pinching="Pinching",e.InitialDisplayInfoApplied="InitialDisplayInfoApplied",e.VisiblePagesLoaded="VisiblePagesLoaded",e.ShowEditableInk="ShowEditableInk",e.ShowErasableInk="ShowErasableInk",e.TriggerInkComposing="TriggerInkComposing"}(a||(a={})),function(e){e.FitSize="FitPageWithWindowSize",e.FitWidth="FitPageWithWindowWidth"}(i||(i={})),function(e){e.Default="default",e.Text="text",e.Link="pointer"}(r||(r={})),function(e){e.Space=" ",e.Tab="Tab",e.Home="Home",e.Enter="Enter",e.End="End",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight"}(o||(o={})),function(e){e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270"}(s||(s={})),function(e){e[e.Success=0]="Success",e[e.InvalidContentType=1]="InvalidContentType",e[e.InvalidContentDisposition=2]="InvalidContentDisposition",e[e.DocumentCancelled=4]="DocumentCancelled",e[e.PdfiumUnknown=5]="PdfiumUnknown",e[e.PdfiumFile=6]="PdfiumFile",e[e.PdfiumFormat=7]="PdfiumFormat",e[e.PdfiumUnsupportedSecurity=8]="PdfiumUnsupportedSecurity",e[e.PdfiumPage=9]="PdfiumPage",e[e.PdfiumXfaLoad=10]="PdfiumXfaLoad",e[e.PdfiumXfaLayout=11]="PdfiumXfaLayout",e[e.IncorrectPassword=12]="IncorrectPassword",e[e.IncorrectResponseStatus=13]="IncorrectResponseStatus",e[e.UnexpectedError=14]="UnexpectedError",e[e.IncorrectMIPAuth=15]="IncorrectMIPAuth"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Ink=1]="Ink",e[e.Erase=2]="Erase",e[e.Highlight=3]="Highlight",e[e.FreeText=4]="FreeText",e[e.PointErase=5]="PointErase"}(d||(d={})),function(e){e.Form="Form"}(l||(l={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>C,b:()=>p,c:()=>_,d:()=>m,e:()=>g,f:()=>b,g:()=>c,h:()=>s,i:()=>o,j:()=>d,k:()=>l,l:()=>u,m:()=>x,n:()=>D,o:()=>S,p:()=>v,q:()=>I,r:()=>y,s:()=>f,t:()=>h,u:()=>i,v:()=>a,w:()=>r});var a=.5,i=5,r=90,o=14,s=3,c=7,d=5,l=5,u=150,f=96,p=100,m=1,_=255,h=1e8,b=255,g="MsPdfViewer.CACHED_DISPLAY_INFO_ARRAY_STORE_KEY",v={r:0,g:81,b:186,a:1},y=1.12,S=-1,D=0,I="freeTextInitialAttributes",x=5242880,C="AbortError"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>h,c:()=>p,d:()=>_,e:()=>m,f:()=>l,g:()=>b,h:()=>r.a,i:()=>s,j:()=>d,k:()=>c,l:()=>f});var a=n("odsp.util_152"),i=n(136),r=n(30),o=window._spPageContextInfo,s=function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e}(),c=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,d=!o||"21"===o.webTemplate&&700===o.listBaseTemplate,l=(window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,a.x9.isActivated("00aa15f3-56ad-456e-84e4-13a81c33c9b8"),{ODB:60798,ODC:"DownloadDebugLogs"}),u={Fallback:!a.x9.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")},f=(a.x9.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly."),a.x9.isActivated("B1DF29B6-8677-490E-9A70-AB171BEF1F47","01/30/2024","Pass oneDs collector url to the photos app"),a.x9.isActivated("A93A8FD3-AE33-4361-94F6-B5B9B4472A91"),function(){var e=function(){if((0,i.a)())return{winappMajorVersion:100,winappMinorVersion:0,winappPatchVersion:0};var e=navigator.userAgent,t=e.substring(e.indexOf("OneDriveWinApp")),n=t&&t.split("/"),a=s&&(n.length>1?n[1].split("."):t);return{winappMajorVersion:a?parseInt(a[0],10):"-1",winappMinorVersion:a?parseInt(a[1],10):"-1",winappPatchVersion:a?parseInt(a[2],10):"-1"}}(),t=e.winappMajorVersion,n=e.winappMinorVersion,a=e.winappPatchVersion;return!(t<19||19===t&&(n<23||23===n&&a<7))}),p=((0,r.a)({ODB:61957}),{ODB:62152}),m={ODB:62153},_={ODB:62187},h={ODB:1508},b={ODB:1934}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>c});var a,i,r=n(126),o=n("odsp.util_152");!function(e){e.updateOneUpStatus="updateOneUpStatus"}(a||(a={})),function(e){e.oneUpItemCacheUpdate="oneUpItemCacheUpdate",e.oneUpSpartanUpdate="oneUpSpartanUpdate",e.initialStoreDataWhenSubscribing="initialStoreDataWhenSubscribing"}(i||(i={}));var s=function(){function e(){this._eventMC=new r.a}return e.prototype.subscribe=function(e,t,n){var a=this._eventMC.subscribe(e,t),r=this.getOneUpProperties();return t(new CustomEvent("updateOneUpStatus",{detail:{publisher:i.initialStoreDataWhenSubscribing,update:r}})),a},e.prototype.update=function(e,t){this._focusItem=e.focusItem||this._focusItem,this._focusItemSet=e.focusItemSet||this._focusItemSet,this._parentItem=e.parentItem||this._parentItem,this._currentIndex=void 0!==e.currentIndex?e.currentIndex:this._currentIndex,this._focusItemKey=e.focusItemKey||this._focusItemKey,this._childItemKeys=e.childItemKeys||this._childItemKeys,this._currentItemSetKey=e.currentItemSetKey||this._currentItemSetKey,this._list=e.list||this._list,this._appLevelPageContext=e.appLevelPageContext||this._appLevelPageContext,this._pageContexts=e.pageContexts||this._pageContexts,this._parentStoreKey=e.parentStoreKey||this._parentStoreKey,this._invalidateitemsAfterRename=e.invalidateItemsAfterRename||this._invalidateitemsAfterRename;var n={publisher:t,update:e};this._eventMC.publish(a.updateOneUpStatus,n)},e.prototype.getOneUpProperties=function(){return this._focusItem?{focusItem:this._focusItem,focusItemSet:this._focusItemSet,parentItem:this._parentItem,currentIndex:this._currentIndex,focusItemKey:this._focusItemKey,childItemKeys:this._childItemKeys,currentItemSetKey:this._currentItemSetKey,list:this._list,appLevelPageContext:this._appLevelPageContext,pageContexts:this._pageContexts,parentStoreKey:this._parentStoreKey,invalidateItemsAfterRename:this._invalidateitemsAfterRename}:void 0},e.prototype.clean=function(){this._focusItem=void 0,this._focusItemSet=void 0,this._parentItem=void 0,this._currentIndex=void 0,this._focusItemKey=void 0,this._childItemKeys=void 0,this._currentItemSetKey=void 0,this._list=void 0,this._appLevelPageContext=void 0,this._pageContexts=void 0,this._parentStoreKey=void 0},Object.defineProperty(e.prototype,"focusItem",{get:function(){return this._focusItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusItemSet",{get:function(){return this._focusItemSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentItem",{get:function(){return this._parentItem},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusItemKey",{get:function(){return this._focusItemKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childItemKeys",{get:function(){return this._childItemKeys},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentItemSetKey",{get:function(){return this._currentItemSetKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this._list},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContexts",{get:function(){return this._pageContexts},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"appLevelPageContext",{get:function(){return this._appLevelPageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentStoreKey",{get:function(){return this._parentStoreKey},enumerable:!1,configurable:!0}),e}(),c=new o.aF({name:"OneUpStore",factory:{dependencies:{},create:function(){return{instance:new s}}}})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});var a=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.midPointTo=function(t){return new e((this.x+t.x)/2,(this.y+t.y)/2)},e.prototype.symmetricMap=function(){return new e(-this.x,-this.y)},e.prototype.plus=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.prototype.round=function(){return Math.round(this.x),Math.round(this.y),this},e}(),i=function(){function e(e,t,n,i){this.origin=new a(e,t),this.size={width:n,height:i}}return e.create=function(t){return new e(t.origin.x,t.origin.y,t.size.width,t.size.height)},e.prototype.scale=function(e){return this.origin.scale(e),this.width*=e,this.height*=e,this},e.prototype.intersect=function(t){if(t){var n=Math.max(this.x,t.x),a=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return n<a&&i<r?new e(n,i,a-n,r-i):void 0}},e.prototype.area=function(){return this.width*this.height},e.prototype.ceil=function(){var e=this.right,t=this.bottom;return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.ceil(e)-this.x,this.height=Math.ceil(t)-this.y,this},e.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},e.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,"), ").concat(this.width," * ").concat(this.height)},Object.defineProperty(e.prototype,"x",{get:function(){return this.origin.x},set:function(e){this.origin.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.origin.y},set:function(e){this.origin.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.size.width},set:function(e){this.size.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.size.height},set:function(e){this.size.height=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_538"),i=n(58),r=n(268),o=function(){function e(e,t,n){var a=new r.d(e);t(a),this._id=a.payload.id,this._name=e.name,this._active=!0,this._startExtraData=e.extraData||{},this._logQosEnd=n}return e.prototype.stop=function(e){this._active&&this._logEnd(i.b.Succeed,e||{})},e.prototype.fail=function(e){this._active&&this._logEnd(i.b.Fail,(0,a.q5)({isExpected:!1},e))},e.prototype._logEnd=function(e,t){t.extraData=(0,a.q5)((0,a.q5)({},this._startExtraData),t.extraData);var n=new r.c(this._id,this._name,e,t);this._logQosEnd(n),this._active=!1},e}(),s="PDF:Telemetry".concat("undefined"==typeof window?" | Worker":""),c=function(){function e(){}return e.prototype.logQosStart=function(e){var t=e.payload;console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,",\n        ").concat(t.startTime,", extraData: ").concat(JSON.stringify(t.extraData)))},e.prototype.logQosEnd=function(e){var t=e.payload,n="[".concat(s,"] [").concat(e.type,"]: ").concat(t.id," | ").concat(t.name,": ").concat(t.status,", ").concat(t.endTime,", ");switch(t.status){case i.b.Succeed:var a=t;n+="extraData: ".concat(JSON.stringify(a.extraData));break;case i.b.Fail:var r=t;n+="isExpected: ".concat(r.isExpected,", code: ").concat(r.code," error: ").concat(JSON.stringify(r.error),", extraData: ").concat(JSON.stringify(r.extraData))}console.log(n)},e.prototype.logEngagement=function(e){this._log(e)},e.prototype.logError=function(e){this._log(e)},e.prototype.logVerbose=function(e){this._log(e)},e.prototype._log=function(e){console.log("[".concat(s,"] [").concat(e.type,"]: ").concat(JSON.stringify(e.payload)))},e}(),d=function(){function e(){}return e.initialize=function(t){e._handler=t},e.createScenario=function(t){var n=e.handler,a=n.logQosStart,i=n.logQosEnd;return new o(t,a,i)},e.logEngagement=function(t){var n=new r.b(t);e.handler.logEngagement(n)},e.logError=function(t){var n=new r.a(t);e.handler.logError(n)},e.logVerbose=function(t){var n,a,i=new r.e(t);null===(a=(n=e.handler).logVerbose)||void 0===a||a.call(n,i)},Object.defineProperty(e,"handler",{get:function(){return e._handler},enumerable:!1,configurable:!0}),e._handler=new c,e}(),l=d.initialize}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152"),i=new a.aF({name:"platformDetection",factory:new a.In(a.rC)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>S});var a=n("odsp.util_152"),i=n(85),r=n(259),o=n(121),s=n(6),c=n(120),d=n(34),l=n(30),u=new a.aF({name:"alwaysUseTokenFetcherForVroom",factory:new a.KS(!1)}),f=!a.x9.isActivated("5190349E-1CFC-4163-AA2E-1494CEAFD7DF"),p=(0,l.a)({ODB:-671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource,this._alwaysUseTokenFetcherForVroom=t.alwaysUseTokenFetcherForVroom}return e.prototype.getToken=function(e,t,n){var i,o,c=null==n?void 0:n.apiQosName,l=this._identityDataSource.getIdentity().type,u=new d.a(t).authority;if(l!==r.a.aad)return f&&u?this._identityDataSource.getSessionToken(!1,!1,void 0,u,{apiQosName:c}):this._identityDataSource.getSessionToken(void 0,void 0,void 0,void 0,{apiQosName:c});if((null==n?void 0:n.useStrongAuthToken)&&this._identityDataSource.getStrongAuthToken)return this._identityDataSource.getStrongAuthToken({apiQosName:c});if(t&&(p||this._alwaysUseTokenFetcherForVroom)){var m=new d.a(t).authority;return null===(o=(i=this._identityDataSource).getSharePointToken)||void 0===o?void 0:o.call(i,m,void 0,void 0,{apiQosName:c})}return this._microServiceDataSource?this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return s.c.resolve()}):s.c.reject(new a.qt({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){var t,n;return null===(n=(t=this._identityDataSource).getFormDigest)||void 0===n?void 0:n.call(t,e)},e.dependencies={identityDataSource:c.a,microServiceDataSource:o.a.optional,alwaysUseTokenFetcherForVroom:u},e}(),_=(0,a._y)("SessionManagementProvider",m),h=n(205),b=n(388),g=n(391),v="VroomDataRequestor",y=new a.aF({name:"".concat(v,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:b.a},create:function(e){return{instance:function(){return s.c.resolve(e.isOfflineStateObservable.get())}}}}}),S=(0,a._y)(v,h.a,{sessionManagementProvider:_.optional,urlDataSource:i.a.optional,cookieOrigin:g.a,isOffline:y})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("urlLite")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("odsp.util_152"),i=n(258),r=n(30),o=function(){function e(){}return e.prototype.onChange=function(){return function(){}},Object.defineProperty(e.prototype,"offline",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),s=function(){function e(){this._detector=(0,i.a)(!0)}return e.prototype.onChange=function(e){return this._detector.onChange(e)},Object.defineProperty(e.prototype,"offline",{get:function(){return this._detector.offline},enumerable:!1,configurable:!0}),e}(),c=new a.aF({name:"offlineDetection",factory:(0,r.a)({ODB:60362})?new a.In(s):new a.In(o)})}
,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.CloudImport=42]="CloudImport",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}(a||(a={}));const i=a}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a,i,r=n("tslib_538");!function(e){e.MSPDF_LOG_VERBOSE="VERBOSE",e.MSPDF_LOG_INFO="INFO",e.MSPDF_LOG_WARNING="WARNING",e.MSPDF_LOG_ERROR="ERROR"}(a||(a={})),function(e){e.GREEN="green",e.CYAN="cyan"}(i||(i={}));var o=function(){function e(){}return e._format=function(e,t,n){return"[".concat("MSPDFKit-Web","] ").concat(e," | ").concat(t,": ").concat(n)},e._tint=function(e,t){return["%c".concat(e),"color:".concat(t)]},e.prototype.verbose=function(t,n){console.log(e._format(a.MSPDF_LOG_VERBOSE,t,n))},e.prototype.info=function(t,n){console.info.apply(console,(0,r.lt)([],(0,r.pM)(e._tint(e._format(a.MSPDF_LOG_INFO,t,n),i.GREEN)),!1))},e.prototype.warn=function(t,n){console.warn(e._format(a.MSPDF_LOG_WARNING,t,n))},e.prototype.error=function(t,n){console.error(e._format(a.MSPDF_LOG_ERROR,t,n.toString()))},e.prototype.time=function(e){console.time(e)},e.prototype.timeEnd=function(e){console.timeEnd(e)},e}(),s=function(){function e(){}return Object.defineProperty(e,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),e.initialize=function(t){e._logHandler=t},e.verbose=function(t,n){e.enabled&&e._logHandler.verbose(t,n)},e.info=function(t,n){e.enabled&&e._logHandler.info(t,n)},e.warn=function(t,n){e.enabled&&e._logHandler.warn(t,n)},e.error=function(t,n){e.enabled&&e._logHandler.error(t,n)},e.time=function(t){e.enabled&&e._logHandler.time&&e._logHandler.time(t)},e.timeEnd=function(t){e.enabled&&e._logHandler.timeEnd&&e._logHandler.timeEnd(t)},e._enabled=!1,e._logHandler=new o,e}()}
,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles",e[e.StockImages=38]="StockImages",e[e.Bing=39]="Bing",e[e.Local=40]="Local",e[e.ChannelSharedList=41]="ChannelSharedList",e[e.SharedByUser=42]="SharedByUser"}(a||(a={}));const i=a}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("identity")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("".concat("MicroServiceDataSource.key",".microServiceDataSource"))}
,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>a,b:()=>i}),function(e){e[e.View=0]="View",e[e.Edit=1]="Edit",e[e.Extract=2]="Extract",e[e.Esign=3]="Esign"}(a||(a={})),function(e){e.ExitEditMode="ExitEditMode"}(i||(i={}))}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>d});var a=n(96),i="text/plain",r={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}function s(e,t){return!!e&&c(e,t)}function c(e,t){return function(e){return e=o(e),r.hasOwnProperty(e)}(e)&&(t===a.a.File||t===a.a.Media||t===a.a.Unknown)}function d(e){var t=o(e);return r.hasOwnProperty(t)?r[t]:void 0}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>m});var a=n("tslib_538"),i=n(59),r=n(74);const o="0.15.3";var s=n(31),c=n(750),d=n(380),l=n(184),u=function(){function e(){}return e.dispose=function(){},e.retreive=function(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(a){return[2,(0,d.c)(e,t,n)]})})},e.update=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,(0,d.d)(e,t)];case 1:return n.sent(),[2]}})})},e}(),f="GetWasmAsset",p=function(){function e(){var e=this;this.wasmModuleInnerInitPromise={},this.initialize=function(t){if(void 0===t&&(t="Main"),!e.wasmModuleInnerInitPromise[t]){var n=s.a.wasmModuleInit.find(function(e){return e.type||"Main"===t});n&&(e.wasmModuleInnerInitPromise[t]=e.convertModuleInit(n))}},this.convertModuleInit=function(t){return(0,a.yv)(e,void 0,void 0,function(){var e,n,o,s,c,d,u,p;return(0,a.SO)(this,function(a){switch(a.label){case 0:if(e=t.wasmUrl,n=t.noCache,o=t.wasmJsUrlOrBlob,s=t.dataUrl,c=t.type,n)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.getWasmBinaryFromCache(e,c)];case 2:return d=a.sent(),[3,4];case 3:return u=a.sent(),p=new i.c(i.b.WasmCacheFailed,"Fail to work on wasm cache, reason: ".concat(u)),r.a.logError(p.toCaughtError()),[3,4];case 4:return d?[3,6]:[4,(0,l.c)(e,{credentials:"same-origin"},f)];case 5:d=a.sent(),a.label=6;case 6:return 0===d.byteLength&&r.a.logError(new i.c(i.b.WasmModuleInitFailed,"The wasm binary is empty and the module instantiation will fail, wasmUrl=".concat(encodeURIComponent(e))).toCaughtError()),[2,{wasmBinary:d,wasmJsUrlOrBlob:o,dataUrl:s,type:c}]}})})}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getModuleInnerInit=function(e){return void 0===e&&(e="Main"),this.initialize(e),this.wasmModuleInnerInitPromise[e]},e.prototype.dispose=function(){var e;this.wasmModuleInnerInitPromise={},null===(e=this.wasmDataCache)||void 0===e||e.dispose()},e.prototype.getWasmBinaryFromCache=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,p,m,_,h;return(0,a.SO)(this,function(a){switch(a.label){case 0:return s.a.disableExternalWasmCache||!(0,c.a)()&&!(0,c.b)()?[3,2]:[4,this.setExternalWasmCache()];case 1:return a.sent(),[3,3];case 2:this.wasmDataCache=u,a.label=3;case 3:if(!this.wasmDataCache)throw"The wasmDataCache is not defined";n="".concat(t||"Main"),a.label=4;case 4:return a.trys.push([4,6,,7]),[4,this.wasmDataCache.retreive(d.a,n,o)];case 5:return(p=a.sent())&&0!==p.byteLength?(r.a.logVerbose({message:"PDF WASM Cache hit. key: ".concat(n)}),[2,p]):[3,7];case 6:return m=a.sent(),_=new i.c(i.b.WasmCacheFailed,"Fail to read from wasm cache, key: ".concat(n," error: ").concat(m)),r.a.logError(_.toCaughtError()),[3,7];case 7:return r.a.logVerbose({message:"PDF WASM Cache miss. key: ".concat(n)}),[4,(0,l.c)(e,{credentials:"same-origin"},f)];case 8:return h=a.sent(),this.wasmDataCache.update(d.a,{key:n,value:h,version:o}).catch(function(e){var t=new i.c(i.b.WasmCacheFailed,"Fail to update wasm cache, error: ".concat(e));r.a.logError(t.toCaughtError())}),"Main"===n&&this.deleteOldWasmCache().catch(function(e){var t=new i.c(i.b.WasmCacheFailed,"Fail to delete old wasm cache, error: ".concat(e));r.a.logError(t.toCaughtError())}),[2,h]}})})},e.prototype.setExternalWasmCache=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,n.e(27).then(n.bind(n,396))];case 1:return e=t.sent(),this.wasmDataCache=e.ExternalWasmCache,[2]}})})},e.prototype.deleteOldWasmCache=function(){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(e){return[2,(0,d.b)(d.a,"".concat("Main","-"))]})})},e}(),m=p.getInstance().initialize}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>m,b:()=>_,c:()=>p,d:()=>a,e:()=>i,f:()=>d,g:()=>b,h:()=>o,i:()=>h,j:()=>f,k:()=>u,l:()=>s,m:()=>c,n:()=>l,o:()=>g});var a,i,r=n(12),o="OneUpLightSpeed.fastOneUp.boot",s="OneUpLightSpeed.fastOneUp.getSingleItem",c="OneUpLightSpeed.getSingleItem.preloadRLDSData",d="OneUpLightSpeed.getSingleItem.callRLDS_gListDataInvalid",l="OneUpLightSpeed.getSingleItem.race.callRLDS",u="OneUpLightSpeed.fastOneUp.getSingleItemFavoriteStatus",f="OneUpLightSpeed.getSingleItem.ensureParentItem",p=(0,r.pb)()?5e3:3e5,m=(0,r.pb)()?5e3:12e4,_=(0,r.pb)()?5e3:12e4;function h(e,t){var n=new Error(e);return n.name=t||e,n}function b(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}function g(e){if(e)try{var t=JSON.stringify(e),n=new RegExp(/\"http[s]*:\/\/(.*?)\"/,"g");return t.replace(n,'"<sanitized>"')}catch(e){return""}return""}!function(e){e.rldsApiError="rldsApiError",e.viewerInitLoadingError="viewerInitLoadingError",e.genericViewerLoadingError="genericViewerLoadingError",e.actionError="actionError",e.reactRenderError="reactRenderError",e.processOneUpItemError="processOneUpItemError",e.rldsApiErrorNoAccess="rldsApiErrorNoAccess"}(a||(a={})),function(e){e.inlineOneUpFirstPage="inlineOneUpFirstPage",e.inlineOneUpSlide="inlineOneUpSlide",e.fastOneUp="fastOneUp"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>me,b:()=>_e});var a=n("odsp.util_152"),i=n(49),r=n("tslib_538"),o=n(437),s=n(11),c=n(24),d=n(33),l=n(18),u=n(94),f=n(95),p=n(67),m=new a.aF({name:"isOneDriveHomeEnabled.key",factory:new a.KS(function(){return!1})}),_=new a.aF({name:"isPeopleEnabled.key",factory:new a.KS(function(){return!1})}),h=n(51),b=n(232),g=n(5),v=n(30),y=n(136),S={ODB:61527},D={pageContext:g.a},I=function(e){var t=e.pageContext,n=!(0,y.b)()&&((0,v.a)(S)||!(0,b.a)()&&function(e,t){return!(!e||1!==(0,h.c)(90244,e))}(t));return I=function(){return n},n},x=new a.aF({name:"isInlineOneDriveSharedFolderEnabled",factory:{dependencies:D,create:function(e){return{instance:function(){return I(e)}}}}}),C=new a.aF({name:"isOpenSharedFolderInPeopleEnabled.key",factory:new a.KS(function(){return!1})}),O=new a.aF({name:"forceLoadAllFoldersInCurrentPage",factory:new a.KS(!1)}),w={ODB:61770},E=a.x9.isActivated("79CFF990-D05C-499D-A210-9CAA1C965AC7"),A={pageContext:g.a},L=function(e){var t=e.pageContext,n=!(0,y.b)()&&((0,v.a)(w)||!(0,b.a)()&&!!(null==t?void 0:t.isMySiteOwner)&&(E||!(0,h.a)(90293,t))&&function(e,t){return!(1!==(0,h.c)(90316,e))}(t));return L=function(){return n},n};new a.aF({name:"isOpenSharedFolderInPeopleEnabled",factory:{dependencies:A,create:function(e){return{instance:function(){return L(e)}}}}});var k=n(371),M=n(118),P=n(40),T=n(88),U=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"];const F=function(){function e(){}return e.isAllowed=function(e){return!(U.indexOf(e.toLocaleLowerCase())>=0)},e}();var H=n(125),R=n(130),N=n(180),B=n(438),j=n(83),V=!a.x9.isActivated("CDDAA141-CBD4-42B5-B007-A9A9340B8D9F"),z=new a.aF({name:"addDefaultParentViewOnViewerOpenUrls.key",factory:new a.KS(!1)}),G=!a.x9.isActivated("960440C4-4144-497B-83AA-14E753E48334"),K=n(137),W=a.x9.isActivated("0BDCFE01-8561-489C-A50B-50AAF7E489CA"),q=!a.x9.isActivated("2FFBE9AD-3AB7-4FF3-BF02-88F9171B020D"),Q="wopiframe.aspx",Y="doc.aspx",J={ODB:!p.i},X={ODB:!p.i||1413},Z={ODB:1080},$={ODB:1064},ee={platformDetection:j.a,isOneDriveHomeEnabled:m,isPeopleEnabled:_,isInlineOneDriveSharedFolderEnabled:x.optional,isOpenSharedFolderInPeopleEnabled:C.optional,addDefaultParentViewOnViewerOpenUrls:z.optional,forceLoadAllFoldersInCurrentPage:O.optional},te=new a.aF({name:"GetDefaultClickUrl",factory:{dependencies:ee,create:function(e){var t=e.isPeopleEnabled,n=e.isInlineOneDriveSharedFolderEnabled,i=e.isOpenSharedFolderInPeopleEnabled,o=e.addDefaultParentViewOnViewerOpenUrls,m=e.forceLoadAllFoldersInCurrentPage;return{instance:function(_){var b=_.defaultRootItemId,g=_.pageContext,y=_.isDocSet,S=_.listId,D=_.listItemId,I=_.itemKey,x=_.itemType,C=_.itemList,O=_.itemOpenUrl,w=_.itemOpenInOfficeOnlineUrl,A=_.itemPreviewIFrameUrl,L=_.itemQueryType,U=_.itemOfficeBundle,j=_.itemContentTypeId,z=_.itemUrls,G=_.itemUrlHelper,ee=_.itemSubsite,te=_.itemExtension,ie=_.itemFSObjType,re=_.itemTranslationLanguages,oe=_.isUnifiedAppSupportedFile,se=_.welcomePageCustomized,ce=_.viewParams,de=_.parentItemKey,le=_.parentItemLink,ue=_.supportsOneUp,fe=_.urlType,pe=void 0===fe?"default":fe,me=_.additionalViewParams,_e=_.driveType,he=_.isRootFolder,be=_.isItemInOtherUsersOneDrive,ge=_.mySiteOwner,ve=_.mainLinkInfo,ye=_.page,Se=void 0===ye?(0,N.f)(ce):ye,De=(0,N.e)(I),Ie=(0,N.c)({key:I,viewParams:ce,defaultRootItemId:b});me&&(0,R.a)(Ie,me),(0,K.a)()&&delete Ie[P.b.shareTokenKey];var xe,Ce=(0,r.q5)({},Ie),Oe=function(){return ne({itemKey:I,parentItemKey:de,params:Ce,supportsOneUp:ue,itemUrlHelper:G,page:Se,addDefaultParentViewOnViewerOpenUrls:o,mainLinkInfo:ve})},we=q?function(){var e;return(null===(e=_.getMediaUrl)||void 0===e?void 0:e.call(_))||Oe()}:_.getMediaUrl||Oe,Ee=!!p.j&&(0,v.a)(J),Ae=!p.j||(0,v.a)(X),Le=(0,p.l)(),ke=_e===B.a.business,Me=!W&&m||Se===T.a.FilePicker||Se===T.a.FileBrowser;Me&&(Ie[P.b.pageParamKey]=Se);var Pe=De[P.b.queryTypeParamKey];if((!Pe||Number(Pe)===M.a.Files)&&e.isOneDriveHomeEnabled()&&(Ie[P.b.queryTypeParamKey]=M.a.Files),Se===T.a.FilePicker&&x!==k.a.Folder)return"";if(L&&(0,N.i)(L)&&!(0,N.i)((0,N.g)(De)))return"";var Te=G.getItemUrlParts(I),Ue="focus"===pe&&!(U&&Te.isCrossDomain)||(0,v.a)(Z)&&L===M.a.SharedWithMe&&U&&p.i,Fe=Te.fullItemUrl,He="current"===pe?k.a.Folder:"external"===pe?k.a.Unknown:x;if(delete Ie[P.b.noAuthRedirect],(0,N.b)(ce)&&"existing"===pe||Ue)xe=we();else if(oe)xe=w||"";else if(U&&U.enableDefaultClick)xe=we();else switch(He){case k.a.Media:xe=we();break;case k.a.Folder:var Re=Ee,Ne=Te.geoRelation!==s.a.sameGeo;if(delete Ie[P.b.navParamKey],delete Ie[P.b.viewerKey],p.i&&!Le&&Te.isCrossList)return"";if(!Me&&ee&&(Ne||ee.isExternal)&&!Re)return ee.serverRelativeUrl;if(!Me&&C&&(Ne||C.isExternal)&&!Re)return Te.fullItemUrl||"";if(y&&(!Ae||se))return O||"";if(Me||!Te.isCrossList&&Te.siteRelation===s.d.sameSite||Number(g.webTemplate)===d.b.mySite&&g.isNoScriptEnabled&&Te.isCrossDomain&&!ke&&(!Ne||Re))he&&ge&&be&&t()&&(null==n?void 0:n())&&(Ie[P.b.emailIdKey]=ge,Ie[P.b.queryTypeParamKey]=M.a.People),xe="#".concat((0,c.a)(Ie,void 0,!1));else if(be&&(!E&&(0,h.a)(90293,g)||(null==i?void 0:i())))he&&ge&&t()&&(null==n?void 0:n())&&(Ie[P.b.emailIdKey]=ge,Ie[P.b.queryTypeParamKey]=M.a.People),xe="#".concat((0,c.a)(Ie,void 0,!1));else if(Ie[P.b.remoteItem])xe="#".concat((0,c.a)(Ie));else{if(O&&(Be=new l.a(O)).getScheme()){xe=O;break}xe=f.a(Te.fullItemUrl||"")}break;case k.a.Shortcut:xe=z&&z[u.b.shortcutTarget]||O||"";break;case k.a.File:if(te&&(0,H.a)(te,He))xe=Se===T.a.TextFileEditor&&F.isAllowed(te||"")?function(e){var t=e.itemKey,n=e.parentItemKey,i=e.parentItemLink,r=e.viewParams,o=e.supportsOneUp,s=e.defaultRootItemId,d=e.addDefaultParentViewOnViewerOpenUrls,l=(0,N.c)({key:t,viewParams:r,defaultRootItemId:s}),u=(0,a.Ho)(n||""),f=u[P.b.idParamKey];if("root"===f){var p=(0,a.Ho)(t)[P.b.listUrlKey];p&&(f=p)}if(l[P.b.parentIdParamKey]=f,V){var m=d?M.a.Files:void 0,_=u[P.b.queryTypeParamKey]||m;void 0!==_&&(l[P.b.parentQueryTypeParamKey]=_)}else l[P.b.parentQueryTypeParamKey]=u[P.b.queryTypeParamKey];l[P.b.pageParamKey]=T.a.TextFileEditor,delete l[P.b.queryTypeParamKey];var h="";return!o&&i?(delete l[P.b.parentQueryTypeParamKey],h=i,"".concat(i,"?").concat((0,c.a)(l,void 0,!0))):(Number(r[P.b.pageParamKey])!==T.a.TextFileEditor&&(h=(0,N.a)()+window.location.pathname),"".concat(h,"#").concat((0,c.a)(l,void 0,!0)))}({itemKey:I,parentItemKey:de,parentItemLink:le,viewParams:ce,supportsOneUp:ue,defaultRootItemId:b,addDefaultParentViewOnViewerOpenUrls:o}):we();else if(re&&re.length>0||function(e){return!!e&&e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B")>-1}(j)){var Be;O?((Be=new l.a(O)).setQueryParameter("stay","true"),xe=Be.toString()):xe=""}else if((0,v.a)($)&&ae(O,Fe)){if(".aspx"==="".concat(te).toLowerCase()&&O)return O;xe=we()}else xe=O||I&&"#"+I;break;default:xe=(0,v.a)($)&&ae(O,Fe)&&te?we():O||I&&"#"+I}if(S&&(He===k.a.File&&A&&(-1!==A.toLowerCase().indexOf(Q)||-1!==A.toLowerCase().indexOf(Y))||He===k.a.OneNote)){var je=new l.a(xe);je.getLastPathSegment().toLowerCase()!==Q&&je.getLastPathSegment().toLowerCase()!==Y||(je.setQueryParameter("1"===ie?"IsFolder":"IsList","1"),je.setQueryParameter("ListId",S),je.setQueryParameter("ListItemId",D||""),xe=je.toString())}return function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e}(xe)}}}}});function ne(e){var t,n=e.itemKey,i=e.params,r=void 0===i?{}:i,o=e.parentItemKey,s=e.supportsOneUp,d=e.itemUrlHelper,l=e.page,u=e.addDefaultParentViewOnViewerOpenUrls,f=e.mainLinkInfo;if(!s){var p=d.getItemUrlParts(n),m=p.serverRelativeItemUrl||"",_=((t={})[P.b.idParamKey]=m,t[P.b.parentIdParamKey]=m.substring(0,m.lastIndexOf("/")),t);return"".concat(p.fullListUrl,"?").concat((0,c.a)(_,void 0))}var h=(0,a.Ho)(o||"");r[P.b.parentIdParamKey]=h[P.b.idParamKey];var b=(0,N.h)(r);if(b){var g=b.mountPoint,v=b.remoteSpItem;if(v){var y={mountPoint:g,remoteSpItem:{listFullUrl:v.listFullUrl,rootFolder:h[P.b.idParamKey],webAbsoluteUrl:v.webAbsoluteUrl}};(0,R.a)(r,(0,N.j)(y))}}if(V){var S=u?M.a.Files:void 0,D=h[P.b.queryTypeParamKey]||S;void 0!==D&&(r[P.b.parentQueryTypeParamKey]=D)}else r[P.b.parentQueryTypeParamKey]=h[P.b.queryTypeParamKey];for(var I in delete h[P.b.idParamKey],delete h[P.b.queryTypeParamKey],delete h[P.b.uniqueParamKey],r){var x=r[I];(null==x||""===x&&I.indexOf("FilterValue")<0)&&delete r[I]}return l&&l!==T.a.Files&&(r[P.b.pageParamKey]="".concat(l)),(0,K.a)()&&(null==f?void 0:f.ShareTokenString)&&(r[P.b.shareTokenKey]=f.ShareTokenString),"#"+(0,c.a)(r,h,!1)}function ae(e,t){return G?function(e,t){if(G){if(!e||!t)return!1;try{if((0,o.a)(e)===t)return!0}catch(e){}try{if(e===t||e===(0,o.a)(t))return!0}catch(e){}return!1}return e===(t&&f.a(t))}(e,t):!(!e||!t||(0,o.a)(e)!==(0,o.a)(t))}function ie(e){var t=function(e,t){var n=e.appMap?e.appMap.toLowerCase():void 0;return"ms-powerpoint"===n||"ms-word"===n||"ms-visio"===n||"ms-excel"===n||!1}(e);return t&&function(e){return!!(e&&e.openUrl&&e.appMap)}(e)&&!a.ov.isFeatureEnabled({ODB:826,OneDrive:!0})}new Set(["WacFailed.DocumentIsIRMProtected","WacFailed.5243086","WacFailed.5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]);var re=n(21),oe=n(54),se=n(237),ce=n(439),de=ce.b.protocolCommand,le=n(440),ue=n(138),fe=n(139),pe=function(){function e(e,t){this._pageContext=t.pageContext,this._navigation=t.navigation,this._itemUrlHelper=t.itemUrlHelper,this._getDefaultClickUrl=t.getDefaultClickUrl,this._platform=t.platform,this._isFastOneUp=t.isFastOneUp,this._addDefaultParentViewOnViewerOpenUrls=t.addDefaultParentViewOnViewerOpenUrls}return e.prototype.getDefaultClickUrlForOneUp=function(e,t){var n,a,i,r=this;if(!e||!e.key)return"";var o=this._navigation.viewParams,s=null==t?void 0:t.parentItem,c=(0,N.f)(o),d=this._itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||"",l=(0,N.c)({key:e.key,viewParams:o,defaultRootItemId:d}),u={itemKey:e.key,viewParams:o,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,isDocSet:e.isDocSet,listId:this._pageContext.listId,listItemId:e.properties&&e.properties.ID,itemType:e.type,itemList:e.list,itemOpenUrl:e.openUrl,itemPreviewIFrameUrl:e.previewIFrameUrl,itemQueryType:e.queryType,itemOfficeBundle:e.officeBundle,itemContentTypeId:e.contentTypeId,itemUrls:e.urls,itemSubsite:void 0,itemExtension:e.extension,itemFSObjType:null===(n=e.properties)||void 0===n?void 0:n.FSObjType,itemTranslationLanguages:null===(a=e.properties)||void 0===a?void 0:a._SPTranslatedLanguages,isUnifiedAppSupportedFile:ie(e),welcomePageCustomized:null===(i=e.properties)||void 0===i?void 0:i.WelcomePageCustomized,getMediaUrl:function(){return ne({itemKey:e.key,parentItemKey:null==s?void 0:s.key,params:l,supportsOneUp:!0,itemUrlHelper:r._itemUrlHelper,page:c,addDefaultParentViewOnViewerOpenUrls:r._addDefaultParentViewOnViewerOpenUrls,mainLinkInfo:e.mainLinkInfo})},parentItemKey:s&&s.key,supportsOneUp:!0,urlType:null==t?void 0:t.urlType,defaultRootItemId:d,page:c,mainLinkInfo:e.mainLinkInfo},f=this._getDefaultClickUrl(u);return this._isFastOneUp&&(f=f.replace("#","?")),f},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,r,o,s,c,d,l,u=e.appMap,f=e.properties&&e.properties.path||this.getItemUrl(e.key),p=e.extension||"",m=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(p.toLowerCase()),_=e.queryType===M.a.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap);return r=u,o=f,s=oe.a.hasItemPermission(e,oe.a.editListItems)&&!m&&(!se.c(e)||se.b(e,this._pageContext.userId))||_?de.Edit:de.View,c=(null===(a=this._platform)||void 0===a?void 0:a.isChrome)&&(null===(i=this._platform)||void 0===i?void 0:i.isMac),d=this._pageContext.isSPO,l=ce.a.none,c&&(l=ce.a.encodeCommand),ce.b.createProtocolHandlerUrl(r,o,s,"",l,d)},e.prototype.getKey=function(e){return(0,N.d)(e)},e.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return f.a((null==t?void 0:t.fullItemUrl)||"")},e.prototype.getOpenInOfficeOnlineUrl=function(e,t){var n,a=e;return n=ie(e)?le.a.GetWopiDocEditUrl(a,t||"",this._pageContext.env):le.a.GetWopiFrameEditUrl(a),this._ensureLayouts15(n||e.openUrl||"")},e.prototype.getApiBaseUrl=function(e){var t="v2.1"===(null==e?void 0:e.apiVersion)?e.apiVersion:"v2.0";return"".concat((0,fe.b)(this._pageContext),"/_api/").concat(t)},e.prototype.getKeyParams=function(e){return(0,N.e)(e)},e.prototype.getPageType=function(e){return(0,N.f)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),(0,N.g)(e)},e.prototype._ensureLayouts15=function(e){return e&&-1!==e.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(e=(e=e.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),e},e.dependencies={navigation:i.a,pageContext:g.a,resources:a.XQ,itemUrlHelper:re.c,getDefaultClickUrl:te,platform:j.a,isFastOneUp:ue.e.optional,addDefaultParentViewOnViewerOpenUrls:z.optional},e}();const me=pe;var _e=(0,a._y)("OneUpUrlDataSource",pe)}
,(e,t,n)=>{"use strict";var a;function i(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}}function r(){return void 0===a&&(a=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||i()),a}n.d(t,{a:()=>i,b:()=>r})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>u,c:()=>l,d:()=>s,e:()=>i,f:()=>d,g:()=>f,h:()=>o,i:()=>r});var a=n("odsp.util_152"),i=(n(5),new a.aF("ResourceKeys")),r=new a.aF("ResourceKeys"),o=new a.aF("ResourceKeys"),s=new a.aF("ResourceKeys"),c=new a.aF("ResourceKeys"),d=new a.aF("ResourceKeys"),l=new a.aF("ResourceKeys"),u=new a.aF("ResourceKeys"),f=new a.aF("ResourceKeys")}
,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n("tslib_538"),i={UseBlobForStringLength:"510d7ace-c669-4a2c-b87c-17de82da37b3",UseGripperSelectText:"87777701-6913-40b9-bb10-4b86c005fbdf",CheckWorkerVersion:"4d99680d-88bd-4dff-99a1-7e3eebd51734",UseSizeObserver:"66c17183-e7b2-4755-a82e-a9a2c20f5d16",UseExternalCidFont:"dc778e1c-946e-42b2-a4f8-5fd70cde9539",EnableCJKInFormTextField:"f3fc69e6-5bdc-4f0f-a5c0-c070ead620ec",StoreFreeTextAttributeInLocalStorage:"24019b2e-df14-4d7f-9fb4-04dbe0ce8933",EnableICUConverter:"ce1c33bb-89ca-4343-9fb4-f2d1d1f101a2",EnableProgressiveDocumentHandler:"d3788b76-abcd-472d-8927-581f42e7a04c",AddOutlineCheck:"8b994226-443a-4593-bf91-ff9fe85c3195",EnableDynamicChunkRequestSize:"bcbadf30-a483-4a3f-9a69-b28997496071",SendMipTelemetryFromWorker:"a27f106d-c10b-4387-afaf-2078ab9775f6",CacheFontFile:"db703eee-5499-45e0-9a72-b1b4ebafb127",CacheMipWasm:"bd4a128d-2b4f-4fa0-8372-903fb1f03381",EnableFetchDataByRangeStream:"72c0dc1c-9a51-4194-806a-8bac708b0359",FRTWithPrerender:"f10f1d8e-ba31-45c1-abae-3d2808cb1714"},r=function(){function e(){}return e.initialize=function(t){var n,r;e.activatedKillSwitches=[];try{for(var o=(0,a.BW)(Object.keys(i)),s=o.next();!s.done;s=o.next()){var c=s.value,d=i[c];t(d)&&e.activatedKillSwitches.push(d)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.isActivated=function(t){var n=i[t];return e.activatedKillSwitches.includes(n)},Object.defineProperty(e,"activatedKillSwitches",{get:function(){return e._activatedKillSwitches},set:function(t){e._activatedKillSwitches=t},enumerable:!1,configurable:!0}),e._activatedKillSwitches=[],e}(),o=r.initialize}
,(e,t,n)=>{"use strict";var a,i;function r(){a=self._pdfSessionPerfMarks=[]}function o(){return void 0===i&&(i=void 0!==typeof performance&&!!performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.now),i}function s(){return"undefined"!=typeof MSPDF_PERF_LAB&&MSPDF_PERF_LAB}n.d(t,{a:()=>c});var c=function(){function e(){}return e.initialize=function(t){var n=t.markNamePrefix;e._markNamePrefix=n||"",r()},e.mark=function(t){e._mark(t)},e.debugMark=function(t){s()&&e._mark(t)},e.getMarkerTime=function(t,n){if(void 0===n&&(n=!0),!o())return NaN;var a=n?e.addPrefix(t):t,i=performance.getEntriesByName(a,"mark");return(null==i?void 0:i.length)>0?Math.round(i[0].startTime):NaN},e.getDurationBetweenMarks=function(t,n){return e.getMarkerTime(n)-e.getMarkerTime(t)},e.enterPerfTestSession=function(e){s()&&(this._curSessionName=e,this._sessionId+=1)},e.sessionMark=function(t,n){if(s()){var i={stage:t,startTime:o()?performance.now():Date.now(),extraData:n},r=e.sessionMarkName,c=a,d=c.find(function(e){return e.name===r});d?d.data.push(i):c.push({name:r,data:[i]})}},e.getSessionMarkerData=function(){var t=e.sessionMarkName,n=a.find(function(e){return e.name===t});return null==n?void 0:n.data},e.clearMarks=function(t){if(o()){var n=[];t&&(n=t.map(e.addPrefix)),performance.getEntriesByType("mark").filter(function(t){return n.length>0?n.indexOf(t.name)>=0:0===t.name.lastIndexOf(e.namePrefix,0)}).forEach(function(e){performance.clearMarks(e.name)}),r()}},e.addPrefix=function(t){var n=e.namePrefix;return 0===t.lastIndexOf(n,0)?t:n+t},e._mark=function(t){if(o()){var n=e.addPrefix(t);performance.mark(n)}},Object.defineProperty(e,"namePrefix",{get:function(){return e._markNamePrefix+"MsPdf."},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sessionMarkName",{get:function(){return e.addPrefix("".concat(e._curSessionName,"_").concat(this._sessionId))},enumerable:!1,configurable:!0}),e._markNamePrefix="",e._curSessionName="Unknown",e._sessionId=-1,e}()}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>o});var a="rgba(31,31,31,.88)",i="#141414",r={themePrimary:"#0F6CBD",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#ffffff",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",whiteTranslucent40:a},o={semanticColors:{bodyBackground:a,bodyStandoutBackground:r.neutralLight,buttonText:r.black,buttonTextPressed:r.neutralDark,buttonTextHovered:r.neutralPrimary,bodySubtext:r.neutralSecondary,disabledBackground:r.neutralQuaternaryAlt,errorText:r.redDark,inputBackgroundChecked:r.themePrimary,menuBackground:r.neutralLighter,menuItemBackgroundHovered:r.neutralQuaternaryAlt,menuItemBackgroundPressed:r.neutralQuaternary,menuDivider:r.neutralTertiaryAlt,menuIcon:r.themeDarkAlt,menuHeader:r.black,menuItemText:r.neutralPrimary,menuItemTextHovered:r.neutralDark,messageText:r.neutralPrimary,buttonBackground:a,buttonBackgroundHovered:"#424242",buttonBackgroundPressed:"#000000",primaryButtonBackground:r.themeTertiary,primaryButtonBackgroundHovered:r.themeLight,primaryButtonBackgroundPressed:r.themeLighter,primaryButtonText:r.black,primaryButtonTextHovered:r.black,primaryButtonTextPressed:r.black,primaryButtonTextDisabled:"#605e5c",buttonBorder:"#808080",variantBorder:r.neutralQuaternary,infoBackground:r.neutralQuaternaryAlt,infoIcon:r.neutralPrimaryAlt,errorIcon:r.redDark,warningIcon:r.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B"},palette:r,isInverted:!0}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(165),i=n(331),r=function(){var e=a.b,t=e.palette,n=e.semanticColors,r="".concat(n.buttonBackground," !important"),o="".concat(n.buttonBorder," !important"),s={background:r,paddingLeft:"8px",paddingRight:"8px",margin:"auto 6px auto 6px",color:t.black,height:"32px",width:"auto",border:"1px solid ".concat(o),".ms-Button-menuIcon":{marginTop:"2px",color:t.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important"}};return(0,i.a)(s)}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s,c:()=>o,d:()=>i,e:()=>u,f:()=>Fe,g:()=>Ve,h:()=>Re,i:()=>Be,j:()=>Ne,k:()=>je,l:()=>te,m:()=>He});var a=n("fui.core_802");const i="data-tabster",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]","details > summary","audio[controls]","video[controls]"].join(", "),o={Source:0,Target:1},s={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},c={Unlimited:0,Limited:1,LimitedTrapFocus:2};function d(e,t){var n;return null===(n=e.storageEntry(t))||void 0===n?void 0:n.tabster}function l(e,t,n){var a,r;const o=n||e._noop?void 0:t.getAttribute(i);let s,c=e.storageEntry(t);if(o){if(o===(null===(a=null==c?void 0:c.attr)||void 0===a?void 0:a.string))return;try{const e=JSON.parse(o);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${o}'.`);s={string:o,object:e}}catch(e){}}else if(!c)return;c||(c=e.storageEntry(t,!0)),c.tabster||(c.tabster={});const d=c.tabster||{},l=(null===(r=c.attr)||void 0===r?void 0:r.object)||{},u=(null==s?void 0:s.object)||{};for(const n of Object.keys(l))if(!u[n]){if("root"===n){const t=d[n];t&&e.root.onRoot(t,!0)}switch(n){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const a=d[n];a&&(a.dispose(),delete d[n]);break;case"observed":delete d[n],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete d[n]}}for(const n of Object.keys(u)){const a=u.sys;switch(n){case"deloser":d.deloser?d.deloser.setProps(u.deloser):e.deloser&&(d.deloser=e.deloser.createDeloser(t,u.deloser));break;case"root":d.root?d.root.setProps(u.root):d.root=e.root.createRoot(t,u.root,a),e.root.onRoot(d.root);break;case"modalizer":d.modalizer?d.modalizer.setProps(u.modalizer):e.modalizer&&(d.modalizer=e.modalizer.createModalizer(t,u.modalizer,a));break;case"restorer":d.restorer?d.restorer.setProps(u.restorer):e.restorer&&u.restorer&&(d.restorer=e.restorer.createRestorer(t,u.restorer));break;case"focusable":d.focusable=u.focusable;break;case"groupper":d.groupper?d.groupper.setProps(u.groupper):e.groupper&&(d.groupper=e.groupper.createGroupper(t,u.groupper,a));break;case"mover":d.mover?d.mover.setProps(u.mover):e.mover&&(d.mover=e.mover.createMover(t,u.mover,a));break;case"observed":e.observedElement&&(d.observed=u.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":d.uncontrolled=u.uncontrolled;break;case"outline":e.outline&&(d.outline=u.outline);break;case"sys":d.sys=u.sys;break;default:console.error(`Unknown key '${n}' in data-tabster attribute value.`)}}s?c.attr=s:(0===Object.keys(d).length&&(delete c.tabster,delete c.attr),e.storageEntry(t,!1))}const u="tabster:movefocus",f="tabster:mover:movefocus",p="tabster:mover:memorized-element",m="tabster:groupper:movefocus",_="tabster:restorer:restore-focus",h="undefined"!=typeof CustomEvent?CustomEvent:function(){};class b extends h{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class g extends b{constructor(e){super("tabster:focusin",e)}}class v extends b{constructor(e){super("tabster:focusout",e)}}class y extends b{constructor(e){super(u,e)}}class S extends b{constructor(e){super("tabster:mover:state",e)}}class D extends b{constructor(e){super("tabster:modalizer:active",e)}}class I extends b{constructor(e){super("tabster:modalizer:inactive",e)}}class x extends b{constructor(){super(_)}}class C extends b{constructor(e){super("tabster:root:focus",e)}}class O extends b{constructor(e){super("tabster:root:blur",e)}}const w={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,n,a)=>e.createTreeWalker(t,n,a),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,n)=>e.insertBefore(t,n),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)};let E;const A="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,n,a){this.left=e||0,this.top=t||0,this.right=(e||0)+(n||0),this.bottom=(t||0)+(a||0)}};let L=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),E=!1}catch(e){E=!0}function k(e){const t=e();let n=t.__tabsterInstanceContext;return n||(n={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=n),n}class M{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&z(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class P{constructor(e,t,n){const a=k(e);let i;a.WeakRef?i=new a.WeakRef(t):(i=new M(t),a.fakeWeakRefs.push(i)),this._ref=i,this._data=n}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function T(e,t){const n=k(e);n.fakeWeakRefs=n.fakeWeakRefs.filter(e=>!M.cleanup(e,t))}function U(e){const t=k(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout(()=>{t.fakeWeakRefsTimer=void 0,T(e),U(e)},12e4))}function F(e,t,n){if(t.nodeType!==Node.ELEMENT_NODE)return;const a=E?n:{acceptNode:n};return w.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,a,!1)}function H(e,t){let n=t.__tabsterCacheId;const a=k(e),i=n?a.containerBoundingRectCache[n]:void 0;if(i)return i.rect;const r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new A;let o=0,s=0,c=r.clientWidth,d=r.clientHeight;if(t!==r){const e=t.getBoundingClientRect();o=Math.max(o,e.left),s=Math.max(s,e.top),c=Math.min(c,e.right),d=Math.min(d,e.bottom)}const l=new A(o<c?o:-1,s<d?s:-1,o<c?c-o:0,s<d?d-s:0);return n||(n="r-"+ ++a.lastContainerBoundingRectCacheId,t.__tabsterCacheId=n),a.containerBoundingRectCache[n]={rect:l,element:t},a.containerBoundingRectCacheTimer||(a.containerBoundingRectCacheTimer=window.setTimeout(()=>{a.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(a.containerBoundingRectCache))delete a.containerBoundingRectCache[e].element.__tabsterCacheId;a.containerBoundingRectCache={}},50)),l}function R(e,t,n){const a=N(t);if(!a)return!1;const i=H(e,a),r=t.getBoundingClientRect(),o=r.height*(1-n),s=Math.max(0,i.top-r.top)+Math.max(0,r.bottom-i.bottom);return 0===s||s<=o}function N(e){const t=e.ownerDocument;if(t){for(let t=w.getParentElement(e);t;t=w.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function B(e){return!!e.__shouldIgnoreFocus}function j(e,t){const n=k(e);let a=t.__tabsterElementUID;return a||(a=t.__tabsterElementUID=function(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const n=[];for(let e=0;e<t.length;e++)n.push(t[e].toString(36));return n.push("|"),n.push((++L).toString(36)),n.push("|"),n.push(Date.now().toString(36)),n.join("")}(e())),!n.elementByUId[a]&&z(t.ownerDocument,t)&&(n.elementByUId[a]=new P(e,t)),a}function V(e,t){const n=k(e);for(const e of Object.keys(n.elementByUId)){const a=n.elementByUId[e],i=a&&a.get();i&&t&&!w.nodeContains(t,i)||delete n.elementByUId[e]}}function z(e,t){return w.nodeContains(null==e?void 0:e.body,t)}function G(e,t){const n=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return n&&n.call(e,t)}let K=0;class W{constructor(e,t,n){const a=e.getWindow;this._tabster=e,this._element=new P(a,t),this._props={...n},this.id="i"+ ++K}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class q{constructor(e,t,n,i,r){var o;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,a.W0R)(e))}const t=this.input;if(this.onFocusIn&&t){const n=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,n),n)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const n=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,n),n)}};const s=e(),c=s.document.createElement("i");c.tabIndex=0,c.setAttribute("role","none"),c.setAttribute("data-tabster-dummy",""),c.setAttribute("aria-hidden","true");const d=c.style;d.position="fixed",d.width=d.height="1px",d.opacity="0.001",d.zIndex="-1",d.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(c),this.input=c,this.isFirst=n.isFirst,this.isOutside=t,this._isPhantom=null!==(o=n.isPhantom)&&void 0!==o&&o,this._fixedTarget=r,c.addEventListener("focusin",this._focusIn),c.addEventListener("focusout",this._focusOut),c.__tabsterDummyContainer=i,this._isPhantom&&(this._disposeTimer=s.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(s.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=w.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var n;const a=null===(n=this.input)||void 0===n?void 0:n.style;a&&(a.top=`${e}px`,a.left=`${t}px`)}_isBackward(e,t,n){return e&&!n?!this.isFirst:!!(n&&t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING)}}class Q{constructor(e,t,n,a,i,r){this._element=t,this._instance=new J(e,t,this,n,a,i,r)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var n;null===(n=this._instance)||void 0===n||n.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,n,i,r){const o=new q(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(o){let s,c;if("BODY"===t.tagName)s=t,c=n&&i||!n&&!i?w.getFirstElementChild(t):null;else{let a,r;n&&(!i||i&&!e.focusable.isFocusable(t,!1,!0,!0))?(s=t,c=i?t.firstElementChild:null):(s=w.getParentElement(t),c=n&&i||!n&&!i?t:w.getNextElementSibling(t));do{a=n&&i||!n&&!i?w.getPreviousElementSibling(c):c,r=ee(a),r===t?c=n&&i||!n&&!i?a:w.getNextElementSibling(a):r=null}while(r)}(null==s?void 0:s.dispatchEvent(new y({by:"root",owner:s,next:null,relatedEvent:r})))&&(w.insertBefore(s,o,c),(0,a.W0R)(o))}}static addPhantomDummyWithTarget(e,t,n,a){const i=new q(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new P(e.getWindow,a)).input;if(i){let e,a;t.querySelector(r)&&!n?(e=t,a=w.getFirstElementChild(t)):(e=w.getParentElement(t),a=n?t:w.getNextElementSibling(t)),e&&w.insertBefore(e,i,a)}}}class Y{constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout(()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const n=w.getParentNode(t);n&&!this._changedParents.has(n)||e()}}}this._changedParents=new WeakSet},100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new P(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter(t=>{const n=t.get();return n&&n!==e}),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout(()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const n of this._updateQueue)t.push(n(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()},100))}}class J{constructor(e,t,n,i,r,o,s){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,n)=>{this._onFocus(!0,e,t,n)},this._onFocusOut=(e,t,n)=>{this._onFocus(!1,e,t,n)},this.moveOut=e=>{var t;const n=this._firstDummy,i=this._lastDummy;if(n&&i){this._ensurePosition();const r=n.input,o=i.input,s=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&o&&s){let t;e?(r.tabIndex=0,t=r):(o.tabIndex=0,t=o),t&&(0,a.W0R)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var n;const i=this._firstDummy,r=this._lastDummy;if(i&&r){this._ensurePosition();const o=i.input,s=r.input,c=null===(n=this._element)||void 0===n?void 0:n.get();if(o&&s&&c){let n;e?!i.isOutside&&this._tabster.focusable.isFocusable(c,!0,!0,!0)?n=c:(i.useDefaultAction=!0,o.tabIndex=0,n=o):(r.useDefaultAction=!0,s.tabIndex=0,n=s),n&&c.dispatchEvent(new y({by:"root",owner:c,next:null,relatedEvent:t}))&&(0,a.W0R)(n)}}},this.setTabbable=(e,t)=>{var n,a;for(const n of this._wrappers)if(n.manager===e){n.tabbable=t;break}const i=this._getCurrent();if(i){const e=i.tabbable?0:-1;let t=null===(n=this._firstDummy)||void 0===n?void 0:n.input;t&&(t.tabIndex=e),t=null===(a=this._lastDummy)||void 0===a?void 0:a.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()},0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,n;const a=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(n=this._lastDummy)||void 0===n?void 0:n.input),i=this._transformElements,r=new Set;let o=0,s=0;const c=this._getWindow();for(let t=a;t&&t.nodeType===Node.ELEMENT_NODE;t=w.getParentElement(t)){let n=e.get(t);if(void 0===n){const a=c.getComputedStyle(t).transform;a&&"none"!==a&&(n={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,n||null)}n&&(r.add(t),i.has(t)||t.addEventListener("scroll",this._addTransformOffsets),o+=n.scrollTop,s+=n.scrollLeft)}for(const e of i)r.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=r,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(o,s),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(o,s)}};const c=t.get();if(!c)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=s;const d=c.__tabsterDummy;if((d||this)._wrappers.push({manager:n,priority:i,tabbable:!0}),d)return d;c.__tabsterDummy=this;const l=null==r?void 0:r.dummyInputsPosition,u=c.tagName;this._isOutside=l?2===l:(o||"UL"===u||"OL"===u||"TABLE"===u)&&!("LI"===u||"TD"===u||"TH"===u),this._firstDummy=new q(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new q(this._getWindow,this._isOutside,{isFirst:!1},t);const f=this._firstDummy.input;f&&e._dummyObserver.add(f,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var n,a,i,r;if(0===(this._wrappers=this._wrappers.filter(n=>n.manager!==e&&!t)).length){delete(null===(n=this._element)||void 0===n?void 0:n.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(a=this._firstDummy)||void 0===a?void 0:a.input;t&&this._tabster._dummyObserver.remove(t),null===(i=this._firstDummy)||void 0===i||i.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,n,a){var i;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(i=r.manager.getHandler(e))||void 0===i||i(t,n,a)}_getCurrent(){return this._wrappers.sort((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority),this._wrappers[0]}_ensurePosition(){var e,t,n;const a=null===(e=this._element)||void 0===e?void 0:e.get(),i=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(n=this._lastDummy)||void 0===n?void 0:n.input;if(a&&i&&r)if(this._isOutside){const e=w.getParentNode(a);if(e){const t=w.getNextSibling(a);t!==r&&w.insertBefore(e,r,t),w.getPreviousElementSibling(a)!==i&&w.insertBefore(e,i,a)}}else{w.getLastElementChild(a)!==r&&w.appendChild(a,r);const e=w.getFirstElementChild(a);e&&e!==i&&e.parentNode&&w.insertBefore(e.parentNode,i,e)}}}function X(e){let t=null;for(let n=w.getLastElementChild(e);n;n=w.getLastElementChild(n))t=n;return t||void 0}function Z(e,t,n,a){const i=e.storageEntry(t,!0);let r=!1;if(!i.aug){if(void 0===a)return r;i.aug={}}if(void 0===a){if(n in i.aug){const e=i.aug[n];delete i.aug[n],null===e?t.removeAttribute(n):t.setAttribute(n,e),r=!0}}else{let e;n in i.aug||(e=t.getAttribute(n)),void 0!==e&&e!==a&&(i.aug[n]=e,null===a?t.removeAttribute(n):t.setAttribute(n,a),r=!0)}return void 0===a&&0===Object.keys(i.aug).length&&(delete i.aug,e.storageEntry(t,!1)),r}function $(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function ee(e){var t;return(null===(t=null==e?void 0:e.__tabsterDummyContainer)||void 0===t?void 0:t.get())||null}function te(e,t){const n=JSON.stringify(e);return!0===t?n:{[i]:n}}class ne extends Q{constructor(e,t,n,i){super(e,t,1,i,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const n=this._element.get();if(n){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:n,ignoreAccessibility:!0});if(t)return void(0,a.W0R)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=n}}class ae extends W{constructor(e,t,n,i,r){super(e,t,i),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const n=this._element.get();n&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),n.dispatchEvent(new C({element:n}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),n.dispatchEvent(new O({element:n}))},0))},this._onFocusIn=e=>{const t=this._tabster.getParent,n=this._element.get();let a=e.composedPath()[0];do{if(a===n)return void this._setFocused(!0);a=a&&t(a)}while(a)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=n;const o=e.getWindow;this.uid=j(o,t),this._sys=r,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const s=o().document;s.addEventListener(a.wZv,this._onFocusIn),s.addEventListener(a.IO8,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ne(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),n=t.document;n.removeEventListener(a.wZv,this._onFocusIn),n.removeEventListener(a.IO8,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const n=this._dummyManager;if(n)n.moveOutWithDefaultAction(e,t);else{const n=this.getElement();n&&ne.moveWithPhantomDummy(this._tabster,n,!0,e,t)}}_add(){}_remove(){}}class ie{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,n=t.body;if(n){this._autoRootUnwait(t);const a=this._autoRoot;if(a)return function(e,t,n){let a;{const t=e.getAttribute(i);if(t)try{a=JSON.parse(t)}catch(e){}}a||(a={}),function(e,t){for(const n of Object.keys(t)){const a=t[n];a?e[n]=a:delete e[n]}}(a,t),Object.keys(a).length>0?e.setAttribute(i,te(a,!0)):e.removeAttribute(i)}(n,{root:a}),l(this._tabster,n),null===(e=d(this._tabster,n))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit(()=>{this._autoRoot&&this._autoRootCreate()})}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach(e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])}),this.rootById={}}createRoot(e,t,n){const a=new ae(this._tabster,e,this._onRootDispose,t,n);return this._roots[a.id]=a,this._forceDummy&&a.addDummyInputs(),a}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const n=e().__tabsterInstance;return n&&n.root.rootById[t]}static getTabsterContext(e,t,n){var a,i,r,o;if(void 0===n&&(n={}),!t.ownerDocument)return;const{checkRtl:s,referenceElement:c}=n,l=e.getParent;let u,f,p,m;e.drainInitQueue();let _,h,b,g,v=!1,y=c||t;const S={};for(;y&&(!u||s);){const n=d(e,y);if(s&&void 0===b){const e=y.dir;e&&(b="rtl"===e.toLowerCase())}if(!n){y=l(y);continue}const o=y.tagName;(n.uncontrolled||"IFRAME"===o||"WEBVIEW"===o)&&(g=y),m||!(null===(a=n.focusable)||void 0===a?void 0:a.excludeFromMover)||p||(v=!0);const c=n.modalizer,D=n.groupper,I=n.mover;!f&&c&&(f=c),p||!D||f&&!c||(f?(!D.isActive()&&D.getProps().tabbability&&f.userId!==(null===(i=e.modalizer)||void 0===i?void 0:i.activeId)&&(f=void 0,p=D),h=D):p=D),m||!I||f&&!c||D&&y===t||!y.contains(t)||(m=I,_=!!p&&p!==D),n.root&&(u=n.root),(null===(r=n.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(S,n.focusable.ignoreKeydown),y=l(y)}if(!u){const n=e.root;n._autoRoot&&(null===(o=t.ownerDocument)||void 0===o?void 0:o.body)&&(u=n._autoRootCreate())}return p&&!m&&(_=!0),u?{root:u,modalizer:f,groupper:p,mover:m,groupperBeforeMover:_,modalizerInGroupper:h,rtl:s?!!b:void 0,uncontrolled:g,excludedFromMover:v,ignoreKeydown:e=>!!S[e.key]}:void 0}static getRoot(e,t){var n;const a=e.getParent;for(let i=t;i;i=a(i)){const t=null===(n=d(e,i))||void 0===n?void 0:n.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class re{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,n=t.indexOf(e);n>=0&&t.splice(n,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach(n=>n(e,t))}}class oe{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=d(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,n,a){return!(!G(e,r)||!t&&-1===e.tabIndex)&&(n||this.isVisible(e))&&(a||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(function(e){var t,n;const a=e.ownerDocument,i=null===(t=a.defaultView)||void 0===t?void 0:t.getComputedStyle(e);if(null===e.offsetParent&&a.body!==e&&"fixed"!==(null==i?void 0:i.position))return!0;if("hidden"===(null==i?void 0:i.visibility))return!0;if("fixed"===(null==i?void 0:i.position)){if("none"===i.display)return!0;if(null===(null===(n=e.parentElement)||void 0===n?void 0:n.offsetParent)&&a.body!==e.parentElement)return!0}return!1}(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let n=e;n;n=w.getParentElement(n)){const e=d(this._tabster,n);if(this._isHidden(n))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(n))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const n=e.getAttribute("aria-hidden");return!(!n||"true"!==n.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const n=this._findElements(!1,e,t);return n?n[0]:n}_findElements(e,t,n){var a,i,r;const{container:o,currentElement:s=null,includeProgrammaticallyFocusable:c,useActiveModalizer:d,ignoreAccessibility:l,modalizerId:u,isBackward:f,onElement:p}=t;n||(n={});const m=[];let{acceptCondition:_}=t;const h=!!_;if(!o)return null;_||(_=e=>this.isFocusable(e,c,!1,l));const b={container:o,modalizerUserId:void 0===u&&d?null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId:u||(null===(r=null===(i=ie.getTabsterContext(this._tabster,o))||void 0===i?void 0:i.modalizer)||void 0===r?void 0:r.userId),from:s||o,isBackward:f,isFindAll:e,acceptCondition:_,hasCustomCondition:h,includeProgrammaticallyFocusable:c,ignoreAccessibility:l,cachedGrouppers:{},cachedRadioGroups:{}},g=F(o.ownerDocument,o,e=>this._acceptElement(e,b));if(!g)return null;const v=t=>{var a,i;const r=null!==(a=b.foundElement)&&void 0!==a?a:b.foundBackward;return r&&m.push(r),e?!(r&&(b.found=!1,delete b.foundElement,delete b.foundBackward,delete b.fromCtx,b.from=r,p&&!p(r))||!r&&!t):(r&&n&&(n.uncontrolled=null===(i=ie.getTabsterContext(this._tabster,r))||void 0===i?void 0:i.uncontrolled),!(!t||r))};if(s||(n.outOfDOMOrder=!0),s&&w.nodeContains(o,s))g.currentNode=s;else if(f){const e=X(o);if(!e)return null;if(this._acceptElement(e,b)===NodeFilter.FILTER_ACCEPT&&!v(!0))return b.skippedFocusable&&(n.outOfDOMOrder=!0),m;g.currentNode=e}do{f?g.previousNode():g.nextNode()}while(v());return b.skippedFocusable&&(n.outOfDOMOrder=!0),m.length?m:null}_acceptElement(e,t){var n,a,i;if(t.found)return NodeFilter.FILTER_ACCEPT;const r=t.foundBackward;if(r&&(e===r||!w.nodeContains(r,e)))return t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT;const o=t.container;if(e===o)return NodeFilter.FILTER_SKIP;if(!w.nodeContains(o,e))return NodeFilter.FILTER_REJECT;if(ee(e))return NodeFilter.FILTER_REJECT;if(w.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const s=t.currentCtx=ie.getTabsterContext(this._tabster,e);if(!s)return NodeFilter.FILTER_SKIP;if(B(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return(null===(n=s.modalizer)||void 0===n?void 0:n.userId)===(null===(a=this._tabster.modalizer)||void 0===a?void 0:a.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let c,d=t.fromCtx;d||(d=t.fromCtx=ie.getTabsterContext(this._tabster,t.from));const l=null==d?void 0:d.mover;let u=s.groupper,f=s.mover;if(c=null===(i=this._tabster.modalizer)||void 0===i?void 0:i.acceptElement(e,t),void 0!==c&&(t.skippedFocusable=!0),void 0===c&&(u||f||l)){const n=null==u?void 0:u.getElement(),a=null==l?void 0:l.getElement();let i=null==f?void 0:f.getElement();i&&w.nodeContains(a,i)&&w.nodeContains(o,a)&&(!n||!f||w.nodeContains(a,n))&&(f=l,i=a),!n||n!==o&&w.nodeContains(o,n)||(u=void 0),i&&!w.nodeContains(o,i)&&(f=void 0),u&&f&&(i&&n&&!w.nodeContains(n,i)?f=void 0:u=void 0),u&&(c=u.acceptElement(e,t)),f&&(c=f.acceptElement(e,t))}if(void 0===c&&(c=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,c===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),c===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&$(e)&&!e.checked){const n=e.name;let a=t.cachedRadioGroups[n];if(a||(a=function(e){if(!$(e))return;const t=e.name;let n,a=Array.from(w.getElementsByName(e,t));return a=a.filter(e=>!!$(e)&&(e.checked&&(n=e),!0)),{name:t,buttons:new Set(a),checked:n}}(e),a&&(t.cachedRadioGroups[n]=a)),(null==a?void 0:a.checked)&&a.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,c=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return c}}const se="Enter",ce="Escape",de="Home",le="ArrowLeft",ue="ArrowUp",fe="ArrowRight",pe="ArrowDown",me={2:0,3:1,1:2};class _e extends re{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(a.wZv,this._onFocusIn,!0),t.addEventListener(a.IO8,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const n=w.getActiveElement(t);n&&n!==t.body&&this._setFocusedElement(n),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if("Tab"!==e.key||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const n=this._tabster,i=n.controlTab,r=ie.getTabsterContext(n,t);if(!r||r.ignoreKeydown(e))return;const o=e.shiftKey,s=_e.findNextTabbable(n,r,void 0,t,void 0,o,!0),c=r.root.getElement();if(!c)return;const l=null==s?void 0:s.element,u=function(e,t){var n;const a=e.getParent;let i=t;do{const t=null===(n=d(e,i))||void 0===n?void 0:n.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(i,!!t.completely))return i;i=a(i)}while(i)}(n,t);if(l){const d=s.uncontrolled;if(r.uncontrolled||w.nodeContains(d,t)){if(!s.outOfDOMOrder&&d===r.uncontrolled||u&&!w.nodeContains(u,l))return;return void Q.addPhantomDummyWithTarget(n,t,o,l)}if(d||"IFRAME"===l.tagName)return void(c.dispatchEvent(new y({by:"root",owner:c,next:l,relatedEvent:e}))&&Q.moveWithPhantomDummy(this._tabster,null!=d?d:l,!1,o,e));(i||(null==s?void 0:s.outOfDOMOrder))&&c.dispatchEvent(new y({by:"root",owner:c,next:l,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,a.W0R)(l))}else!u&&c.dispatchEvent(new y({by:"root",owner:c,next:null,relatedEvent:e}))&&r.root.moveOutWithDefaultAction(o,e)},this._onChanged=(e,t)=>{var n,a;if(e)e.dispatchEvent(new g(t));else{const e=null===(n=this._lastVal)||void 0===n?void 0:n.get();if(e){const n={...t},i=ie.getTabsterContext(this._tabster,e),r=null===(a=null==i?void 0:i.modalizer)||void 0===a?void 0:a.userId;r&&(n.modalizerId=r),e.dispatchEvent(new v(n))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(a.wZv,this._onFocusIn,!0),t.removeEventListener(a.IO8,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const n=this._asyncFocus;n&&(e.clearTimeout(n.timeout),delete this._asyncFocus),delete _e._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var n,a;let i=_e._lastResetElement,r=i&&i.get();r&&w.nodeContains(t,r)&&delete _e._lastResetElement,r=null===(a=null===(n=e._nextVal)||void 0===n?void 0:n.element)||void 0===a?void 0:a.get(),r&&w.nodeContains(t,r)&&delete e._nextVal,i=e._lastVal,r=i&&i.get(),r&&w.nodeContains(t,r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!z(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,n,a){return!!this._tabster.focusable.isFocusable(e,t,!1,n)&&(e.focus({preventScroll:a}),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var n;const{container:a,ignoreAccessibility:i}=t;let r;if(a){const t=ie.getTabsterContext(this._tabster,a);t&&(r=null===(n=_e.findNextTabbable(this._tabster,t,a,void 0,void 0,!e,i))||void 0===n?void 0:n.element)}return r&&!w.nodeContains(a,r)&&(r=void 0),r||void 0}_focusFirstOrLast(e,t){const n=this.getFirstOrLastTabbable(e,t);return!!n&&(this.focus(n,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),n=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),_e._lastResetElement=new P(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",n)}return!0}requestAsyncFocus(e,t,n){const a=this._tabster.getWindow(),i=this._asyncFocus;if(i){if(me[e]>me[i.source])return;a.clearTimeout(i.timeout)}this._asyncFocus={source:e,callback:t,timeout:a.setTimeout(()=>{this._asyncFocus=void 0,t()},n)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,n){null===n?e.removeAttribute(t):e.setAttribute(t,n)}_setFocusedElement(e,t,n){var a,i;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(a=_e._lastResetElement)||void 0===a?void 0:a.get();if(_e._lastResetElement=void 0,t===e||B(e))return;r.isFocusedProgrammatically=n;const o=ie.getTabsterContext(this._tabster,e),s=null===(i=null==o?void 0:o.modalizer)||void 0===i?void 0:i.userId;s&&(r.modalizerId=s)}const o=this._nextVal={element:e?new P(this._win,e):void 0,detail:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===o&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new P(this._win,e))}static findNextTabbable(e,t,n,a,i,r,o){const s=n||t.root.getElement();if(!s)return null;let c=null;const d=_e._isTabbingTimer,l=e.getWindow();d&&l.clearTimeout(d),_e.isTabbing=!0,_e._isTabbingTimer=l.setTimeout(()=>{delete _e._isTabbingTimer,_e.isTabbing=!1},0);const u=t.modalizer,f=t.groupper,p=t.mover,m=t=>{if(c=t.findNextTabbable(a,i,r,o),a&&!(null==c?void 0:c.element)){const i=t!==u&&w.getParentElement(t.getElement());if(i){const s=ie.getTabsterContext(e,a,{referenceElement:i});if(s){const a=t.getElement(),d=r?a:a&&X(a)||a;d&&(c=_e.findNextTabbable(e,s,n,d,i,r,o),c&&(c.outOfDOMOrder=!0))}}}};if(f&&p)m(t.groupperBeforeMover?f:p);else if(f)m(f);else if(p)m(p);else if(u)m(u);else{const t={container:s,currentElement:a,referenceElement:i,ignoreAccessibility:o,useActiveModalizer:!0},n={},d=e.focusable[r?"findPrev":"findNext"](t,n);c={element:d,outOfDOMOrder:n.outOfDOMOrder,uncontrolled:n.uncontrolled}}return c}}_e.isTabbing=!1;class he extends Q{constructor(e,t,n,i){super(n,e,4,i,!0),this._setHandlers((i,r,o)=>{var s,c;const d=e.get(),l=i.input;if(d&&l){const e=ie.getTabsterContext(n,l);if(e){let u;u=null===(s=t.findNextTabbable(o||void 0,void 0,r,!0))||void 0===s?void 0:s.element,u||(u=null===(c=_e.findNextTabbable(n,e,void 0,i.isOutside?l:function(e,t){let n=e,a=null;for(;n&&!a;)a=t?w.getPreviousElementSibling(n):w.getNextElementSibling(n),n=w.getParentElement(n);return a||void 0}(d,!r),void 0,r,!0))||void 0===c?void 0:c.element),u&&(0,a.W0R)(u)}}})}}class be extends W{constructor(e,t,n,a,i){super(e,t,a),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=n,e.controlTab||(this.dummyManager=new he(this._element,this,e,i))}dispose(){var e;this._onDispose(this),this._element.get(),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(e,t,n,a){const i=this.getElement();if(!i)return null;const r=ee(e)===i;if(!this._shouldTabInside&&e&&w.nodeContains(i,e)&&!r)return{element:void 0,outOfDOMOrder:!0};const o=this.getFirst(!0);if(!e||!w.nodeContains(i,e)||r)return{element:o,outOfDOMOrder:!0};const s=this._tabster;let d,l=null,u=!1;if(this._shouldTabInside&&o){const r={container:i,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},o={};l=s.focusable[n?"findPrev":"findNext"](r,o),u=!!o.outOfDOMOrder,l||this._props.tabbability!==c.LimitedTrapFocus||(l=s.focusable[n?"findLast":"findFirst"]({container:i,ignoreAccessibility:a,useActiveModalizer:!0},o),u=!0),d=o.uncontrolled}return{element:l,uncontrolled:d,outOfDOMOrder:u}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;const n=this.getElement()||null;let a=!0;for(let e=w.getParentElement(n);e;e=w.getParentElement(e)){const n=null===(t=d(this._tabster,e))||void 0===t?void 0:t.groupper;n&&(n._shouldTabInside||(a=!1))}let i=a?!!this._props.tabbability&&this._shouldTabInside:void 0;if(i&&e){const e=this._tabster.focusedElement.getFocusedElement();e&&(i=e!==this.getFirst(!0))}return i}getFirst(e){var t;const n=this.getElement();let a;if(n){if(e&&this._tabster.focusable.isFocusable(n))return n;a=null===(t=this._first)||void 0===t?void 0:t.get(),a||(a=this._tabster.focusable.findFirst({container:n,useActiveModalizer:!0})||void 0,a&&this.setFirst(a))}return a}setFirst(e){e?this._first=new P(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){const n=t.cachedGrouppers,a=w.getParentElement(this.getElement()),i=a&&ie.getTabsterContext(this._tabster,a),r=null==i?void 0:i.groupper,o=(null==i?void 0:i.groupperBeforeMover)?r:void 0;let s;const c=e=>{let t,a=n[e.id];return a?t=a.isActive:(t=this.isActive(!0),a=n[e.id]={isActive:t}),t};if(o&&(s=o.getElement(),!c(o)&&s&&t.container!==s&&w.nodeContains(t.container,s)))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const d=c(this),l=this.getElement();if(l&&!0!==d){if(l===e&&r&&(s||(s=r.getElement()),s&&!c(r)&&w.nodeContains(t.container,s)&&s!==t.container))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;if(l!==e&&w.nodeContains(l,e))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const a=n[this.id];let i;if(i="first"in a?a.first:a.first=this.getFirst(!0),i&&t.acceptCondition(i))return t.rejectElementsFrom=l,t.skippedFocusable=!0,i!==t.from?(t.found=!0,t.foundElement=i,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class ge{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{const e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);const t=e.document,n=w.getActiveElement(t);n&&this._onFocus(n),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(m,this._onMoveFocus)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e,!0,!0)},this._onMouseDown=e=>{e.target&&this._updateCurrent(e.target,!0)},this._onKeyDown=e=>{if(e.key!==se&&e.key!==ce)return;if(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.action;n&&void 0!==a&&!e.defaultPrevented&&(1===a?this._enterGroupper(n):this._escapeGroupper(n),e.stopImmediatePropagation())},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){const e=this._win();this._tabster.focusedElement.cancelAsyncFocus(1),this._current={},this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener(m,this._onMoveFocus),Object.keys(this._grouppers).forEach(e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])})}createGroupper(e,t,n){const a=new be(this._tabster,e,this._onGroupperDispose,t,n);this._grouppers[a.id]=a;const i=this._tabster.focusedElement.getFocusedElement();return i&&w.nodeContains(e,i)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout(()=>{delete this._updateTimer,i===this._tabster.focusedElement.getFocusedElement()&&this._updateCurrent(i,!0,!0)},0)),a}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e,t,n){var a;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);const i={};let r=!0;for(let o=e;o;o=w.getParentElement(o)){const s=null===(a=d(this._tabster,o))||void 0===a?void 0:a.groupper;if(s){if(i[s.id]=!0,r&&n&&o!==e&&(r=!1),t||!r){this._current[s.id]=s;const t=s.isActive()||e!==o&&(!s.getProps().delegated||s.getFirst(!1)!==e);s.makeTabbable(t)}r=!1}}for(const e of Object.keys(this._current)){const t=this._current[e];t.id in i||(t.makeTabbable(!1),t.setFirst(void 0),delete this._current[e])}}_enterGroupper(e,t){const n=this._tabster,a=ie.getTabsterContext(n,e),i=(null==a?void 0:a.groupper)||(null==a?void 0:a.modalizerInGroupper),r=null==i?void 0:i.getElement();if(i&&r&&(e===r||i.getProps().delegated&&e===i.getFirst(!1))){const a=n.focusable.findNext({container:r,currentElement:e,useActiveModalizer:!0});if(a&&(!t||t&&r.dispatchEvent(new y({by:"groupper",owner:r,next:a,relatedEvent:t}))))return t&&(t.preventDefault(),t.stopImmediatePropagation()),a.focus(),a}return null}_escapeGroupper(e,t,n){var a;const i=this._tabster,r=ie.getTabsterContext(i,e),o=null==r?void 0:r.modalizerInGroupper;let s=(null==r?void 0:r.groupper)||o;const c=null==s?void 0:s.getElement();if(s&&c&&w.nodeContains(c,e)){let r;if(e!==c||n)r=s.getFirst(!0);else{const e=w.getParentElement(c),t=e?ie.getTabsterContext(i,e):void 0;s=null==t?void 0:t.groupper,r=null==s?void 0:s.getFirst(!0)}if(r&&(!t||t&&c.dispatchEvent(new y({by:"groupper",owner:c,next:r,relatedEvent:t}))))return s&&(s.makeTabbable(!1),o&&(null===(a=i.modalizer)||void 0===a||a.setActive(void 0))),r.focus(),r}return null}moveFocus(e,t){return 1===t?this._enterGroupper(e):this._escapeGroupper(e)}handleKeyPress(e,t,n){const a=this._tabster,i=ie.getTabsterContext(a,e);if(i&&((null==i?void 0:i.groupper)||(null==i?void 0:i.modalizerInGroupper))){if(a.focusedElement.cancelAsyncFocus(1),i.ignoreKeydown(t))return;if(t.key===se)this._enterGroupper(e,t);else if(t.key===ce){const i=a.focusedElement.getFocusedElement();a.focusedElement.requestAsyncFocus(1,()=>{(i===a.focusedElement.getFocusedElement()||(!n||i)&&n)&&this._escapeGroupper(e,t,n)},0)}}}}class ve extends re{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,a.u4q)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,a.Xhg)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let ye=0;const Se="aria-hidden";class De extends Q{constructor(e,t,n){super(t,e,2,n),this._setHandlers((n,i)=>{var r,o;const s=e.get(),c=s&&(null===(r=ie.getRoot(t,s))||void 0===r?void 0:r.getElement()),d=n.input;let l;if(c&&d){const e=ee(d),n=ie.getTabsterContext(t,e||d);n&&(l=null===(o=_e.findNextTabbable(t,n,c,d,void 0,i,!0))||void 0===o?void 0:o.element),l&&(0,a.W0R)(l)}})}}class Ie extends W{constructor(e,t,n,a,i,r){super(e,t,a),this._wasFocused=0,this.userId=a.id,this._onDispose=n,this._activeElements=r,e.controlTab||(this.dummyManager=new De(this._element,e,i))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const n=this._activeElements,a=n.map(e=>e.get()).indexOf(t);e?a<0&&n.push(new P(this._tabster.getWindow,t)):a>=0&&n.splice(a,1)}this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++ye),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return w.nodeContains(this.getElement(),e)}findNextTabbable(e,t,n,a){var i,r;if(!this.getElement())return null;const o=this._tabster;let s,c=null,d=!1;const l=e&&(null===(i=ie.getRoot(o,e))||void 0===i?void 0:i.getElement());if(l){const i={container:l,currentElement:e,referenceElement:t,ignoreAccessibility:a,useActiveModalizer:!0},u={};c=o.focusable[n?"findPrev":"findNext"](i,u),!c&&this._props.isTrapped&&(null===(r=o.modalizer)||void 0===r?void 0:r.activeId)?(c=o.focusable[n?"findLast":"findFirst"]({container:l,ignoreAccessibility:a,useActiveModalizer:!0},u),null===c&&(c=e),d=!0):d=!!u.outOfDOMOrder,s=u.uncontrolled}return{element:c,uncontrolled:s,outOfDOMOrder:d}}_dispatchEvent(e,t){const n=this.getElement();let a=!1;if(n){const i=t?this._activeElements.map(e=>e.get()):[n];for(const t of i)if(t){const i={id:this.userId,element:n},r=e?new D(i):new I(i);t.dispatchEvent(r),r.defaultPrevented&&(a=!0)}}return a}_remove(){}}class xe{constructor(e,t,n){this._onModalizerDispose=e=>{const t=e.id,n=e.userId,a=this._parts[n];delete this._modalizers[t],a&&(delete a[t],0===Object.keys(a).length&&(delete this._parts[n],this.activeId===n&&this.setActive(void 0)))},this._onKeyDown=e=>{var t;if(e.key!==ce)return;const n=this._tabster,a=n.focusedElement.getFocusedElement();if(a){const i=ie.getTabsterContext(n,a),r=null==i?void 0:i.modalizer;if(i&&!i.groupper&&(null==r?void 0:r.isActive())&&!i.ignoreKeydown(e)){const a=r.userId;if(a){const i=this._parts[a];if(i){const a=Object.keys(i).map(e=>{var t;const n=i[e],a=n.getElement();let r;return a&&(r=null===(t=d(this._tabster,a))||void 0===t?void 0:t.groupper),n&&a&&r?{el:a,focusedSince:n.focused(!0)}:{focusedSince:0}}).filter(e=>e.focusedSince>0).sort((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0);if(a.length){const i=a[0].el;i&&(null===(t=n.groupper)||void 0===t||t.handleKeyPress(i,e,!0))}}}}}},this._onFocus=(e,t)=>{var n,a;const i=e&&ie.getTabsterContext(this._tabster,e);if(!i||!e)return;const r=this._augMap;for(let t=e;t;t=w.getParentElement(t))r.has(t)&&(r.delete(t),Z(this._tabster,t,Se));const o=i.modalizer;if(null===(a=o||(null===(n=d(this._tabster,e))||void 0===n?void 0:n.modalizer))||void 0===a||a.focused(),(null==o?void 0:o.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==o?void 0:o.getProps().isAlwaysAccessible))this.setActive(o);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout(()=>this._restoreModalizerFocus(e),100)}else this.currentIsOthersAccessible=null==o?void 0:o.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=n,this.activeElements=[],e.controlTab||e.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit(()=>{this._tabster.focusedElement.subscribe(this._onFocus)})}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach(e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])}),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,n){var a;const i=new Ie(this._tabster,e,this._onModalizerDispose,t,n,this.activeElements),r=i.id,o=t.id;this._modalizers[r]=i;let s=this._parts[o];return s||(s=this._parts[o]={}),s[r]=i,w.nodeContains(e,null!==(a=this._tabster.focusedElement.getFocusedElement())&&void 0!==a?a:null)&&(o!==this.activeId?this.setActive(i):i.makeActive(!0)),i}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout(()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()},250))}setActive(e){const t=null==e?void 0:e.userId,n=this.activeId;if(n!==t){if(this.activeId=t,n){const e=this._parts[n];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate()}}focus(e,t,n){const a=ie.getTabsterContext(this._tabster,e),i=null==a?void 0:a.modalizer;if(i){this.setActive(i);const e=i.getProps(),a=i.getElement();if(a){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:a}))return!0;if(void 0===n&&(n=e.isNoFocusDefault),!n&&this._tabster.focusedElement.focusDefault(a))return!0;this._tabster.focusedElement.resetFocus(a)}}return!1}acceptElement(e,t){var n;const a=t.modalizerUserId,i=null===(n=t.currentCtx)||void 0===n?void 0:n.modalizer;if(a)for(const t of this.activeElements){const n=t.get();if(n&&(w.nodeContains(e,n)||n===e))return NodeFilter.FILTER_SKIP}const r=a===(null==i?void 0:i.userId)||!a&&(null==i?void 0:i.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==r&&(t.skippedFocusable=!0),r}_hiddenUpdate(){var e;const t=this._tabster,n=t.getWindow().document.body,a=this.activeId,i=this._parts,r=[],o=[],s=this._alwaysAccessibleSelector,c=s?Array.from(w.querySelectorAll(n,s)):[],d=[];for(const e of Object.keys(i)){const t=i[e];for(const n of Object.keys(t)){const i=t[n],s=i.getElement(),l=i.getProps().isAlwaysAccessible;s&&(e===a?(d.push(s),this.currentIsOthersAccessible||r.push(s)):l?c.push(s):o.push(s))}}const l=this._augMap,u=r.length>0?[...r,...c]:void 0,f=[],p=new WeakMap,m=(e,n)=>{var a;const i=e.tagName;if("SCRIPT"===i||"STYLE"===i)return;let r=!1;l.has(e)?n?r=!0:(l.delete(e),Z(t,e,Se)):n&&!(null===(a=this._accessibleCheck)||void 0===a?void 0:a.call(this,e,d))&&Z(t,e,Se,"true")&&(l.set(e,!0),r=!0),r&&(f.push(new P(t.getWindow,e)),p.set(e,!0))},_=e=>{var n;for(let a=w.getFirstElementChild(e);a;a=w.getNextElementSibling(a)){let e=!1,i=!1,r=!1;if(u){const o=t.getParent(a);for(const t of u){if(a===t){e=!0;break}if(w.nodeContains(a,t)){i=!0;break}w.nodeContains(t,o)&&(r=!0)}i||(null===(n=a.__tabsterElementFlags)||void 0===n?void 0:n.noDirectAriaHidden)?_(a):e||r||m(a,!0)}else m(a,!1)}};u||c.forEach(e=>m(e,!1)),o.forEach(e=>m(e,!0)),n&&_(n),null===(e=this._aug)||void 0===e||e.map(e=>e.get()).forEach(e=>{e&&!p.get(e)&&m(e,!1)}),this._aug=f,this._augMap=p}_restoreModalizerFocus(e){const t=null==e?void 0:e.ownerDocument;if(!e||!t)return;const n=ie.getTabsterContext(this._tabster,e),a=null==n?void 0:n.modalizer,i=this.activeId;if(!a&&!i||a&&i===a.userId)return;const r=null==n?void 0:n.root.getElement();if(r){let t=this._tabster.focusable.findFirst({container:r,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=this._tabster.focusable.findLast({container:r,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void this._tabster.focusedElement.focus(t)}}e.blur()}}const Ce=["input","textarea","*[contenteditable]"].join(", ");class Oe extends Q{constructor(e,t,n,i){super(t,e,3,i),this._onFocusDummyInput=e=>{var t,n;const i=this._element.get(),r=e.input;if(i&&r){const o=ie.getTabsterContext(this._tabster,i);let s;o&&(s=null===(t=_e.findNextTabbable(this._tabster,o,void 0,r,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const c=null===(n=this._getMemorized())||void 0===n?void 0:n.get();c&&this._tabster.focusable.isFocusable(c)&&(s=c),s&&(0,a.W0R)(s)}},this._tabster=t,this._getMemorized=n,this._setHandlers(this._onFocusDummyInput)}}class we extends W{constructor(e,t,n,a,i){var r;super(e,t,a),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,n=j(this._win,e);let a,i=this._fullyVisible;if(t.intersectionRatio>=.25?(a=t.intersectionRatio>=.75?2:1,2===a&&(i=n)):a=0,this._visible[n]!==a){void 0===a?(delete this._visible[n],i===n&&delete this._fullyVisible):(this._visible[n]=a,this._fullyVisible=i);const t=this.getState(e);t&&e.dispatchEvent(new S(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(r=a.visibilityTolerance)&&void 0!==r?r:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=n,e.controlTab||(this.dummyManager=new Oe(this._element,e,()=>a.memorizeCurrent?this._current:void 0,i))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new P(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout(()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const n of t){const t=null==n?void 0:n.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new S(e))}}}}))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,n,a){const i=this.getElement(),r=i&&ee(e)===i;if(!i)return null;let o,s=null,c=!1;if(this._props.tabbable||r||e&&!w.nodeContains(i,e)){const r={currentElement:e,referenceElement:t,container:i,ignoreAccessibility:a,useActiveModalizer:!0},d={};s=this._tabster.focusable[n?"findPrev":"findNext"](r,d),c=!!d.outOfDOMOrder,o=d.uncontrolled}return{element:s,uncontrolled:o,outOfDOMOrder:c}}acceptElement(e,t){var n,a;if(!_e.isTabbing)return(null===(n=t.currentCtx)||void 0===n?void 0:n.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:i,visibilityAware:r,hasDefault:o=!0}=this._props,s=this.getElement();if(s&&(i||r||o)&&(!w.nodeContains(s,t.from)||ee(t.from)===s)){let e;if(i){const n=null===(a=this._current)||void 0===a?void 0:a.get();n&&t.acceptCondition(n)&&(e=n)}if(!e&&o&&(e=this._tabster.focusable.findDefault({container:s,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:s,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var n;const a=j(this._win,e),i=this._visible[a];return s!==e&&!!(null===(n=this._allElements)||void 0===n?void 0:n.get(e))&&t.acceptCondition(e)&&(2===i||1===i&&(1===r||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=s,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),n=this._allElements=new WeakMap,a=this._tabster.focusable;let i=this._updateQueue=[];const r=w.createMutationObserver(e=>{for(const t of e){const e=t.target,n=t.removedNodes,a=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&i.push({element:e,type:2});else{for(let e=0;e<n.length;e++)i.push({element:n[e],type:3});for(let e=0;e<a.length;e++)i.push({element:a[e],type:1})}}u()}),o=(e,t)=>{var a,i;const r=n.get(e);r&&t&&(null===(a=this._intersectionObserver)||void 0===a||a.unobserve(e),n.delete(e)),r||t||(n.set(e,this),null===(i=this._intersectionObserver)||void 0===i||i.observe(e))},s=e=>{const t=a.isFocusable(e);n.get(e)?t||o(e,!0):t&&o(e)},c=e=>{const{mover:n}=f(e);if(n&&n!==this){if(n.getElement()!==e||!a.isFocusable(e))return;o(e)}const i=F(t.document,e,e=>{const{mover:t,groupper:n}=f(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const i=null==n?void 0:n.getFirst(!0);return n&&n.getElement()!==e&&i&&i!==e?NodeFilter.FILTER_REJECT:(a.isFocusable(e)&&o(e),NodeFilter.FILTER_SKIP)});if(i)for(i.currentNode=e;i.nextNode(););},l=e=>{n.get(e)&&o(e,!0);for(let t=w.getFirstElementChild(e);t;t=w.getNextElementSibling(t))l(t)},u=()=>{!this._updateTimer&&i.length&&(this._updateTimer=t.setTimeout(()=>{delete this._updateTimer;for(const{element:e,type:t}of i)switch(t){case 2:s(e);break;case 1:c(e);break;case 3:l(e)}i=this._updateQueue=[]},0))},f=e=>{const t={};for(let n=e;n;n=w.getParentElement(n)){const e=d(this._tabster,n);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};i.push({element:e,type:1}),u(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){const t=j(this._win,e);if(t in this._visible){const n=this._visible[t]||0;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:n}}}}class Ee{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(f,this._onMoveFocus),e.addEventListener(p,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let n=e,a=e;for(let i=w.getParentElement(e);i;i=w.getParentElement(i)){const e=null===(t=d(this._tabster,i))||void 0===t?void 0:t.mover;e&&(e.setCurrent(a),n=void 0),!n&&this._tabster.focusable.isFocusable(i)&&(n=a=i)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const n=e.key;let a;if(n===pe?a=2:n===fe?a=4:n===ue?a=1:n===le?a=3:"PageDown"===n?a=6:"PageUp"===n?a=5:n===de?a=7:"End"===n&&(a=8),!a)return;const i=this._tabster.focusedElement.getFocusedElement();i&&!await this._isIgnoredInput(i,n)&&this._moveFocus(i,a,e)},this._onMoveFocus=e=>{var t;const n=e.composedPath()[0],a=null===(t=e.detail)||void 0===t?void 0:t.key;n&&void 0!==a&&!e.defaultPrevented&&(this._moveFocus(n,a),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const n=e.composedPath()[0];let a=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(n){const t=ie.getTabsterContext(this._tabster,n),i=null==t?void 0:t.mover;i&&(a&&!w.nodeContains(i.getElement(),a)&&(a=void 0),i.setCurrent(a),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(f,this._onMoveFocus),t.removeEventListener(p,this._onMemorizedElement),Object.keys(this._movers).forEach(e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])})}createMover(e,t,n){const a=new we(this._tabster,e,this._onMoverDispose,t,n);return this._movers[a.id]=a,a}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,n){var i,r;const o=this._tabster,c=ie.getTabsterContext(o,e,{checkRtl:!0});if(!c||!c.mover||c.excludedFromMover||n&&c.ignoreKeydown(n))return null;const l=c.mover,u=l.getElement();if(c.groupperBeforeMover){const e=c.groupper;if(!e||e.isActive(!0))return null;for(let t=w.getParentElement(e.getElement());t&&t!==u;t=w.getParentElement(t))if(null===(r=null===(i=d(o,t))||void 0===i?void 0:i.groupper)||void 0===r?void 0:r.isActive(!0))return null}if(!u)return null;const f=o.focusable,p=l.getProps(),m=p.direction||s.Both,_=m===s.Both,h=_||m===s.Vertical,b=_||m===s.Horizontal,g=m===s.GridLinear,v=g||m===s.Grid,S=p.cyclic;let D,I,x,C=0,O=0;if(v&&(x=e.getBoundingClientRect(),C=Math.ceil(x.left),O=Math.floor(x.right)),c.rtl&&(4===t?t=3:3===t&&(t=4)),2===t&&h||4===t&&(b||v))if(D=f.findNext({currentElement:e,container:u,useActiveModalizer:!0}),D&&v){const e=Math.ceil(D.getBoundingClientRect().left);!g&&O>e&&(D=void 0)}else!D&&S&&(D=f.findFirst({container:u,useActiveModalizer:!0}));else if(1===t&&h||3===t&&(b||v))if(D=f.findPrev({currentElement:e,container:u,useActiveModalizer:!0}),D&&v){const e=Math.floor(D.getBoundingClientRect().right);!g&&e>C&&(D=void 0)}else!D&&S&&(D=f.findLast({container:u,useActiveModalizer:!0}));else if(7===t)v?f.findElement({container:u,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var n;if(!f.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&C<=a||(D=t,!1)}}):D=f.findFirst({container:u,useActiveModalizer:!0});else if(8===t)v?f.findElement({container:u,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var n;if(!f.isFocusable(t))return!1;const a=Math.ceil(null!==(n=t.getBoundingClientRect().left)&&void 0!==n?n:0);return t!==e&&C>=a||(D=t,!1)}}):D=f.findLast({container:u,useActiveModalizer:!0});else if(5===t){if(f.findElement({currentElement:e,container:u,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!(!f.isFocusable(e)||R(this._win,e,l.visibilityTolerance)&&(D=e,1))}),v&&D){const e=Math.ceil(D.getBoundingClientRect().left);f.findElement({currentElement:D,container:u,useActiveModalizer:!0,acceptCondition:t=>{if(!f.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return C<n||e>=n||(D=t,!1)}})}I=!1}else if(6===t){if(f.findElement({currentElement:e,container:u,useActiveModalizer:!0,acceptCondition:e=>!(!f.isFocusable(e)||R(this._win,e,l.visibilityTolerance)&&(D=e,1))}),v&&D){const e=Math.ceil(D.getBoundingClientRect().left);f.findElement({currentElement:D,container:u,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!f.isFocusable(t))return!1;const n=Math.ceil(t.getBoundingClientRect().left);return C>n||e<=n||(D=t,!1)}})}I=!0}else if(v){const n=1===t,a=C,i=Math.ceil(x.top),r=O,o=Math.floor(x.bottom);let s,c,d=0;f.findAll({container:u,currentElement:e,isBackward:n,onElement:e=>{const t=e.getBoundingClientRect(),l=Math.ceil(t.left),u=Math.ceil(t.top),f=Math.floor(t.right),p=Math.floor(t.bottom);if(n&&i<p||!n&&o>u)return!0;const m=Math.ceil(Math.min(r,f))-Math.floor(Math.max(a,l)),_=Math.ceil(Math.min(r-a,f-l));if(m>0&&_>=m){const t=m/_;t>d&&(s=e,d=t)}else if(0===d){const t=function(e,t,n,a,i,r,o,s){const c=n<i?i-n:o<e?e-o:0,d=a<r?r-a:s<t?t-s:0;return 0===c?d:0===d?c:Math.sqrt(c*c+d*d)}(a,i,r,o,l,u,f,p);(void 0===c||t<c)&&(c=t,s=e)}else if(d>0)return!1;return!0}}),D=s}return D&&(!n||n&&u.dispatchEvent(new y({by:"mover",owner:u,next:D,relatedEvent:n})))?(void 0!==I&&function(e,t,n){const a=N(t);if(a){const i=H(e,a),r=t.getBoundingClientRect();a.scrollTop+=n?r.top-i.top:r.bottom-i.bottom}}(this._win,D,I),n&&(n.preventDefault(),n.stopImmediatePropagation()),(0,a.W0R)(D),D):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(G(e,Ce)){let n,a=0,i=0,r=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const n=e.type,o=e.value;if(r=(o||"").length,"email"===n||"number"===n){if(r){const n=w.getSelection(e);if(n){const e=n.toString().length,a=t===le||t===ue;if(n.modify("extend",a?"backward":"forward","character"),e!==n.toString().length)return n.modify("extend",a?"forward":"backward","character"),!0;r=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===n;a=t||0,i=e.selectionEnd||0}}else"true"===e.contentEditable&&(n=new(function(e){const t=k(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}(this._win))(t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const n=this._win();this._ignoredInputTimer&&n.clearTimeout(this._ignoredInputTimer);const{anchorNode:o,focusNode:s,anchorOffset:c,focusOffset:d}=w.getSelection(e)||{};this._ignoredInputTimer=n.setTimeout(()=>{var t,n,l;delete this._ignoredInputTimer;const{anchorNode:u,focusNode:f,anchorOffset:p,focusOffset:m}=w.getSelection(e)||{};if(u===o&&f===s&&p===c&&m===d){if(a=p||0,i=m||0,r=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0,u&&f&&w.nodeContains(e,u)&&w.nodeContains(e,f)&&u!==e){let t=!1;const n=e=>{if(e===u)t=!0;else if(e===f)return!0;const r=e.textContent;if(r&&!w.getFirstChild(e)){const e=r.length;t?f!==u&&(i+=e):(a+=e,i+=e)}let o=!1;for(let t=w.getFirstChild(e);t&&!o;t=t.nextSibling)o=n(t);return o};n(e)}null===(l=this._ignoredInputResolve)||void 0===l||l.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)},0)}));if(n&&!await n)return!0;if(a!==i)return!0;if(a>0&&(t===le||t===ue||t===de))return!0;if(a<r&&(t===fe||t===pe||"End"===t))return!0}return!1}}class Ae{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var n;const a=null===(n=this._isUncontrolledCompletely)||void 0===n?void 0:n.call(this,e,t);return void 0===a?t:a}}class Le extends W{constructor(e,t,n){var a;if(super(e,t,n),this._hasFocus=!1,this._onFocusOut=e=>{var t;const n=null===(t=this._element)||void 0===t?void 0:t.get();n&&null===e.relatedTarget&&n.dispatchEvent(new x),n&&!w.nodeContains(n,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===o.Source){const e=null===(a=this._element)||void 0===a?void 0:a.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=w.nodeContains(e,e&&w.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===o.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new x)}}}class ke{constructor(e){this._stack=[],this._getWindow=e}push(e){var t;(null===(t=this._stack[this._stack.length-1])||void 0===t?void 0:t.get())!==e&&(this._stack.length>ke.DEPTH&&this._stack.shift(),this._stack.push(new P(this._getWindow,e)))}pop(e){var t;void 0===e&&(e=()=>!0);const n=this._getWindow().document;for(let a=this._stack.length-1;a>=0;a--){const a=null===(t=this._stack.pop())||void 0===t?void 0:t.get();if(a&&w.nodeContains(n.body,w.getParentElement(a))&&e(a))return a}}}ke.DEPTH=10;class Me{constructor(e){this._onRestoreFocus=e=>{var t,n;this._focusedElementState.cancelAsyncFocus(2);const a=e.composedPath()[0];if(a){const e=null===(n=null===(t=d(this._tabster,a))||void 0===t?void 0:t.restorer)||void 0===n?void 0:n.getProps().id;this._focusedElementState.requestAsyncFocus(2,()=>this._restoreFocus(a,e),0)}},this._onFocusIn=e=>{var t;if(!e)return;const n=d(this._tabster,e);(null===(t=null==n?void 0:n.restorer)||void 0===t?void 0:t.getProps().type)===o.Target&&this._history.push(e)},this._restoreFocus=(e,t)=>{var n;const a=this._getWindow().document;if(w.getActiveElement(a)!==a.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&w.nodeContains(a.body,e))return;const i=e=>{var t,n;return null===(n=null===(t=d(this._tabster,e))||void 0===t?void 0:t.restorer)||void 0===n?void 0:n.getProps().id};null===(n=this._history.pop(e=>t===i(e)))||void 0===n||n.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(_,this._onRestoreFocus),this._history=new ke(this._getWindow),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),e.removeEventListener(_,this._onRestoreFocus)}createRestorer(e,t){const n=new Le(this._tabster,e,t);return t.type===o.Target&&w.getActiveElement(e.ownerDocument)===e&&this._history.push(e),n}}class Pe{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const n=t.call(this,e);for(const e of Pe._shadowObservers)e._addSubObserver(n);return n},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,n=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<n.length;e++)this._walkShadows(n[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&function(e,t){var n,a;if(!e||!t)return!1;let i=t;for(;i;){if(i===e)return!0;i="function"!=typeof i.assignedElements&&(null===(n=i.assignedSlot)||void 0===n?void 0:n.parentNode)?null===(a=i.assignedSlot)||void 0===a?void 0:a.parentNode:i.nodeType===document.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode}return!1}(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,Pe._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,a=null==n?void 0:n.defaultView;n&&a&&(Pe._overrideAttachShadow(a),Pe._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const n=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(n){if(e===n)e=n.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}n.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}Pe._shadowObservers=new Set;class Te{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class Ue{constructor(e,t){var n,a;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.2.0",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))w[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new ve(r),this.focusedElement=new _e(this,r),this.focusable=new oe(this),this.root=new ie(this,null==t?void 0:t.autoRoot),this.uncontrolled=new Ae((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(n=null==t?void 0:t.controlTab)||void 0===n||n,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new Y(r),this.getParent=null!==(a=null==t?void 0:t.getParent)&&void 0!==a?a:w.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=r().document;this._unobserve=function(e,t,n,a){if("undefined"==typeof MutationObserver)return()=>{};const r=t.getWindow;let o;function s(t,n){o||(o=k(r).elementByUId),c(t,n);const a=F(e,t,e=>c(e,n));if(a)for(;a.nextNode(););}function c(e,a){var s;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const c=e.__tabsterElementUID;return c&&o&&(a?delete o[c]:null!==(s=o[c])&&void 0!==s||(o[c]=new P(r,e))),(d(t,e)||e.hasAttribute(i))&&n(t,e,a),NodeFilter.FILTER_SKIP}const l=w.createMutationObserver(e=>{var a,r,o,c,d;const l=new Set;for(const d of e){const e=d.target,u=d.removedNodes,f=d.addedNodes;if("attributes"===d.type)d.attributeName===i&&(l.has(e)||n(t,e));else{for(let n=0;n<u.length;n++){const i=u[n];l.add(i),s(i,!0),null===(r=(a=t._dummyObserver).domChanged)||void 0===r||r.call(a,e)}for(let n=0;n<f.length;n++)s(f[n]),null===(c=(o=t._dummyObserver).domChanged)||void 0===c||c.call(o,e)}}l.clear(),null===(d=t.modalizer)||void 0===d||d.hiddenUpdate()});return a&&s(r().document.body),l.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[i]}),()=>{l.disconnect()}}(t,this,l,e)}}},U(r),this.queueInit(()=>{this.internal.resumeObserver(!0)})}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const n=new Te(this);return e||this._wrappers.add(n),this._mergeProps(t),n}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,n,a,i,r,o,s;this.internal.stopObserver();const c=this._win;null==c||c.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],c&&this._forgetMemorizedTimer&&(c.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(n=this.deloser)||void 0===n||n.dispose(),null===(a=this.groupper)||void 0===a||a.dispose(),null===(i=this.mover)||void 0===i||i.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(o=this.observedElement)||void 0===o||o.dispose(),null===(s=this.restorer)||void 0===s||s.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=k(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),V(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),c&&(function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(c),delete c.__tabsterInstance,delete this._win)}storageEntry(e,t){const n=this._storage;let a=n.get(e);return a?!1===t&&0===Object.keys(a).length&&n.delete(e):!0===t&&(a={},n.set(e,a)),a}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())V(this.getWindow,e),_e.forgetMemorized(this.focusedElement,e)},0),T(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout(()=>{delete this._initTimer,this.drainInitQueue()},0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach(e=>e())}}function Fe(e,t){let n=ze(e);return n?n.createTabster(!1,t):(n=new Ue(e,t),e.__tabsterInstance=n,n.createTabster())}function He(e){const t=ze(e);return t?t.createTabster(!0):null}function Re(e){const t=e.core;return t.groupper||(t.groupper=new ge(t,t.getWindow)),t.groupper}function Ne(e){const t=e.core;return t.mover||(t.mover=new Ee(t,t.getWindow)),t.mover}function Be(e,t,n){const a=e.core;return a.modalizer||(a.modalizer=new xe(a,t,n)),a.modalizer}function je(e){const t=e.core;return t.restorer||(t.restorer=new Me(t)),t.restorer}function Ve(e,t){e.core.disposeTabster(e,t)}function ze(e){return e.__tabsterInstance}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l,c:()=>f,d:()=>u,e:()=>c});var a=n("tslib_538"),i=n("react-lib"),r=n(175),o=n(31),s=n(65),c=function(e){var t=i.useRef();return i.useEffect(function(){t.current=e}),t.current};function d(e){var t=i.useRef(e);t.current=e;var n=i.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}var l=function(e,t){var n=i.useRef(!1);i.useEffect(function(){if(t){var a=function(){n.current=!0},i=function(){n.current?n.current=!1:t()};return e.on(s.e.ResponsiveResize,a),e.on(s.e.ScaleChanged,i),e.on(s.e.RotationChanged,t),function(){e.off(s.e.ResponsiveResize,a),e.off(s.e.ScaleChanged,i),e.off(s.e.RotationChanged,t)}}},[e,t])},u=function(e){var t=(0,a.pM)(i.useState(!1),2),n=t[0],r=t[1];return i.useEffect(function(){var t=function(){r(!0)},n=function(){r(!1)};return e.on(s.e.ZoomStart,t),e.on(s.e.ZoomEnd,n),function(){e.off(s.e.ZoomStart,t),e.off(s.e.ZoomEnd,n)}},[e]),n},f=function(e){var t,n=(0,r.b)().enablePreRender,c=function(e){var t=(0,a.pM)(i.useState(!1),2),n=t[0],r=t[1];return i.useEffect(function(){var t=function(){r(!0)},n=function(){r(!1)};return e.on(s.e.Pinching,t),e.on(s.e.ZoomEnd,n),function(){e.off(s.e.Pinching,t),e.off(s.e.ZoomEnd,n)}},[e]),n}(e);return(null===(t=o.a.features)||void 0===t?void 0:t.enableOptimizedPinch)&&n&&c}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext(void 0),o=i.createContext(function(){}),s=function(){return i.useContext(r)},c=function(){var e=i.useContext(o);return{updateSaveFreeText:i.useCallback(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),{saveFreeText:t})})},[e]),updateEnableAutoSizerHeightGrowing:i.useCallback(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),{enableAutoSizerHeightGrowing:t})})},[e])}},d=function(e){var t=e.children,n=e.enableFreeText,s=e.freeTextHandler,c=e.freeTextContainer,d=e.showEditableFreeTextAt,l=e.setInitialFontAttributes,u=(0,a.pM)(i.useState({saveFreeText:function(){},enableAutoSizerHeightGrowing:function(){}}),2),f=u[0],p=u[1],m=(0,a.q5)((0,a.q5)({},f),{enableFreeText:n,freeTextHandler:s,freeTextContainer:c,showEditableFreeTextAt:d,setInitialFontAttributes:l});return i.createElement(o.Provider,{value:p},i.createElement(r.Provider,{value:m},t))}}
,(e,t)=>{"use strict";var n,a,i,r;if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var d=null,l=null,u=function(){if(null!==d)try{var e=t.unstable_now();d(!0,e),d=null}catch(e){throw setTimeout(u,0),e}};n=function(e){null!==d?setTimeout(n,0,e):(d=e,setTimeout(u,0))},a=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},r=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var m=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var _=!1,h=null,b=-1,g=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},r=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var y=new MessageChannel,S=y.port2;y.port1.onmessage=function(){if(null!==h){var e=t.unstable_now();v=e+g;try{h(!0,e)?S.postMessage(null):(_=!1,h=null)}catch(e){throw S.postMessage(null),e}}else _=!1},n=function(e){h=e,_||(_=!0,S.postMessage(null))},a=function(e,n){b=f(function(){e(t.unstable_now())},n)},i=function(){p(b),b=-1}}function D(e,t){var n=e.length;e.push(t);e:for(;;){var a=n-1>>>1,i=e[a];if(!(void 0!==i&&0<C(i,t)))break e;e[a]=t,e[n]=i,n=a}}function I(e){return void 0===(e=e[0])?null:e}function x(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length;a<i;){var r=2*(a+1)-1,o=e[r],s=r+1,c=e[s];if(void 0!==o&&0>C(o,n))void 0!==c&&0>C(c,o)?(e[a]=c,e[s]=n,a=s):(e[a]=o,e[r]=n,a=r);else{if(!(void 0!==c&&0>C(c,n)))break e;e[a]=c,e[s]=n,a=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var O=[],w=[],E=1,A=null,L=3,k=!1,M=!1,P=!1;function T(e){for(var t=I(w);null!==t;){if(null===t.callback)x(w);else{if(!(t.startTime<=e))break;x(w),t.sortIndex=t.expirationTime,D(O,t)}t=I(w)}}function U(e){if(P=!1,T(e),!M)if(null!==I(O))M=!0,n(F);else{var t=I(w);null!==t&&a(U,t.startTime-e)}}function F(e,n){M=!1,P&&(P=!1,i()),k=!0;var r=L;try{for(T(n),A=I(O);null!==A&&(!(A.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=A.callback;if("function"==typeof o){A.callback=null,L=A.priorityLevel;var s=o(A.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?A.callback=s:A===I(O)&&x(O),T(n)}else x(O);A=I(O)}if(null!==A)var c=!0;else{var d=I(w);null!==d&&a(U,d.startTime-n),c=!1}return c}finally{A=null,L=r,k=!1}}var H=r;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){M||k||(M=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return L},t.unstable_getFirstCallbackNode=function(){return I(O)},t.unstable_next=function(e){switch(L){case 1:case 2:case 3:var t=3;break;default:t=L}var n=L;L=t;try{return e()}finally{L=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=L;L=e;try{return t()}finally{L=n}},t.unstable_scheduleCallback=function(e,r,o){var s=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:E++,callback:r,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,D(w,e),null===I(O)&&e===I(w)&&(P?i():P=!0,a(U,o-s))):(e.sortIndex=c,D(O,e),M||k||(M=!0,n(F))),e},t.unstable_wrapCallback=function(e){var t=L;return function(){var n=L;L=t;try{return e.apply(this,arguments)}finally{L=n}}}}
,(e,t,n)=>{var a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,l=c||d||Function("return this")(),u=Object.prototype.toString,f=Math.max,p=Math.min,m=function(){return l.Date.now()};function _(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function h(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(_(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=_(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=r.test(e);return n||o.test(e)?s(e.slice(2),n?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,n){var a,i,r,o,s,c,d=0,l=!1,u=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var n=a,r=i;return a=i=void 0,d=t,o=e.apply(r,n)}function v(e){return d=e,s=setTimeout(S,t),l?g(e):o}function y(e){var n=e-c;return void 0===c||n>=t||n<0||u&&e-d>=r}function S(){var e=m();if(y(e))return D(e);s=setTimeout(S,function(e){var n=t-(e-c);return u?p(n,r-(e-d)):n}(e))}function D(e){return s=void 0,b&&a?g(e):(a=i=void 0,o)}function I(){var e=m(),n=y(e);if(a=arguments,i=this,c=e,n){if(void 0===s)return v(c);if(u)return s=setTimeout(S,t),g(c)}return void 0===s&&(s=setTimeout(S,t)),o}return t=h(t)||0,_(n)&&(l=!!n.leading,r=(u="maxWait"in n)?f(h(n.maxWait)||0,t):r,b="trailing"in n?!!n.trailing:b),I.cancel=function(){void 0!==s&&clearTimeout(s),d=0,a=c=i=s=void 0},I.flush=function(){return void 0===s?o:D(m())},I}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>A,b:()=>O,c:()=>x,d:()=>C,e:()=>i.Ho,f:()=>w,g:()=>u.b,h:()=>b,i:()=>E,j:()=>g});var a=n("tslib_538"),i=n("odsp.util_152"),r=n(24),o=n(130),s=n(88),c=n(118),d=n(40),l=n(30),u=n(186),f=!i.x9.isActivated("303D5922-4E07-4EDD-80D5-786E09050BF3"),p=n(235),m=n(236),_=n(233),h=n(234);function b(e){var t=e[h.a];if(t){var n=JSON.parse("".concat(t||""));return{mountPoint:n.mp,remoteSpFolderById:n.rsf,remoteSpItem:n.rsi}}}function g(e){var t;if(!e)return{};var n={mp:e.mountPoint,rsf:e.remoteSpFolderById,rsi:e.remoteSpItem};return(t={})[h.a]=JSON.stringify(n),t}var v={ODB:60210},y={ODB:!i.x9.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},S=!i.x9.isActivated("D583FA81-FDE5-486B-9BFC-5AFAF2252239"),D=!i.x9.isActivated("25ABC593-FB06-42D5-AE05-E3F978701388"),I=(0,l.a)(y);function x(e){var t=e.defaultRootItemId,n=e.viewParams,r=e.listUrl,s=e.viewId,l=e.key,p=(0,i.Ho)(l),m=(0,a.q5)({},n);delete m[d.b.idParamKey],f&&(delete m[d.b.cid],delete m[d.b.mid],delete m[d.b.mcid],delete m[d.b.sortBy],delete m[d.b.sortDirection]),S&&(delete m[d.b.contextualFilter],delete m[d.b.extensionFilter],delete m[d.b.searchConversationId],delete m[d.b.dateFilterType],delete m[d.b.beginDate],delete m[d.b.endDate],delete m[d.b.scope]),delete m[d.b.rootFolderParamKey],delete m[d.b.queryTypeParamKey],delete m[d.b.queryParamKey],delete m[d.b.listUrlKey],i.x9.isActivated("0405907e-3935-4959-bd2c-b5a5b89f8acb","09/09/2022","preserve search filters in oneUp and exiting oneUp in odb, return to search when exiting oneUp in odb/spo")||(delete m[d.b.dateFilterKey],delete m[d.b.userFiltersKey]),delete m[d.b.typeFiltersKey],delete m[d.b.remoteItem],delete m[d.b.sortFieldKey],delete m[d.b.groupByKey],delete m[d.b.viewIdKey],delete m[d.b.personIdKey],delete m[d.b.meetingIdKey],delete m[d.b.emailIdKey];for(var _=0,h=Object.keys(n);_<h.length;_++){var b=h[_];d.c.test(b)&&delete m[b]}return delete m[d.b.searchScopeKey],delete m[d.b.disableQueryAlterationKey],delete m[d.b.itemId],delete m[d.b.playlistLayout],(0,o.a)(m,p),delete m[d.b.parentIdParamKey],delete m[d.b.parentQueryTypeParamKey],delete m[d.b.pageParamKey],delete m[d.b.sharedLibraryCreated],p[d.b.idParamKey]===t&&(delete m[d.b.idParamKey],delete m[d.b.rootFolderParamKey]),i.x9.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")&&(m[d.b.listUrlKey]===n[d.b.listUrlKey]&&(0,u.b)(p)===c.a.Files&&(s||"").replace("{","").replace("}","")!==m[d.b.viewIdKey]||delete m[d.b.viewIdKey],m[d.b.newTargetListUrlKey]===r&&(delete m[d.b.newTargetListUrlKey],delete m[d.b.viewPathKey])),delete m[d.b.uniqueParamKey],I&&(delete m[d.b.callerId],delete m[d.b.callerScenarioId]),delete m.photosData,m}function C(e,t){var n,a=Number(e[d.b.queryTypeParamKey])||c.a.Files,i=((n={})[d.b.idParamKey]=e[d.b.idParamKey]||t||"",n[d.b.driveIdParamKey]=e[d.b.driveIdParamKey]||"",n[d.b.driveEndpointParamKey]=e[d.b.driveEndpointParamKey]||"",n[d.b.listUrlKey]=e[d.b.listUrlKey]||"",n[d.b.queryTypeParamKey]="".concat(a||""),n[d.b.queryParamKey]=e[d.b.queryParamKey]||"",n[d.b.typeFiltersKey]=e[d.b.typeFiltersKey]||"",n[d.b.userFiltersKey]=e[d.b.userFiltersKey]||"",n[d.b.dateFilterKey]=e[d.b.dateFilterKey]||"",n[d.b.uniqueParamKey]=e[d.b.uniqueParamKey]||"",n[d.b.disableQueryAlterationKey]=(0,l.a)(v)&&e[d.b.disableQueryAlterationKey]||"",n[d.b.metadataSearchIdKey]=e[d.b.metadataSearchIdKey]||"",n);return e[d.b.searchScopeKey]&&(i[d.b.searchScopeKey]=e[d.b.searchScopeKey]||""),f&&e[d.b.cid]&&(i[d.b.cid]=e[d.b.cid]||""),D&&(i[d.b.contextualFilter]=e[d.b.contextualFilter]||"",i[d.b.extensionFilter]=e[d.b.extensionFilter]||"",i[d.b.searchConversationId]=e[d.b.searchConversationId]||"",i[d.b.dateFilterType]=e[d.b.dateFilterType]||"",i[d.b.beginDate]=e[d.b.beginDate]||"",i[d.b.endDate]=e[d.b.endDate]||"",i[d.b.scope]=e[d.b.scope]||""),(0,r.a)(i,void 0,!0)}function O(e){if(i.x9.isActivated("2CFC06AF-7448-498E-ADB8-F185A6DE6D14")){var t=void 0,n=e[d.b.parentIdParamKey],a=e[d.b.parentQueryTypeParamKey];return(n||a)&&((t={})[d.b.idParamKey]=e[d.b.idParamKey],t[d.b.listUrlKey]=e[d.b.listUrlKey],a&&(t[d.b.queryTypeParamKey]=e[d.b.queryTypeParamKey])),t?(0,r.a)(t,void 0,!0):""}return function(e){var t,n=e[p.a],a=e[m.a];return(n||a)&&((t={})[_.b]=e[_.b],t[_.e]=e[_.e],a&&(t[m.b]=e[m.b])),t?(0,r.a)(t,void 0,!0):""}(e)}function w(e,t){var n=Number(e[d.b.pageParamKey]);switch(n){case s.a.FilePicker:case s.a.FileBrowser:case s.a.TextFileEditor:case s.a.Error:case s.a.Share:case s.a.Embed:case s.a.Restore:case s.a.Settings:case s.a.MobileAppUpsell:case s.a.FileRequest:return n}return O(e)&&t?s.a.OneUp:s.a.Files}function E(e){return e===c.a.RecycleBin||e===c.a.SecondStageRecycleBin}function A(){return window.location.protocol+"//"+window.location.host}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f,b:()=>a,c:()=>l,d:()=>u});var a,i=n("tslib_538"),r=n("react-lib");!function(e){e.Hidden="hidden",e.Running="running",e.Success="success",e.Error="error",e.Info="info"}(a||(a={}));var o=function(e,t){switch(t.type){case a.Hidden:return{type:t.type,text:"",link:"",linkText:"",percentComplete:0};case a.Success:return{type:t.type,text:t.text,link:t.link,linkText:t.linkText,disableAutoHide:t.disableAutoHide,percentComplete:1,onClickButton:t.onClickClose};case a.Error:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:0,onClickButton:t.onClickClose};case a.Info:return{type:t.type,text:t.text,infoIconName:t.infoIconName,shouldAutoFocus:t.shouldAutoFocus,onClickButton:t.onClickClose};default:case a.Running:return{type:t.type,text:t.text,link:"",linkText:"",percentComplete:t.percentComplete,onClickButton:t.onClickExpand}}},s={type:a.Hidden,text:"",link:"",linkText:"",percentComplete:0,onClickButton:function(){}},c=r.createContext(s),d=r.createContext(function(){}),l=function(){return r.useContext(c)},u=function(){return r.useContext(d)},f=function(e){var t=e.children,n=(0,i.pM)(r.useReducer(o,s),2),a=n[0],l=n[1];return r.createElement(c.Provider,{value:a},r.createElement(d.Provider,{value:l},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i,c:()=>a});var a,i,r="https://portal.office.com/";!function(e){e[e.STI=1]="STI",e[e.Default=2]="Default"}(a||(a={})),function(e){e[e.Default=1]="Default",e[e.Search=2]="Search"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l,c:()=>d,d:()=>u});var a=n("tslib_538"),i=n(59),r=n(101),o=n(66),s="Fetch",c=3;function d(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){var r,s,c,d,l,u,f,p,m,_;return(0,a.SO)(this,function(a){switch(a.label){case 0:r=0,s="inferredExtension=".concat(function(e){var t;return null===(t=e.split(/[#?]/)[0].split(".").pop())||void 0===t?void 0:t.trim()}(e)),a.label=1;case 1:return a.trys.push([1,7,,8]),[4,fetch(e,t)];case 2:if(c=a.sent(),r=1,d=c.ok,l=c.status,u=c.statusText,f=c.headers,r=2,!d)throw new i.a(l,u,n,"Unexpected HTTP status ".concat(l," from fetch, ").concat(s," stage: ").concat(r),f);r=3,a.label=3;case 3:return a.trys.push([3,5,,6]),[4,c.arrayBuffer()];case 4:if(p=a.sent(),r=4,0===p.byteLength)throw new i.a(void 0,"EmptyFile",n,"Empty response from fetch ".concat(s," stage: ").concat(r),f,!0);return r=5,[2,p];case 5:throw(m=a.sent()).name===o.a||"NetworkError"===m.name?m:new i.a(void 0,"FailToReadResponse",n,"Failed to read response from fetch, ".concat(s," stage: ").concat(r," ").concat(m.name," ").concat(m.message),f);case 6:return[3,8];case 7:throw(_=a.sent()).name===o.a||"NetworkError"===_.name?_:new i.a(void 0,_.name,n,"".concat(_.message,", ").concat(s," stage: ").concat(r));case 8:return[2]}})})}function l(e,t,n,d,l){return(0,a.yv)(this,void 0,void 0,function(){function u(o){return(0,a.yv)(this,void 0,void 0,function(){var c,d,u,p,m,h,b;return(0,a.SO)(this,function(g){switch(g.label){case 0:return o?(c=(t||{}).headers,d=void 0===c?{}:c,u=(0,a.q5)((0,a.q5)({},t),{headers:(0,a.q5)((0,a.q5)({},d),{Range:"bytes=".concat(o.start,"-").concat(o.end-1)})}),[4,fetch(e,u)]):[2];case 1:if((p=g.sent()).ok)return[3,2];throw m=new i.a(p.status,p.statusText,l,"Fetch request by range failed. fileSize: ".concat(n)),r.a.error(s,m),m;case 2:return[4,p.arrayBuffer()];case 3:h=g.sent(),_+=h.byteLength,b=new Uint8Array(h),f.set(b,o.start),g.label=4;case 4:return[2]}})})}var f,p,m,_,h,b,g,v;return(0,a.SO)(this,function(e){switch(e.label){case 0:for(f=new Uint8Array(n),p=[],m=Math.ceil(n/c),_=0,h=0,b=m;p.length<c;)p.push({start:h,end:b}),h=b,b=Math.min(b+m,n);e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(p.map(u))];case 2:if(e.sent(),r.a.verbose(s,"Download by range completed"),_!==n)throw g=new i.c(i.b.RangeDownloadSizeMismatch,"Download by range failed. Incorrect size. fileSize: ".concat(n,", downloaded length: ").concat(_)),r.a.error(s,g),g;return[2,f.buffer];case 3:throw v=e.sent(),r.a.error(s,new i.c(i.b.FileDownloadFailed,"Download by range failed. e: ".concat(v,", fileSize: ").concat(n))),v.name!==o.a&&d(),v;case 4:return[2]}})})}function u(e,t,n,i,r,o){return(0,a.yv)(this,void 0,void 0,function(){var s,c,l;return(0,a.SO)(this,function(u){switch(u.label){case 0:return s=i.signal,c={credentials:"same-origin",signal:s,headers:(0,a.q5)((0,a.q5)({},void 0!==t&&void 0!==n&&{Range:"bytes=".concat(t,"-").concat(n)}),o&&{Authorization:o})},[4,d(e,c,r)];case 1:return l=u.sent(),[2,new Uint8Array(l)]}})})}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n(187),i=n(40);function r(e){var t=e[i.b.queryTypeParamKey];return t||(t=e[i.b.parentQueryTypeParamKey]),t?Number(t):a.a.Files}const o=r}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("itemComment")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)({name:"".concat("dataRequestNoRedirect.key",".dataRequestNoRedirect"),factory:{dependencies:{},create:function(){return{instance:void 0}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a=n("tslib_538"),i=n(160),r=n("react-lib"),o=n(31),s=n(303),c=n(407),d=n(206),l="dynamic-print-style",u=r.lazy(function(){return n.e(30).then(n.bind(n,688)).then(function(e){return{default:e.PdfJsPreviewer}})}),f=r.forwardRef(function(e,t){var n,f,p=e.filename,m=e.url,_=e.token,h=e.enablePreview,b=e.enablePrint,g=void 0===b||b,v=e.onDocumentLoaded,y=e.onDocumentFullyLoaded,S=e.onFirstRenderVisible,D=e.onNeedPassword,I=e.onDocumentPreviewed,x=r.useRef(null),C=r.useRef(null),O=r.useRef(void 0),w=r.useRef(void 0),E=r.useRef(void 0),A=r.useRef(void 0),L=(0,a.pM)(r.useState(!1),2),k=L[0],M=L[1],P=(0,a.pM)(r.useState(!0),2),T=P[0],U=P[1],F=(0,a.pM)(r.useState(!0),2),H=F[0],R=F[1],N=(0,a.pM)(r.useState(!0),2),B=N[0],j=N[1],V=r.useRef(!1);r.useImperativeHandle(t,function(){return{isMip:function(){var e;return h&&E.current?E.current.mip:!!(null===(e=x.current)||void 0===e?void 0:e.isMip)},getFilename:function(){return void 0===p?(0,s.a)(m):p},getViewer:function(){return x.current},verifyPassword:function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return h&&!k&&C.current?(O.current=e,null===(n=C.current)||void 0===n||n.verifyPassword(e,t),[3,3]):[3,1];case 1:return x.current?[4,null===(i=x.current)||void 0===i?void 0:i.verifyPassword(e,t)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}}},[h,p,k,m]),r.useEffect(function(){i.a.mark("Start")},[]),r.useEffect(function(){var e=document.getElementById(l);if(B&&g)e&&document.head.removeChild(e);else if(!e){var t=document.createElement("style");t.id=l,t.innerHTML="\n            @media print {\n              * {\n                display: none !important;\n              }\n            }\n          ",document.head.appendChild(t)}},[B,g]);var z=r.useCallback(function(e){E.current=e,null==I||I(),e.mip&&(null==v||v(e))},[v,I]),G=r.useCallback(function(e){O.current=void 0,A.current=void 0,U(e.isFormFieldAllowed),R(e.isAnnotAllowed),j(e.isPrintAllowed),null==v||v(e)},[v]),K=r.useCallback(function(){null==S||S()},[S]),W=r.useCallback(function(){h?null==y||y():V.current||(i.a.mark("FirstRenderCompleted"),null==S||S(),V.current=!0)},[h,y,S]),q=r.useCallback(function(e,t){var n;w.current=t,A.current=e,(null===(n=E.current)||void 0===n?void 0:n.mip)||M(!0)},[]),Q=r.useCallback(function(){var e;(null===(e=E.current)||void 0===e?void 0:e.mip)||M(!0)},[]);return h&&o.a.pdfJsWorkerSrc&&!k?r.createElement(r.Suspense,{fallback:r.createElement("div",null)},r.createElement(u,{ref:C,url:m,token:_,workerSrc:o.a.pdfJsWorkerSrc,cMapUrl:o.a.pdfJsCmapUrl,onDocumentLoaded:z,onFirstPageRendered:K,onDocumentFetched:q,onDocumentLoadFailed:Q,onNeedPassword:D})):r.createElement(c.a,{isAnnotationEnabled:!!e.enableEdit&&H,isFormFillingEnabled:!!e.enableEdit&&!!(null===(n=o.a.features)||void 0===n?void 0:n.enableFormFilling)&&T,isFreeTextEnabled:!!e.enableEdit&&!!(null===(f=o.a.features)||void 0===f?void 0:f.enableFreeText)&&H},r.createElement(d.a,(0,a.q5)({key:m,componentRef:x},e,{fileData:A.current,defaultPageNumber:w.current||e.defaultPageNumber,defaultScale:e.defaultScale,initialPassword:O.current,onDocumentLoaded:G,onFirstRenderVisible:W})))})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i,c:()=>a}),(0,n("fui.util_867").ZW)([{rawString:".page_363c865a{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);background-color:rgba(0,0,0,0)}.pageText_363c865a{position:absolute;width:100%;height:100%}.formOverlay_363c865a{position:absolute;width:100%;height:100%}"}]);const a="page_363c865a",i="pageText_363c865a",r="formOverlay_363c865a"}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>a}),function(e){e.Reset="Reset",e.Add="Add",e.Delete="Delete",e.Unknown="Unknown"}(a||(a={}))}
,e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,r){for(var o,s,c=i(e),d=1;d<arguments.length;d++){for(var l in o=Object(arguments[d]))n.call(o,l)&&(c[l]=o[l]);if(t){s=t(o);for(var u=0;u<s.length;u++)a.call(o,s[u])&&(c[s[u]]=o[s[u]])}}return c}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n(93),i=n(20),r=n(3),o=n("odsp.util_152"),s=n(5),c="UserLicensedForCopilot",d="UserNotLicensedForCopilot",l=new o.aF({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:s.a.optional},create:function(e){var t=e.pageContext,n=!1,o=(0,a.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(o.availability.isLicenseCheckBypassed=!0,n=!0):(n=!!(null==t?void 0:t.canUserUseSPCopilot),new r.a({name:n?c:d}).end({resultType:r.b.Success}),i.a.logData({name:n?c:d})),o.availability.isLicensed=n,o.availability.siteSubscriptionId=null==t?void 0:t.siteSubscriptionId,{instance:function(){return n}}}}})}
,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_152"),i="SpHttpDataSource.async.key",r=new a.aF({name:i,loader:new a.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(61)]).then(n.bind(n,656)).then(function(e){return e.resourceKey})})});new a.aF({name:i,loader:new a.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(61)]).then(n.bind(n,656)).then(function(e){return e.typeResourceKey})})})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_152"),i=n(67),r=new a.aF({name:"isSubstrateAcquireDisabled",factory:{dependencies:{},create:function(){return{instance:function(){return(0,i.h)(i.e)}}}}})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>Pt});var a=n("tslib_538"),i=n("fui.util_867");(0,i.ZW)([{rawString:"#printContainer_e193b7f6{display:none}@media print{body{background:rgba(0,0,0,0)}body[data-pdfprinting]>*{display:none}#printContainer_e193b7f6{display:block;height:100%}#printContainer_e193b7f6>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%;page-break-after:always;page-break-inside:avoid}#printContainer_e193b7f6>div img{max-width:100%;max-height:100%}}"}]);var r,o,s=n(161),c=n(8),d=n(304),l=n(269),u=n(73),f=n(216),p=n.n(f),m=n(305),_=n(59);(o=r||(r={})).MipFileSizeExceeded="MipFileSizeExceeded",o.MipWasmLoadFailed="MipWasmLoadFailed",o.MipFetchTokenFailed="MipFetchTokenFailed",o.MipInitializationFailed="MipInitializationFailed",o.MipDecryptionFailed="MipDecryptionFailed",o.MipFetchTokenNotSupported="MipFetchTokenNotSupported",o.MipUnknownError="MipUnknownError",o.MipBadInputError="MipBadInputError",o.MipInsufficientBufferError="MipInsufficientBufferError",o.MipFileIOError="MipFileIOError",o.MipNetworkError="MipNetworkError",o.MipInternalError="MipInternalError",o.MipJustificationRequired="MipJustificationRequired",o.MipNotSupportedOperation="MipNotSupportedOperation",o.MipPrivilegedRequired="MipPrivilegedRequired",o.MipAccessDenied="MipAccessDenied",o.MipConsentDenied="MipConsentDenied",o.MipNoPermissions="MipNoPermissions",o.MipNoAuthToken="MipNoAuthToken",o.MipDisabledService="MipDisabledService",o.MipProxyAuthError="MipProxyAuthError",o.MipNoPolicy="MipNoPolicy",o.MipOperationCancelled="MipOperationCancelled",o.MipAdhocProtectionRequired="MipAdhocProtectionRequired",o.MipDeprecatedApi="MipDeprecatedApi",o.MipTemplateNotFound="MipTemplateNotFound",o.MipLabelNotFound="MipLabelNotFound",o.MipLabelDisabled="MipLabelDisabled",o.MipDoubleKeyDisabled="MipDoubleKeyDisabled",o.MipLicenseNotRegistered="MipLicenseNotRegistered",o.MipContentFormatNotSupported="MipContentFormatNotSupported",o.MipTemplateArchived="MipTemplateArchived",o.MipCustomerKeyUnavailable="MipCustomerKeyUnavailable",o.MipDelegateResponse="MipDelegateResponse",o.MipCount="MipCount";var h,b,g=[r.MipNoPermissions,r.MipAccessDenied,r.MipFileSizeExceeded,r.MipFetchTokenNotSupported];(b=h||(h={})).Trace="Trace",b.Info="Info",b.Warning="Warning",b.Error="Error",b.UnKnown="UnKnown";var v=n(306),y=n(159),S=n(101),D=n(160),I=n(74),x=n(58),C=n(502),O=n(751);const w=Symbol("Comlink.proxy"),E=Symbol("Comlink.endpoint"),A=Symbol("Comlink.releaseProxy"),L=Symbol("Comlink.thrown"),k=e=>"object"==typeof e&&null!==e||"function"==typeof e,M=new Map([["proxy",{canHandle:e=>k(e)&&e[w],serialize(e){const{port1:t,port2:n}=new MessageChannel;return P(e,t),[n,[n]]},deserialize:e=>(e.start(),U(e))}],["throw",{canHandle:e=>k(e)&&L in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function P(e,t=self){t.addEventListener("message",function n(a){if(!a||!a.data)return;const{id:i,type:r,path:o}=Object.assign({path:[]},a.data),s=(a.data.argumentList||[]).map(j);let c;try{const t=o.slice(0,-1).reduce((e,t)=>e[t],e),n=o.reduce((e,t)=>e[t],e);switch(r){case"GET":c=n;break;case"SET":t[o.slice(-1)[0]]=j(a.data.value),c=!0;break;case"APPLY":c=n.apply(t,s);break;case"CONSTRUCT":c=function(e){return Object.assign(e,{[w]:!0})}(new n(...s));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;P(e,n),c=function(e,t){return N.set(e,t),e}(t,[t])}break;case"RELEASE":c=void 0;break;default:return}}catch(e){c={value:e,[L]:0}}Promise.resolve(c).catch(e=>({value:e,[L]:0})).then(e=>{const[a,o]=B(e);t.postMessage(Object.assign(Object.assign({},a),{id:i}),o),"RELEASE"===r&&(t.removeEventListener("message",n),T(t))})}),t.start&&t.start()}function T(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function U(e,t){return H(e,[],t)}function F(e){if(e)throw new Error("Proxy has been released and is not useable")}function H(e,t=[],n=function(){}){let a=!1;const i=new Proxy(n,{get(n,r){if(F(a),r===A)return()=>V(e,{type:"RELEASE",path:t.map(e=>e.toString())}).then(()=>{T(e),a=!0});if("then"===r){if(0===t.length)return{then:()=>i};const n=V(e,{type:"GET",path:t.map(e=>e.toString())}).then(j);return n.then.bind(n)}return H(e,[...t,r])},set(n,i,r){F(a);const[o,s]=B(r);return V(e,{type:"SET",path:[...t,i].map(e=>e.toString()),value:o},s).then(j)},apply(n,i,r){F(a);const o=t[t.length-1];if(o===E)return V(e,{type:"ENDPOINT"}).then(j);if("bind"===o)return H(e,t.slice(0,-1));const[s,c]=R(r);return V(e,{type:"APPLY",path:t.map(e=>e.toString()),argumentList:s},c).then(j)},construct(n,i){F(a);const[r,o]=R(i);return V(e,{type:"CONSTRUCT",path:t.map(e=>e.toString()),argumentList:r},o).then(j)}});return i}function R(e){const t=e.map(B);return[t.map(e=>e[0]),(n=t.map(e=>e[1]),Array.prototype.concat.apply([],n))];var n}const N=new WeakMap;function B(e){for(const[t,n]of M)if(n.canHandle(e)){const[a,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:a},i]}return[{type:"RAW",value:e},N.get(e)||[]]}function j(e){switch(e.type){case"HANDLER":return M.get(e.name).deserialize(e.value);case"RAW":return e.value}}function V(e,t,n){return new Promise(a=>{const i=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),a(n.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)})}var z,G=n("react-lib"),K=n.n(G),W=n(66),q=n(65),Q=function(e,t){void 0===t&&(t=1);var n=e.map(function(e){return e.height*t}),i=e.map(function(e){return e.width*t}),r=e.length;return{width:Math.max.apply(Math,(0,a.lt)([],(0,a.pM)(n),!1))+(W.j+W.k)*t,height:(W.h+(r-1)*W.i+W.g)*t+i.reduce(function(e,t){return e+t},0)}},Y=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!0),void 0===s&&(s=!0),void 0===c&&(c=!0),void 0===d&&(d=!0),void 0===l&&(l=!0),void 0===u&&(u=!0),void 0===f&&(f=!0),this._isMipDecrypted=!1,this._isFileEncrypted=!1,this._isAnnotAllowed=!0,this._isFormFieldAllowed=!0,this._isCopyAllowed=!0,this._isEditAllowed=!0,this._isPrintAllowed=!0,this._isCopyAccessibleAllowed=!0,this._isSignAllowed=!0,this._scale=1,this._rotation=q.f.Degree0,this._originalLayoutSize=e,this._layoutSize=e,this._pageCount=t,this._originalPageSizes=n,this._pageSizes=n,S.a.verbose("PdfMetadata","Page count ".concat(t,", layout size (").concat(e.width,", ").concat(e.height,")")),this._mip=!!a,this._isMipDecrypted=i,this._isFileEncrypted=r,this._isSigned=p,this._isAnnotAllowed=o,this._isFormFieldAllowed=s,this._isCopyAllowed=c,this._isEditAllowed=d,this._isPrintAllowed=l,this._isCopyAccessibleAllowed=u,this._isSignAllowed=f,this._hasOutline=m}return e.prototype.updateOriginalLayoutForProgressiveLoading=function(e,t){var n=this,a=this.inverted?t.map(function(e){var t=e.width;return{width:e.height,height:t}}):t,i=e.width!==this.originalLayoutSize.width||e.height!==this.originalLayoutSize.height||a.length!==this.originalPageSizes.length||a.some(function(e,t){var a=e.width,i=e.height;return a!==n._originalPageSizes[t].width||i!==n._originalPageSizes[t].height});return i&&(this._originalPageSizes=a,this._originalLayoutSize=this.inverted?Q(this.originalPageSizes):e,this._originalLayoutSize=this.inverted?Q(t):e,this.updateSizes()),i},e.prototype.addRotation=function(e){this._rotation=(this._rotation+e)%(q.f.Degree270+1),this.updateSizes()},Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e,this.updateSizes()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this._pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalLayoutSize",{get:function(){return this._originalLayoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layoutSize",{get:function(){return this._layoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originalPageSizes",{get:function(){return this._originalPageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageSizes",{get:function(){return this._pageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inverted",{get:function(){return this.rotation===q.f.Degree90||this.rotation===q.f.Degree270},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mip",{get:function(){return this._mip},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMipDecrypted",{get:function(){return this._isMipDecrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFileEncrypted",{get:function(){return this._isFileEncrypted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSigned",{get:function(){return this._isSigned},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasOutline",{get:function(){return this._hasOutline},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isAnnotAllowed",{get:function(){return this._isAnnotAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFormFieldAllowed",{get:function(){return this._isFormFieldAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAllowed",{get:function(){return this._isCopyAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEditAllowed",{get:function(){return this._isEditAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPrintAllowed",{get:function(){return this._isPrintAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCopyAccessibleAllowed",{get:function(){return this._isCopyAccessibleAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSignAllowed",{get:function(){return this._isSignAllowed},enumerable:!1,configurable:!0}),e.prototype.getDocPermissions=function(){return[{type:"Annot",isAllowed:this.isAnnotAllowed},{type:"Copy",isAllowed:this.isCopyAllowed},{type:"CopyAccessible",isAllowed:this.isCopyAccessibleAllowed},{type:"Edit",isAllowed:this.isEditAllowed},{type:"FormField",isAllowed:this.isFormFieldAllowed},{type:"Print",isAllowed:this.isPrintAllowed},{type:"Sign",isAllowed:this.isSignAllowed}]},e.prototype.updateSizes=function(){this.updatePageSizes(),this.updateLayoutSize()},e.prototype.updatePageSizes=function(){var e=this;this._pageSizes=this.originalPageSizes.map(function(t){var n=t.width*e.scale,a=t.height*e.scale,i=!e.inverted;return{width:i?n:a,height:i?a:n}})},e.prototype.updateLayoutSize=function(){this._layoutSize=this.inverted?Q(this.originalPageSizes,this.scale):{width:this.originalLayoutSize.width*this.scale,height:this.originalLayoutSize.height*this.scale}},e}(),J=n(31),X=function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=void 0,(null===(r=J.a.features)||void 0===r?void 0:r.enableEncrypt)?[4,e.hasSignature()]:[3,2];case 1:t=!!a.sent(),a.label=2;case 2:return n=void 0,y.a.isActivated("AddOutlineCheck")?[3,4]:[4,e.hasOutline()];case 3:n=!!a.sent(),a.label=4;case 4:return[4,e.getDocumentMetaData()];case 5:return i=a.sent(),[2,new Y(i.layoutSize,i.pageCount,i.pagesSize,i.isMip,i.isMipDecrypted,i.isFileEncrypted,i.isAnnotAllowed,i.isFormFieldAllowed,i.isCopyAllowed,i.isEditAllowed,i.isPrintAllowed,i.isCopyAccessibleAllowed,i.isSignAllowed,t,n)]}})})},Z=function(){function e(e,t,n){this._viewHandler=e,this._inputEvtHandler=t,this._metadata=n}return e.getInstance=function(t,n){return(0,a.yv)(this,void 0,void 0,function(){var i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return i=e.bind,r=[void 0,t,n],[4,X(t)];case 1:return[2,new(i.apply(e,r.concat([a.sent()])))]}})})},e.prototype.dispose=function(){this._viewHandler.dispose()},e.prototype.initMetadata=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return e=this,[4,X(this.viewHandler)];case 1:return e._metadata=t.sent(),[2]}})})},e.prototype.updateOriginalLayoutForProgressiveLoading=function(){return(0,a.yv)(this,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,this._viewHandler.getDocumentLayoutSize()];case 1:return e=n.sent(),[4,this._viewHandler.getPageSizes()];case 2:return t=n.sent(),[2,this._metadata.updateOriginalLayoutForProgressiveLoading(e,t)]}})})},Object.defineProperty(e.prototype,"viewHandler",{get:function(){return this._viewHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inputEvtHandler",{get:function(){return this._inputEvtHandler},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),e}(),$=n(665),ee=n(179),te=n.n(ee),ne=n(368),ae=n(503),ie=n(360),re=function(e){function t(t,n,i,r,o,s,c,l,f){var p=e.call(this,t)||this;return p.isSelecting=!1,p.scrollIntoView=te()(function(){if(p.searchScrollPayload){var e=p.searchScrollPayload,t=e.page,n=e.x,a=e.y,i=e.width,r=e.height,o=p.metadata,s=o.originalPageSizes,c=o.rotation,d=o.scale,l=(0,ne.d)(new u.b(n,a,i,r),s[t],d,c).origin;p.goToPageFn(t,l,!0)}},500),p.handleTextSelected=te()(function(){var e;p.selectedText&&""!==p.selectedText&&(d.a.read(p.l10n.get("textSelectedAria",[p.selectedText])),null===(e=p.onTextSelected)||void 0===e||e.call(p,p.selectedText))},500),p.onKeyDown=function(e){return(0,a.yv)(p,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:if(!e.ctrlKey)return[3,5];switch(e.code){case"KeyA":return[3,1];case"KeyC":return[3,3]}return[3,4];case 1:return e.preventDefault(),[4,this.viewHandler.selectAll()];case 2:return t.sent(),[3,5];case 3:return this.copyToClipboard(),[3,5];case 4:return[3,5];case 5:return[2]}})})},p.copyToClipboard=function(){p.selectedText&&window.navigator.clipboard.writeText(p.selectedText)},p.getPageText=function(e){return(0,a.yv)(p,void 0,void 0,function(){return(0,a.SO)(this,function(t){return[2,this.viewHandler.getPageText(e)]})})},p.renderRect=function(e,t){return(0,a.yv)(p,void 0,void 0,function(){var n,i,r,o=this;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=this.metadata.layoutSize,[4,this.viewHandler.selectRender(e.scale((0,m.a)()),{width:(0,m.b)(n.width),height:(0,m.b)(n.height)})];case 1:return(i=a.sent())&&(r=(0,ae.a)(i),requestAnimationFrame(function(){o.setStatesFn(r),null==t||t()})),[2]}})})},p.pointerDown=!1,p.layoutManager=n,p.l10n=i,p.setStatesFn=r,p.goToPageFn=o,p.scrollViewerFn=s,p.onTextSelected=c,p.onTextDeselected=l,p.refreshViewPortForProgressiveLoadingFn=f,p}return(0,a.e2)(t,e),t.prototype.onNotification=function(e){var t;return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o,s,c,d;return(0,a.SO)(this,function(a){switch(a.label){case 0:switch(e.name){case 13:return[3,1];case 4:return[3,2];case 2:return[3,6];case 7:return[3,8]}return[3,9];case 1:return this.selectedText=e.payload,!this.pointerDown&&this.isSelecting&&this.handleTextSelected(),[3,10];case 2:return n=e.payload,i=n.left,r=n.top,o=n.right,s=n.bottom,c=(0,ae.b)(i,r,o,s,this.metadata.scale),[4,null===(t=this.refreshViewPortForProgressiveLoadingFn)||void 0===t?void 0:t.call(this)];case 3:return a.sent()?[3,5]:[4,this.renderRect(c)];case 4:a.sent(),a.label=5;case 5:return[3,10];case 6:return d=this.layoutManager.viewportRectRelativeToDocument,[4,this.renderRect(d)];case 7:return a.sent(),[3,10];case 8:return this.searchScrollPayload=e.payload,this.scrollIntoView(),[3,10];case 9:return[3,10];case 10:return[2]}})})},t.prototype.onPointerDown=function(e){0===e.button&&(this.pointerDown=!0,this.deselectText(),this.isSelecting=!0)},t.prototype.onPointerMove=function(e){this.pointerDown&&this.trySelectionAutoScroll(e)},t.prototype.onPointerUp=function(){this.pointerDown&&(this.pointerDown=!1,this.cancelSelectionScrollTimer(),this.selectText(),this.isSelecting=!1)},t.prototype.selectText=function(){this.handleTextSelected()},t.prototype.deselectText=function(){var e,t=this.selectedText;this.selectedText="",t&&!this.selectedText&&(null===(e=this.onTextDeselected)||void 0===e||e.call(this,t))},t.prototype.onGripperMove=function(e){this.trySelectionAutoScroll(e)},t.prototype.onGirpperUp=function(){this.cancelSelectionScrollTimer()},t.prototype.hasTextSelected=function(){return!!this.selectedText},t.prototype.trySelectionAutoScroll=function(e){var t=this;this.cancelSelectionScrollTimer();var n=this.layoutManager.rootRect,a=n.y,i=a+n.getClientHeight(),r=e.y<=a,o=e.y>=i;if(!r&&!o)return!1;var s,c,d=r?e.y-a:e.y-i;return this.selectionAutoScrollTimerId=(s=function(){var e;null===(e=t.scrollViewerFn)||void 0===e||e.call(t,0,Math.min(W.c,d*W.d))},c=W.b,s(),window.setInterval(s,c)),!0},t.prototype.cancelSelectionScrollTimer=function(){this.selectionAutoScrollTimerId&&(window.clearInterval(this.selectionAutoScrollTimerId),this.selectionAutoScrollTimerId=void 0)},t}(ie.a),oe=n(184),se=n(303),ce="PdfDocumentLoader",de=function(){function e(e,t,n,a,i,r){void 0===n&&(n=0),void 0===a&&(a=!1),this.url=e,this.token=i,this._filename=void 0===t?(0,se.a)(this.url):t,this._fileSize=n,this._enableRanges=a,this.abortController=new AbortController,this.getAuthHeaders=r}return e.prototype.dispose=function(){this.abortController.abort()},e.prototype.fetch=function(){return(0,a.yv)(this,void 0,void 0,function(){var e,t,n,i,r,o,s,c,d,l,u,f=this;return(0,a.SO)(this,function(a){switch(a.label){case 0:this.abortController.abort(),e=this._enableRanges&&0!==this._fileSize,a.label=1;case 1:return a.trys.push([1,8,,9]),t=(this.abortController=new AbortController).signal,n={},this.getAuthHeaders?[4,this.getAuthHeaders()]:[3,3];case 2:a.sent().forEach(function(e){n[e.name]=e.value}),a.label=3;case 3:return this.token&&(n.Authorization=this.token),i={credentials:"same-origin",signal:t,headers:n},e?[4,(0,oe.b)(this.url,i,this._fileSize,function(){f.abortController.abort()},"GetDocument")]:[3,5];case 4:return o=a.sent(),[3,7];case 5:return[4,(0,oe.c)(this.url,i,"GetDocument")];case 6:o=a.sent(),a.label=7;case 7:return r=o,S.a.verbose(ce,"The document is fetched"),s=new Uint8Array(r,0,r.byteLength),this._fileSize=s.byteLength,[2,s];case 8:if((c=a.sent()).name===W.a)return S.a.info(ce,"Aborted the document fetching request"),[2];throw d="NetworkError"===c.name?c.status:void 0,l=C.a.getTempAuthLogFields(this.url,this.token),u=new _.c(_.b.FileDownloadFailed,"Fail to download the PDF file, \n          status: ".concat(d,", \n          downloadByRange?: ").concat(e,", \n          fileSize: ").concat(this._fileSize,", \n          noTempAuth: ").concat(l.noTempAuth,", \n          useToken: ").concat(l.useToken)),I.a.logError(u.toCaughtError()),c;case 9:return[2]}})})},Object.defineProperty(e.prototype,"filename",{get:function(){return this._filename},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fileSize",{get:function(){return this._fileSize},enumerable:!1,configurable:!0}),e}(),le=function(){function e(e){this.noFailedAttempt=!0,this.onNeedPassword=e}return e.prototype.tryOpen=function(e,t){var n;return void 0===e&&(e=""),(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return this._viewHandler?[4,this._viewHandler.openDocument(e)]:[2,!1];case 1:return a.sent()?[2,!0]:(this.noFailedAttempt?(null===(n=this.onNeedPassword)||void 0===n||n.call(this),this.noFailedAttempt=!1):null==t||t(),[2,!1])}})})},Object.defineProperty(e.prototype,"viewHandler",{set:function(e){this._viewHandler=e},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.noFailedAttempt=!0},e}(),ue=function(){function e(e){this.dispatchEventFn=e}return e.prototype.onNotification=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,f,p;return(0,a.SO)(this,function(a){switch(e.name){case 21:t=e.payload,n=t.pageIndex,i=t.left,r=t.top,o=t.right,s=t.bottom,c=t.text,d=t.fontSize,l=t.isMultiLine,f=new u.b(i,r,o-i,s-r),p={pageIndex:n,rect:f,text:c,fontSize:d,isMultiLine:l},this.dispatchEventFn(q.e.ShowTextField,p);break;case 22:this.dispatchEventFn(q.e.ShowTextField,void 0)}return[2]})})},e}(),fe="PdfFreeTextService",pe=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.setInitialFontAttributes=function(e){r.initialFontAttribute=e},r.getAccDataInPage=function(e){return(0,a.yv)(r,void 0,void 0,function(){return(0,a.SO)(this,function(t){return[2,this.viewHandler.getAccDataInPage(e)]})})},r.applyFreeTextAttributes=function(){if(!y.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=window.localStorage.getItem(W.q);if(e){var t=JSON.parse(e);r.setInitialFontAttributes(t)}}catch(e){S.a.error(fe,e)}},r.originalPageRects=n,r.dispatchEventFn=i,r.initialFontAttribute={fontSize:14,fontColor:W.p},r.applyFreeTextAttributes(),r}return(0,a.e2)(t,e),t.prototype.onNotification=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r,o,s,c,d,u,f,p;return(0,a.SO)(this,function(m){if(0===this.originalPageRects.length)return[2];switch(t={},e.name){case 18:n=e.payload,i=n.position,r=n.pageIndex,t={pageIndex:r,id:0,boundingBox:{left:i.x,top:i.y,right:0,bottom:0},text:"",textColor:this.initialFontAttribute.fontColor,fontSize:this.initialFontAttribute.fontSize,lineHeight:14*W.r/10,characterSpacing:W.n,newCreated:!0},(0,l.a)()&&(t.boundingBox.right=-(this.originalPageRects[r].width-i.x)),this.dispatchEventFn(q.e.ShowFreeText,t);break;case 19:o=e.payload.freeText,s=o.boundingBox,c=s.left,d=s.top,u=s.right,f=s.bottom,p={left:c,top:d,right:c+(u-c),bottom:d+(f-d)},(0,l.a)()&&(p.right=-(this.originalPageRects[o.pageIndex].width-u),p.left=-(this.originalPageRects[o.pageIndex].width-c)),o.boundingBox=p,t=(0,a.q5)((0,a.q5)({},o),{newCreated:!1}),this.dispatchEventFn(q.e.ShowFreeText,t);break;case 20:this.dispatchEventFn(q.e.AnnotationChanged)}return[2]})})},t.prototype.storeFreeTextAttribute=function(){if(!y.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var e=JSON.stringify(this.initialFontAttribute);window.localStorage.setItem(W.q,e)}catch(e){S.a.error(fe,e)}},t}(ie.a),me=n(504),_e=n(382),he=function(e){switch(e){case"Content":return 0;case"Cursor":return 1;case"Link":return 2;case"Search":return 3;case"Ink":return 4;case"Document":return 5;case"Gripper":return 8;case"RangeRequest":return 9;case"FreeText":return 6;case"Form":return 7;case"UpdateViewport":return 10;default:return 11}},be=function(e){switch(e){case"DocumentSaved":return 0;case"InkStrokesAdded":return 1;case"InvalidateRect":return 4;case"InvalidateAll":return 2;case"DocumentSizeUpdated":return 3;case"SetDocumentDirty":return 8;case"ScrollIntoView":return 7;case"UpdateCursor":return 9;case"UpdateNumberOfFindResults":return 11;case"UpdateSelectedFindResult":return 12;case"UpdateLinkRect":return 10;case"UpdateSelectedText":return 13;case"NavigateTo":return 5;case"NavigateToDest":return 6;case"GripperPositionChanged":return 14;case"SendRangeRequest":return 15;case"DocumentReady":return 17;case"DocumentDownLoadComplete":return 16;case"ShowNewFreeText":return 18;case"ShowEditableFreeText":return 19;case"FreeTextChanged":return 20;case"TextFieldFocused":return 21;case"TextFieldBlur":return 22;case"VisiblePagesLoaded":return 23;default:return 24}},ge=function(e){e.preventDefault()},ve=function(){function e(e){this.element=e}return e.prototype.activate=function(){this.element.addEventListener("touchmove",ge,{passive:!1})},e.prototype.deactivate=function(){this.element.removeEventListener("touchmove",ge)},e}(),ye=function(e){function t(t,n,i,r,o){var s=e.call(this,t)||this;return s.onLongPress=function(){s.isGripperPosValid&&(s.isLongPress=!0,s.toggleGripperFn(!0),s.isGripperShown=!0)},s.onTouchMove=function(e,t){return(0,a.yv)(s,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.isGripperMoving?(e.preventDefault(),n=new u.a(e.touches[0].clientX,e.touches[0].clientY),this.contentService.onGripperMove(n),[4,this.inputEvtHandler.onPointerMove(t)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})},s.onTouchEnd=function(){return(0,a.yv)(s,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return this.isGripperMoving||this.isLongPress?(this.contentService.onGirpperUp(),null===(t=this.contentService)||void 0===t||t.selectText()):(null===(e=this.contentService)||void 0===e||e.deselectText(),this.toggleGripperFn(!1),this.isGripperShown=!1),this.isGripperMoving?[4,this.inputEvtHandler.onPointerUp(new u.a(0,0))]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isGripperMoving=!1,this.isLongPress=!1,[2]}})})},s.onGripperTouchStart=function(e){return(0,a.yv)(s,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.isGripperMoving=!0,t=e?this.originalGripperPos.right:this.originalGripperPos.left,n=e?this.originalGripperPos.left:this.originalGripperPos.right,[4,this.inputEvtHandler.onPointerDown(t)];case 1:return a.sent(),[4,this.inputEvtHandler.onPointerMove(n)];case 2:return a.sent(),[2]}})})},s.gripperDeSelectText=function(){return(0,a.yv)(s,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onPointerUp(new u.a(0,0))];case 1:return e.sent(),[4,this.inputEvtHandler.onPointerDown(new u.a(0,0))];case 2:return e.sent(),[4,this.inputEvtHandler.onPointerUp(new u.a(0,0))];case 3:return e.sent(),[2]}})})},s.layoutManager=n,s.contentService=i,s.originalGripperPos={left:new u.a(0,0),right:new u.a(0,0)},s.isGripperMoving=!1,s.isLongPress=!1,s.isGripperPosValid=!1,s._isGripperShown=!1,s.toggleGripperFn=r,s.updateGripperPositionFn=o,s}return(0,a.e2)(t,e),t.prototype.onNotification=function(e){if(8===e.type&&14===e.name){var t=e.payload,n=t.leftGripperBoundingRect,a=t.rightGripperBoungdingRect;if(this.isGripperPosValid=n.right-n.left>0||a.right-a.left>0,!this.isGripperPosValid)return;var i=function(e){return new u.a(e.left,(e.bottom+e.top)/2)};this.originalGripperPos.left=i(n),this.originalGripperPos.right=i(a),this.updateGripperPositionFn({left:(0,ne.b)(n,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation),right:(0,ne.b)(a,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation)})}},Object.defineProperty(t.prototype,"isGripperShown",{get:function(){return this._isGripperShown},set:function(e){this._isGripperShown=e},enumerable:!1,configurable:!0}),t}(ie.a),Se="InputEvtService",De=function(e){function t(t,n,i,r,o,s,c,d,l,f,p,m,_,h,b){var g=e.call(this,t)||this;return g._isFormFocused=!1,g.setMode=function(e){var t,n;e!==g.mode&&(g.mode=e,g.isEraseMode()?(g.updateCursor("Eraser"),null===(t=g.preventDefaultOnTouchMove)||void 0===t||t.activate()):g.isFreeTextMode()?g.updateCursor("FreeText"):(g.updateCursorFn(q.b.Default),null===(n=g.preventDefaultOnTouchMove)||void 0===n||n.deactivate()))},g.showEditableFreeTextAt=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.layoutManager.convertPointFromClientToOriginalDocument(e),[4,null===(n=this.inputEvtHandler)||void 0===n?void 0:n.onPointerUp(t)];case 1:return a.sent(),[2]}})})},g.onPointerDown=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.gripperService.toggleGripperFn(!1),this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerDown(e)),t=this,[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.onPointerDown(this.getCursorInOriginDocument(new u.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=a.sent(),[2]}})})},g.onPointerMove=function(e){var t=e.x,n=e.y,i=e.pointerType;return(0,a.yv)(g,void 0,void 0,function(){var e,r,o,s,c;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(i)?(e=new u.a(t,n),(r=this.getCursorType())&&(o=this.layoutManager.convertPointFromClientToDocument(e),(null===(s=this.layoutManager.pageManager)||void 0===s?void 0:s.isPointInVisiblePages(o))?this.updateCursor(r):this.updateCursorFn(q.b.Default)),[4,null===(c=this.inputEvtHandler)||void 0===c?void 0:c.onPointerMove(this.getCursorInOriginDocument(e))]):[2];case 1:return a.sent(),[2]}})})},g.getCursorType=function(){switch(g.mode){case q.a.Erase:return"Eraser";case q.a.FreeText:return"FreeText";default:return null}},g.onPointerUp=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.shouldHandlePointerEvt(e.pointerType)?(this.isDisplayMode()&&(null===(n=this.contentService)||void 0===n||n.onPointerUp()),t=this,[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.onPointerUp(this.getCursorInOriginDocument(new u.a(e.x,e.y)))]):[2];case 1:return t.isFormFocused=a.sent(),[2]}})})},g.onClick=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=e.type,n=e.detail,"click"===t&&n>1&&n<4?(i=this,[4,null===(r=this.inputEvtHandler)||void 0===r?void 0:r.onMultiTapped(this.getCursorInOriginDocument(new u.a(e.x,e.y)),n)]):[3,2];case 1:i.isFormFocused=a.sent(),a.label=2;case 2:return[2]}})})},g.onTouchStart=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n,i=this;return(0,a.SO)(this,function(r){switch(r.label){case 0:return e.touches.length>1?[2]:(t=new u.a(e.touches[0].clientX,e.touches[0].clientY),this.touchDownPoint=t,this.isFreeTextMode()?[2]:(n=this.getCursorInOriginDocument(t),!y.a.isActivated("UseGripperSelectText")&&this.isDisplayMode()&&(this.pressTimer=window.setTimeout(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,this.inputEvtHandler.onMultiTapped(n,2)];case 1:return e.sent(),this.gripperService.onLongPress(),this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0),[2]}})})},500)),this.gripperService.isGripperShown?[3,2]:[4,this.inputEvtHandler.onPointerDown(n)]));case 1:r.sent(),r.label=2;case 2:return[2]}})})},g.onTouchMove=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return y.a.isActivated("UseGripperSelectText")||!this.isDisplayMode()?[2]:(t=new u.a(e.touches[0].clientX,e.touches[0].clientY),n=this.getCursorInOriginDocument(t),this.resetTimer(),[4,this.gripperService.onTouchMove(e,n)]);case 1:return a.sent(),[2]}})})},g.onTouchEnd=function(e){return(0,a.yv)(g,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e.changedTouches.length>1?[2]:(t=new u.a(e.changedTouches[0].clientX,e.changedTouches[0].clientY),!this.gripperService.isGripperShown&&this.isTouchMoving(t)?[2]:(n=this.getCursorInOriginDocument(t),this.resetTimer(),y.a.isActivated("UseGripperSelectText")||!this.gripperService.isGripperShown?[3,2]:[4,this.gripperService.onTouchEnd()]));case 1:return a.sent(),[3,4];case 2:return[4,this.inputEvtHandler.onPointerUp(n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},g.onGripperTouchStart=function(e){return(0,a.yv)(g,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,this.gripperService.onGripperTouchStart(e)];case 1:return t.sent(),[2]}})})},g.gripperDeSelectText=function(){return(0,a.yv)(g,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,this.gripperService.gripperDeSelectText()];case 1:return e.sent(),[2]}})})},g.pasteTextIntoFormField=function(){return(0,a.yv)(g,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:e="",n.label=1;case 1:return n.trys.push([1,4,,5]),[4,window.navigator.clipboard.readText()];case 2:return 0===(e=n.sent()).length?[2]:[4,this.inputEvtHandler.pasteIntoFormField(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),S.a.error(Se,t),[2];case 5:return[2]}})})},g.formCopyAndCut=function(e,t){return(0,a.yv)(g,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.inputEvtHandler.getFormSelectedText()];case 1:n=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,window.navigator.clipboard.writeText(n)];case 3:return a.sent(),[3,5];case 4:return i=a.sent(),S.a.error(Se,i),[2];case 5:return"KeyX"===e&&n?null!==(d=this.inputEvtHandler)&&void 0!==d?[3,6]:(r=void 0,[3,9]):[3,11];case 6:return s=(o=d).onKeyDown,[4,null===(l=this.inputEvtHandler)||void 0===l?void 0:l.getVirtualKeyFromEvt("Delete")];case 7:return c=[a.sent()],[4,null===(u=this.inputEvtHandler)||void 0===u?void 0:u.getModifierKeyFromEvt("None")];case 8:r=s.apply(o,c.concat([a.sent(),t])),a.label=9;case 9:return[4,r];case 10:a.sent(),a.label=11;case 11:return[2]}})})},g.onKeyDown=function(e,t){return(0,a.yv)(g,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return this.isDisplayMode()&&!this.isFormFocused&&e.ctrlKey?[4,this.contentService.onKeyDown(e)]:[3,2];case 1:return n.sent(),[2];case 2:return this.isFormFillingEnabledFn()&&(0,_e.b)()?[4,this.handleKeyDownForForm(e,t)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}})})},g.isFormFillingEnabledFn=h,g.mode=q.a.None,g.layoutManager=n,g.l10n=i,g.contentService=r,g.gripperService=new ye(t,n,r,o,s),g.pressTimer=void 0,g.updateCursorFn=m,b&&(g.preventDefaultOnTouchMove=new ve(b)),g.goToPageFn=c,g.scrollByFn=d,g.scrollToFn=l,g.focusOnVirtualForwardFormFn=f,g.focusOnVirtualBackwardFormFn=p,g.onFormFocusFn=_,g}return(0,a.e2)(t,e),t.prototype.dispose=function(){var e;null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.deactivate()},t.prototype.onNotification=function(e){switch(e.type){case 1:9===e.name&&this.isDisplayMode()&&this.updateCursorFn(function(e){switch(e){case"Text":return q.b.Text;case"Link":return q.b.Link;default:return q.b.Default}}(e.payload));break;case 8:this.gripperService.onNotification(e)}},t.prototype.isTouchMoving=function(e){var t=this.touchDownPoint&&e.distanceTo(this.touchDownPoint)>5;return this.touchDownPoint=void 0,t},t.prototype.resetTimer=function(){"number"==typeof this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0)},t.prototype.getCursorInOriginDocument=function(e){return this.layoutManager.convertPointFromClientToOriginalDocument(e)},t.prototype.isDisplayMode=function(){return this.mode===q.a.None},t.prototype.isEraseMode=function(){return this.mode===q.a.Erase||this.mode===q.a.PointErase},t.prototype.isFreeTextMode=function(){return this.mode===q.a.FreeText},t.prototype.shouldHandlePointerEvt=function(e){return!e||"mouse"===e||!this.isDisplayMode()},t.prototype.isFormValidChars=function(e){return 1===e.length||e===q.d.Enter},t.prototype.updateCursor=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,this.getCustomCursor(e)];case 1:return(t=n.sent())&&this.updateCursorFn(t),[2]}})})},t.prototype.getCustomCursor=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return this.cursorHelper?[3,2]:(t=this,[4,(0,me.a)()]);case 1:t.cursorHelper=n.sent(),n.label=2;case 2:switch(e){case"Eraser":return[2,this.cursorHelper.getEraserCursor()];case"FreeText":return[2,this.cursorHelper.getFreeTextCursor()];default:return[2,void 0]}return[2]}})})},Object.defineProperty(t.prototype,"isFormFocused",{get:function(){return this._isFormFocused},set:function(e){this.onFormFocusFn(e),this._isFormFocused=e},enumerable:!1,configurable:!0}),t.prototype.handleKeyDownForForm=function(e,t){var n,i,r,o,s,c,l;return(0,a.yv)(this,void 0,void 0,function(){var u,f,p,m,_,h,b,g,v,y,S,D,I,x,C;return(0,a.SO)(this,function(a){switch(a.label){case 0:return u=e.key,Object.values(q.d).includes(u)&&e.preventDefault(),this.isFormValidChars(u)&&this.isFormFocused&&e.preventDefault(),(f=1!==u.length)?[4,null===(n=this.inputEvtHandler)||void 0===n?void 0:n.getVirtualKeyFromEvt(u)]:[3,2];case 1:f=0===a.sent(),a.label=2;case 2:return f?[2]:e.ctrlKey?"KeyC"!==e.code&&"KeyX"!==e.code?[3,4]:[4,this.formCopyAndCut(e.code,t)]:[3,6];case 3:return a.sent(),[2];case 4:return"KeyV"!==e.code?[3,6]:[4,this.pasteTextIntoFormField()];case 5:return a.sent(),[2];case 6:return!this.isFormValidChars(u)||e.ctrlKey?[3,12]:(m=void 0,u!==q.d.Enter?[3,8]:[4,null===(i=this.inputEvtHandler)||void 0===i?void 0:i.getVirtualKeyFromEvt(u)]);case 7:return m=a.sent(),[3,9];case 8:m=u.charCodeAt(0),a.label=9;case 9:return h=(_=this.inputEvtHandler).onChar,b=[m],[4,null===(r=this.inputEvtHandler)||void 0===r?void 0:r.getModifierKeyFromEvt("None")];case 10:return[4,h.apply(_,b.concat([a.sent()]))];case 11:return p=a.sent(),u!==q.d.Space||p||this.goToPageFn(t+1),[2];case 12:return(S=e.shiftKey)?[4,null===(o=this.inputEvtHandler)||void 0===o?void 0:o.getModifierKeyFromEvt("Shift")]:[3,14];case 13:S=a.sent(),a.label=14;case 14:return(y=S)?[3,17]:(D=e.ctrlKey)?[4,null===(s=this.inputEvtHandler)||void 0===s?void 0:s.getModifierKeyFromEvt("Control")]:[3,16];case 15:D=a.sent(),a.label=16;case 16:y=D,a.label=17;case 17:return(v=y)?[3,19]:[4,null===(c=this.inputEvtHandler)||void 0===c?void 0:c.getModifierKeyFromEvt("None")];case 18:v=a.sent(),a.label=19;case 19:return g=v,null!==(l=this.inputEvtHandler)&&void 0!==l?[3,20]:(I=void 0,[3,22]);case 20:return C=(x=l).onKeyDown,[4,this.inputEvtHandler.getVirtualKeyFromEvt(u)];case 21:I=C.apply(x,[a.sent(),g,t]),a.label=22;case 22:return[4,I];case 23:if(p=a.sent(),u===q.d.Tab&&(this.isFormFocused=p),p)u===q.d.Tab&&d.a.read(this.l10n.get("formFieldAria"));else switch(u){case q.d.Home:this.scrollToFn(0,0);break;case q.d.End:this.scrollToFn(0,this.layoutManager.documentSize.height);break;case q.d.ArrowDown:this.scrollByFn(0,100);break;case q.d.ArrowUp:this.scrollByFn(0,-100);break;case q.d.ArrowLeft:this.scrollByFn(-100,0);break;case q.d.ArrowRight:this.scrollByFn(100,0);break;case q.d.Tab:e.shiftKey?this.focusOnVirtualBackwardFormFn(t):this.focusOnVirtualForwardFormFn(t)}return[2]}})})},t.prototype.addFreeText=function(){var e,t;return(0,a.yv)(this,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=new u.a(document.documentElement.clientWidth/2,document.documentElement.clientHeight/2),[4,null===(e=this.inputEvtHandler)||void 0===e?void 0:e.onPointerDown(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 1:return a.sent(),[4,null===(t=this.inputEvtHandler)||void 0===t?void 0:t.onPointerUp(this.layoutManager.convertPointFromClientToOriginalDocument(n))];case 2:return a.sent(),d.a.read(this.l10n.get("freeTextAdded")),[2]}})})},t}(ie.a),Ie=function(e){function t(t,n,i,r){var o=e.call(this,t)||this;return o.onNotification=function(e){switch(e.name){case 10:var t=e.payload,n=t.left,a=t.top,i=t.right,r=t.bottom;if(n===i||a===r)o.dispatchEventFn(q.e.ClearHighlightLink);else{var s=(0,ae.b)(n,a,i,r,o.metadata.scale),c=o.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();s.origin=s.origin.plus(c),o.dispatchEventFn(q.e.HighlightLink,s)}break;case 5:var d=e.payload;o.navigateToWebLink(d);break;case 6:o.dispatchEventFn(q.e.ClearHighlightLink);var l=e.payload,f=l.page,p=l.x,m=l.y;o.navigateToDocumentLink(f,new u.a(p,m))}},o.getLinkInfosInPage=function(e,t){return(0,a.yv)(o,void 0,void 0,function(){return(0,a.SO)(this,function(n){return[2,this.viewHandler.getLinkInfosInPage(e,t?1:this.metadata.scale)]})})},o.layoutManager=n,o.goToPageFn=i,o.dispatchEventFn=r,o}return(0,a.e2)(t,e),t.prototype.navigateToDocumentLink=function(e,t){t.scale(this.metadata.scale),this.goToPageFn(e,t)},t.prototype.navigateToWebLink=function(e){(0,se.b)(e)?this.navigateToUrlViaATag(e):S.a.warn("PdfLinkService","Unsupported web link")},t.prototype.navigateToUrlViaATag=function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.click()},t}(ie.a),xe=function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.target.apply(null,e.args)];case 1:return t=a.sent(),e.isCancelled?[2,!1]:(null===(i=e.onsuccess)||void 0===i||i.call(e,t),[2,!0]);case 2:return n=a.sent(),null===(r=e.onerror)||void 0===r||r.call(e,n),[2,!1];case 3:return[2]}})})},Ce=function(){function e(){var e=this;this.internalRun=function(){return(0,a.yv)(e,void 0,void 0,function(){var e,t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return this.running=!0,(e=this.pickTask())?(t=e.type,n=e.task,[4,xe(n)]):(this.running=!1,[2]);case 1:switch(i=a.sent(),t){case"Micro":r=this.microQueue.findIndex(function(e){return e===n}),this.microQueue.splice(0,r+1);break;case"Normal":this.queue.shift();break;case"PreRender":i&&(this.preRenderTask=void 0)}return this.internalRun(),[2]}})})},this.microQueue=[],this.queue=[],this.running=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.add=function(e,t){t?this.microQueue.push(e):this.queue.push(e),this.running||this.run()},e.prototype.poll=function(e){return e?this.microQueue.shift():this.queue.shift()},e.prototype.setPreRenderTask=function(e){this.preRenderTask=e,this.running||this.run()},e.prototype.cancelPreRenderTask=function(){var e,t;(e=this.preRenderTask)&&(null===(t=e.oncancel)||void 0===t||t.call(e),e.isCancelled=!0,e=void 0)},e.prototype.run=function(){this.internalRun()},e.prototype.clear=function(){this.cancelPreRenderTask(),e.instance=void 0},e.prototype.pickTask=function(){if(this.preRenderTask&&this.preRenderTask.isPageVisible())return{type:"PreRender",task:this.preRenderTask};if(this.microQueue.length>=1){var e=this.microQueue.length;return{type:"Micro",task:this.microQueue[e-1]}}return this.queue.length>=1?{type:"Normal",task:this.queue[0]}:this.preRenderTask?{type:"PreRender",task:this.preRenderTask}:void 0},e}();!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Up=2]="Up",e[e.Down=3]="Down"}(z||(z={}));var Oe=function(e){function t(t,n,a,i){var r=e.call(this,t)||this;return r.firstRender=!0,r.itemQueue=[],r.msgQueue=Ce.getInstance(),r.setStatesFn=n,r.handleErrorFn=a,r.onInitialMetadataUpdated=i,r.viewHandler.setDPR((0,m.a)()),r}return(0,a.e2)(t,e),t.prototype.clear=function(){this.itemQueue=[],this.viewHandler.clearRender()},t.prototype.render=function(e){var t,n,i=function(e,t){if(e){var n=e.rect;return t&&n.x!==t.x&&n.y!==t.y?[{rect:new u.b(t.x,n.y,n.width,n.height),layoutSize:e.layoutSize},e]:[e]}}(function(e){var t=e.layoutSize;if(t.width*t.height!=0){var n=new u.b(0,0,t.width,t.height),i=e.rect.intersect(n);return i?(0,a.q5)((0,a.q5)({},e),{rect:i,layoutSize:{width:(0,m.b)(t.width),height:(0,m.b)(t.height)}}):void 0}}(e),null===(n=this.lastItemInQueue)||void 0===n?void 0:n.rect);i&&0!==i.length&&((t=this.itemQueue).push.apply(t,(0,a.lt)([],(0,a.pM)(i),!1)),this.updateMetadata(e.triggerType),this.itemQueue.length===i.length&&this.doRender(i[0]),this.internalRender())},t.prototype.updateMetadata=function(e){var t=this;if(this.lastItemInQueue){var n=this.lastItemInQueue,a=n.rect,i=n.layoutSize,r=n.rotation,o=u.b.create(a);this.msgQueue.add({target:this.viewHandler.setRenderingMetadata,args:[o.scale((0,m.a)()),i,r],onsuccess:function(){var n;"Init"===e&&(null===(n=t.onInitialMetadataUpdated)||void 0===n||n.call(t))},onerror:this.handleErrorFn},!0)}},t.prototype.internalRender=function(){for(;this.itemQueue.length>=2;)this.doRender(this.itemQueue[1],this.itemQueue[0]),this.itemQueue.shift()},t.prototype.doRender=function(e,t){var n=this,a=u.b.create(e.rect),i="Scroll"===e.triggerType,r=void 0;if(i&&t){var o=t.rect,s=a.intersect(o);if(s)if(a.y!==o.y){var c=a.y<o.y;r=c?z.Up:z.Down,a.height-=s.height,a.y=c?a.y:o.y+o.height}else if(a.x!==o.x){var d=a.x<o.x;r=d?z.Left:z.Right,a.width-=s.width,a.x=d?a.x:o.x+o.width}}a.scale((0,m.a)()),S.a.verbose("PdfRenderService","Rect to render: ".concat(a.toString(),", in layout(").concat(e.layoutSize.width,", ").concat(e.layoutSize.height)),this.msgQueue.add({target:this.viewHandler.scrollRender,args:[a,e.layoutSize,e.rotation,i,r],onsuccess:function(t){var a,i=!1;if(t){var r=t.layoutSize,o=t.rotation;if(t&&(!r||r.width===(0,m.b)(n.metadata.layoutSize.width))&&(void 0===o||o===n.metadata.rotation)){t.triggerType=e.triggerType;var s=(0,ae.a)(t);n.firstRender?(s.firstRender=!0,n.firstRender=!1):s.originRelativeToDoc=s.origin,n.setStatesFn(s),i=!0}}null===(a=e.onCompleted)||void 0===a||a.call(e,i)},onerror:function(t){var a;e.onError?e.onError(t):null===(a=n.handleErrorFn)||void 0===a||a.call(n,t)}})},Object.defineProperty(t.prototype,"lastItemInQueue",{get:function(){return this.itemQueue.length>=1?this.itemQueue[this.itemQueue.length-1]:void 0},enumerable:!1,configurable:!0}),t}(ie.a),we=function(e){function t(t){return e.call(this,t)||this}return(0,a.e2)(t,e),t.prototype.onNotification=function(e){var t,n;return(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:switch(e.name){case 11:return[3,1];case 12:return[3,4]}return[3,5];case 1:return i=e.payload,r=i.totalResultCount,o=i.isFinalResult,0!==r?[3,3]:[4,this.stopSearch()];case 2:a.sent(),a.label=3;case 3:return null===(t=this.callbacks)||void 0===t||t.onTotalResultUpdate(r,o),[3,6];case 4:return s=e.payload,null===(n=this.callbacks)||void 0===n||n.onHitIndexUpdate(s),[3,6];case 5:return[3,6];case 6:return[2]}})})},t.prototype.startSearch=function(e,t,n,i){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return i&&(this.callbacks=i),[4,this.viewHandler.startSearch(e,t,n)];case 1:return a.sent(),[2]}})})},t.prototype.goToNextSearchResult=function(e){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,this.viewHandler.goToNextSearchResult(e)];case 1:return t.sent(),[2]}})})},t.prototype.stopSearch=function(){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,this.viewHandler.stopSearch()];case 1:return e.sent(),[2]}})})},t}(ie.a),Ee=n(374),Ae=function(){function e(){}return e.computeNewScale=function(e,t){var n=3*this.normalizeDelta(e),a=Math.pow(1.1,Math.ceil(Math.abs(n)));return Ee.a.normalizeScale(n>=0?t*a:t/a,2)},e.normalizeDelta=function(e){var t=e.deltaX,n=e.deltaY,a=Math.atan2(n,t),i=-45*Math.PI/180,r=135*Math.PI/180,o=Math.sqrt(t*t+n*n);switch(i<a&&a<r&&(o=-o),e.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:return o/900;case WheelEvent.DOM_DELTA_LINE:return o/30;default:return o}},e}(),Le=function(e,t,n){return(e-1)*(t-n)},ke=function(e){function t(t,n,a,i,r,o,s){var c=e.call(this,t)||this;return c.unfinishedZoomingList=[],c.throttledWheelZoom=p()(function(e){var t=Ae.computeNewScale(e,c.metadata.scale);c.isValidScale(t)&&(c.curZoomOpt=void 0,c.blurZoom(t),c.debouncedRender())},100),c.debouncedRender=te()(function(){c.render()},200),c.blurZoom=function(e,t){var n;if(!c.isValidScale(e))return!1;c.dispatchEventFn(q.e.ZoomStart),c.lastZoomSnapshot||c.refreshLastZoomSnapshot();var a=c.layoutManager.rootRect;t?c.metadata.layoutSize.width*e<=a.getClientWidth()&&(t.x=a.getClientWidth()/2):t=new u.a(a.getClientWidth()/2,a.getClientHeight()/2),S.a.verbose("PdfZoomService","newScale: ".concat(e,", anchor: (").concat(t.x,", ").concat(t.y,")"));var i=new u.a(a.getScrollLeft(),a.getScrollTop()),r=c.getViewportScrollVector(i,e/c.metadata.scale,t),o=c.lastZoomSnapshot,s=o.scale,d=o.visibleDocumentOrigin,l=e/(c.blurred?s:c.metadata.scale),f=c.getScaledVisibleDocumentOrigin(c.blurred?d:c.getCurrentVisibleDocumentOrigin(),l,t);c.scale=e,c.layoutManager.resetContentSize(),c.layoutManager.scrollPosition=new u.a(c.layoutManager.isDocumentWiderThanViewport()?Math.min(r.x,c.metadata.layoutSize.width-a.getClientWidth()):0,c.layoutManager.isDocumentHigherThanViewport()?Math.min(r.y,c.metadata.layoutSize.height-a.getClientHeight()):0);var p=Math.abs(i.x-a.getScrollLeft())<1&&(Math.abs(i.y-a.getScrollTop())<1||c.metadata.layoutSize.height<=a.getClientHeight());return c.triggerBlurDraw(f,l,p),c.blurred=!0,p||null===(n=c.preventScrollFn)||void 0===n||n.call(c),!0},c.render=function(){var e;c.unfinishedZoomingList.includes(c.metadata.scale)||(null===(e=c.lastZoomSnapshot)||void 0===e?void 0:e.scale)===c.metadata.scale||(c.unfinishedZoomingList.push(c.metadata.scale),requestAnimationFrame(function(){var e={scale:c.metadata.scale,visibleDocumentOrigin:c.getCurrentVisibleDocumentOrigin()};c.renderFn("Zoom").then(function(t){var n=c.unfinishedZoomingList.findIndex(function(t){return t===e.scale});c.unfinishedZoomingList.splice(n,1),0===c.unfinishedZoomingList.length&&c.dispatchEventFn(q.e.ZoomEnd),t&&(c.blurred=!1,c.refreshLastZoomSnapshot(e))})}))},c.layoutManager=n,c.renderFn=a,c.setStatesFn=i,c.dispatchEventFn=r,c.preventScrollFn=o,c.onScaleUpdated=s,Ee.a.setMinMaxScale(c.minScale,c.maxScale),c}return(0,a.e2)(t,e),t.prototype.initScale=function(e){void 0===e&&(e=q.g.FitSize),this.updateZoomOpt(e),this.scale=this.getZoomScale(e)},t.prototype.isResponsiveZoomValid=function(){return!!this.curZoomOpt&&this.isValidScale(this.curZoomOpt)},t.prototype.responsiveZoom=function(e){if(!this.curZoomOpt)return!1;if(e){var t=this.getZoomScale(this.curZoomOpt);return!!this.isValidScale(t)&&(this.scale=t,!0)}return this.zoom(this.curZoomOpt)},t.prototype.zoom=function(e,t){var n=this.getZoomScale(e);if(!this.isValidScale(n))return!1;this.updateZoomOpt(e);var a=this.blurZoom(n,t);return this.debouncedRender(),a},t.prototype.wheelZoom=function(e){this.throttledWheelZoom(e)},t.prototype.isValidScale=function(e){var t=this.getZoomScale(e);return t>=this.minScale&&t<=this.maxScale&&t!==this.metadata.scale},Object.defineProperty(t.prototype,"minScale",{get:function(){return Math.min(W.v,this.getZoomScale(q.g.FitWidth),this.getZoomScale(q.g.FitSize))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){return Math.max(W.u,this.getZoomScale(q.g.FitWidth),this.getZoomScale(q.g.FitSize))},enumerable:!1,configurable:!0}),t.prototype.getZoomOpt=function(){return this.curZoomOpt},Object.defineProperty(t.prototype,"scale",{set:function(e){var t;this.metadata.scale=e,null===(t=this.onScaleUpdated)||void 0===t||t.call(this,e,this.curZoomOpt)},enumerable:!1,configurable:!0}),t.prototype.refreshLastZoomSnapshot=function(e){this.lastZoomSnapshot=e||{scale:this.metadata.scale,visibleDocumentOrigin:this.getCurrentVisibleDocumentOrigin()}},t.prototype.updateZoomOpt=function(e){this.curZoomOpt="number"==typeof e?void 0:e},t.prototype.getZoomScale=function(e){var t=this.convertScaleToNumber(e);return Ee.a.normalizeScale(t,2)},t.prototype.convertScaleToNumber=function(e){if("number"==typeof e)return e;var t=this.layoutManager.rootRect;return e===q.g.FitWidth?(t.getClientWidth()-10)/this.metadata.originalLayoutSize.width:(t.getClientHeight()+20)/this.getCurrentPageHeightInOriginalScale()},t.prototype.getViewportScrollVector=function(e,t,n){var a=new u.a(this.layoutManager.documentLeftToViewport,0),i=(a.y+e.y)*(t-1)+Le(t,n.y,a.y),r=Math.max(0,e.y+i),o=Le(t,n.x,a.x),s=o>a.x?o-a.x:e.x;return new u.a(s,r)},t.prototype.triggerBlurDraw=function(e,t,n){var a=this,i=this.getCurrentVisibleDocumentOrigin(),r=n?new u.a(0,0):new u.a(e.x-i.x,e.y-i.y);requestAnimationFrame(function(){a.setStatesFn({prevOrigin:r,ratio:t})})},t.prototype.getScaledVisibleDocumentOrigin=function(e,t,n){return new u.a(e.x-Le(t,n.x,e.x),e.y-Le(t,n.y,e.y))},t.prototype.getCurrentVisibleDocumentOrigin=function(){return new u.a(this.layoutManager.visibleDocumentLeftToViewport,0)},t.prototype.getCurrentPageHeightInOriginalScale=function(){var e,t=(null===(e=this.layoutManager.pageManager)||void 0===e?void 0:e.getCurrentPage())||0,n=this.metadata.originalPageSizes[t],a=n.width,i=n.height;return this.metadata.inverted?a:i},t}(ie.a),Me=function(){function e(){this.element=document.body}return e.prototype.initialize=function(e){this.element=e},e.prototype.setWidth=function(e){var t=this;requestAnimationFrame(function(){t.element.style.width="".concat(e,"px")})},e.prototype.getClientWidth=function(){return this.element.clientWidth},e.prototype.getWidth=function(){return this.element.getBoundingClientRect().width},e.prototype.setHeight=function(e){var t=this;requestAnimationFrame(function(){t.element.style.height="".concat(e,"px")})},e.prototype.getClientHeight=function(){return this.element.clientHeight},e.prototype.getHeight=function(){return this.element.getBoundingClientRect().height},e.prototype.setSize=function(e,t){this.setHeight(t),this.setWidth(e)},e.prototype.setScrollLeft=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollLeft=e,t.element===document.body&&(document.documentElement.scrollLeft=e)})},e.prototype.getScrollLeft=function(){return Math.round(this.element.scrollLeft)||0},e.prototype.setScrollTop=function(e){var t=this;requestAnimationFrame(function(){t.element.scrollTop=e,t.element===document.body&&(document.documentElement.scrollTop=e)})},e.prototype.getScrollTop=function(){return Math.round(this.element.scrollTop)||0},e.prototype.setScrollLocation=function(e){this.setScrollLeft(e.x),this.setScrollTop(e.y)},Object.defineProperty(e.prototype,"x",{get:function(){return this.element.getBoundingClientRect().x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.element.getBoundingClientRect().y},enumerable:!1,configurable:!0}),e}(),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.e2)(t,e),t.prototype.setScrollLeft=function(t){this.scrollLeft=t,e.prototype.setScrollLeft.call(this,this.scrollLeft)},t.prototype.getScrollLeft=function(){return void 0===this.scrollLeft&&(this.scrollLeft=e.prototype.getScrollLeft.call(this)),this.scrollLeft},t.prototype.setScrollTop=function(t){this.scrollTop=t,e.prototype.setScrollTop.call(this,this.scrollTop)},t.prototype.getScrollTop=function(){return void 0===this.scrollTop&&(this.scrollTop=e.prototype.getScrollTop.call(this)),this.scrollTop},t.prototype.clear=function(){this.scrollTop=void 0,this.scrollLeft=void 0},t.prototype.reset=function(){this.setScrollTop(0),this.setScrollLeft(0),this.clear()},t}(Me),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.e2)(t,e),t.prototype.setWidth=function(t){var n,a=(null===(n=this.element.parentElement)||void 0===n?void 0:n.clientWidth)||0;this.width=t>a?t:a,e.prototype.setWidth.call(this,this.width)},t.prototype.getWidth=function(){return void 0===this.width&&(this.width=e.prototype.getWidth.call(this)),this.width},t.prototype.setHeight=function(t){this.height=t,e.prototype.setHeight.call(this,t)},t.prototype.getHeight=function(){return void 0===this.height&&(this.height=e.prototype.getHeight.call(this)),this.height},t.prototype.clear=function(){this.width=void 0,this.height=void 0},t.prototype.reset=function(){this.setHeight(0),this.setWidth(0),this.clear()},t}(Me),Ue=function(e,t,n){return 1-(Math.max(0,t-n.y)+Math.max(0,n.y+n.height-t-e))/n.height},Fe=function(){function e(e,t){var n=this;this.isPageVisible=function(e){var t=n.getYPosOfPage(e),a=n.rootRect.getScrollTop();return t+n.metadata.pageSizes[e].height>a&&t<a+n.rootRect.getClientHeight()},this.getScaledOriginalPageRects=function(e){var t,i;void 0===e&&(e=n.metadata.scale);var r=[],o=n.metadata.originalPageSizes,s=W.i*e,c=n.metadata.originalLayoutSize.width*e,d=W.h*e;try{for(var l=(0,a.BW)(o),f=l.next();!f.done;f=l.next()){var p=f.value,m=p.width*e,_=p.height*e;r.push(new u.b((c-m)/2,d,m,_)),d+=_+s}}catch(e){t={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}return r},this.getScaledOriginalPageRectByIndex=function(e,t){void 0===t&&(t=n.metadata.scale);var a=n.metadata.pageSizes,i=t/n.metadata.scale,r=W.i*t,o=a.slice(0,e).reduce(function(e,t){return e+t.height*i+r},W.h*t),s=a[e],c=s.width*i,d=s.height*i,l=(n.metadata.layoutSize.width-s.width)/2*i;return new u.b(l,o,c,d)},this.metadata=e,this.rootRect=t,this._currentIndex=this.getCurrentPage()}return e.prototype.getVisiblePageRects=function(){return this.getVisiblePages().map(function(e){return e.rect})},e.prototype.getAccessiblePages=function(e,t){var n;void 0===t&&(t=1);var i=this.getVisiblePages().filter(function(t){return e.includes(t.index)});if(0===i.length||0===t)return i;t=Math.abs(t);for(var r=[],o=this.metadata.pageSizes,s=this.metadata.pageCount,c=i[0].index,d=i[0].rect.y,l=c-1;l>=c-t&&!(l<0);l--){var f=o[l],p=f.width,m=f.height;d=d-this.pageGap-m,r.push({index:l,rect:new u.b(0,d,p,m)})}(n=r.reverse()).push.apply(n,(0,a.lt)([],(0,a.pM)(i),!1));var _=i[i.length-1].index;d=i[i.length-1].rect.y;for(var h=_;h<_+t&&!(h>=s-1);h++){d=d+o[h].height+this.pageGap;var b=o[h+1];p=b.width,m=b.height,r.push({index:h+1,rect:new u.b(0,d,p,m)})}return r},e.prototype.isPointInVisiblePages=function(e){var t,n,i=e.x,r=e.y,o=this.getVisiblePages(),s=-1;try{for(var c=(0,a.BW)(o),d=c.next();!d.done;d=c.next()){var l=d.value,u=l.index,f=l.rect;if(r>=f.y&&r<=f.bottom&&i>=f.x&&i<=f.right){s=u;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return!(s<0)},e.prototype.getPageIndexFromPointInOriginalLayout=function(e){var t,n,i=e.x,r=e.y,o=-1,s=this.metadata.originalLayoutSize.width,c=W.h;try{for(var d=(0,a.BW)(this.metadata.originalPageSizes),l=d.next();!l.done;l=d.next()){var f=l.value,p=f.width,m=f.height;o++;var _=new u.b((s-p)/2,c,p,m);if(r>=_.y&&r<=_.bottom&&i>=_.x&&i<=_.right)return o;c+=m+W.i}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return o},e.prototype.getCurrentPage=function(){var e=this.getVisiblePages();if(0===e.length)return 0;if(1===e.length)return e[0].index;var t=this.rootRect.getClientHeight(),n=this.rootRect.getScrollTop();return Ue(t,n,e[0].rect)>=Ue(t,n,e[1].rect)?e[0].index:e[1].index},e.prototype.getYPosOfPage=function(e){var t=this.metadata.pageCount;if(e<0||e>=t)return-1;for(var n=this.metadata.pageSizes,a=this.pageGap,i=W.h*this.metadata.scale,r=0;r<e;r++)i+=n[r].height+a;return i},e.prototype.getOriginalPageRects=function(){var e,t,n=W.h,i=[],r=this.metadata.originalLayoutSize.width;try{for(var o=(0,a.BW)(this.metadata.originalPageSizes),s=o.next();!s.done;s=o.next()){var c=s.value;i.push(new u.b((r-c.width)/2,n,c.width,c.height)),n+=c.height+W.i}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return i},e.prototype.getVisiblePages=function(){for(var e=[],t=this.metadata.pageSizes,n=this.metadata.layoutSize.width,a=this.rootRect.getScrollTop(),i=a+this.rootRect.getClientHeight(),r=W.h*this.metadata.scale,o=0;o<t.length;o++){var s=t[o],c=s.width,d=s.height;if(r<a&&r+d>a||r>=a&&r<i)e.push({index:o,rect:new u.b((n-c)/2,r,c,d)});else if(r>=i)break;r+=d+this.pageGap}return e},Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(e){this._currentIndex=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageGap",{get:function(){return W.i*this.metadata.scale},enumerable:!1,configurable:!0}),e}(),He=function(){function e(){var e=this;this.convertPointFromClientToOriginalDocument=function(t){var n,a=e.convertPointFromClientToDocument(t);return a.scale(1/((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1)),a},this.convertPointFromOriginalDocumentToClient=function(t){var n,a=new u.a(t.x,t.y);return e.convertPointFromClientToDocument(a.scale((null===(n=e._metadata)||void 0===n?void 0:n.scale)||1),!0)},this.getDistToViewportCenter=function(t){if(e.pageManager&&e._metadata){var n=e.pageManager.getYPosOfPage(t)+e._metadata.pageSizes[t].height/2,a=e.rootRect.getScrollTop()+e.rootRect.getClientHeight()/2;return Math.abs(a-n)}},this._rootRect=new Pe,this._contentRect=new Te}return e.prototype.initialize=function(e,t,n){this._rootRect.initialize(e),this._contentRect.initialize(t),this._onScrollPositionUpdated=n},Object.defineProperty(e.prototype,"metadata",{set:function(e){this._metadata=e,this._pageManager=e?new Fe(e,this._rootRect):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollPosition",{set:function(e){var t;this.rootRect.setScrollLocation(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e.x,e.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollLeft",{set:function(e){var t;this.rootRect.setScrollLeft(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,e,this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scrollTop",{set:function(e){var t;this.rootRect.setScrollTop(e),null===(t=this._onScrollPositionUpdated)||void 0===t||t.call(this,this.rootRect.getScrollLeft(),e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentSize",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootRect",{get:function(){return this._rootRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageManager",{get:function(){return this._pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScrollPosition",{get:function(){return new u.a(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){var e;return(null===(e=this._metadata)||void 0===e?void 0:e.rotation)||0},enumerable:!1,configurable:!0}),e.prototype.resetContentSize=function(){this.contentRect.setSize(this.documentSize.width,this.documentSize.height)},e.prototype.scrollRootByPage=function(e,t,n){var a,i;void 0===t&&(t=new u.a(0,0)),void 0===n&&(n=!1);var r=(null===(a=this._metadata)||void 0===a?void 0:a.pageCount)||0;if(e<0||e>=r)return!1;var o=null===(i=this.pageManager)||void 0===i?void 0:i.getYPosOfPage(e);if(void 0===o)return!1;var s=new u.a(t.x,o+t.y),c=this.rootRect;return(!n||s.y<c.getScrollTop()||s.y>c.getScrollTop()+c.getClientHeight())&&(this.scrollTop=s.y),0!==c.getScrollLeft()&&0!==s.x&&(s.x<c.getScrollLeft()||s.x>c.getScrollLeft()+c.getClientWidth())&&(this.scrollLeft=s.x),!0},e.prototype.convertPointFromClientToDocument=function(e,t){void 0===t&&(t=!1);var n=t?1:-1,a=new u.a(n*+this.rootRect.x,n*+this.rootRect.y);return this.convertPointFromViewportToDocument(e.plus(a),t)},e.prototype.isDocumentWiderThanViewport=function(){return this.documentSize.width>this.rootRect.getClientWidth()},e.prototype.isDocumentHigherThanViewport=function(){return this.documentSize.height>this.rootRect.getClientHeight()},Object.defineProperty(e.prototype,"viewportRectRelativeToContent",{get:function(){return new u.b(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop(),this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportRectRelativeToDocument",{get:function(){var e=this.convertPointFromViewportToDocument(new u.a(0,0));return new u.b(e.x,e.y,this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentRectRelativeToContent",{get:function(){return new u.b(this.visibleDocumentLeftToContent,this.rootRect.getScrollTop(),this.visibleDocumentWidth,this.visibleDocumentHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentWidth",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getClientWidth():this.documentSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentHeight",{get:function(){return this.rootRect.getClientHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToContent",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getScrollLeft():(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleDocumentLeftToViewport",{get:function(){return this.isDocumentWiderThanViewport()?0:(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToViewport",{get:function(){return(this.contentRect.getWidth()-this.documentSize.width)/2-this.rootRect.getScrollLeft()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"documentLeftToContent",{get:function(){return this.documentSize.width>this.contentRect.getWidth()?0:(this.contentRect.getWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),e.prototype.convertPointFromViewportToDocument=function(e,t){void 0===t&&(t=!1);var n=t?-1:1,a=new u.a(n*this.rootRect.getScrollLeft(),n*this.rootRect.getScrollTop()).plus(this.contentOffsetFromDocument.scale(n));return e.plus(a)},Object.defineProperty(e.prototype,"contentOffsetFromDocument",{get:function(){return new u.a(this.isDocumentWiderThanViewport()?0:(this.documentSize.width-this.rootRect.getClientWidth())/2,0)},enumerable:!1,configurable:!0}),e}(),Re=n(127),Ne=n(407),Be=n(375),je=n(177),Ve=G.createContext(void 0),ze=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return G.createElement(Ve.Provider,{value:n},t)},Ge=function(){return G.useContext(Ve)},Ke=n(364),We=n(175),qe="DisplayHelper",Qe=function(e){return e instanceof DOMException&&"QuotaExceededError"===e.name},Ye=function(){try{var e=window.localStorage.getItem(W.e);return e?JSON.parse(e):[]}catch(e){return S.a.error(qe,e),[]}},Je=function(e){window.localStorage.setItem(W.e,JSON.stringify(e))},Xe=function(e){var t=this;this.storeInfoInLocalStorage=function(e){try{var n={uniqueId:t.uniqueId,pos:e.pos,scale:e.scale,rotation:e.rotation},a=Ye(),i=a.findIndex(function(e){return e.uniqueId===t.uniqueId});-1!==i&&a.splice(i,1),a.unshift(n),a.length>30&&a.pop();try{Je(a)}catch(e){!function(e,t){Qe(e)?t.length>0&&(t.pop(),function(e){var t=1,n=function(e){try{Je(e)}catch(a){if(Qe(a)&&t<3){if(e.pop(),0===e.length)return;t++,n(e)}else S.a.error(qe,a)}};n(e)}(t)):S.a.error(qe,e)}(e,Ye())}}catch(e){S.a.error(qe,e)}},this.applyInfoInLocalStorage=function(e){try{var n=Ye(),a=n.findIndex(function(e){return e.uniqueId===t.uniqueId});if(-1!==a){var i=n[a],r=i.pos,o=i.scale,s=i.rotation;void 0!==r&&void 0!==o&&void 0!==s&&(e.pageNumber=1,e.pos=r,e.scale=o,e.rotation=s)}}catch(e){S.a.error(qe,e)}},this.uniqueId=e},Ze=n(383),$e=n(75),et=n(369),tt=n(191);(0,i.ZW)([{rawString:".root_26f9d840{width:100%;height:100%}.link_26f9d840{position:absolute}.link_26f9d840 a{display:inline-block;width:100%;height:100%;vertical-align:top}.link_26f9d840 a:hover{background-color:rgba(255,255,0,.2)}"}]);var nt="_blank",at=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),left:"".concat(e.x,"px"),top:"".concat(e.y,"px")}},it=function(e){e.stopPropagation()},rt=G.memo(function(e){var t=e.pageIndex,n=e.originalPageSize,i=e.scale,r=e.rotation,o=e.getLinkInfosFn,s=e.goToPageFn,c=e.toggleGripperFn,l=(0,a.pM)(G.useState(),2),f=l[0],p=l[1],m=(0,et.b)(),_=G.useCallback(function(e){null==c||c(!1),e.stopPropagation()},[c]);G.useEffect(function(){var e=!0;return null==o||o(t,!0).then(function(n){if(e){var a=[];null==n||n.forEach(function(e,n){var i=e.type,r=e.rect,o=e.text,s=e.url,c=e.targetPageIndex,d=e.targetOffset,l=function(e,t){return"Link-".concat(e,"-").concat(t)}(t,n);a.push({id:l,rect:u.b.create(r),text:o,href:1===i&&s?s:"",displayTarget:1===i?nt:void 0,docTargetInfo:0===i?{pageIndex:void 0!==c?c:-1,offset:d&&new u.a(d.x,d.y)}:void 0})}),p(a)}}).catch(function(){S.a.warn("VirtualLinks","Fail to get link infos")}),function(){e=!1}},[t,o]);var h=G.useCallback(function(e){var t=e.pageIndex,n=e.offset;null==s||s(t,n)},[s]),b=G.useCallback(function(e,t){e.stopPropagation(),t&&"Enter"===e.key&&(e.preventDefault(),h(t))},[h]),g=G.useCallback(function(e,t){e.stopPropagation(),t&&(e.preventDefault(),h(t))},[h]),v=G.useCallback(function(e){d.a.read(e)},[]),y=G.useMemo(function(){var e=[];return null==f||f.forEach(function(t){var o=t.rect,s=t.docTargetInfo;e.push((0,a.q5)((0,a.q5)({},t),{rect:(0,ne.c)(o.origin,n,i,r,o.size),docTargetInfo:s&&{pageIndex:s.pageIndex,offset:s.offset&&(0,ne.c)(s.offset,n,i,r).origin}}))}),e},[f,n,r,i]);return G.createElement("div",{className:"root_26f9d840"},y.map(function(e){var t=e.id,n=e.rect,a=e.text,i=e.href,r=e.displayTarget,o=e.docTargetInfo;return G.createElement("div",{key:t,className:"link_26f9d840",style:at(n)},G.createElement("a",{tabIndex:m?-1:0,href:i,target:r,rel:r===nt?"noopener noreferrer":void 0,onPointerDown:_,onPointerMove:it,onKeyDown:function(e){b(e,o)},onClick:function(e){g(e,o)},onFocus:function(){v(a)}}))}))}),ot=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},st=function(e){return void 0===e||e===q.a.None},ct=function(){return!y.a.isActivated("EnableCJKInFormTextField")},dt=G.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(25)]).then(n.bind(n,699)).then(function(e){return{default:e.VirtualAnnots}})}),lt=function(e){return G.createElement(G.Suspense,{fallback:G.createElement("div",null)},G.createElement(dt,(0,a.q5)({},e)))},ut=G.lazy(function(){return n.e(24).then(n.bind(n,700)).then(function(e){return{default:e.VirtualFormOverlay}})}),ft=G.memo(G.forwardRef(function(e,t){var n=e.scale,i=e.rotation,r=e.mode,o=e.getPageTextFn,s=e.getLinkInfosFn,c=e.getAccDataInPage,l=e.goToPageFn,u=e.toggleGripperFn,f=(0,Ke.d)(),p=(0,et.b)(),m=G.useMemo(function(){return i%2==0},[i]),_=(0,a.pM)(G.useState(),2),h=_[0],b=_[1],g=(0,je.c)().enableFreeText,v=(0,We.b)(),y=v.eventBus,S=v.pageManager,D=(0,Be.b)(),I=D.enableFormFilling,x=D.formHandler,C=G.useRef([]),O=G.useRef([]),w=G.useRef([]),E=G.useCallback(function(e){return function(t){C.current[e]=t}},[]),A=G.useCallback(function(e){return function(t){O.current[e]=t}},[]),L=G.useCallback(function(e){return function(t){w.current[e]=t}},[]);G.useEffect(function(){var e=function(e){var t=null==S?void 0:S.getAccessiblePages(e);b(t)};return y.on(q.e.VisiblePagesLoaded,e),function(){y.off(q.e.VisiblePagesLoaded,e)}},[y,S]);var k=G.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,null==o?void 0:o(e)];case 1:return t=a.sent(),d.a.read(t||""),ct()?[4,null===(n=w.current[e])||void 0===n?void 0:n.setHasFormOnPage()]:[3,3];case 2:return a.sent(),[3,5];case 3:return[4,null==x?void 0:x.onFocusFormOverlay(e)];case 4:a.sent(),a.label=5;case 5:return[2]}})})},[x,o]),M=G.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return ct()?[3,2]:[4,null==x?void 0:x.killFormFocus()];case 1:e.sent(),e.label=2;case 2:return[2]}})})},[x]);return G.useImperativeHandle(t,function(){return{focusOnVirtualForwardForm:function(e){ct()?w.current[e].focusOnVirtualForwardForm():O.current[e].focus()},focusOnVirtualBackwardForm:function(e){var t;null===(t=C.current)||void 0===t||t[e].focus()}}}),G.createElement("div",null,null==h?void 0:h.map(function(e){var t=e.index,a=e.rect;return G.createElement("div",{key:t,ref:E(t),className:tt.c,style:ot(a),tabIndex:p?-1:0,"aria-label":f.get("currentPageNumberAria",[t+1])},G.createElement("div",{className:tt.b,tabIndex:p?-1:0,role:"paragraph",onFocus:function(){k(t)},onBlur:M}),I&&!ct()&&G.createElement("div",{ref:A(t),className:"vform",tabIndex:p?-1:0}),I&&ct()&&G.createElement(G.Suspense,{fallback:G.createElement("div",null)},G.createElement(ut,{ref:L(t),index:t,scale:n,pageRect:a,rotation:i})),st(r)&&G.createElement(rt,{pageIndex:t,originalPageSize:{width:(m?a.width:a.height)/n,height:(m?a.height:a.width)/n},scale:n,rotation:i,getLinkInfosFn:s,goToPageFn:l,toggleGripperFn:u}),g&&function(e){return st(e)||e===q.a.FreeText}(r)&&G.createElement(lt,{pageIndex:t,originalPageWidth:(m?a.width:a.height)/n,originalPageHeight:(m?a.height:a.width)/n,scale:n,rotation:i,mode:r,getAccDataInPage:c}))}))})),pt=n(376),mt=n(392),_t=n(192),ht=n(36),bt=n(282),gt=K().memo(K().forwardRef(function(e,t){var n=e.isGripperVisible,i=e.scale,r=Ge().copyToClipboard,o=(0,$e.a)(),s=(0,a.pM)(K().useState(new u.a(0,0)),2),c=s[0],d=s[1],l=K().useRef(null),f=(0,Ke.d)();K().useImperativeHandle(t,function(){return{updateContextualMenu:function(e){d(new u.a(e.x,e.y-50*i-36))}}});var p=K().useCallback(function(e){null==e||e.stopPropagation(),null==r||r()},[r]),m=K().useCallback(function(e){e.stopPropagation()},[]),_=K().useCallback(function(e){e.stopPropagation()},[]),h=K().useMemo(function(){return[{key:"Copy",text:f.get("Copy"),iconProps:{iconName:"Copy",style:{color:o.palette.neutralPrimary}},itemProps:{styles:{root:{overflow:"hidden"},menuItemText:{color:o.palette.black}}},onClick:p,onPointerDown:m,onPointerUp:m,onTouchStart:_,onTouchEnd:_}]},[f,o.palette.neutralPrimary,o.palette.black,p,m,_]),b=K().useMemo(function(){return{isBeakVisible:!1,directionalHint:ht.a.topLeftEdge,gapSpace:20,items:h,styles:{root:{backgroundColor:o.semanticColors.menuBackground}}}},[h,o.semanticColors.menuBackground]);return n?K().createElement("div",{id:"contextMenuParent",ref:l,style:{position:"absolute",left:"".concat(c.x,"px"),top:"".concat(c.y,"px")}},K().createElement(bt.a,(0,a.q5)({id:"ContextualMenu"},b,{target:l.current,useTargetWidth:!0,hidden:!n}))):null}));gt.displayName="ContextMenu";var vt=G.memo(function(e){var t=e.isLeft,n=e.rotation,i=e.gripperLeft,r=e.gripperTop,o=Ge().onGripperTouchStart,s=G.useMemo(function(){var e="0%",a="0%";switch(n%4){case q.f.Degree0:e=t?"-45%":"-40%";break;case q.f.Degree90:e="-40%",a="100%";break;case q.f.Degree180:e=t?"45%":"50%",a="105%";break;case q.f.Degree270:e="40%"}return"rotate(".concat(n%4*90,"deg) translateX(").concat(e,") translateY(").concat(a,")")},[t,n]),c=G.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return e.stopPropagation(),1===e.touches.length&&o?[4,o(t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},[o,t]);return G.createElement("div",null,G.createElement("svg",{width:25,height:25,viewBox:"-1.5 0 15 15",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"#000000",style:{position:"absolute",left:"".concat(i,"px"),top:"".concat(r,"px"),backgroundColor:"transparent",transform:"".concat(s)},onTouchStart:c},G.createElement("g",{strokeWidth:0}),G.createElement("g",{strokeLinecap:"round",strokeLinejoin:"round"}),G.createElement("g",null,G.createElement("g",{stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},G.createElement("g",{transform:"translate(".concat(-224,", ").concat(-7882,")"),fill:"#5f7eef"},G.createElement("g",{transform:"translate(".concat(56,", ").concat(160,")")},G.createElement("path",{d:"M180,7731 C180,7734.314 177.314,7737 174,7737 C170.686,7737 168,7734.314 168,7731 C168,7727.686 172.5,7722 174,7722 C175.5,7722 180,7727.686 180,7731"})))))))});vt.displayName="Gripper";var yt=G.memo(G.forwardRef(function(e,t){var n=e.rotation,i=e.isGripperVisible,r=(0,a.pM)(G.useState(new u.a(0,0)),2),o=r[0],s=r[1],c=(0,a.pM)(G.useState(new u.a(0,0)),2),d=c[0],l=c[1],f=G.useCallback(function(e){var t=e.left,n=e.right;s(t),l(n)},[]);return G.useImperativeHandle(t,function(){return{updateGripperPosition:function(e){f(e)}}}),G.createElement("div",null,i&&G.createElement("div",null,G.createElement(vt,{isLeft:!0,gripperLeft:o.x,gripperTop:o.y,rotation:n}),G.createElement(vt,{isLeft:!1,gripperLeft:d.x,gripperTop:d.y,rotation:n})))})),St=n(176);(0,i.ZW)([{rawString:".root_d3fbf39d{width:100%}.page_d3fbf39d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);-webkit-box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13);box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13)}.page_d3fbf39d .childWrapper_d3fbf39d{width:100%;height:100%}"}]);var Dt="PreRenderImgs",It=function(e){var t=e.renderPreRenderList,n=function(e){var t=e.visiblePages,n=e.pageCount,i=e.rotation,r=e.renderTargetPageRectByIndex,o=e.getPageSize,s=e.getPredictedMemUsage,c=e.getDistToViewportCenter,d=e.isPageVisible,l=(0,a.pM)(G.useState({}),2),f=l[0],p=l[1],m=G.useRef({}),h=(0,St.e)(t),b=function(){var e=(0,a.pM)(G.useState(!1),2),t=e[0],n=e[1],i=(0,We.b)().eventBus;return G.useEffect(function(){var e=function(){n(!0)};return i.on(q.e.InitialDisplayInfoApplied,e),function(){i.off(q.e.InitialDisplayInfoApplied,e)}},[i]),t}(),g=(0,St.e)(b),v=G.useRef([]),y=G.useRef(0),D=G.useRef(Ce.getInstance()),I=(0,St.a)(function(e){var t,n=m.current[e];n&&(null===(t=n.dispose)||void 0===t||t.call(n),delete m.current[e])}),x=(0,St.a)(function(e){var t,n;try{for(var i=(0,a.BW)(e),r=i.next();!r.done;r=i.next()){var o=r.value;I(o)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}p(function(t){var n,i,r={};try{for(var o=(0,a.BW)(Object.entries(t)),s=o.next();!s.done;s=o.next()){var c=(0,a.pM)(s.value,2),d=c[0],l=c[1];e.includes(d)||(r[d]=l)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return S.a.verbose(Dt,"removeInvalidatedPagesFromCache, pages=".concat(JSON.stringify(e)," | setCachedImgMap to ").concat(JSON.stringify(Object.keys(r)))),r})}),C=function(e){var t=(0,a.pM)(G.useState(!1),2),n=t[0],i=t[1],r=(0,We.b)(),o=r.eventBus,s=r.pageManager,c=G.useRef(!1),d=G.useRef([]);return G.useEffect(function(){var e=function(){c.current=!0},t=function(e){var t=e.left,n=e.top;if(c.current&&s){c.current=!1;var a=s.getPageIndexFromPointInOriginalLayout(new u.a(t,n)),i="".concat(a);d.current.includes(i)||d.current.push(i)}};return o.on(q.e.DocumentDirty,e),o.on(q.e.InvalidateRect,t),function(){o.off(q.e.DocumentDirty,e),o.off(q.e.InvalidateRect,t)}},[o,s]),G.useEffect(function(){var t=function(){0!==d.current.length&&(e(d.current),i(!0),d.current=[])};return o.on(q.e.Scrolling,t),function(){o.off(q.e.Scrolling,t)}},[o,e]),{isInvalidateRendering:n,setIsInvalidateRendering:i}}(x),O=C.isInvalidateRendering,w=C.setIsInvalidateRendering,E=(0,St.a)(function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n,r;return(0,a.SO)(this,function(o){return t?(n=document.createElement("canvas"),r=n.getContext("2d"),n.width=t.width,n.height=t.height,null==r||r.putImageData(t,0,0),S.a.verbose(Dt,"completed for ".concat(e)),[2,new Promise(function(t,r){try{n.toBlob(function(n){if(n){var o=URL.createObjectURL(n),s="".concat(e);m.current[s]={usedMemory:n.size,rotation:i,dispose:function(){URL.revokeObjectURL(o)}},p(function(e){var t,n,i,r,c,d={};try{for(var l=(0,a.BW)(Object.entries(e)),u=l.next();!u.done;u=l.next()){var f=(0,a.pM)(u.value,2),p=f[0],_=f[1];d[p]=_}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return d[s]=(i=o,r={width:"100%",height:"100%"},!(c=function(){return void 0!==m.current[s]})||c()?G.createElement("img",{src:i,style:r}):G.createElement(G.Fragment,null)),d}),t()}else r(new _.c(_.b.PreRenderError,"canvas.toBlob returns null"))})}catch(e){r(new _.c(_.b.PreRenderError,"Fail in canvas.toBlob: ".concat(e)))}})]):[2]})})}),A=G.useCallback(function(){return Object.keys(m.current).map(function(e){return parseInt(e)})},[]),L=G.useCallback(function(){var e,t=-1;return A().forEach(function(n){var a=null==c?void 0:c(n);void 0!==a&&(void 0===e||a>e)&&(e=a,t=n)}),{maxDTV:e,indexWithMaxDTV:"".concat(t)}},[A,c]),k=G.useCallback(function(){var e=y.current=y.current+1,i=(0,a.pM)([Math.max.apply(Math,(0,a.lt)([],(0,a.pM)(t),!1))+e,Math.min.apply(Math,(0,a.lt)([],(0,a.pM)(t),!1))-e],2),r=i[0],o=i[1];r<n&&v.current.push(r),o>=0&&v.current.push(o)},[n,t]),M=(0,St.a)(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n,i,o,l,u;return(0,a.SO)(this,function(f){return t=Object.values(m.current).map(function(e){return e.usedMemory}).reduce(function(e,t){return e+t},0),n=s(e)||0,S.a.verbose(Dt,"tryRenderTargetPage ".concat(e,", usedMemMap=").concat(JSON.stringify(m.current),", predictedIncomingMemUsage=").concat(n)),t+n<10485760?(v.current.shift(),[2,new Promise(function(t,n){D.current.setPreRenderTask({target:r,args:[e],isPageVisible:function(){return(null==d?void 0:d(e))||!1},onsuccess:function(n){E(e,n).catch(function(e){S.a.error(Dt,e)}).finally(function(){t(!0)})},onerror:n,oncancel:function(){S.a.verbose(Dt,"cancel pre-render for ".concat(e)),t(!1)}})})]):(i=null==c?void 0:c(e),o=L(),l=o.maxDTV,u=o.indexWithMaxDTV,void 0!==i&&void 0!==l&&i<l?(I(u),p(function(e){var t,n,i={};try{for(var r=(0,a.BW)(Object.entries(e)),o=r.next();!o.done;o=r.next()){var s=(0,a.pM)(o.value,2),c=s[0],d=s[1];c!==u&&(i[c]=d)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return S.a.verbose(Dt,"setCachedImgMap - ".concat(JSON.stringify(Object.keys(i)))),i}),[2,M(e)]):(v.current=[],y.current=0,[2,!1]))})})}),P=(0,St.a)(function(){if(0===v.current.length&&(k(),0===v.current.length))return Promise.resolve(!1);var e=v.current[0];return A().includes(e)?(S.a.verbose(Dt,"doRender return, page ".concat(e," hits the cache")),v.current.shift(),Promise.resolve(!0)):M(e)}),T=(0,St.a)(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(t){return e||S.a.verbose(Dt,"renderInLoop"),[2,P().then(function(e){return e?T(!0):void S.a.verbose(Dt,"The render loop is ended")},function(e){S.a.error(Dt,new _.c(_.b.PreRenderError,e))})]})})});G.useEffect(function(){(O||!g&&b||0!==t.length&&JSON.stringify(t)!==JSON.stringify(h))&&b&&(v.current=t.slice(),y.current=0,D.current.cancelPreRenderTask(),S.a.verbose(Dt,"isInvalidateRendering=".concat(O,", visiblePages=").concat(JSON.stringify(t),", waitingList=").concat(JSON.stringify(v.current))),T(),w(!1))},[t,h,T,O,w,b,g]),G.useEffect(function(){var e=D.current;return function(){e.cancelPreRenderTask()}},[]);var U=(0,St.a)(function(e,t){var n,i,r={};try{for(var o=(0,a.BW)(Object.entries(f)),s=o.next();!s.done;s=o.next()){var c=(0,a.pM)(s.value,2),d=c[0],l=c[1],u=m.current[d];if(u){var _=e-u.rotation,h=_%2==0,b=t(parseInt(d)),g=b.width,v=b.height,y=(0,a.pM)(h?["100%","100%",0]:["".concat(v,"px"),"".concat(g,"px"),(v-g)/2],3),S=y[0],D=y[1],I=y[2],x={width:S,height:D,transform:"translate(".concat(-I,"px, ").concat(I,"px) rotate(").concat(_*W.w,"deg)")};r[d]=G.cloneElement(l,{style:x})}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}p(r)});return G.useEffect(function(){U(i,o)},[o,U,i]),f}((0,a.dc)(e,["renderPreRenderList"]));return G.createElement(G.Fragment,null,t(function(e){return n[e]}))},xt=function(e){return{width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),top:"".concat(e.y,"px")}},Ct=G.memo(function(e){var t=e.pageInfos,n=e.metadata,i=e.curPageIndex,r=e.getScaledOriginalPageRectByIndex,o=e.getDistToViewportCenter,s=e.isPageVisible,c=(0,We.b)(),d=c.viewHandler,l=c.dpr,u=c.eventBus,f=c.onFirstRenderVisibleFn,p=c.enablePreRender,m=G.useMemo(function(){var e=null==t?void 0:t.map(function(e){return e.index});return o&&e?e.sort(function(e,t){return(o(e)||0)-(o(t)||0)}):e||[]},[o,t]),_=G.useMemo(function(){var e;if(p){var r=null===(e=null==t?void 0:t.find(function(e){return e.index===i}))||void 0===e?void 0:e.rect;if(r&&void 0!==i){var o=n.pageSizes[i],s=o.width,c=o.height,d=(0,a.pM)([s/n.scale,c/n.scale],2),u=d[0],f=d[1],m=Math.min(l,3),_=Math.min(r.height/2,900)/f*m;return Math.round(_*u)/u}}},[i,l,p,n.pageSizes,n.scale,t]),h=G.useCallback(function(e){if(void 0!==_){var t=n.originalPageSizes[e],a=t.width,i=t.height;return a*_*i*_*.5}},[n.originalPageSizes,_]),b=(0,St.a)(function(e){var t=null==r?void 0:r(e,_),a=n.layoutSize,i=a.width,o=a.height;return d&&t&&void 0!==_?d.render(t,{width:i/n.scale*_,height:o/n.scale*_}):Promise.resolve(void 0)}),g=G.useRef(!0),v=(0,St.a)(function(e,t){var n=null==t?void 0:t(e);return!y.a.isActivated("FRTWithPrerender")&&n&&g.current&&(null==f||f(),g.current=!1),n}),S=(0,St.d)(u),D=(0,St.c)(u),I=(0,St.a)(function(e){return G.createElement("div",{className:"root_d3fbf39d"},null==t?void 0:t.map(function(t){var n=t.index,i=t.rect;return G.createElement("div",{key:n,className:"page_d3fbf39d",style:(0,a.q5)((0,a.q5)({},xt(i)),{backgroundColor:"#ffffff"})},G.createElement("div",{className:"childWrapper_d3fbf39d",style:{visibility:S&&!D?"hidden":"visible"}},v(n,e)))}))}),x=G.useCallback(function(e){return n.pageSizes[e]},[n.pageSizes]);return G.createElement(G.Fragment,null,p?G.createElement(It,{renderPreRenderList:I,visiblePages:m,pageCount:n.pageCount,rotation:n.rotation,renderTargetPageRectByIndex:b,getPredictedMemUsage:h,getDistToViewportCenter:o,isPageVisible:s,getPageSize:x}):I())});(0,i.ZW)([{rawString:".root_4eb6d5c3{position:absolute}.root_4eb6d5c3 canvas{position:absolute;width:100%;height:100%}.canvasFixingExtraWhitePage_4eb6d5c3{left:0px}"}]);var Ot=function(e,t){var n;if(e.width&&e.height){var a=document.createElement("canvas");return a.width=e.width,a.height=e.height,null===(n=a.getContext("2d"))||void 0===n||n.drawImage(e,(null==t?void 0:t.x)||0,(null==t?void 0:t.y)||0),a}},wt=function(e){var t=e.width,n=e.height,a=e.top,i=e.left,r=e.renderResult,o=e.blurRenderResult,s=(0,m.a)()*t,c=(0,m.a)()*n,d=(0,We.b)(),l=d.eventBus,f=d.onFirstRenderVisibleFn,p=(0,St.e)({left:i,top:a})||{left:i,top:a},_=G.useRef(null),h=G.useRef();G.useLayoutEffect(function(){if(_.current&&t*n!=0&&!o){var e=new u.a(p.left-i,p.top-a).scale((0,m.a)()),r=Ot(_.current,e),d=_.current.getContext("2d");null==d||d.clearRect(0,0,s,c),r&&(null==d||d.drawImage(r,0,0))}},[a,i,t,n,o,p.left,p.top,s,c]),G.useLayoutEffect(function(){var e=_.current;if(e){var t=e.getContext("2d");if(r){var n=r.image,a=r.origin,i=r.originRelativeToDoc;a.scale((0,m.a)()),null==t||t.clearRect(a.x,a.y,n.width,n.height),null==t||t.drawImage(function(e){var t,n=document.createElement("canvas");return n.width=e.width,n.height=e.height,null===(t=n.getContext("2d"))||void 0===t||t.putImageData(e,0,0),n}(n),a.x,a.y),"Zoom"===r.triggerType?D.a.sessionMark("End",{rect:JSON.stringify({x:a.x*(0,m.a)(),y:a.y*(0,m.a)(),width:n.width,height:n.height})}):"Scroll"===r.triggerType&&i&&D.a.sessionMark("End",{rect:JSON.stringify({x:i.x,y:i.y,width:n.width,height:n.height})}),r.firstRender&&(null==f||f()),h.current=Ot(e,new u.a(0,0))}else null==t||t.clearRect(0,0,s,c)}},[c,s,r,f]);var b=(0,St.c)(l);G.useLayoutEffect(function(){if(!b&&_.current&&h.current&&o){var e=_.current.getContext("2d");null==e||e.clearRect(0,0,s,c);var t=o.prevOrigin;t.scale((0,m.a)()).round();var n=h.current.width*(o.ratio||1);null==e||e.drawImage(h.current,0,0,h.current.width,h.current.height,t.x,t.y,n,n*h.current.height/h.current.width),D.a.sessionMark("RenderBlur")}},[o,b,c,s]);var g={width:"".concat(t,"px"),height:"".concat(n,"px"),left:"".concat(i,"px"),top:"".concat(a,"px")};return G.createElement("div",{style:g,className:"root_4eb6d5c3"},G.createElement("canvas",{width:s,height:c,ref:_,style:{visibility:b?"hidden":"visible"},className:"canvasFixingExtraWhitePage_4eb6d5c3"}))},Et=G.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(25)]).then(n.bind(n,698)).then(function(e){return{default:e.AnnotationOverlays}})}),At=G.forwardRef(function(e,t){var n=e.enableAnnotation,i=e.ariaHidden,r=e.visibleDocumentRect,o=e.viewportRenderResult,s=e.viewportBlurRenderResult,c=e.curPageIndex,d=e.visiblePageInfos,l=e.metadata,u=e.annotHandler,f=e.annotParams,p=e.viewHandler,m=e.contentRef,_=e.getScaledOriginalPageRectByIndex,h=e.getDistToViewportCenter,b=e.isPageVisible,g=e.onEditStateChanged,v=e.getPageTextFn,S=e.getLinkInfosFn,D=e.getAccDataInPageFn,I=e.goToPageFn,x=e.toggleGripperFn,C=e.renderRectFn,O=e.renderViewportFn,w=e.syncModeFn,E=(f||{}).mode,A=(0,mt.b)(),L=A.editState,k=A.dispatchEditAction,M=(0,We.b)().eventBus,P=(0,$e.a)(),T=(0,a.pM)(G.useState(!1),2),U=T[0],F=T[1],H=G.useRef(null),R=G.useRef(null),N=G.useRef(null),B=Ge(),j=B.enableGripperContextualMenu,V=B.deSelectText,z=G.useRef(),K=G.useCallback(function(){k({type:_t.a.Reset})},[k]);G.useEffect(function(){z.current=g},[g]),G.useEffect(function(){var e;null===(e=z.current)||void 0===e||e.call(z,L)},[L]),G.useEffect(function(){K()},[K]),G.useEffect(function(){var e=function(e){k({type:_t.a.Unknown,payload:{annotType:null==e?void 0:e.annotationType}})};return M.on(q.e.DocumentDirty,e),function(){M.off(q.e.DocumentDirty,e)}},[M,k]),G.useEffect(function(){void 0!==E&&(null==u||u.setAnnotationMode(E),null==w||w(E))},[E,u,w]);var W=G.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return K(),[4,null==p?void 0:p.rotate(l.rotation)];case 1:return e.sent(),[4,null==O?void 0:O("Rotate")];case 2:return e.sent(),[2]}})})},[l.rotation,O,K,p]);return G.useImperativeHandle(t,function(){return{reloadCurrentDocument:function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,null==p?void 0:p.reloadCurrentDocument(e)];case 1:return t.sent(),[4,W()];case 2:return t.sent(),[2]}})})},discardEdits:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,null==p?void 0:p.dropAllChanges()];case 1:return e.sent(),[4,W()];case 2:return e.sent(),[2]}})})},focusOnVirtualForwardForm:function(e){var t;null===(t=H.current)||void 0===t||t.focusOnVirtualForwardForm(e)},focusOnVirtualBackwardForm:function(e){var t;null===(t=H.current)||void 0===t||t.focusOnVirtualBackwardForm(e)},updateGripperPosition:function(e){var t,n;null===(t=R.current)||void 0===t||t.updateGripperPosition(e),null===(n=N.current)||void 0===n||n.updateContextualMenu(e.left)},toggleGripper:function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return e===U?[3,3]:U?[4,null==V?void 0:V()]:[3,2];case 1:t.sent(),t.label=2;case 2:F(e),t.label=3;case 3:return[2]}})})}}},[V,U,W,p]),G.createElement("div",{className:Ze.b,ref:m,style:{backgroundColor:P.semanticColors.bodyBackground}},G.createElement(Ct,{pageInfos:d,metadata:l,curPageIndex:c,getScaledOriginalPageRectByIndex:_,getDistToViewportCenter:h,isPageVisible:b}),G.createElement(wt,{width:r.width,height:r.height,left:r.x,top:r.y,renderResult:o,blurRenderResult:s}),G.createElement(et.a,{ariaHidden:!!i},G.createElement(ft,{ref:H,scale:l.scale,rotation:l.rotation,mode:E,getPageTextFn:v,getLinkInfosFn:S,getAccDataInPage:D,goToPageFn:I,toggleGripperFn:x})),n&&G.createElement(G.Suspense,{fallback:G.createElement("div",null)},G.createElement(pt.a,{metadata:l,annotHandler:u},G.createElement(Et,(0,a.q5)({pageInfos:d,renderRectFn:C,getPageRectFn:_},f)))),!y.a.isActivated("UseGripperSelectText")&&G.createElement("div",null,G.createElement(yt,{ref:R,rotation:l.rotation,isGripperVisible:U}),j&&G.createElement(gt,{ref:N,isGripperVisible:U,scale:l.scale})))});At.displayName="PdfViewerRendererInner";var Lt=G.memo(G.forwardRef(function(e,t){return G.createElement("div",null,G.createElement(mt.a,null,G.createElement(At,(0,a.q5)({},e,{ref:t}))))}));Lt.displayName="PdfViewerRenderer";var kt={visibleDocumentRect:new u.b(0,0,0,0),viewportRenderResult:void 0,viewportBlurRenderResult:void 0,cursorType:q.b.Default,dpr:(0,m.a)(),fileReady:!1},Mt="PdfViewer",Pt=function(e){function t(t){var n=e.call(this,t)||this;return n.updateCurrentIndex=p()(function(){var e,t,a=n.pageManager;if(a){var i=a.getCurrentPage();i!==a.currentIndex&&(null===(t=(e=n.props).onCurrentPageChanged)||void 0===t||t.call(e,i),a.currentIndex=i)}n.eventBus.dispatch(q.e.Scrolling)},150),n.extract=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.getCurrentFileData()];case 1:return(t=a.sent())?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(n=a.sent())||void 0===n?void 0:n.extract(t,e)]}})})},n.merge=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,this.getManipulatorHandler()];case 1:return[2,null===(t=n.sent())||void 0===t?void 0:t.merge(e)]}})})},n.encrypt=function(e,t,i){return(0,a.yv)(n,void 0,void 0,function(){var n,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.getCurrentFileData()];case 1:return n=a.sent(),(null===(r=J.a.features)||void 0===r?void 0:r.enableEncrypt)&&n?[4,this.getManipulatorHandler()]:[2];case 2:return[2,null===(o=a.sent())||void 0===o?void 0:o.encrypt(n,e,t,i)]}})})},n.focus=function(){var e;null===(e=n.rootRef.current)||void 0===e||e.focus()},n.verifyPassword=function(e,t){return(0,a.yv)(n,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return S.a.verbose(Mt,"Verifying password"),[4,this.tryOpenDocument(e,t)];case 1:return n.sent(),[2]}})})},n.startSearch=function(e,t,i,r){return void 0===t&&(t=n.currentIndex),(0,a.yv)(n,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,null===(n=this.searchService)||void 0===n?void 0:n.startSearch(e,t,i,r)];case 1:return a.sent(),[2]}})})},n.goToNextSearchResult=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,null===(n=this.searchService)||void 0===n?void 0:n.goToNextSearchResult(e)];case 1:return a.sent(),this.props.onScrollPositionUpdated&&(t=this.currentScrollPosition,this.props.onScrollPositionUpdated(t.x,t.y)),[2]}})})},n.stopSearch=function(){return(0,a.yv)(n,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.searchService)||void 0===e?void 0:e.stopSearch()];case 1:return t.sent(),[2]}})})},n.scrollBy=function(e,t){var a;null===(a=n.rootRef.current)||void 0===a||a.scrollBy(e,t)},n.scrollTo=function(e,t,a){var i;null===(i=n.rootRef.current)||void 0===i||i.scrollTo({top:t,left:e,behavior:a})},n.goToPage=function(e,t,a){if(e<0)d.a.read(n.l10n.get("firstPagePrompt"));else if(e>=n.pageCount)d.a.read(n.l10n.get("lastPagePrompt"));else{var i=n.layoutManager.scrollRootByPage(e,t,a);e!==n.currentIndex&&i&&d.a.read(n.l10n.get("currentPageNumberAria",[e+1]))}},n.zoom=function(e){var t,a;S.a.verbose(Mt,"Received zoom evt"),D.a.sessionMark("Start"),(null===(t=n.zoomService)||void 0===t?void 0:t.isValidScale(e))&&(n.clearViewport(),null===(a=n.zoomService)||void 0===a||a.zoom(e))},n.rotate=function(e){return void 0===e&&(e=W.w),(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r=this;return(0,a.SO)(this,function(a){switch(a.label){case 0:return S.a.verbose(Mt,"Received rotate evt"),this.clearViewport(),this.rotateService||!this.viewContext?[3,2]:[4,(0,$.e)()];case 1:t=a.sent(),this.rotateService=new t(this.viewContext,this.layoutManager,this.l10n,this.renderViewport),a.label=2;case 2:return[4,null===(n=this.rotateService)||void 0===n?void 0:n.rotate(e,function(){var e,t,n;null===(e=r.zoomService)||void 0===e||e.responsiveZoom(!0),r.eventBus.dispatch(q.e.RotationChanged),null===(n=(t=r.props).onRotationChanged)||void 0===n||n.call(t)})];case 3:return a.sent(),null===(i=this.viewerRendererRef)||void 0===i||i.toggleGripper(!1),[2]}})})},n.print=function(e,t,i){return(0,a.yv)(n,void 0,void 0,function(){var n,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return S.a.verbose(Mt,"Received print evt"),this.printService?[3,2]:[4,(0,$.c)()];case 1:n=a.sent(),this.printService=new n(this.getCurrentFileData),a.label=2;case 2:return this.pageManager&&this.viewContext&&(null===(r=this.printService)||void 0===r||r.initPagesPrinter(this.viewContext,this.pageManager.getScaledOriginalPageRects)),[4,null===(o=this.printService)||void 0===o?void 0:o.print(e,t,i)];case 3:return a.sent(),[2]}})})},n.cancelPrint=function(){var e;S.a.verbose(Mt,"Received cancelPrint evt"),null===(e=n.printService)||void 0===e||e.cancel()},n.renderThumbnail=function(e,t,i){return(0,a.yv)(n,void 0,void 0,function(){var n,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return S.a.verbose(Mt,"Received renderThumbnail evt"),!this.thumbnailService&&this.viewContext&&this.pageManager?[4,(0,$.f)()]:[3,2];case 1:n=a.sent(),this.thumbnailService=new n(this.viewContext,this.pageManager.getScaledOriginalPageRectByIndex),a.label=2;case 2:return[2,null===(r=this.thumbnailService)||void 0===r?void 0:r.renderThumbnail(e,t,i)]}})})},n.clearThumbnailCache=function(){var e;S.a.verbose(Mt,"Received clear thumbnail evt"),null===(e=n.thumbnailService)||void 0===e||e.dispose()},n.getCurrentFileData=function(){return(0,a.yv)(n,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){return this.triggerInkComposing(),[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getCurrentFileData()]})})},n.getTelemetryData=function(){return(0,a.yv)(n,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){return[2,null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler.getTelemetryData()]})})},n.hasSignature=function(){return(0,a.yv)(n,void 0,void 0,function(){var e,t,n;return(0,a.SO)(this,function(a){return[2,null===(n=null===(e=this.viewContext)||void 0===e?void 0:(t=e.viewHandler).hasSignature)||void 0===n?void 0:n.call(t)]})})},n.reloadCurrentDocument=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.viewerRendererRef)||void 0===t?void 0:t.reloadCurrentDocument(e)];case 1:return n.sent(),[2]}})})},n.discardEdits=function(){return(0,a.yv)(n,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.viewerRendererRef)||void 0===e?void 0:e.discardEdits()];case 1:return t.sent(),[2]}})})},n.triggerInkComposing=function(){n.eventBus.dispatch(q.e.TriggerInkComposing)},n.getEventHandlers=function(){return{onClick:n.onClick,onKeyDown:n.onKeyDown,onPointerDown:function(e){n.onPointerDown(e)},onPointerMove:function(e){n.onPointerMove(e)},onPointerUp:function(e){n.onPointerUp(e)},onTouchStart:function(e){n.onTouchStart(e)},onTouchMove:function(e){n.onTouchMove(e)},onTouchEnd:function(e){n.onTouchEnd(e)},onWheel:n.onWheel}},n.getPageText=function(e){var t;return(null===(t=n.contentService)||void 0===t?void 0:t.getPageText(e))||Promise.resolve("")},n.getWorkerPerfMarks=function(){return n.viewWorker.getPerfMarks()},n.getCurrentPageIndex=function(){var e;return(null===(e=n.pageManager)||void 0===e?void 0:e.getCurrentPage())||0},n.addFreeText=function(){return(0,a.yv)(n,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,null===(e=this.inputEvtService)||void 0===e?void 0:e.addFreeText()];case 1:return t.sent(),[2]}})})},n.getDocPermissions=function(){var e;return(null===(e=n.viewContext)||void 0===e?void 0:e.metadata.getDocPermissions())||[]},n.storeDisplayInfo=function(){var e,t,a;if(n.displayHelper||n.freeTextService){var i={pos:n.currentScrollPosition,scale:(null===(e=n.zoomService)||void 0===e?void 0:e.getZoomOpt())||n.scale,rotation:n.rotation};null===(t=n.displayHelper)||void 0===t||t.storeInfoInLocalStorage(i),null===(a=n.freeTextService)||void 0===a||a.storeFreeTextAttribute()}},n.setViewerRendererRef=function(e){n.viewerRendererRef=e},n.onScroll=function(){n.preventScrollRender?n.preventScrollRender=!1:(n.renderViewport(),n.updateCurrentIndex())},n.onResize=function(){var e;S.a.verbose(Mt,"Received resize evt"),n.resizeViewer(),null===(e=n.viewerRendererRef)||void 0===e||e.toggleGripper(!1)},n.onWheel=function(e){var t,a;e.ctrlKey&&(e.preventDefault(),null===(t=n.renderService)||void 0===t||t.clear(),null===(a=n.zoomService)||void 0===a||a.wheelZoom(e))},n.onKeyDown=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onKeyDown(this.getNativeEvt(e),this.currentIndex)];case 1:return n.sent(),[2]}})})},n.onPointerDown=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(i=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerDown)||void 0===i||i.call(n,t),[4,null===(r=this.inputEvtService)||void 0===r?void 0:r.onPointerDown(t)];case 1:return a.sent(),[2]}})})},n.onPointerMove=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(i=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerMove)||void 0===i||i.call(n,t),[4,null===(r=this.inputEvtService)||void 0===r?void 0:r.onPointerMove(t)];case 1:return a.sent(),[2]}})})},n.onPointerUp=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(i=null===(n=this.pinchable)||void 0===n?void 0:n.onPointerUp)||void 0===i||i.call(n,t),[4,null===(r=this.inputEvtService)||void 0===r?void 0:r.onPointerUp(t)];case 1:return a.sent(),[2]}})})},n.onPointerCancel=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onPointerOut=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onPointerLeave=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){return null===(n=null===(t=this.pinchable)||void 0===t?void 0:t.onPointerUp)||void 0===n||n.call(t,this.getNativeEvt(e)),[2]})})},n.onTouchStart=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onTouchStart(t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onTouchStart(t)];case 1:return a.sent(),[2]}})})},n.onTouchMove=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return null===(t=this.pinchable)||void 0===t||t.onTouchMove(this.getNativeEvt(e)),[4,null===(n=this.inputEvtService)||void 0===n?void 0:n.onTouchMove(e)];case 1:return a.sent(),[2]}})})},n.onTouchEnd=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t=this.getNativeEvt(e),null===(n=this.pinchable)||void 0===n||n.onTouchEnd(t),[4,null===(i=this.inputEvtService)||void 0===i?void 0:i.onTouchEnd(t)];case 1:return a.sent(),[2]}})})},n.onClick=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=this.inputEvtService)||void 0===t?void 0:t.onClick(this.getNativeEvt(e))];case 1:return n.sent(),[2]}})})},n.onContextMenu=function(e){e.preventDefault()},n.onGlobalMouseMove=function(e){var t;n.isEvtInsideViewer(e)||null===(t=n.contentService)||void 0===t||t.onPointerMove(new u.a(e.clientX,e.clientY))},n.onGlobalMouseUp=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(null===(t=this.props.annotParams)||void 0===t?void 0:t.mode)!==q.a.None||this.isEvtInsideViewer(e)?[2]:[4,null===(n=this.inputEvtService)||void 0===n?void 0:n.onPointerUp(e)];case 1:return a.sent(),[2]}})})},n.onBeforePageUnload=function(){I.a.logVerbose({name:x.a.DocumentLoad,message:"Before PDF Page Unload"}),n.pageLoaded=!1,n.storeDisplayInfo()},n.onPageUnload=function(){I.a.logVerbose({name:x.a.DocumentLoad,message:"PDF Page Unload"}),n.pageLoaded=!1},n.onWorkerMessage=function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r,o,s,c,d,l,u,f,p,m,_;return(0,a.SO)(this,function(a){switch(a.label){case 0:switch(h=e.data,(t={type:he(h.type),name:be(h.name),payload:h.payload}).type){case 0:return[3,1];case 1:case 8:return[3,7];case 2:return[3,8];case 3:return[3,9];case 4:case 5:return[3,10];case 6:return[3,11];case 7:return[3,13];case 10:return[3,15];case 9:return[3,16]}return[3,18];case 1:return 3!==t.name?[3,3]:[4,null===(o=this.progressiveLoadingService)||void 0===o?void 0:o.onNotification(t)];case 2:return a.sent(),[3,19];case 3:return(n=4===t.name)&&this.eventBus.dispatch(q.e.InvalidateRect,t.payload),i=(null===(s=this.props.annotParams)||void 0===s?void 0:s.mode)||q.a.None,n&&(i===q.a.Highlight||i===q.a.Ink||(null===(c=J.a.features)||void 0===c?void 0:c.enableEnhancedInk)&&i===q.a.PointErase)?(this.eventBus.dispatch(q.e.InvalidateRectForAnnot,t.payload),[3,6]):[3,4];case 4:return[4,null===(d=this.contentService)||void 0===d?void 0:d.onNotification(t)];case 5:a.sent(),a.label=6;case 6:return[3,19];case 7:return null===(l=this.inputEvtService)||void 0===l||l.onNotification(t),[3,19];case 8:return null===(u=this.linkService)||void 0===u||u.onNotification(t),[3,19];case 9:return null===(f=this.searchService)||void 0===f||f.onNotification(t),[3,19];case 10:try{r=function(e){switch(e){case"DocumentSaved":return q.e.DocumentSaved;case"InkStrokesAdded":return q.e.InkStrokesAdded;case"InkAdded":return q.e.InkAdded;case"InkUpdated":return q.e.InkUpdated;case"SetDocumentDirty":return q.e.DocumentDirty;case"ShowEditableInk":return q.e.ShowEditableInk;case"ShowEraserableInk":return q.e.ShowErasableInk;default:throw"Unsupported notification name"}}(e.data.name),this.eventBus.dispatch(r,t.payload)}catch(e){}return[3,19];case 11:return[4,null===(p=this.freeTextService)||void 0===p?void 0:p.onNotification(t)];case 12:return a.sent(),[3,19];case 13:return[4,null===(m=this.formService)||void 0===m?void 0:m.onNotification(t)];case 14:return a.sent(),[3,19];case 15:return 23===t.name&&this.eventBus.dispatch(q.e.VisiblePagesLoaded,t.payload),[3,19];case 16:return[4,null===(_=this.progressiveLoadingService)||void 0===_?void 0:_.onNotification(t)];case 17:return a.sent(),[3,19];case 18:return[3,19];case 19:return[2]}var h})})},n.renderViewport=function(e){return void 0===e&&(e="Scroll"),(0,a.yv)(n,void 0,void 0,function(){var t,n,i,r=this;return(0,a.SO)(this,function(a){return this.layoutManager.rootRect.clear(),"Scroll"===e&&D.a.sessionMark("Start",{scrollPos:JSON.stringify({x:this.layoutManager.rootRect.getScrollLeft(),y:this.layoutManager.rootRect.getScrollTop()})}),t=this.layoutManager.viewportRectRelativeToDocument,this.setState({visibleDocumentRect:this.layoutManager.visibleDocumentRectRelativeToContent}),null===(i=(n=this.props).onRenderViewport)||void 0===i||i.call(n),[2,new Promise(function(n,a){var i,o;null===(i=r.renderService)||void 0===i||i.render({rect:t,layoutSize:r.layoutManager.documentSize,rotation:null===(o=r.viewContext)||void 0===o?void 0:o.metadata.rotation,triggerType:e,onCompleted:function(e){n(e)},onError:function(e){a(e)}})})]})})},n.updateRenderResult=function(e){var t;if(e){var a=n.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();e.origin=null===(t=e.origin)||void 0===t?void 0:t.plus(a)}n.setState({viewportRenderResult:e,viewportBlurRenderResult:void 0})},n.updateBlurRenderResult=function(e){n.setState({visibleDocumentRect:n.layoutManager.visibleDocumentRectRelativeToContent,viewportBlurRenderResult:e})},n.updateCursorType=function(e){var t,a;e!==n.state.cursorType&&(n.setState({cursorType:e}),Object.values(q.b).includes(e)&&(null===(a=(t=n.props).onCursorUpdate)||void 0===a||a.call(t,e)))},n.onFormFocus=function(e){var t,a,i;if(n.context.isFormFillingEnabled&&n.props.formAttributes){var r=null===(t=n.rootRef.current)||void 0===t?void 0:t.hasAttribute(n.props.formAttributes);e&&!r?null===(a=n.rootRef.current)||void 0===a||a.setAttribute(n.props.formAttributes,"true"):!e&&r&&(null===(i=n.rootRef.current)||void 0===i||i.removeAttribute(n.props.formAttributes))}},(0,c.a)(n),n.state=kt,n.pageLoaded=!0,n.outerRef=G.createRef(),n.outerRect=new Me,n.rootRef=G.createRef(),n.contentRef=G.createRef(),n.layoutManager=new He,n.l10n=(0,Ke.b)(),n.wasmDataProvider=Re.a.getInstance(),n.worker=new Worker(J.a.workerSrc),n.viewWorker=U(n.worker),n.viewWorker.setupEnv({wasmModuleInit:J.a.wasmModuleInit,enableLogging:!!J.a.enableLogging,activatedKillSwitches:y.a.activatedKillSwitches,globalVarNameForWorkerVer:J.a.globalVarNameForWorkerVer}),n.docLoader=new de(t.url,t.filename,t.fileSize,t.enableDownloadByRange,t.token,t.getAuthHeaders),n.docOpener=new le(t.onNeedPassword),n.eventBus=new v.a,n.preventScrollRender=!1,n}return(0,a.e2)(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.outerRect.initialize(this.outerRef.current),this.layoutManager.initialize(this.rootRef.current,this.contentRef.current,this.props.onScrollPositionUpdated),this.updateOuterHeight(),this.setLocaleStrings(),this.initViewer()},t.prototype.componentDidUpdate=function(e){var t,n=this.props,a=n.url,i=n.height,r=n.localeStrings,o=n.enableEdit;a!==e.url?(this.reset(),this.initViewer()):i!==e.height&&(this.updateOuterHeight(),this.resizeViewer()),r!==e.localeStrings&&this.setLocaleStrings(),void 0!==o&&e.enableEdit!==o&&(null===(t=this.viewContext)||void 0===t||t.viewHandler.setEditEnabled(o))},t.prototype.componentWillUnmount=function(){var e,t,n;this.mounted=!1,this.initRenderRequestId&&cancelAnimationFrame(this.initRenderRequestId),this.dispose(),this.worker.terminate(),this.wasmDataProvider.dispose(),null===(e=this.fontProvider)||void 0===e||e.dispose(),null===(n=(t=this.props).onDocumentUnloaded)||void 0===n||n.call(t)},t.prototype.render=function(){var e,t,n,i,r,o,c,d,u,f,p,m,_,h,b=(0,O.a)(this.props.theme,this.props.darkMode),g=this.pageManager,v=this.context;return G.createElement(s.a,{theme:(0,a.q5)({rtl:(0,l.a)()},b),className:Ze.a},G.createElement(Ke.a,{strings:this.strings},G.createElement(We.a,{dpr:this.state.dpr,eventBus:this.eventBus,pageManager:g,viewHandler:null===(e=this.viewContext)||void 0===e?void 0:e.viewHandler,onFirstRenderVisibleFn:this.props.onFirstRenderVisible,enablePreRender:this.state.fileReady&&this.props.enablePreRender},G.createElement(Be.a,{enableFormFilling:v.isFormFillingEnabled,formHandler:this.formHandler},G.createElement(ze,{enableGripperContextualMenu:this.props.enableGripperContextualMenu||!1,onGripperTouchStart:null===(t=this.inputEvtService)||void 0===t?void 0:t.onGripperTouchStart,copyToClipboard:null===(n=this.contentService)||void 0===n?void 0:n.copyToClipboard,deSelectText:null===(i=this.inputEvtService)||void 0===i?void 0:i.gripperDeSelectText},G.createElement(je.a,{enableFreeText:v.isFreeTextEnabled,freeTextHandler:this.freeTextHandler,freeTextContainer:this.props.freeTextContainer,showEditableFreeTextAt:null===(r=this.inputEvtService)||void 0===r?void 0:r.showEditableFreeTextAt,setInitialFontAttributes:null===(o=this.freeTextService)||void 0===o?void 0:o.setInitialFontAttributes},G.createElement("div",{className:Ze.c,ref:this.outerRef},G.createElement("div",{className:Ze.d,style:{cursor:this.state.cursorType},tabIndex:this.props.isRootFocusable&&!this.props.ariaHidden?0:-1,"aria-label":this.docLoader.filename,ref:this.rootRef,onClick:this.onClick,onContextMenu:this.onContextMenu,onKeyDown:this.onKeyDown,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onPointerCancel:this.onPointerCancel,onPointerOut:this.onPointerOut,onPointerLeave:this.onPointerLeave,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},G.createElement(Lt,{ref:this.setViewerRendererRef,enableAnnotation:v.isAnnotationEnabled,ariaHidden:this.props.ariaHidden,contentRef:this.contentRef,visibleDocumentRect:this.state.visibleDocumentRect,curPageIndex:null==g?void 0:g.getCurrentPage(),visiblePageInfos:null==g?void 0:g.getVisiblePages(),viewportRenderResult:this.state.viewportRenderResult,viewportBlurRenderResult:this.state.viewportBlurRenderResult,metadata:(null===(c=this.viewContext)||void 0===c?void 0:c.metadata)||new Y({width:0,height:0},0,[]),annotHandler:this.annotHandler,viewHandler:null===(d=this.viewContext)||void 0===d?void 0:d.viewHandler,annotParams:this.props.annotParams,getScaledOriginalPageRectByIndex:null==g?void 0:g.getScaledOriginalPageRectByIndex,getDistToViewportCenter:this.layoutManager.getDistToViewportCenter,isPageVisible:null==g?void 0:g.isPageVisible,getPageTextFn:null===(u=this.contentService)||void 0===u?void 0:u.getPageText,getLinkInfosFn:null===(f=this.linkService)||void 0===f?void 0:f.getLinkInfosInPage,getAccDataInPageFn:null===(p=this.freeTextService)||void 0===p?void 0:p.getAccDataInPage,renderRectFn:null===(m=this.contentService)||void 0===m?void 0:m.renderRect,renderViewportFn:this.renderViewport,goToPageFn:this.goToPage,toggleGripperFn:null===(_=this.viewerRendererRef)||void 0===_?void 0:_.toggleGripper,syncModeFn:null===(h=this.inputEvtService)||void 0===h?void 0:h.setMode,onEditStateChanged:this.props.onEditStateChanged})))))))))},Object.defineProperty(t.prototype,"pageCount",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentIndex",{get:function(){var e=this.pageManager;return e?e.currentIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentScrollPosition",{get:function(){return this.layoutManager.currentScrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filename",{get:function(){return this.docLoader.filename},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalLayoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.originalLayoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layoutSize",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSizes",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.pageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalPageRects",{get:function(){var e=this.pageManager;return e?e.getOriginalPageRects():[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){var e,t=null===(e=this.viewContext)||void 0===e?void 0:e.metadata.rotation;return t?t*W.w:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMip",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.mip)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMipDecrypted",{get:function(){var e;return(null===(e=this.viewContext)||void 0===e?void 0:e.metadata.isMipDecrypted)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinateConverters",{get:function(){return{convertPointFromClientToOriginalDocument:this.layoutManager.convertPointFromClientToOriginalDocument,convertPointFromOriginalDocumentToClient:this.layoutManager.convertPointFromOriginalDocumentToClient}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zoomOpt",{get:function(){var e;return null===(e=this.zoomService)||void 0===e?void 0:e.getZoomOpt()},enumerable:!1,configurable:!0}),t.prototype.setLocaleStrings=function(){return(0,a.yv)(this,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return e=this,(t=this.props.localeStrings)?[3,2]:[4,(0,Ke.c)()];case 1:t=n.sent(),n.label=2;case 2:return e.strings=t,this.l10n.strings=this.strings,[2]}})})},t.prototype.tryCreateProgressiveLoadingService=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return!this.progressiveLoadingService&&this.props.enableProgressiveLoading&&this.props.fileSize?[4,(0,$.d)()]:[3,3];case 1:return e=t.sent(),this.progressiveLoadingService=new e(this.props.url,this.props.token),[4,this.progressiveLoadingService.tryInitRangeDownload(this.props.url,this.props.fileSize,this.props.token)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},t.prototype.getFileData=function(){var e,t;return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.tryCreateProgressiveLoadingService()];case 1:return a.sent(),(null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.enabled)&&this.props.fileSize?[2,[new Uint8Array(0),this.props.fileSize]]:this.mounted?(n=null===(t=this.progressiveLoadingService)||void 0===t?void 0:t.getFileData())?(r=n,[3,6]):[3,2]:[2,[void 0,0]];case 2:return this.props.enablePreview&&this.props.fileData?(o=this.props.fileData,[3,5]):[3,3];case 3:return[4,this.docLoader.fetch()];case 4:o=a.sent(),a.label=5;case 5:r=o,a.label=6;case 6:return i=r,this.mounted&&i?(this.setState({fileReady:!0}),[2,[i,i.length]]):[2,[void 0,0]]}})})},t.prototype.initProgressiveLoadingService=function(e){var t;return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o,s,c=this;return(0,a.SO)(this,function(d){return(null===(t=this.progressiveLoadingService)||void 0===t?void 0:t.enabled)&&this.viewContext&&(n=function(){var e,t;c.setState({fileReady:!0}),c.viewContext&&(null===(t=(e=c.props).onDocumentLoaded)||void 0===t||t.call(e,c.viewContext.metadata))},i=function(t,n,i){return(0,a.yv)(c,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,e.onRangeRequestDone(t,n,i)];case 1:return a.sent(),[2]}})})},r=function(e){var t;null===(t=c.docLoadScenario)||void 0===t||t.fail(e)},o=function(){return(0,a.yv)(c,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,this.initDocument()];case 1:return n.sent(),null===(t=(e=this.props).onDocumentPreviewed)||void 0===t||t.call(e),[2]}})})},s=function(){return(0,a.yv)(c,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,e.resetStream()];case 1:return t.sent(),[4,e.closeDocument()];case 2:return t.sent(),this.dispose(),this.initViewer(!0),[2]}})})},this.progressiveLoadingService.initProgressiveLoadingService(this.viewContext,this.layoutManager,this.renderViewport,s,o,n,i,r),this.bindWorkerMessage()),[2]})})},t.prototype.initViewer=function(e){var t,n,i,r,o,s,c,d,l,u,f,p,m;return void 0===e&&(e=!1),(0,a.yv)(this,void 0,void 0,function(){var h,b,g,v,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N;return(0,a.SO)(this,function(B){switch(B.label){case 0:e||(this.docLoadScenario=I.a.createScenario({name:x.a.DocumentLoad,extraData:this.tempAuthLogFields})),B.label=1;case 1:return B.trys.push([1,18,,19]),y.a.isActivated("CheckWorkerVersion")?[3,3]:[4,this.checkWorkerVersion()];case 2:B.sent(),B.label=3;case 3:return this.bindPageEvents(),[4,this.getFileData()];case 4:return h=a.pM.apply(void 0,[B.sent(),2]),b=h[0],g=h[1],this.mounted&&b&&g?(D.a.mark("Downloaded"),this.exposeFnsToWorker(),[4,this.wasmDataProvider.getModuleInnerInit()]):(v=new _.c(_.b.PdfLoadCanceled,"PdfViewer unmounted before opening document.unmounted:".concat(!this.mounted,", filedata undefined:").concat(!b,", fileSize:").concat(g)),I.a.logError(v.toCaughtError()),null===(t=this.docLoadScenario)||void 0===t||t.stop(),[2]);case 5:return C=B.sent(),[4,this.viewWorker.initialize(C)];case 6:return B.sent(),[4,this.viewWorker.getHandlerInstance(b,g,!!this.props.enableCopyByChunk,null===(n=this.progressiveLoadingService)||void 0===n?void 0:n.getChunkRequestSize())];case 7:return O=B.sent(),S.a.verbose(Mt,"Created PdfViewHandler instance"),[4,this.viewWorker.getInputEvtHandler()];case 8:return w=B.sent(),E=this,[4,Z.getInstance(O,w)];case 9:return E.viewContext=B.sent(),this.docOpener.viewHandler=O,this.docOpener.reset(),[4,this.initProgressiveLoadingService(O)];case 10:return B.sent(),A={featureConfigInMspdfkit:{enableFormFilling:!!(null===(i=J.a.features)||void 0===i?void 0:i.enableFormFilling),enableOpenMip:!!this.props.enableOpenMip,enableProgressiveLoading:!!(null===(r=this.progressiveLoadingService)||void 0===r?void 0:r.enabled),enableICUConverterKS:!y.a.isActivated("EnableICUConverter"),enableMipSdkTelemetry:!!(null===(o=J.a.features)||void 0===o?void 0:o.enableMipSdkTelemetry)},featureConfigInPdfControl:{enableFreeText:!!(null===(s=J.a.features)||void 0===s?void 0:s.enableFreeText),enableEnhancedInk:!!(null===(c=J.a.features)||void 0===c?void 0:c.enableEnhancedInk),enableProgressiveDocumentHandler:!!(null===(d=this.progressiveLoadingService)||void 0===d?void 0:d.enabled)&&!y.a.isActivated("EnableProgressiveDocumentHandler")}},[4,O.setFeatureConfig(A)];case 11:return B.sent(),O.setEditEnabled(!!this.props.enableEdit),L=this,[4,this.viewWorker.getAnnotationHandlerInstance()];case 12:return L.annotHandler=B.sent(),(null===(l=J.a.features)||void 0===l?void 0:l.enableFreeText)?(k=this,[4,this.viewWorker.getFreeTextHandler()]):[3,14];case 13:k.freeTextHandler=B.sent(),B.label=14;case 14:return(null===(u=J.a.features)||void 0===u?void 0:u.enableFormFilling)?(M=this,[4,this.viewWorker.getFormHandler()]):[3,16];case 15:M.formHandler=B.sent(),B.label=16;case 16:return P=this.props.enablePreview&&this.props.initialPassword?this.props.initialPassword:void 0,[4,this.tryOpenDocument(P)];case 17:return B.sent(),[3,19];case 18:return(null==(T=B.sent())?void 0:T.message)&&(U=J.a.wasmModuleInit.length>0?J.a.wasmModuleInit[0]:void 0)&&(F=U.wasmUrl,H=U.dataUrl,R=U.wasmJsUrlOrBlob,T.message+=". Additional: wasmUrl=".concat(encodeURIComponent(F).replace("https",""),", wasmJsUrl=").concat("string"==typeof R&&encodeURIComponent(R).replace("https",""),", dataUrl=").concat(encodeURIComponent(H||"").replace("https",""))),N=T instanceof _.c?T.toQosError():{isExpected:T.isExpected||T.name===_.b.InvalidPDF,error:T,code:T.name},this.pageLoaded&&this.mounted||(N.isExpected=!0),N.extraData=(0,a.q5)((0,a.q5)((0,a.q5)({},N.extraData),this.tempAuthLogFields),{unmounted:!this.mounted,unloaded:!this.pageLoaded}),null===(f=this.docLoadScenario)||void 0===f||f.fail(N),null===(m=(p=this.props).onInitError)||void 0===m||m.call(p,N),[2];case 19:return[2]}})})},t.prototype.tryOpenDocument=function(e,t){var n,i;return(0,a.yv)(this,void 0,void 0,function(){var r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:r=!1,o=void 0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.docOpener.tryOpen(e,t)];case 2:return r=a.sent(),[3,4];case 3:if(s=a.sent(),!(this.props.enableOpenMip&&s.name&&s.name.startsWith("Mip")))throw s;return r=!0,o={isExpected:g.includes(s.name),error:s.message,code:s.name},[3,4];case 4:return r?(null===(i=this.progressiveLoadingService)||void 0===i?void 0:i.enabled)?[3,6]:[4,this.initDocument(o)]:(null===(n=this.docLoadScenario)||void 0===n||n.stop(),[2]);case 5:a.sent(),a.label=6;case 6:return[2]}})})},t.prototype.initDocument=function(e){var t,n,i,o,s,c,d,l;return(0,a.yv)(this,void 0,void 0,function(){var u,f,p,m,h=this;return(0,a.SO)(this,function(b){switch(b.label){case 0:if(D.a.mark("Opened"),!this.viewContext)throw new _.c(_.b.ViewContextNotInitialized,"PdfViewer viewContext empty");return[4,this.viewContext.initMetadata()];case 1:return b.sent(),u=this.layoutManager.metadata=this.viewContext.metadata,f=(0,a.q5)({pageCount:u.pageCount,averagePageSize:0===u.pageCount?0:this.docLoader.fileSize/u.pageCount,mip:u.mip,hasOutline:u.hasOutline},this.tempAuthLogFields),e?(e.extraData=f,e.code===r.MipNoPermissions&&(null===(n=(t=this.props).onMipAuthFailed)||void 0===n||n.call(t)),null===(i=this.docLoadScenario)||void 0===i||i.fail(e),I.a.logError(e)):null===(o=this.docLoadScenario)||void 0===o||o.stop({extraData:f}),this.loadFontPromise=J.a.fontConfigs&&this.loadFonts(),this.initServices(),[4,(0,$.g)()];case 2:return p=b.sent(),this.pinchable=new p(function(){return h.scale},this.zoomService.blurZoom,function(){var e,t;null===(e=h.renderService)||void 0===e||e.clear(),null===(t=h.zoomService)||void 0===t||t.render()},this.eventBus.dispatch.bind(this.eventBus)),this.props.enableCacheDisplayInfo&&this.props.uniqueId&&!this.props.defaultPageNumber&&!this.props.defaultScale&&(this.displayHelper=new Xe(this.props.uniqueId)),this.bindEvents(),m={pageNumber:this.props.defaultPageNumber,pos:void 0,scale:this.props.defaultScale,rotation:void 0},null===(s=this.displayHelper)||void 0===s||s.applyInfoInLocalStorage(m),[4,this.initContent(m)];case 3:return b.sent(),(null===(c=this.progressiveLoadingService)||void 0===c?void 0:c.enabled)||null===(l=(d=this.props).onDocumentLoaded)||void 0===l||l.call(d,u),[2]}})})},t.prototype.loadFonts=function(){return(0,a.yv)(this,void 0,void 0,function(){var e,t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.viewWorker.getFontHandler()];case 1:return e=a.sent(),J.a.fontConfigs?y.a.isActivated("CacheFontFile")?[3,4]:[4,(0,$.a)()]:[2];case 2:return t=a.sent(),this.fontProvider=new t(e),[4,this.fontProvider.loadFonts(J.a.fontConfigs)];case 3:return a.sent(),[3,6];case 4:return n=J.a.fontConfigs.map(function(e){return e.fontUrl}),[4,e.loadFonts(n)];case 5:a.sent(),a.label=6;case 6:return[2]}})})},t.prototype.exposeFnsToWorker=function(){var e=this;P({getMIPToken:function(){return(0,a.yv)(e,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){return this.props.enableOpenMip?[2,null===(t=(e=this.props).getMIPToken)||void 0===t?void 0:t.call(e)]:[2]})})},logQosStart:function(e){I.a.handler.logQosStart(e)},logQosEnd:function(e){I.a.handler.logQosEnd(e)},logEngagement:function(e){I.a.handler.logEngagement(e)},logError:function(e){I.a.handler.logError(e)},logVerbose:function(e){var t,n;null===(n=(t=I.a.handler).logVerbose)||void 0===n||n.call(t,e)}},this.worker)},t.prototype.initServices=function(){var e,t,n,a,i,r=this;this.viewContext&&(this.renderService=new Oe(this.viewContext,this.updateRenderResult,this.props.onRenderError,function(){r.eventBus.dispatch(q.e.InitialDisplayInfoApplied)}),this.zoomService=new ke(this.viewContext,this.layoutManager,this.renderViewport,this.updateBlurRenderResult,this.eventBus.dispatch.bind(this.eventBus),function(){r.preventScrollRender=!0},function(e,t){var n,a,i;null===(n=r.viewerRendererRef)||void 0===n||n.toggleGripper(!1),null===(i=(a=r.props).onScaleChanged)||void 0===i||i.call(a,e,t),r.eventBus.dispatch(q.e.ScaleChanged)}),this.contentService=new re(this.viewContext,this.layoutManager,this.l10n,this.updateRenderResult,this.goToPage,this.scrollBy,this.props.onTextSelected,this.props.onTextDeselected,null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.refreshViewPortForProgressiveLoading),this.linkService=new Ie(this.viewContext,this.layoutManager,this.goToPage,this.eventBus.dispatch.bind(this.eventBus)),this.searchService=new we(this.viewContext),this.inputEvtService=new De(this.viewContext,this.layoutManager,this.l10n,this.contentService,function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.toggleGripper(e)},function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.updateGripperPosition(e)},this.goToPage,this.scrollBy,this.scrollTo,function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.focusOnVirtualForwardForm(e)},function(e){var t;null===(t=r.viewerRendererRef)||void 0===t||t.focusOnVirtualBackwardForm(e)},this.updateCursorType,this.onFormFocus,function(){return r.context.isFormFillingEnabled},this.rootRef.current||void 0),(null===(t=J.a.features)||void 0===t?void 0:t.enableFreeText)&&(this.freeTextService=new pe(this.viewContext,(null===(n=this.pageManager)||void 0===n?void 0:n.getOriginalPageRects())||[],this.eventBus.dispatch.bind(this.eventBus))),(null===(a=J.a.features)||void 0===a?void 0:a.enableFormFilling)&&(this.formService=new ue(this.eventBus.dispatch.bind(this.eventBus))),null===(i=this.loadFontPromise)||void 0===i||i.then(function(){r.renderViewport("Init")}))},t.prototype.initContent=function(e){var t;return(0,a.yv)(this,void 0,void 0,function(){var n=this;return(0,a.SO)(this,function(a){switch(a.label){case 0:return null===(t=this.zoomService)||void 0===t||t.initScale(e.scale),e.rotation?[4,this.rotate(e.rotation)]:[3,2];case 1:a.sent(),a.label=2;case 2:return this.layoutManager.resetContentSize(),e.pageNumber&&this.goToPage(e.pageNumber-1,e.pos),this.initRenderRequestId=requestAnimationFrame(function(){n.layoutManager.resetContentSize(),requestAnimationFrame(function(){S.a.verbose(Mt,"Root size: ".concat(n.layoutManager.rootRect.getClientWidth(),", ").concat(n.layoutManager.rootRect.getClientHeight())),n.renderViewport("Init")})}),[2]}})})},t.prototype.initManipulator=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,this.wasmDataProvider.getModuleInnerInit("Manipulator")];case 1:return e=t.sent(),[4,this.viewWorker.initialize(e)];case 2:return t.sent(),[2,this.viewWorker.getManipulatorHandlerInstance()]}})})},t.prototype.getManipulatorHandler=function(){return this.manipulatorInitPromise||(this.manipulatorInitPromise=this.initManipulator()),this.manipulatorInitPromise},t.prototype.reset=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.dispose(),this.layoutManager.metadata=void 0,this.setState(kt),this.layoutManager.contentRect.reset(),this.layoutManager.rootRect.clear(),this.docLoader=new de(this.props.url,this.props.filename,this.props.fileSize,this.props.enableDownloadByRange,this.props.token,this.props.getAuthHeaders),S.a.verbose(Mt,"Reset")},t.prototype.dispose=function(){var e,t,n,a,i,r;this.removeEvents(),this.storeDisplayInfo(),null===(e=this.renderService)||void 0===e||e.clear(),null===(t=this.printService)||void 0===t||t.dispose(),null===(n=this.inputEvtService)||void 0===n||n.dispose(),null===(a=this.viewContext)||void 0===a||a.dispose(),this.docLoader.dispose(),null===(i=this.thumbnailService)||void 0===i||i.dispose(),null===(r=this.progressiveLoadingService)||void 0===r||r.dispose(),Ce.getInstance().clear(),D.a.clearMarks(),this.renderService=void 0,this.zoomService=void 0,this.contentService=void 0,this.inputEvtService=void 0},t.prototype.bindWorkerMessage=function(){this.worker.addEventListener("message",this.onWorkerMessage)},t.prototype.bindPageEvents=function(){window.addEventListener("beforeunload",this.onBeforePageUnload),window.addEventListener("unload",this.onPageUnload)},t.prototype.bindEvents=function(){var e;y.a.isActivated("UseSizeObserver")?window.addEventListener("resize",this.onResize):this.observeOuterSizeChange(),window.addEventListener("mousemove",this.onGlobalMouseMove),window.addEventListener("mouseup",this.onGlobalMouseUp);var t=this.rootRef.current;null==t||t.addEventListener("touchmove",this.onTouchMove),null==t||t.addEventListener("scroll",this.onScroll),null==t||t.addEventListener("wheel",this.onWheel,{passive:!1}),(null===(e=this.progressiveLoadingService)||void 0===e?void 0:e.enabled)||this.bindWorkerMessage()},t.prototype.removeEvents=function(){var e;y.a.isActivated("UseSizeObserver")?window.removeEventListener("resize",this.onResize):null===(e=this.outerSizeObserver)||void 0===e||e.disconnect(),window.removeEventListener("mousemove",this.onGlobalMouseMove),window.removeEventListener("mouseup",this.onGlobalMouseUp),window.removeEventListener("beforeunload",this.onBeforePageUnload),window.removeEventListener("unload",this.onPageUnload);var t=this.rootRef.current;null==t||t.removeEventListener("touchmove",this.onTouchMove),null==t||t.removeEventListener("scroll",this.onScroll),null==t||t.removeEventListener("wheel",this.onWheel),this.worker.removeEventListener("message",this.onWorkerMessage),this.eventBus.dispose()},t.prototype.observeOuterSizeChange=function(){var e=this,t=!0;this.outerSizeObserver=new ResizeObserver(function(n){var i,r;try{for(var o=(0,a.BW)(n),s=o.next();!s.done;s=o.next())if(s.value.target.className===Ze.c){t?t=!1:e.onResize();break}}catch(e){i={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}}),this.outerRef.current&&this.outerSizeObserver.observe(this.outerRef.current)},t.prototype.resizeViewer=function(){var e,t,n=this,a=(0,m.a)();a!==this.state.dpr&&(this.setState({dpr:a}),this.clearViewport()),(null===(e=this.zoomService)||void 0===e?void 0:e.isResponsiveZoomValid())&&this.eventBus.dispatch(q.e.ResponsiveResize),(null===(t=this.zoomService)||void 0===t?void 0:t.responsiveZoom())||(this.layoutManager.resetContentSize(),requestAnimationFrame(function(){n.renderViewport()}))},t.prototype.updateOuterHeight=function(){this.props.height&&this.outerRect.setHeight(this.props.height)},t.prototype.clearViewport=function(){var e;null===(e=this.renderService)||void 0===e||e.clear(),this.setState({viewportRenderResult:void 0,viewportBlurRenderResult:void 0})},t.prototype.isEvtInsideViewer=function(e){var t,n,a=new u.a(e.clientX,e.clientY),i=e.target,r=null===(t=this.rootRef.current)||void 0===t?void 0:t.getBoundingClientRect();return i instanceof Node&&(null===(n=this.rootRef.current)||void 0===n?void 0:n.contains(i))||!!r&&a.x>=r.x&&a.x<=r.x+r.width&&a.y>=r.y&&a.y<=r.y+r.height},t.prototype.getNativeEvt=function(e){return e.nativeEvent||e},t.prototype.checkWorkerVersion=function(){var e,t;return(0,a.yv)(this,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,this.viewWorker.getExtWorkerVersion()];case 1:if(n=a.sent(),null===(t=(e=this.props).isWorkerVersionMismatch)||void 0===t?void 0:t.call(e,n))throw new _.e("Fail to initialize viewer due to mismatching between web worker and the main app, workerVersion=".concat(n,", workerSrc=").concat(encodeURIComponent(J.a.workerSrc)));return[2]}})})},Object.defineProperty(t.prototype,"pageManager",{get:function(){return this.layoutManager.pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tempAuthLogFields",{get:function(){return C.a.getTempAuthLogFields(this.props.url,this.props.token)},enumerable:!1,configurable:!0}),t.defaultProps={isRootFocusable:!0,enableCacheDisplayInfo:!0},t.contextType=Ne.b,t}(G.Component)}
,,,,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{legacyGraphDataSourceKey:()=>_});var a=n("tslib_538"),i=n(6),r=n("odsp.util_152"),o=n(34),s=n(21),c=n(39),d=n(84),l=n(5),u=n(135),f={ODB:620},p=27e5,m=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}return e.prototype.getItemCurrentVersion=function(e,t){return(0,a.yv)(this,void 0,i.c,function(){var n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=this.getItemUrl(e,t),i="".concat(n,"/versions?$select=id"),[4,this._sendVroomRequest(n,i,e,t||{},"versions",{})];case 1:return[2,(r=a.sent().value).length>0?r[0].id:""]}})})},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t={});var n=this._urlCache;if(!t.forceRefresh){var a=n.get(e.key)||{},o=a.url,s=a.time;if(!r.x9.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&o&&s>Date.now()-p)return i.c.wrap(o)}if(t.excludeTempAuth&&e.downloadUrlNoAuth)return i.c.resolve(e.downloadUrlNoAuth);if(e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<p)return i.c.resolve(e.downloadUrl);var c=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,d=this.getItemUrl(e,t),l="".concat(d,"?select=id,@content.downloadUrl");return this._sendVroomRequest(d,l,e,t,"itemDownloadUrl",c).then(function(t){var a=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})},e.prototype.getDownloadToken=function(e){var t=e.item,n=this._itemUrlHelper.getItemUrlParts(t.key);return n.isCrossDomain?this._identityDataSource.getSharePointToken(new o.a(n.fullItemUrl).authority).then(function(e){var t=e.accessToken,n=e.isBadger;return"".concat(n?"badger":"bearer"," ").concat(t)}):i.c.resolve(void 0)},e.prototype.getAuthenticationParams=function(e,t){var n=this,i=(t||{}).apiVersion,o=void 0===i?r.ov.isFeatureEnabled(f)?"v2.1":"v2.0":i;return this.refreshAccessToken(e,(0,a.q5)((0,a.q5)({},t),{apiVersion:o})).then(function(){return n._getAuthenticationParamsSync(e,t)})},e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0===n?!this._pageContext.isSPO:n,i=t.isPath,r=void 0!==i&&i,o=t.apiVersion,s=void 0===o?"v2.0":o,c=t.allowCookies,d=void 0!==c&&c,l=this._getGraphBaseUrl(e,{useDirectEndpoint:a,apiVersion:s,allowCookies:d}),u=e.graph;if(u&&u.driveId&&"root"!==u.itemId){var f=u.driveId,p=void 0===f?"me":f,m=u.itemId,_=void 0===m?"root":m;return"".concat(l,"/drives/").concat(encodeURIComponent(p)).concat("root"===_?"/root":"/items/".concat(encodeURIComponent(_))).concat(r?":":"")}var h=e.graph,b=void 0;if((p=h&&h.driveId)&&(b="".concat(l,"/drives/").concat(encodeURIComponent(p))),!b)return"";var g=this._itemUrlHelper.getItemUrlParts(e.key),v=this._itemUrlHelper.getUrlParts({path:g.serverRelativeItemUrl,listUrl:g.serverRelativeListUrl}).listRelativeItemUrl;return"".concat(b,"/root").concat(v?":/".concat(encodeURI(v)).concat(r?"":":"):"".concat(r?":":""))},e.prototype.getAccessToken=function(e,t){void 0===t&&(t={});var n=e;return"v2.1"===t.apiVersion?n&&n.graph.sessionTokenV21:n&&n.graph.sessionToken},e.prototype.refreshAccessToken=function(e,t){return void 0===t&&(t={}),i.c.resolve(this.getAccessToken(e,t))},e.prototype.getMetaPac=function(e,t){return void 0===t&&(t={}),i.c.resolve(this.getAccessToken(e,t))},e.prototype.getDownloadUrlSync=function(e,t){},e.prototype.getDriveUrl=function(e,t){return""},e.prototype._getAuthenticationParamsSync=function(e,t){var n=this.getAccessToken(e,t);if(n){var a=n.accessToken,i=n.proofToken,r={};return a&&(r.access_token=a),i&&(r.prooftoken=i),r}return{}},e.prototype._getGraphBaseUrl=function(e,t){var n=t.useDirectEndpoint,a=t.apiVersion,i=this._itemUrlHelper.getItemUrlParts(e.key),r=i.fullListUrl;if(n){if(r)return"".concat(new o.a(r).authority,"/_api/").concat(a);if(i.isCrossDomain||i.isCrossList){var s=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return"".concat(new o.a(s).authority,"/_api/").concat(a)}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"},e.prototype._sendVroomRequest=function(e,t,n,a,r,s){var c=this;void 0===a&&(a={});var d=this._itemUrlHelper.getItemUrlParts(n.key).isCrossDomain;a.apiName&&(r="".concat(a.apiName,".").concat(r));var l=!d;return(l?i.c.resolve(void 0):this._identityDataSource.getSharePointToken(new o.a(e).authority)).then(function(e){var n=l?void 0:e;return c._vroomDataRequestor.send({apiName:r,path:"".concat(t),accessToken:n,qosExtraData:a.qosExtraData,allowCookies:l,headers:s})})},e.dependencies={urlDataSource:u.b,itemUrlHelper:s.c,pageContext:l.a,vroomDataRequestor:d.a,identityDataSource:c.resourceKey},e}(),_=(0,r._y)("LegacyGraphDataSource",m)}
,(e,t,n)=>{var a="Expected a function",i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=d||l||Function("return this")(),f=Object.prototype.toString,p=Math.max,m=Math.min,_=function(){return u.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==f.call(e)}(e))return NaN;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=o.test(e);return n||s.test(e)?c(e.slice(2),n?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(a);return h(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(e,t,n){var i,r,o,s,c,d,l=0,u=!1,f=!1,g=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=i,a=r;return i=r=void 0,l=t,s=e.apply(a,n)}function y(e){return l=e,c=setTimeout(D,t),u?v(e):s}function S(e){var n=e-d;return void 0===d||n>=t||n<0||f&&e-l>=o}function D(){var e=_();if(S(e))return I(e);c=setTimeout(D,function(e){var n=t-(e-d);return f?m(n,o-(e-l)):n}(e))}function I(e){return c=void 0,g&&i?v(e):(i=r=void 0,s)}function x(){var e=_(),n=S(e);if(i=arguments,r=this,d=e,n){if(void 0===c)return y(d);if(f)return c=setTimeout(D,t),v(d)}return void 0===c&&(c=setTimeout(D,t)),s}return t=b(t)||0,h(n)&&(u=!!n.leading,o=(f="maxWait"in n)?p(b(n.maxWait)||0,t):o,g="trailing"in n?!!n.trailing:g),x.cancel=function(){void 0!==c&&clearTimeout(c),l=0,i=d=r=c=void 0},x.flush=function(){return void 0===c?s:I(_())},x}(e,t,{leading:i,maxWait:t,trailing:r})}}
,,,,,,,,,,,,,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>a}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={})),function(e){e[e.None=0]="None",e[e.CommentsDisabled=1]="CommentsDisabled",e[e.CommentsInTable=2]="CommentsInTable",e[e.CommentsMigrating=4]="CommentsMigrating",e[e.LikesMigrating=8]="LikesMigrating"}(i||(i={}))}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("odsp.util_152"),i=n(135),r=new a.aF({name:"oneUpUrlDataSource",factory:new a.Rj(i.a)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>a,c:()=>d,d:()=>i,e:()=>r,f:()=>l,g:()=>p,h:()=>c,i:()=>u,j:()=>o,k:()=>f});var a="id",i="listId",r="listurl",o="viewid",s="groupBy",c="sortField",d="isAscending",l="searchid",u="typeFilters",f="viewpath",p="q"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a="remoteItem"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a="parent"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});var a="parentview",i="view"}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("odsp.util_152").ov.isFeatureEnabled,i={ODB:61286},r={ODB:62036};function o(){return a(i)&&a(r)}}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a,i,r=n("odsp.util_152"),o=n(138),s=n(5),c=n(245),d=n(33);!function(e){e.legacy="legacy",e.phase1="react",e.phase2="newDesign"}(a||(a={})),function(e){e.carousel="carousel",e.fast="fast",e.embed="embed"}(i||(i={}));var l={isFastOneUp:o.e.optional,pageContext:s.a},u=new r.aF({name:"OneUpEngagementContextKey",factory:{dependencies:l,create:function(e){var t=e.pageContext,n=e.isFastOneUp,i=t?(0,d.c)(Number(t.webTemplate)):"unknown",r=a.phase2,o=t?(0,c.a)(t):void 0;return{instance:{previewContext:f(n),webTemplate:i,clientId:o,isSyntexEnabled:t?t.isSyntexEnabled:"unknown",oneUpPhase:r}}}}});function f(e){return e?i.fast:i.carousel}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("tslib_538"),i=n(33),r=n("odsp.util_152"),o=n(97);function s(e){var t,n,s,c,d,l,u=(null==e?void 0:e.authToken)||"",f=(0,o.b)(u);return f&&f.app_displayname?t=f.app_displayname:(s=window,c=(0,r.Ho)((s.location.search||"").slice(1)),d=(0,r.Ho)((s.location.hash||"").slice(1)),l=(null===(n=s.PageContext)||void 0===n?void 0:n.scenarioContext.embed)||{},t=(0,a.q5)((0,a.q5)((0,a.q5)({},c),d),l).client_id||(Number(e.webTemplate)===i.b.mySite?"ODB":"SPList")),t}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>L});var a,i,r=n("tslib_538"),o=n(147),s=n("odsp.util_152"),c=n(83),d=n(97),l=new s.aF("pdfViewerEmbedOptions"),u=n(88),f=n(12),p=n(251),m=n(49),_=n(5),h=n(85),b=n(54),g=function(e){function t(t,n){var a=e.call(this)||this;return a._pageContext=n.pageContext,a}return(0,r.e2)(t,e),t.prototype.canSaveAsOriginal=function(e){var t,n,a=e.item;return!!a&&b.a.hasItemPermission(a,b.a.insertListItems)&&b.a.hasItemPermission(a,b.a.editListItems)&&!(null===(t=this._pageContext)||void 0===t?void 0:t.isAnonymousGuestUser)&&!(null===(n=this._pageContext)||void 0===n?void 0:n.isEmailAuthenticationGuestUser)},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsOriginal(e)},e}()),v=(0,s._y)("PdfDataSource",g,{pageContext:_.a.optional}),y=n(252),S=n(253),D=n(66),I=n(94),x=n(254),C=n(255);!function(e){e.GetDownloadUrl="GetDownloadUrl",e.GetDownloadToken="GetDownloadToken"}(a||(a={})),function(e){e.DownloadAspx="DownloadAspx",e.MeTATransform="MeTATransform",e.VroomContent="VroomContent",e.Unknown="Unknown"}(i||(i={}));var O=".pdf",w=10485760,E=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack","ODBUWP"],A=function(){function e(e,t){this.isWorkerVersionMismatch=function(e){var t,n=null===(t=window._spModuleLink)||void 0===t?void 0:t.buildNumber;return"dev"!==n&&!(!e||!n)&&e!==n},this._enablePdf=(0,f.wb)(f.X),this._enableMsPdfviewer=(0,f.wb)(f.S),this._enableEmbedMsPdfviewer=(0,f.wb)(f.h),this._enableEditPdf=(0,f.wb)(f.g),this._enableExtractPdf=(0,f.wb)(f.I),this._enableEncryptPdf=(0,f.wb)(f.H),this._enablePreviewTif=(0,f.wb)(f.T),this._enableDeprecateTempAuth=(0,f.wb)(f.K),this._enableDeprecateTempAuthForPrefetch=(0,f.wb)(f.J),this._enableNoTempAuthForEmbedSameDomain=(0,f.wb)(f.N),this._enableNoTempAuthForEmbedCrossDomain=(0,f.wb)(f.L),this._enableHTML=(0,f.wb)(f.U)&&((0,p.a)()||t.platformDetection.isEdge),this._urlDataSource=t.urlDataSource,this._pdfDataSource=t.pdfDataSource,this._navigation=t.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=t.platformDetection,this._pageContext=t.pageContext,this._embedOptions=t.embedOptions}return e.isWasmSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported},e.prototype.isNotEmbed=function(){return this._urlDataSource.getPageType(this._viewParams)!==u.a.Embed},e.prototype.isSameDomainEmbed=function(e){if(!this.isNotEmbed()){var t=this._getHostOriginFromQSP(),n=window.location.origin;if(t)return t===n&&n===new URL(e).origin}},e.prototype.isSupportedFileType=function(e){var t=this._extension(e);return this._enablePdf&&(t===O||".ai"===t||!!e.pdfConversion)&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)},e.prototype.isProgressiveLoadingEnabled=function(e){return!(!(0,f.wb)(f.w)&&!(0,S.a)(f.v.ECS)||!e.size||e.pdfConversion||!(0,f.wb)(f.n)&&!(this._platformDetection.isMobile?e.size>w:e.size>104857600))},e.prototype.isPreviewerEnabled=function(e,t){if(void 0===t&&(t=!0),this.isProgressiveLoadingEnabled(e))return!1;if(!((0,f.wb)(f.G)||(0,f.Xb)()&&t)&&(this.isNotEmbed()||(0,y.h)()||(0,S.b)(f.f.ECS))||!e.size)return!1;var n=this._platformDetection.isMobile?w:209715200;return e.size>n&&!e.pdfConversion},e.prototype.isMsPdfViewerSupported=function(e){var t;if(!e)return!1;var n=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),a=this._isHostAppTeams()&&(0,S.a)(f.R.ECS),i=!(0,y.g)()&&!(0,S.b)(f.a.ECS)&&!this.isNotEmbed()&&((null===(t=this._embedOptions)||void 0===t?void 0:t.useMsPdf)||!1);return(n||a||i)&&this._isMsPdfViewerSupported(e)},e.prototype.isMsPdfViewerAvailable=function(e){return this.isSupportedFileType(e)&&this._isEnabledInOneUp(e)&&this.isMsPdfViewerSupported(e.size)},e.prototype.isPdfEditAvailable=function(e){var t=!!e.size&&e.size<=D.t;return this.isMsPdfViewerAvailable(e)&&(this._enableEditPdf||!this.isNotEmbed()&&!(0,y.f)()&&!(0,S.b)(f.e.ECS))&&this._extension(e)===O&&t},e.prototype.isPdfExtractAvailable=function(e){return(this.hasSyntexLicense()||(0,f.wb)(f.A))&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()&&this._enableExtractPdf},e.prototype.isPdfEncryptAvailable=function(e){return this.hasSyntexLicense()&&this._enableEncryptPdf&&this.isMsPdfViewerAvailable(e)&&this.isNotEmbed()},e.prototype.isPdfExtractable=function(){return(this.hasSyntexLicense()||(0,f.wb)(f.A))&&this._enableExtractPdf},e.prototype.isPdfEditable=function(e){var t;return e.itemStatus!==o.b.ConditionalAccessViewOnly&&e.itemStatus!==o.b.ConditionalAccessBlocked&&(null===(t=this._pdfDataSource)||void 0===t?void 0:t.canSave({item:e}))},e.prototype.isPdfPrintable=function(e){return!!(e&&e.extension&&e.openUrl&&e.itemStatus!==o.b.ConditionalAccessViewOnly&&e.itemStatus!==o.b.ConditionalAccessBlocked&&b.a.hasItemPermission(e,b.a.openItems))},e.prototype.getWorkerManifestName=function(){var e,t=(null===(e=window._spModuleLink)||void 0===e?void 0:e.manifestName)||"";return(0,f.wb)(f.z)&&-1!==E.indexOf(t)?"odbmspdfwebworker":"mspdfwebworker"},e.prototype.getEmbedOptions=function(){return this._embedOptions},e.prototype.hasSyntexLicense=function(){var e,t;return(null===(e=this._pageContext)||void 0===e?void 0:e.canUserUseSyntex)||(0,y.w)()&&(null===(t=this._pageContext)||void 0===t?void 0:t.isUserSyntexV2Licensed)||!1},e.prototype.isNoTempAuthEnabled=function(){return!(0,y.u)()&&!(0,S.b)(f.M.ECS)},e.prototype.isTempAuthDeprecated=function(e){var t;if(this.isNotEmbed())return(null==e?void 0:e.downloadUrl)?!(0,y.p)()&&this._enableDeprecateTempAuthForPrefetch:!(0,y.q)()&&this._enableDeprecateTempAuth;if(!(0,y.s)()&&e.urls&&e.urls[I.a.downloadUrlNoAuth]){var n=this.isSameDomainEmbed(e.urls[I.a.downloadUrlNoAuth]);return n?this._enableNoTempAuthForEmbedSameDomain:!1===n&&this._enableNoTempAuthForEmbedCrossDomain&&!!(null===(t=this._embedOptions)||void 0===t?void 0:t.hostHasTokenProvider)}return!1},e.prototype.getPdfSource=function(e){return e?e.url?(0,x.a)(e.url)?i.MeTATransform:i.Unknown:i.VroomContent:i.DownloadAspx},e.prototype.getTempAuthLogData=function(e){if(!(0,y.r)()&&e.url){var t=(0,C.b)(e.url);return void 0!==t?{isPdfNoTempAuth:!t,isPdfUseToken:!!e.token}:{isPdfUseToken:!!e.token}}},e.prototype._isHostAppTeams=function(){if(this.isNotEmbed())return!1;var e=this._getClientId();return!!e&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(e)},e.prototype._isEnabledInOneUp=function(e){return!(e.officeBundle||e.wopiFrameUrl||this._enableHTML&&e.htmlConversion)},e.prototype._isMsPdfViewerSupported=function(t){if(!t)return!1;var n=t<(performance.memory?performance.memory.jsHeapSizeLimit-performance.memory.totalJSHeapSize:268435456)/4&&((0,y.l)()||t<536870912);return e.isWasmSupported()&&n},e.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""},e.prototype._getClientId=function(){var e,t=(null===(e=this._pageContext)||void 0===e?void 0:e.authToken)||"",n=(0,d.b)(t);return n&&n.app_displayname||this._getClientIdFromQSP()},e.prototype._getClientIdFromQSP=function(){var e,t=window,n=(0,s.Ho)((t.location.search||"").slice(1)),a=(0,s.Ho)((t.location.hash||"").slice(1)),i=(null===(e=t.PageContext)||void 0===e?void 0:e.scenarioContext.embed)||{};return(0,r.q5)((0,r.q5)((0,r.q5)({},n),a),i).client_id},e.prototype._getHostOriginFromQSP=function(){var e=window,t=(0,s.Ho)((e.location.hash||"").slice(1));if(t.origin)return t.origin;var n=(0,s.Ho)((e.location.search||"").slice(1));if(n.embed)try{return JSON.parse(n.embed).o}catch(e){return}},e.dependencies={},e}(),L=(0,s._y)("PdfViewerHelper",A,{platformDetection:c.a,urlDataSource:h.a,navigation:m.a,pdfDataSource:v,pageContext:_.a.optional,embedOptions:l.optional})}
,(e,t,n)=>{"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,{a:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>I,b:()=>l,c:()=>m,d:()=>C,e:()=>d,f:()=>s,g:()=>i,h:()=>o,i:()=>c,j:()=>p,k:()=>O,l:()=>u,m:()=>f,n:()=>y,o:()=>D,p:()=>b,q:()=>h,r:()=>v,s:()=>g,t:()=>S,u:()=>_,v:()=>x,w:()=>r});var a=n("odsp.util_152"),i=function(){return a.x9.isActivated("c3dc126d-70db-4dc6-9ad6-3ce6d59dfaca")},r=function(){return!a.x9.isActivated("acc3d562-8099-40b9-ad90-f199e8fcec91","6/15/2023","Syntex V2 License check")},o=function(){return a.x9.isActivated("8abd1628-3d93-4f7f-812c-632b31cc516f","06/19/2023","Enable previewer for embedded scenarios")},s=function(){return a.x9.isActivated("f644d6f3-bfb2-4b67-9ea4-f2bbd98431b0","07/17/2023","Enable editing for mspdf in embed scenarios")},c=function(){return a.x9.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change")},d=function(){return a.x9.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF")},l=function(){return a.x9.isActivated("5b9870f7-f2fd-4892-baf4-5cdf182ff84f","29/02/2024","Do not activate esign new design")},u=function(){return a.x9.isActivated("20302a2a-5087-41af-b2a7-57f1d3a7bb82","01/26/2024","Use MsPdf fallback theshold")},f=function(){return a.x9.isActivated("068F8934-7C5F-4B80-A3C6-6CB83E3E7188","02/27/2024","Send PDF full page load perf data")},p=function(){return a.x9.isActivated("3c48928f-2237-4566-bc7d-8eeb1da30f4a","01/09/2025","load Chinese traditional font")},m=function(){return a.x9.isActivated("EE02F3C9-6475-4A21-92FD-34501A13F529","07/11/2024","disable open in app on mobile")},_=function(){return a.x9.isActivated("afc23a17-7c59-482b-977e-03721de0334e","01/16/2025","Disable temp auth deprecation for all scenarios")},h=function(){return a.x9.isActivated("F8DA2D1F-DFA4-4517-9725-12E716766315","08/07/2024","Disable temp auth deprecation for legacy OneUp PDF viewer and new inline OneUp PDF viewer")},b=function(){return a.x9.isActivated("74E95D32-2C34-478C-812F-C3D8516E7845","08/07/2024","Disable temp auth deprecation for new fast OneUp PDF viewer where prefetches the download url")},g=function(){return a.x9.isActivated("67d4a9e9-0fd8-4493-88e7-a9866c728b0a","08/29/2024","Disable temp auth deprecation for the embedded OneUp PDF viewer")},v=function(){return a.x9.isActivated("e66ba878-0389-4296-9158-6f0fce24ae33","09/10/2024","Add RUMOne log for temp auth deprecation")},y=function(){return a.x9.isActivated("87c18969-8b19-468b-b5c2-03558ae814af","02/06/2025","Disable temp auth deprecation for PDF conversion")},S=function(){return a.x9.isActivated("ec9f89cd-e773-4158-ae47-68d5097f6e54","08/13/2024","Refactor the implmentation for versions API")},D=function(){return a.x9.isActivated("f65d78e0-eb8a-4de0-a500-a48ec644f91d","08/14/2024","Pdf copy the file content by chunks to reduce memory usage")},I=function(){return a.x9.isActivated("c798f4e6-7216-47a4-a5c6-0c00fa6233ff","09/06/2024","Close UA when entering PDF edit mode")},x=function(){return a.x9.isActivated("06cef174-4981-4e0e-9051-f82587e53a2b","10/02/2024","Prevent double render in PDF viewer")},C=function(){return a.x9.isActivated("31cda21c-8300-4326-b8c9-7c43106da470","12/02/2024","Disable print permission for not-allowed pdf")},O=function(){return a.x9.isActivated("0e5ca4e9-7964-4974-8ad5-e100b53f5d3a","01/06/2025","Log EvTrace events")}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>i});var a=function(e){var t,n,a,i;if(!e)return!1;var r=(null===(t=window.Flight)||void 0===t?void 0:t.ecsConfig)&&JSON.parse(null===(n=window.Flight)||void 0===n?void 0:n.ecsConfig),o=null===(i=null===(a=null==r?void 0:r.RolloutContext)||void 0===a?void 0:a.settings)||void 0===i?void 0:i.ODSPMicroservices_ODWeb;return o&&!0===o[e]},i=function(e){return a(e)}}
,(e,t,n)=>{"use strict";function a(e){return!!(null==e?void 0:e.match(/https?:\/\/[^\/]+\/transform\/.*/))}function i(e){var t=e.headers;return{correlationId:t.get("X-Correlationid")||void 0,failureReason:t.get("X-Onedrive-Thumbnailfailurereason")||void 0}}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";function a(e){if(e){var t=new URL(e);return{urlOrigin:t.origin,urlPath:t.pathname}}}function i(e){var t=function(e){try{var n=new URL(e.toLowerCase()).searchParams,a=n.get("tempauth"),i=n.get("access_token"),r=n.get("docid");return!!(a&&"false"!==a||i&&"false"!==i)||!!r&&t(decodeURI(r))}catch(e){return}};return t(e)}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>_});var a=n("tslib_538"),i=n("odsp.util_152"),r=n(56),o=n(21),s=n(257),c=n(5),d=n(465),l=n(84),u=(0,i._y)("PreAuthServiceKey",d.a,{dataRequestor:l.a}),f=n(39),p=n(12),m={oneUpStateStore:r.e,graphDataSource:s.a,itemUrlHelper:o.c,preAuthService:u,identityDataSource:f.resourceKey,pageContext:c.a},_=new i.aF({name:"FileHandlerHelper",factory:{dependencies:m,create:function(e){return{instance:{hasFileHandler:function(t){var n=e.oneUpStateStore.getFileHandlerOptions();if(n)for(var a=null==n?void 0:n.data.actions.preview,i=t.extension,r=0;r<a.length;r++){var o=a[r].availableOn.file,s=o&&o.extensions||void 0;if(o&&i){var c="."!==i.charAt(0)?"."+i:i;return!s||-1!==s.indexOf(c.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*")}}return!1},getCorrespondingPreviewFileHandlerPostData:function(t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l,u;return(0,a.SO)(this,function(f){switch(f.label){case 0:if(!(n=e.oneUpStateStore.getFileHandlerOptions()))return[3,6];i=null==n?void 0:n.data.actions.preview,r=t.extension,o=0,f.label=1;case 1:if(!(o<i.length))return[3,6];if(s=i[o].availableOn.file,c=s&&s.extensions||void 0,!s||!r)return[3,5];if(d="."!==r.charAt(0)?"."+r:r,c&&-1===c.indexOf(d.toLowerCase())&&-1===c.indexOf("*")&&-1===c.indexOf(".*"))return[3,5];f.label=2;case 2:return f.trys.push([2,4,,5]),[4,this.getFileHandlerItemUrl(t,i[o],!!i[o].handler.isPromoted)];case 3:if((l=f.sent())&&l.length>0)return[2,(0,a.q5)((0,a.q5)({},i[o]),{itemUrls:l})];throw new Error("failed to get fileHandler item url");case 4:throw u=f.sent(),new Error(u);case 5:return o++,[3,1];case 6:return[2,Promise.resolve(void 0)]}})})},getFileHandlerItemUrl:function(t,n,i){var r,o;return(0,a.yv)(this,void 0,void 0,function(){var s,c,d;return(0,a.SO)(this,function(a){switch(a.label){case 0:return i?[2,Promise.resolve([e.graphDataSource.getItemUrl(t,{useDirectEndpoint:!1})])]:[3,1];case 1:return s=e.itemUrlHelper.getItemUrlParts(t.key).fullItemUrl,c=e.itemUrlHelper.getItemUrlParts(t.key).fullWebUrl,s&&c?[4,e.identityDataSource.getSharePointToken(c)]:[3,4];case 2:return d=a.sent(),[4,e.preAuthService.getPreAuthUrls({driveUrl:(0,p.Eb)()?null===(o=null===(r=t.graph)||void 0===r?void 0:r.sessionToken)||void 0===o?void 0:o.tokenUrl:void 0,appId:n.handler.appId,items:[s],accessToken:d})];case 3:return[2,a.sent()];case 4:throw new Error("no item full url / item webAbsolute Url")}})})}}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>S});var a=n("tslib_538"),i=n("odsp.util_152"),r=n(34),o=n(21),s=n(39),c=n(84),d=n(5),l=n(135),u=n(140),f=n(202),p=n(261),m=n(215),_=n(262),h={ODB:620},b=i.x9.isActivated("482C00F6-EA94-4C87-8A26-587BFF52B45E"),g=27e5,v=function(){function e(e,t){this._urlDataSource=t.urlDataSource,this._itemUrlHelper=t.itemUrlHelper,this._pageContext=t.pageContext,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._identityDataSource=t.identityDataSource}return e.prototype.getItemCurrentVersion=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=this.getItemUrl(e,t),i="".concat(n,"/versions?$select=id"),[4,this._sendVroomRequest(n,i,e,t||{},"versions",{})];case 1:return[2,(r=a.sent().value).length>0?r[0].id:""]}})})},e.prototype.getDownloadUrl=function(e,t){return void 0===t&&(t={}),(0,a.yv)(this,void 0,void 0,function(){var n,r,o,s,c,d,l,u;return(0,a.SO)(this,function(a){return n=this._urlCache,!t.forceRefresh&&(r=n.get(e.key),s=(o=r||{}).url,c=o.time,!i.x9.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&s&&c>Date.now()-g)?[2,s]:t.excludeTempAuth&&e.downloadUrlNoAuth?[2,e.downloadUrlNoAuth]:e.downloadUrl&&""!==e.downloadUrl&&e.itemGeneratedTimeStamp&&Date.now()-e.itemGeneratedTimeStamp<g?[2,e.downloadUrl]:(d=t.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,l=this.getItemUrl(e,t),u="".concat(l,"?select=id,@content.downloadUrl"),[2,this._sendVroomRequest(l,u,e,t,"itemDownloadUrl",d).then(function(t){var a=t["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return n.set(e.key,{url:a,time:Date.now()}),a})])})})},e.prototype.getThumbnailUrl=function(e,t){return void 0===t&&(t={}),(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o,s,c,d,l;return(0,a.SO)(this,function(a){switch(a.label){case 0:n=this.getItemUrl(e,t),i=t.size||{},r=i.width,o=i.height,s=r&&o?"c".concat(Math.ceil(r),"x").concat(Math.ceil(o)):"large",c="".concat(n,"/thumbnails/0/").concat(s,"/content?prefer=noredirect,closestavailablesize"),d=function(e){var t=e.response;return{blobUrl:URL.createObjectURL(t)}},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._sendVroomRequest(n,c,e,t,"thumbnailUrl",{},"blob",d)];case 2:return[2,a.sent()];case 3:return"code"in(l=a.sent())&&(l.code="".concat(l.code,": VroomFetchError")),[2,{error:l}];case 4:return[2]}})})},e.prototype.getDownloadToken=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,o,s;return(0,a.SO)(this,function(a){return t=e.url,n=e.item,!b&&t&&this._pageContext.webAbsoluteUrl?(i=new r.a(t).authority,o=new r.a(this._pageContext.webAbsoluteUrl).authority,i!==o?[2,this._identityDataSource.getSharePointToken(i).then(function(e){var t=e.accessToken,n=e.isBadger;return"".concat(n?"badger":"bearer"," ").concat(t)})]:[2,void 0]):(s=this._itemUrlHelper.getItemUrlParts(n.key)).isCrossDomain?[2,this._identityDataSource.getSharePointToken(new r.a(s.fullItemUrl).authority).then(function(e){var t=e.accessToken,n=e.isBadger;return"".concat(n?"badger":"bearer"," ").concat(t)})]:[2,void 0]})})},e.prototype.getAuthenticationParams=function(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,r,o;return(0,a.SO)(this,function(s){switch(s.label){case 0:return n=(t||{}).apiVersion,r=void 0===n?i.ov.isFeatureEnabled(h)?"v2.1":"v2.0":n,[4,this.getAccessToken(e,(0,a.q5)((0,a.q5)({},t),{apiVersion:r}))];case 1:return o=s.sent(),[2,this._getAuthenticationParamsSync(o)]}})})},e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0===n?!this._pageContext.isSPO:n,i=t.isPath,r=void 0!==i&&i,o=t.apiVersion,s=void 0===o?"v2.0":o,c=t.allowCookies,d=void 0!==c&&c,l=this._getGraphBaseUrl(e,{useDirectEndpoint:a,apiVersion:s,allowCookies:d}),u=e.graph;if(u&&u.driveId&&"root"!==u.itemId){var f=u.driveId,p=void 0===f?"me":f,m=u.itemId,_=void 0===m?"root":m;return"".concat(l,"/drives/").concat(encodeURIComponent(p)).concat("root"===_?"/root":"/items/".concat(encodeURIComponent(_))).concat(r?":":"")}var h=e.graph,b=void 0;if((p=h&&h.driveId)&&(b="".concat(l,"/drives/").concat(encodeURIComponent(p))),!b)return"";var g=this._itemUrlHelper.getItemUrlParts(e.key),v=this._itemUrlHelper.getUrlParts({path:g.serverRelativeItemUrl,listUrl:g.serverRelativeListUrl}).listRelativeItemUrl;return"".concat(b,"/root").concat(v?":/".concat(encodeURI(v)).concat(r?"":":"):"".concat(r?":":""))},e.prototype.getAccessToken=function(e,t){return void 0===t&&(t={}),(0,a.yv)(this,void 0,void 0,function(){var n,i,o,s,c,d,l,p;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=t.apiVersion,i=t.forceRefresh,o=void 0!==i&&i,!(s=this._getAccessTokenFromItem(e,{apiVersion:n}))||(c=s.accessToken,d=s.proofToken,l=s.tokenExpiry,o||(0,u.a)((0,f.default)({authToken:c},{proofToken:f.optional(d),expiry:f.optional(l?new Date(l):void 0)}),3e5))?(p=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl,[4,this._identityDataSource.getSharePointToken(new r.a(p).authority,o)]):[2,s];case 1:return[2,a.sent()]}})})},e.prototype.getMetaPac=function(e,t,n){return void 0===n&&(n={}),(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,f,p,m;return(0,a.SO)(this,function(a){switch(a.label){case 0:return i=n.apiVersion,r=void 0===i?"2.0":i,o=n.forceRefresh,s=void 0!==o&&o,(c=this._getAccessTokenFromItem(t,n))&&(d=c.metaPac,!s&&d&&!(0,u.a)({authToken:d},3e5))?[2,c]:[4,e.consumeAsync(_.a)];case 1:return[4,null==(l=a.sent())?void 0:l.refreshAuthToken()];case 2:if(f=a.sent()){if(p=f.driveAccessCode,m=f.driveAccessCodeV21,p&&"v2.0"===r)return[2,{metaPac:p}];if(m&&"v2.1"===r)return[2,{metaPac:m}]}throw new Error("Cannot find valid MeTA access code")}})})},e.prototype._getAccessTokenFromItem=function(e,t){var n,a;return void 0===t&&(t={}),"v2.1"===t.apiVersion?null===(n=e.graph)||void 0===n?void 0:n.sessionTokenV21:null===(a=e.graph)||void 0===a?void 0:a.sessionToken},e.prototype._getAuthenticationParamsSync=function(e){if(e){var t=e.accessToken,n=e.proofToken,a={};return t&&(a.access_token=t),n&&(a.prooftoken=n),a}return{}},e.prototype._getGraphBaseUrl=function(e,t){var n=t.useDirectEndpoint,a=t.apiVersion,i=this._itemUrlHelper.getItemUrlParts(e.key),o=i.fullListUrl;if(n){if(o)return"".concat(new r.a(o).authority,"/_api/").concat(a);if(i.isCrossDomain||i.isCrossList){var s=this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;return"".concat(new r.a(s).authority,"/_api/").concat(a)}return this._urlDataSource.getApiBaseUrl({apiVersion:a})}return"https://graph.microsoft.com/v1.0"},e.prototype._sendVroomRequest=function(e,t,n,a,i,o,s,c){var d=this;void 0===a&&(a={});var l=this._itemUrlHelper.getItemUrlParts(n.key).isCrossDomain;a.apiName&&(i="".concat(a.apiName,".").concat(i));var u=!l;return(u?Promise.resolve(void 0):this._identityDataSource.getSharePointToken(new r.a(e).authority)).then(function(e){var n=u?void 0:e;return d._vroomDataRequestor.send({apiName:i,path:"".concat(t),accessToken:n,qosExtraData:a.qosExtraData,allowCookies:u,headers:o,responseType:s,parseResponse:c})})},e.dependencies={urlDataSource:l.b,itemUrlHelper:o.c,pageContext:d.a,vroomDataRequestor:c.a,identityDataSource:s.resourceKey},e}(),y=m.legacyGraphDataSourceKey,S=p.a?y:(0,i._y)("oneup-lightspeed/GraphDataSource",v)}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=n("odsp.util_152").x9.isActivated("fb3bead2-a0ae-4f8b-a7f4-c777ae0a7a93")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152"),i=new a.aF({name:"OneUpAuthTokenHelperAsync.key",loader:new a.xT(function(){return n.e(37).then(n.bind(n,676)).then(function(e){return e.authTokenHelperResourceKey})})})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(23);function i(){return window.ONEUPTELEMETRY_MANAGER=window.ONEUPTELEMETRY_MANAGER||(0,a.b)({sourceName:"OneUp"})}}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>_,b:()=>a,c:()=>h,d:()=>b,e:()=>v,f:()=>g});var a,i=n("tslib_538"),r=n(373),o=n(53),s=n(40),c=n(230),d=n(149),l=n("odsp.util_152"),u=n(357),f=n(42),p=n(98),m=function(e){function t(t,n){var a=e.call(this,n)||this;return a.name="NetworkError",a.status=t,a}return(0,i.e2)(t,e),t}(Error),_=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ManipulationError",n}return(0,i.e2)(t,e),t}(Error);!function(e){e.ExceedsMaximumLength="ExceedsMaximumLength"}(a||(a={}));var h=function(e){function t(n,a,i){var r=e.call(this,a)||this;return Object.setPrototypeOf(r,t.prototype),r.name="UploadError",r.type=n,r.url=i||"",r}return(0,i.e2)(t,e),t}(Error);function b(e,t){return(0,i.yv)(this,void 0,void 0,function(){return(0,i.SO)(this,function(n){return[2,Promise.all(e.map(function(e){return function(e,t){return(0,i.yv)(this,void 0,void 0,function(){var n;return(0,i.SO)(this,function(a){switch(a.label){case 0:if(!t)throw new Error("Invalid url");return[4,fetch(t,e)];case 1:if(!(n=a.sent()).ok)throw new m(n.status,"Fail to fetch file, url=".concat(t));return[2,n.arrayBuffer()]}})})}(t,e)}))]})})}function g(e,t){var n="".concat(t.webUrl,"/").concat(e).concat(".pdf");if(n.length>=400)throw new h(a.ExceedsMaximumLength,l.PN(d.t,n.length),n)}function v(e,t,a,d){return(0,i.yv)(this,void 0,void 0,function(){var l,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k;return(0,i.SO)(this,function(M){switch(M.label){case 0:return(null==d?void 0:d.webUrl)?[4,n.e(60).then(n.bind(n,650))]:[2,Promise.reject("")];case 1:return l=M.sent().SharePointUploader,m={name:e.name,size:e.size,slice:function(t,n){return e}},_=decodeURI(new URL(d.webUrl).pathname),h=decodeURI(d["@sharePoint.listUrl"]||""),b=a.getKey(((E={})[s.b.idParamKey]=_,E[s.b.listUrlKey]=h,E)),g=new f.a({},{pageContext:t}),v=new p.a({},{pageContext:t,itemUrlHelper:g}),y=g.getItemUrlParts(b),[4,new l({webApiUrl:v.build().webByItemUrl(y),fileUpload:m,throttler:new r.a({maxParallelUploads:1}),canStream:!0,dataRequestor:new o.b({},{pageContext:t,noRedirect:!0}),destinationUrl:y.serverRelativeItemUrl||"",nameConflictBehavior:u.a.rename,appName:"ODB OneUp viewer",onStart:function(){},onAbort:function(){},onProgress:function(e){}}).upload()];case 2:return S=M.sent(),D=a.getKey(((A={})[s.b.idParamKey]=S.ServerRelativeUrl,A)),I=h&&y.isCrossList,x=a.getKey((0,i.q5)(((L={})[s.b.idParamKey]=_,L),I?((k={})[s.b.listUrlKey]=h,k):{})),C={key:D||"",id:S.ServerRelativeUrl,type:c.a.File},O={key:x||"",id:y.serverRelativeItemUrl,type:c.a.Folder},w=a.getDefaultClickUrlForOneUp(C,{parentItem:O,urlType:"focus"}),[2,Promise.resolve(w)]}})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>c,c:()=>s,d:()=>o,e:()=>l});var a=n("tslib_538"),i=n(479),r=n(58),o=function(e){this.type="Qos",this.payload=(0,a.q5)((0,a.q5)({privacyClassification:"RequiredService"},e),{id:(0,i.a)(),status:r.b.Start,startTime:performance.now()})},s=function(e,t,n,i){this.type="Qos",this.payload=(0,a.q5)((0,a.q5)({privacyClassification:"RequiredService"},i),{id:e,name:t,status:n,endTime:performance.now()})},c=function(e){this.type="Engagement",this.payload=(0,a.q5)({privacyClassification:"OptionalDiagnostic"},e)},d=function(e){this.type="CaughtError",this.payload=(0,a.q5)({privacyClassification:"RequiredService"},e)},l=function(e){this.type="Verbose",this.payload=(0,a.q5)({privacyClassification:"OptionalDiagnostic"},e)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(){return"rtl"===(document.body&&document.body.getAttribute("dir")||document.documentElement.getAttribute("dir"))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_538"),i=/\{(\d+)\}/g;function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(i,function(e,n){var a=t[Number(n)];return null!==a?"".concat(a):""})}var o=function(){function e(e){this._strings=e}return Object.defineProperty(e.prototype,"strings",{get:function(){return this._strings},set:function(e){this._strings=e},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){if(!this._strings)return"";var n=this._strings[e];return t?r.apply(void 0,(0,a.lt)([n],(0,a.pM)(t),!1)):n},e}()}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n(101);function i(e){try{var t=new URL(e).toString().match(/\/([^\/?#]+)[^\/]*$/);return t&&t.length>1?t[1]:""}catch(t){return a.a.warn("UrlHelper",'Given url "'.concat(e,'" is invalid')),""}}function r(e){e.startsWith("www.")&&(e="https://".concat(e));try{switch(new URL(e).protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}catch(e){return!1}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_538");(0,n("fui.util_867").ZW)([{rawString:".screenReader_6d70c630{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}"}]);var i=function(){function e(){}return e.read=function(e,t){if(""!==e)for(var n=[e],a=this._getLiveNodes(n.length,t||0),i=function(e){window.setTimeout(function(){a[e].textContent=n[e]},500*(e+1))},r=0;r<n.length;r++)i(r)},e.clear=function(){var e,t;try{for(var n=(0,a.BW)(this._liveNodes),i=n.next();!i.done;i=n.next()){var r=i.value;document.body.removeChild(r)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._liveNodes=[]},e._getLiveNodes=function(e,t){this.clear();for(var n=[],a=0;a<e;a++){var i=document.createElement("div");switch(n.push(i),document.body.appendChild(i),i.classList.add("screenReader_6d70c630"),t){case 0:i.setAttribute("aria-live","polite");break;case 1:i.setAttribute("role","alert"),i.setAttribute("aria-live","assertive")}}return this._liveNodes=n,n},e._liveNodes=[],e}()}
,(e,t,n)=>{"use strict";function a(){if(window.devicePixelRatio)return Math.ceil(window.devicePixelRatio);if(window.matchMedia)for(var e=4;e>1;e=Math.round(10*(e-.1))/10)if(window.matchMedia("(-webkit-min-device-pixel-ratio: ".concat(e,")")).matches||window.matchMedia("(min-resolution: ".concat(e,"dppx)")).matches)return e;return 1}function i(e){return Math.floor(e*a())}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n(59),i=n(74),r=function(){function e(){this._eventMap={}}return e.prototype.on=function(e,t){this._eventMap[e]||(this._eventMap[e]=[]),this._eventMap[e].push(t)},e.prototype.off=function(e,t){var n,a=this._eventMap[e];!a||(n=a.indexOf(t))<0||a.splice(n,1)},e.prototype.dispatch=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this._eventMap[e]&&this._eventMap[e].forEach(function(n){try{n.apply(null,t)}catch(t){var r=new a.c(a.b.EventHandleFailed,"Fail to handle event ".concat(e,", error: ").concat(t));i.a.logError(r.toCaughtError())}})},e.prototype.dispose=function(){var e=this;Object.keys(this._eventMap).forEach(function(t){for(var n=e._eventMap[t],a=n.length;a>=0;a--)e.off(t,n[a])})},e}()}
,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>r,c:()=>o,d:()=>c,e:()=>u,f:()=>m,g:()=>f,h:()=>p,i:()=>_});var a=n(529);function i(e,t,n){let{reference:i,floating:r}=e;const o=(0,a.m)(t),s=(0,a.d)(t),c=(0,a.g)(s),d=(0,a.n)(t),l="y"===o,u=i.x+i.width/2-r.width/2,f=i.y+i.height/2-r.height/2,p=i[c]/2-r[c]/2;let m;switch(d){case"top":m={x:u,y:i.y-r.height};break;case"bottom":m={x:u,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:f};break;case"left":m={x:i.x-r.width,y:f};break;default:m={x:i.x,y:i.y}}switch((0,a.f)(t)){case"start":m[s]-=p*(n&&l?-1:1);break;case"end":m[s]+=p*(n&&l?-1:1)}return m}const r=async(e,t,n)=>{const{placement:a="bottom",strategy:r="absolute",middleware:o=[],platform:s}=n,c=o.filter(Boolean),d=await(null==s.isRTL?void 0:s.isRTL(t));let l=await s.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:f}=i(l,a,d),p=a,m={},_=0;for(let n=0;n<c.length;n++){const{name:o,fn:h}=c[n],{x:b,y:g,data:v,reset:y}=await h({x:u,y:f,initialPlacement:a,placement:p,strategy:r,middlewareData:m,rects:l,platform:s,elements:{reference:e,floating:t}});u=null!=b?b:u,f=null!=g?g:f,m={...m,[o]:{...m[o],...v}},y&&_<=50&&(_++,"object"==typeof y&&(y.placement&&(p=y.placement),y.rects&&(l=!0===y.rects?await s.getElementRects({reference:e,floating:t,strategy:r}):y.rects),({x:u,y:f}=i(l,p,d))),n=-1)}return{x:u,y:f,placement:p,strategy:r,middlewareData:m}};async function o(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:o,rects:s,elements:c,strategy:d}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:p=!1,padding:m=0}=(0,a.c)(t,e),_=(0,a.l)(m),h=c[p?"floating"===f?"reference":"floating":f],b=(0,a.q)(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(h)))||n?h:h.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(c.floating)),boundary:l,rootBoundary:u,strategy:d})),g="floating"===f?{...s.floating,x:i,y:r}:s.reference,v=await(null==o.getOffsetParent?void 0:o.getOffsetParent(c.floating)),y=await(null==o.isElement?void 0:o.isElement(v))&&await(null==o.getScale?void 0:o.getScale(v))||{x:1,y:1},S=(0,a.q)(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:g,offsetParent:v,strategy:d}):g);return{top:(b.top-S.top+_.top)/y.y,bottom:(S.bottom-b.bottom+_.bottom)/y.y,left:(b.left-S.left+_.left)/y.x,right:(S.right-b.right+_.right)/y.x}}const s=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:r,rects:o,platform:s,elements:c,middlewareData:d}=t,{element:l,padding:u=0}=(0,a.c)(e,t)||{};if(null==l)return{};const f=(0,a.l)(u),p={x:n,y:i},m=(0,a.d)(r),_=(0,a.g)(m),h=await s.getDimensions(l),b="y"===m,g=b?"top":"left",v=b?"bottom":"right",y=b?"clientHeight":"clientWidth",S=o.reference[_]+o.reference[m]-p[m]-o.floating[_],D=p[m]-o.reference[m],I=await(null==s.getOffsetParent?void 0:s.getOffsetParent(l));let x=I?I[y]:0;x&&await(null==s.isElement?void 0:s.isElement(I))||(x=c.floating[y]||o.floating[_]);const C=S/2-D/2,O=x/2-h[_]/2-1,w=(0,a.p)(f[g],O),E=(0,a.p)(f[v],O),A=w,L=x-h[_]-E,k=x/2-h[_]/2+C,M=(0,a.a)(A,k,L),P=!d.arrow&&null!=(0,a.f)(r)&&k!==M&&o.reference[_]/2-(k<A?w:E)-h[_]/2<0,T=P?k<A?k-A:k-L:0;return{[m]:p[m]+T,data:{[m]:M,centerOffset:k-M-T,...P&&{alignmentOffset:T}},reset:P}}}),c=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:s,rects:c,initialPlacement:d,platform:l,elements:u}=t,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:_="bestFit",fallbackAxisSideDirection:h="none",flipAlignment:b=!0,...g}=(0,a.c)(e,t);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const v=(0,a.n)(r),y=(0,a.n)(d)===d,S=await(null==l.isRTL?void 0:l.isRTL(u.floating)),D=m||(y||!b?[(0,a.k)(d)]:(0,a.h)(d));m||"none"===h||D.push(...(0,a.i)(d,b,h,S));const I=[d,...D],x=await o(t,g),C=[];let O=(null==(i=s.flip)?void 0:i.overflows)||[];if(f&&C.push(x[v]),p){const e=(0,a.e)(r,c,S);C.push(x[e[0]],x[e[1]])}if(O=[...O,{placement:r,overflows:C}],!C.every(e=>e<=0)){var w,E;const e=((null==(w=s.flip)?void 0:w.index)||0)+1,t=I[e];if(t)return{data:{index:e,overflows:O},reset:{placement:t}};let n=null==(E=O.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:E.placement;if(!n)switch(_){case"bestFit":{var A;const e=null==(A=O.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=d}if(r!==n)return{reset:{placement:n}}}return{}}}};function d(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function l(e){return a.s.some(t=>e[t]>=0)}const u=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...r}=(0,a.c)(e,t);switch(i){case"referenceHidden":{const e=d(await o(t,{...r,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:l(e)}}}case"escaped":{const e=d(await o(t,{...r,altBoundary:!0}),n.floating);return{data:{escapedOffsets:e,escaped:l(e)}}}default:return{}}}}},f=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:o,placement:s,middlewareData:c}=t,d=await async function(e,t){const{placement:n,platform:i,elements:r}=e,o=await(null==i.isRTL?void 0:i.isRTL(r.floating)),s=(0,a.n)(n),c=(0,a.f)(n),d="y"===(0,a.m)(n),l=["left","top"].includes(s)?-1:1,u=o&&d?-1:1,f=(0,a.c)(t,e);let{mainAxis:p,crossAxis:m,alignmentAxis:_}="number"==typeof f?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...f};return c&&"number"==typeof _&&(m="end"===c?-1*_:_),d?{x:m*u,y:p*l}:{x:p*l,y:m*u}}(t,e);return s===(null==(n=c.offset)?void 0:n.placement)&&null!=(i=c.arrow)&&i.alignmentOffset?{}:{x:r+d.x,y:o+d.y,data:{...d,placement:s}}}}},p=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,{mainAxis:s=!0,crossAxis:c=!1,limiter:d={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=(0,a.c)(e,t),u={x:n,y:i},f=await o(t,l),p=(0,a.m)((0,a.n)(r)),m=(0,a.j)(p);let _=u[m],h=u[p];if(s){const e="y"===m?"bottom":"right",t=_+f["y"===m?"top":"left"],n=_-f[e];_=(0,a.a)(t,_,n)}if(c){const e="y"===p?"bottom":"right",t=h+f["y"===p?"top":"left"],n=h-f[e];h=(0,a.a)(t,h,n)}const b=d.fn({...t,[m]:_,[p]:h});return{...b,data:{x:b.x-n,y:b.y-i}}}}},m=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:r,rects:o,middlewareData:s}=t,{offset:c=0,mainAxis:d=!0,crossAxis:l=!0}=(0,a.c)(e,t),u={x:n,y:i},f=(0,a.m)(r),p=(0,a.j)(f);let m=u[p],_=u[f];const h=(0,a.c)(c,t),b="number"==typeof h?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(d){const e="y"===p?"height":"width",t=o.reference[p]-o.floating[e]+b.mainAxis,n=o.reference[p]+o.reference[e]-b.mainAxis;m<t?m=t:m>n&&(m=n)}if(l){var g,v;const e="y"===p?"width":"height",t=["top","left"].includes((0,a.n)(r)),n=o.reference[f]-o.floating[e]+(t&&(null==(g=s.offset)?void 0:g[f])||0)+(t?0:b.crossAxis),i=o.reference[f]+o.reference[e]+(t?0:(null==(v=s.offset)?void 0:v[f])||0)-(t?b.crossAxis:0);_<n?_=n:_>i&&(_=i)}return{[p]:m,[f]:_}}}},_=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:i,platform:r,elements:s}=t,{apply:c=(()=>{}),...d}=(0,a.c)(e,t),l=await o(t,d),u=(0,a.n)(n),f=(0,a.f)(n),p="y"===(0,a.m)(n),{width:m,height:_}=i.floating;let h,b;"top"===u||"bottom"===u?(h=u,b=f===(await(null==r.isRTL?void 0:r.isRTL(s.floating))?"start":"end")?"left":"right"):(b=u,h="end"===f?"top":"bottom");const g=_-l[h],v=m-l[b],y=!t.middlewareData.shift;let S=g,D=v;if(p){const e=m-l.left-l.right;D=f||y?(0,a.p)(v,e):e}else{const e=_-l.top-l.bottom;S=f||y?(0,a.p)(g,e):e}if(y&&!f){const e=(0,a.o)(l.left,0),t=(0,a.o)(l.right,0),n=(0,a.o)(l.top,0),i=(0,a.o)(l.bottom,0);p?D=m-2*(0!==e||0!==t?e+t:(0,a.o)(l.left,l.right)):S=_-2*(0!==n||0!==i?n+i:(0,a.o)(l.top,l.bottom))}await c({...t,availableWidth:D,availableHeight:S});const I=await r.getDimensions(s.floating);return m!==I.width||_!==I.height?{reset:{rects:!0}}:{}}}}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>f});var a=n("tslib_538"),i=n("odsp.util_152"),r=n(56),o=n(54),s=n(5),c=n(545),d=n(39),l=!i.x9.isActivated("F7F844A1-C5CA-40D4-A9F1-D446600D3D5F"),u={oneUpStateStore:r.e,pageContext:s.a,getExecutor:c.a.async.lazy,identityDataSource:d.resourceKey},f=new i.aF({name:"SaveAction",factory:{dependencies:u,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n,i,r=!!(null===(i=null===(n=t.oneUpStateStore.getViewerState(e.item.key))||void 0===n?void 0:n.saveData)||void 0===i?void 0:i.fileUpload)&&o.a.hasItemPermission(e.item,o.a.editListItems),s=t.pageContext,c={isAvailable:r,id:"SaveAction",onExecute:function(n){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,t.getExecutor()];case 1:return[2,a.sent().executeSave({item:e.item,parentItem:e.parentItem,fileUpload:n.fileUpload,pageContext:s,oneUpStateStore:t.oneUpStateStore,saveascopy:n.saveascopy||!1,identityDataSource:t.identityDataSource,qosEvent:n.qosEvent})]}})})},customerPromise:l?{startSchema:{pillar:"Edit"},computeVeto:function(){return"Save Failure"}}:void 0};return c})}}}}})}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_538"),i=n(165),r=function(e){var t=i.b,n=t.palette,r=t.semanticColors,o="".concat(r.buttonBackground," !important"),s="".concat(r.buttonBackgroundHovered," !important"),c="".concat(r.buttonBackgroundPressed," !important");return{root:(0,a.q5)({},e),rootHovered:(0,a.q5)((0,a.q5)({cursor:"pointer"},e),{background:s}),rootPressed:{background:c},rootExpanded:(0,a.q5)({backgroundColor:o},e),rootCheckedHovered:(0,a.q5)((0,a.q5)({cursor:"pointer"},e),{background:s}),rootCheckedPressed:(0,a.q5)((0,a.q5)({},e),{background:c}),rootExpandedHovered:{background:s,cursor:"pointer"},flexContainer:{color:n.black,width:"auto"},icon:{color:n.black}}}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>P,b:()=>M,c:()=>L,d:()=>k});var a=n("tslib_538"),i=n("odsp.util_152"),r=n("react-lib"),o=n(596),s=n(148),c=n(55),d=n(42),l=n(39),u=n(34),f=n(336),p=n(41),m=n(597),_=n(600),h=n(606),b=n(12),g=n(67),v=(0,s.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(59)]).then(n.bind(n,732))];case 1:return[2,e.sent().ShareDialog]}})})});function y(e){var t,n=new i.K3,s=new d.a({},{pageContext:e.pageContext});t=(0,b.rb)()?s.getItemUrlParts(e.item.key).isCrossDomain:s.getItemUrlParts(e.item.key).isCrossList;var y=s.getItemUrlParts(e.item.key).fullWebUrl,S=(0,i.Ho)((0,i.qN)(window.location.href)),D=S.listurl,I=S.id;return e.onRender&&e.onRender(r.createElement(function(e){var t=Date.now();return r.createElement(v,{getSharingInformation:x,getClientId:function(){return"oneup"},initializeShareFrame:C,mode:o.a.share,resolve:function(){},reject:function(e){n.reject(e)},locale:c.a.language||"en-US",itemName:e.itemName||"",onShareReady:function(){},onShareLoaded:function(e){var t={resultType:e.resultType,extraData:(0,a.dc)(e,["resultType"])};n.resolve(t)},onModalClose:function(){e.onClose&&e.onClose()},clickTime:t})},(0,a.q5)({},e))),n.promise;function x(){if(t){var n=Date.now();return e.resources.consume(l.resourceKey).getSharePointToken(new u.a(y).authority,void 0,void 0,{apiQosName:"Sharing.getAuthToken",disallowSelfIssuedToken:(0,g.h)(g.g)}).then(function(t){var i={authToken:t.accessToken,webAbsoluteUrl:y,isODB:!0,itemName:e.itemName,listUrl:D,serverRelativeItemUrl:I,cookieAuthIframeUrlForCrossDomain:"".concat(e.pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=").concat(n)};return Promise.resolve((0,a.q5)({},i))})}var i="".concat(e.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?listId=").concat(e.listId,"&clientId=").concat("oneup","&listItemId=").concat(e.listItemId,"&mode=").concat(e.mode,"&fullScreenMode=true");return Promise.resolve({cookieAuthIframeUrl:i})}function C(n){var a,i,r,o=(0,h.a)("OneUpSharingModalContainer"),s=o[0],d=o[1];if(t&&s){s.style.position="relative",s.style.zIndex="10000000000000";var l={authToken:n.sharingInformation.authToken||"",clientId:"oneup",mode:Number(e.mode),listItemId:e.item.itemId||"",itemName:e.item.name||"",itemAppmap:e.item.appMap,itemType:e.item.type,itemExtension:e.item.extension,correlationId:null!==(i=null===(a=e.pageContext)||void 0===a?void 0:a.CorrelationId)&&void 0!==i?i:p.a.generate(),scenarioId:"OneUp-CrossList",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:f.a.sharepoint,serverRelativeItemUrl:I,listUrl:D,webAbsoluteUrl:y||"",locale:c.a.language||"en-US",fullScreenIframe:!0};new _.a({element:s,locale:l.locale,environment:null!==(r=e.pageContext.env2)&&void 0!==r?r:m.a.prod,disableIframeDomainCheck:!0,isConsumer:!1,context:l,styles:{minWidth:"480px"},clickTime:n.clickTime,options:{onError:function(e){},onReady:function(){console.log("sharePrefetch ready")},onTimeout:function(){},onDismiss:function(){d()}}}).initializeUI()}}}var S=new i.aF({name:"ShowShareDialog",factory:{dependencies:{},create:function(e){return{instance:{showShareDialog:y}}}}}),D=n(5),I=n(71),x=n(56),C=n(263),O="ShareAction",w="AddAgentToTeamsAction",E=function(e,t,n){return function(i){var r=function(e){var t;return!(null===(t=e.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)}(i.item);return t===w&&i.item.extension!==C.c&&i.item.extension!==C.d&&(r=!1),{isAvailable:r,id:t,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var t,i,r,o,s,c,d;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStore.getOneUpProperties())?(i=(0,b.rb)()&&(null===(s=null===(o=null==t?void 0:t.list)||void 0===o?void 0:o.list)||void 0===s?void 0:s.id)||e.pageContext.listId,r={listId:i,webAbsoluteUrl:e.pageContext.webAbsoluteUrl,listItemId:null===(d=null===(c=t.focusItem)||void 0===c?void 0:c.properties)||void 0===d?void 0:d.ID,mode:n,fullScreenMode:!0,itemName:t.focusItem.name,item:t.focusItem,pageContext:e.pageContext,resources:e.resources,onClose:function(){e.oneUpStateStore.updateModalState("shareCommand",{showModal:!1,content:void 0})},onRender:function(t){e.oneUpStateStore.updateModalState("shareCommand",{showModal:!0,content:t})}},[4,e.getExecutor()]):[3,3];case 1:return[4,a.sent().showShareDialog(r)];case 2:return[2,a.sent()];case 3:return[2]}})})}}}},A={getExecutor:S.async.lazy,pageContext:D.a,oneUpStore:I.b,resources:i.XQ,oneUpStateStore:x.e},L=new i.aF({name:"ShareAction",factory:{dependencies:A,create:function(e){return{instance:{evaluateAction:E(e,O,o.a.manageAccess)}}}}}),k=new i.aF({name:"ShareAction",factory:{dependencies:A,create:function(e){return{instance:{evaluateAction:E(e,O,o.a.share)}}}}}),M=new i.aF({name:"ShareAction",factory:{dependencies:A,create:function(e){return{instance:{evaluateAction:E(e,"CopyAction",o.a.copyLink)}}}}}),P=new i.aF({name:"ShareAction",factory:{dependencies:A,create:function(e){return{instance:{evaluateAction:E(e,w,o.a.copyLink)}}}}})}
,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152");function i(){return!a.x9.isActivated("6552AD7B-5349-4049-BB5F-536F9A742BB1")&&a.ov.isFeatureEnabled({ODB:62144})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_538"),i=n(270),r=n("react-lib"),o=r.createContext(void 0),s=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return r.createElement(o.Provider,{value:new i.a(n.strings)},t)},c=function(){return r.useContext(o)},d=function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n;return(0,a.SO)(this,function(i){switch(i.label){case 0:return[4,Promise.all([Promise.resolve().then(function(){var e=new Error("Cannot find module '../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e}),Promise.resolve().then(function(){var e=new Error("Cannot find module '@ms/file-annotation-bar/lib/l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})])];case 1:return e=a.pM.apply(void 0,[i.sent(),2]),t=e[0],n=e[1],[2,(0,a.q5)((0,a.q5)({},t.default),n.default)]}})})}}
,,(e,t,n)=>{"use strict";var a,i;n.d(t,{a:()=>i,b:()=>a}),function(e){e.FreeText="FreeText",e.Pen="Pen",e.Highlighter="Highlighter",e.Eraser="Eraser",e.PointEraser="PointEraser",e.Display="Display"}(a||(a={})),function(e){e.DarkYellow="#FED430",e.LightOrange="#FBAE17",e.Orange="#F36323",e.Red="#E3182D",e.DarkPurple="#5B318D",e.Purple="#914BB8",e.Magenta="#CF1278",e.DarkRed="#C10051",e.LightBlue="#3ECCFD",e.Blue="#0078D7",e.DarkBlue="#0051BA",e.LightGreen="#7EC400",e.Green="#00B44B",e.LightGrey="#EBEBEB",e.Grey="#B6B6B6",e.Black="#1F1F1F"}(i||(i={}))}
,,(e,t,n)=>{"use strict";n.d(t,{A:()=>r,B:()=>g,C:()=>s,D:()=>c,E:()=>i,F:()=>p,G:()=>m,H:()=>f,I:()=>o,J:()=>h,K:()=>x,L:()=>B,a:()=>C,b:()=>b,c:()=>I,d:()=>D,e:()=>S,f:()=>u,g:()=>l,h:()=>O,i:()=>_,j:()=>d,k:()=>v,l:()=>y,m:()=>P,n:()=>L,o:()=>k,p:()=>M,q:()=>A,r:()=>E,s:()=>a,t:()=>w,u:()=>N,v:()=>H,w:()=>F,x:()=>U,y:()=>R,z:()=>T}),(0,n("fui.util_867").ZW)([{rawString:".OneUpModal_b77516d0 .OneUpRoot_b77516d0{display:flex;flex-direction:row;position:absolute;top:45px;left:0;right:0;bottom:0}.OneUpModal_b77516d0 .OneUpRoot_b77516d0 .OneUpRightPane_b77516d0{min-width:320px}.OneUpModal_b77516d0 .OneUpRoot_b77516d0 .OneUpVersionHistoryRightPane_b77516d0{min-width:320px;overflow-y:auto!important}.OneUpModal_b77516d0 .OneUpRootLightBackground_b77516d0{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpModal_b77516d0 .OneUpRootDarkBackground_b77516d0{background-color:rgba(0,0,0,0)}.OneUpModal_b77516d0 [data-automation-id=CopilotPaneCommand]{min-width:32px!important;width:32px!important;margin:4px 2px!important}.OneUpModal_b77516d0 [data-automation-id=commentCommand]{margin:4px 2px!important;width:32px!important}.OneUpModal_b77516d0 .OneUpRootNoCommandBar_b77516d0{display:flex;flex-direction:column;position:absolute;top:0;left:0;right:0;bottom:0}.OneUpModal_b77516d0 .OneUpDetailsPane_b77516d0{position:relative;width:380px;height:100%}@media (width <= 380px){.OneUpModal_b77516d0 .OneUpDetailsPane_b77516d0{width:100%}}.OneUpModal_b77516d0 .OneUpCommentsPane_b77516d0{padding:10px 10px 10px 20px;width:340px;height:calc(100% - 60px)}.OneUpModal_b77516d0 .OneUpCommentsPane_b77516d0 .OneUpCommentsPaneTitle_b77516d0{display:flex;align-items:center;font-family:sans-serif;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.OneUpModal_b77516d0 .OneUpVersionHistoryPane_b77516d0{padding:10px;width:630px}.OneUpModal_b77516d0 .OneUpVersionHistoryPane_b77516d0 .OneUpVersionHistoryPaneHeader_b77516d0{display:flex;justify-content:space-between;align-items:center;padding:10px}.OneUpModal_b77516d0 .OneUpVersionHistoryPane_b77516d0 .OneUpVersionHistoryPaneHeader_b77516d0 .OneUpVersionHistoryPaneTitle_b77516d0{font-size:20px;font-weight:600;font-family:sans-serif;margin:0}.OneUpModal_b77516d0 .OneUpDetailsPaneSpinner_b77516d0{height:100%;display:flex;justify-content:center;align-items:center}.OneUpModal_b77516d0 .OneUpViewer_b77516d0{position:relative;flex:1 1 auto}.OneUpModal_b77516d0 .OneUpAccessibleLoadAnnouncement_b77516d0{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUpModal_b77516d0 .OneUpCommandBar_b77516d0{display:flex;justify-content:space-between}.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0{opacity:0;transition:opacity 367ms linear,visibility 367ms linear,transform 367ms linear}.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0.OneUpEntrance_b77516d0{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0.OneUpExit_b77516d0{opacity:0;visibility:hidden}.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0.OneUpEntranceV2_b77516d0{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0.OneUpExitV2_b77516d0{opacity:0;visibility:hidden}@media (prefers-reduced-motion){.OneUpModal_b77516d0 div.OneUpRootAnimation_b77516d0{transition:unset;opacity:1;visibility:inherit}}.OneUpCommandButtonPrimary_b77516d0{margin-left:5px;margin-right:5px}.OneUpCommandButtonPrimaryWhite_b77516d0{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpCommandButtonPrimaryWhiteV2_b77516d0{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"!important;border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"!important}.PreviousButton_b77516d0{position:absolute;top:50%;left:32px;z-index:9999}.NextButton_b77516d0{position:absolute;top:50%;right:32px}.OneUpContextMenuCommandIcon_b77516d0{display:flex}.OneUpNewBadge_b77516d0{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.OneUpHelpMenuOption_b77516d0{border:transparent;margin:5px}.OneUpHelpButton_b77516d0{width:32px;height:32px;position:absolute;bottom:12px;right:24px;z-index:99999;display:flex;flex-direction:column;align-items:center}.OneUpHelpButton_b77516d0 i{font-size:16px}.OneUpHelpButtonPerfBtnOpen_b77516d0{right:249px}.OneUpHelpButtonRightPaneOpen_b77516d0{right:364px}.OneUpHelpButtonVersionHistoryPaneOpen_b77516d0{right:694px}.OneUpHelpButtonDetailsPaneOpen_b77516d0{right:424px}.OneUpPerfButton_b77516d0{position:absolute;bottom:0;right:0;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;box-shadow:0 0 5px "},{theme:"black",defaultValue:"#000"},{rawString:";border-top-left-radius:10px;border-top-right-radius:10px}.OneUpPerfButton_b77516d0 .OneUpPerfButtonHeader_b77516d0{display:flex;flex-direction:row;justify-content:space-between;width:100%;border-radius:inherit}.OneUpPerfButton_b77516d0 .OneUpPerfButtonHeaderText_b77516d0{margin-top:5px;margin-left:10px}.OneUpPerfButton_b77516d0 .OneUpPerfButtonDivider_b77516d0{margin-left:10px;margin-right:10px}.OneUpPerfButton_b77516d0 .OneUpPerfButtonLink_b77516d0{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUpPerfButton_b77516d0 .OneUpPerfButtonContent_b77516d0{margin:10px;display:flex;flex-direction:row;align-items:flex-end}.versionHistoryNumber_b77516d0:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}::-webkit-scrollbar{width:14px;height:14px;scrollbar-width:thin;scrollbar-color:#605e5c transparent}::-webkit-scrollbar-thumb{-webkit-background-clip:content-box;background-clip:content-box;border-radius:8px;border:4px solid transparent;background-color:#605e5c}::-webkit-scrollbar-thumb:hover{background-color:#3b3a39}::-webkit-scrollbar-button{display:none}::-webkit-scrollbar-corner{background:0 0}@media (forced-colors:active){::-webkit-scrollbar{scrollbar-color:CanvasText transparent}::-webkit-scrollbar-thumb{background-color:CanvasText;border:4px solid Window}}"}]);const a="OneUpModal_b77516d0",i="OneUpRoot_b77516d0",r="OneUpRightPane_b77516d0",o="OneUpVersionHistoryRightPane_b77516d0",s="OneUpRootDarkBackground_b77516d0",c="OneUpRootNoCommandBar_b77516d0",d="OneUpDetailsPane_b77516d0",l="OneUpCommentsPane_b77516d0",u="OneUpCommentsPaneTitle_b77516d0",f="OneUpVersionHistoryPane_b77516d0",p="OneUpVersionHistoryPaneHeader_b77516d0",m="OneUpVersionHistoryPaneTitle_b77516d0",_="OneUpDetailsPaneSpinner_b77516d0",h="OneUpViewer_b77516d0",b="OneUpAccessibleLoadAnnouncement_b77516d0",g="OneUpRootAnimation_b77516d0",v="OneUpEntranceV2_b77516d0",y="OneUpExitV2_b77516d0",S="OneUpCommandButtonPrimary_b77516d0",D="OneUpCommandButtonPrimaryWhite_b77516d0",I="OneUpCommandButtonPrimaryWhiteV2_b77516d0",x="PreviousButton_b77516d0",C="NextButton_b77516d0",O="OneUpContextMenuCommandIcon_b77516d0",w="OneUpNewBadge_b77516d0",E="OneUpHelpMenuOption_b77516d0",A="OneUpHelpButton_b77516d0",L="OneUpHelpButtonPerfBtnOpen_b77516d0",k="OneUpHelpButtonRightPaneOpen_b77516d0",M="OneUpHelpButtonVersionHistoryPaneOpen_b77516d0",P="OneUpHelpButtonDetailsPaneOpen_b77516d0",T="OneUpPerfButton_b77516d0",U="OneUpPerfButtonHeader_b77516d0",F="OneUpPerfButtonHeaderText_b77516d0",H="OneUpPerfButtonDivider_b77516d0",R="OneUpPerfButtonLink_b77516d0",N="OneUpPerfButtonContent_b77516d0",B="versionHistoryNumber_b77516d0"}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>l,c:()=>o,e:()=>s,d:()=>r.a,f:()=>d});var a=n("odsp.util_152"),i=(n(393),n(188),n(120)),r=(new a.aF("list"),new a.aF("oAuthTokenDataSource"),new a.aF("siteScripts"),n(747),n(85)),o=(new a.aF("recentList"),new a.aF("prefetchCache"),new a.aF("folder"),new a.aF("appsItem"),new a.aF("externallySharedItem"),new a.aF("popularItem"),new a.aF("subsiteItem"),new a.aF("mostViewsItem"),new a.aF("mostViewersItem"),new a.aF("settings"),new a.aF("getItem"),new a.aF("items"),new a.aF("versionControl"),new a.aF("versionHistory"),new a.aF("vault"),i.a),s=(new a.aF("peopleCardFactory"),new a.aF("peopleCard"),new a.aF("language"),new a.aF("languagePicker"),new a.aF("leftNav"),new a.aF("search"),new a.aF("sharing"),new a.aF("sharingLightSpeed"),new a.aF("sharingData"),new a.aF("groups"),new a.aF("suiteNav"),new a.aF("iosMobileAppPath"),new a.aF("url")),c=(new a.aF("universalAnnotation"),new a.aF("download")),d=(new a.aF("docFormat"),new a.aF("footer"),new a.aF("manifests"),new a.aF("itemActivityFeed"),new a.aF("itemActivityFeedHelper"),new a.aF("itemActivityFeedSharingHelper"),new a.aF("userInfo"),new a.aF("storageInfo"),new a.aF("storageOptions"),new a.aF("album"),new a.aF("tag"),new a.aF("shareByLink"),new a.aF("folderItemCount"),new a.aF("photo"),new a.aF("subscriptions"),new a.aF("analytics"),new a.aF("sendFeedback"),new a.aF("embed"),new a.aF("application"),new a.aF("policyTip"),new a.aF("policyTipLightSpeed"),new a.aF("customAction"),new a.aF("taxonomy"),new a.aF("web"),new a.aF("floodgate"),new a.aF("shortcutsDS"),new a.aF("encoding"),new a.aF("rating"),new a.aF("publish"),new a.aF("videoItem")),l=(new a.aF("sites"),new a.aF("copy"),new a.aF("upsell"),new a.aF("notifications"),new a.aF("command"),new a.aF("processFilters"),new a.aF("quota"),new a.aF("itemColumn"),new a.aF("bundle"),new a.aF("itemPicker"),new a.aF("site"),new a.aF("pushChannel"),new a.aF("itemAutoRefresh"),new a.aF("loginApp"),new a.aF("mruRecent"),new a.aF("pdf"),new a.aF("zip"),new a.aF("url2"),new a.aF("attachments"),new a.aF("spotlight"),new a.aF("error"),new a.aF("promotedPhotos"),new a.aF("fileHandler"),new a.aF("fileHandlerFromCache"),new a.aF("recycleBin"),new a.aF("deleteRestore"),new a.aF("instrumentation"),new a.aF("shadowCall"),new a.aF("graph"));new a.aF("formula"),new a.aF("appUrl"),new a.aF("graphUrl"),new a.aF("batchUploaderType"),new a.aF("vroomItemIdentityProcessor"),new a.aF("preAuth"),new a.aF("peopleService"),new a.aF("schema"),new a.aF("restore"),new a.aF("restore"),new a.aF("restoreActivities"),new a.aF("inAppMessaging"),new a.aF("notificationSettings"),new a.aF("itemInvalidator"),new a.aF("itemUpdator"),new a.aF("wopiFrame"),new a.aF("wrs"),new a.aF("excel"),new a.aF("winAppCommunicator"),new a.aF("wip"),new a.aF("worker"),new a.aF("checkUserAccessDataSource"),new a.aF("userExpiration"),new a.aF("itemMuteNotificationDataSource"),new a.aF("ticketRedeemer"),new a.aF("recommendList"),new a.aF("reportAbuse"),new a.aF("requestReview"),new a.aF("removeFromShareWithMeList")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(e){this.viewHandler=e.viewHandler,this.inputEvtHandler=e.inputEvtHandler,this.metadata=e.metadata}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("clientName")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n(5),i=n(21),r=n(98),o=n("odsp.util_152"),s="ApiUrlHelper",c=new o.aF({name:"".concat(s,".encodeWebAbsoluteUrl"),factory:new o.KS(!0)}),d=(0,o._y)(s,r.a,{itemUrlHelper:i.c,pageContext:a.a,encodeWebAbsoluteUrl:c})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>o,c:()=>l,d:()=>d});var a=n("tslib_538"),i=n(270),r=n("react-lib"),o=function(e){return new i.a(e)},s=r.createContext(void 0),c=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return r.createElement(s.Provider,{value:o(n.strings)},t)},d=function(){return r.useContext(s)},l=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){var e=new Error("Cannot find module '../../l10n/Strings.resx'");throw e.code="MODULE_NOT_FOUND",e})];case 1:return[2,e.sent().default]}})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c.a,b:()=>d.o,c:()=>d.r,d:()=>l.f,f:()=>a.c,e:()=>a.b});var a=n(177),i=n(190),r=(n(206),n("tslib_538")),o=n("react-lib"),s=n("react-dom-lib"),c=(function(){function e(e,t){this.container=e,this.render(t)}e.prototype.render=function(e){var t=this;s.render(o.createElement(i.a,(0,r.q5)({},(0,r.q5)((0,r.q5)({},e),{componentRef:function(e){t._innerRef=e}}))),this.container)},e.prototype.dispose=function(){s.unmountComponentAtNode(this.container)},Object.defineProperty(e.prototype,"innerRef",{get:function(){return this._innerRef},enumerable:!1,configurable:!0})}(),n(31)),d=n(66),l=n(65);n(127)}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>l,c:()=>d});var a=n("tslib_538"),i=n("react-lib"),r=n.n(i),o={setMode:function(){},resetPageSelection:function(){},subscribe:function(){},unsubscribe:function(){},toggle:function(){}},s=(0,i.createContext)(o),c=(0,i.createContext)(function(){}),d=function(){return r().useContext(s)},l=function(){var e=r().useContext(c);return(0,i.useCallback)(function(t){e(function(e){return(0,a.q5)((0,a.q5)({},e),t)})},[e])},u=function(e){var t=e.children,n=(0,a.pM)((0,i.useState)(o),2),d=n[0],l=n[1];return r().createElement(c.Provider,{value:l},r().createElement(s.Provider,{value:d},t))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>d,c:()=>s,d:()=>o});var a=n("tslib_538"),i=n(73),r=n(65),o=function(e,t,n,o){var s,c,d,l,u,f=(0,a.pM)([e.x,e.y],2),p=f[0],m=f[1],_=(0,a.pM)([e.width,e.height],2),h=_[0],b=_[1];switch(o){case r.f.Degree90:p=(s=(0,a.pM)([t.height-m-b,p],2))[0],m=s[1],h=(c=(0,a.pM)([b,h],2))[0],b=c[1];break;case r.f.Degree180:p=(d=(0,a.pM)([t.width-p-h,t.height-m-b],2))[0],m=d[1];break;case r.f.Degree270:p=(l=(0,a.pM)([m,t.width-p-h],2))[0],m=l[1],h=(u=(0,a.pM)([b,h],2))[0],b=u[1]}return new i.b(p,m,h,b).scale(n||1)},s=function(e,t,n,a,r){var s=e.x,c=e.y,d=void 0===r?{width:0,height:0}:r,l=d.width,u=d.height;return o(new i.b(s,c,l,u),t,n,a)},c=function(e,t,n,o){var s,c,d,l=(0,a.pM)([e.x/n,e.y/n],2),u=l[0],f=l[1];switch(o){case r.f.Degree90:u=(s=(0,a.pM)([f,t.height-u],2))[0],f=s[1];break;case r.f.Degree180:u=(c=(0,a.pM)([t.width-u,t.height-f],2))[0],f=c[1];break;case r.f.Degree270:u=(d=(0,a.pM)([t.width-f,u],2))[0],f=d[1]}return new i.a(u,f)},d=function(e,t,n,a,o){var s=e.left,c=e.top,d=e.bottom,l=e.right,u=function(e,t){return new i.a(e*a+n,t*a)};switch(o){case r.f.Degree0:return u(s,d);case r.f.Degree90:return u(s,c);case r.f.Degree180:return u(t?l:s,c);case r.f.Degree270:return u(l,t?d:c);default:return new i.a(0,0)}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n("react-lib"),i=a.createContext(!1),r=function(e){var t=e.children,n=e.ariaHidden;return a.createElement(i.Provider,{value:n},t)},o=function(){return a.useContext(i)}}
,,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>i}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={}));const i=a}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>j});for(var a=n("odsp.util_152"),i=n("tslib_538"),r=n(50),o=n(53),s=n(29),c=n(11),d=n(242),l=a.x9.isActivated("C134DFC3-6FF8-4D99-B5C2-E2DB36121E98"),u=a.x9.isActivated("E6AD62F8-51A5-4763-9734-7DC476E4FD1E"),f=function(){function e(e,t){var n=this,s=t.cookieRefresher,c=t.pageContext,d=t.noRedirect,l=void 0===d?!a.x9.isActivated("22A14184-8C68-4EA3-8CA6-09C8A9009A71")||void 0:d;this._pageContext=c;var u=s?{getFormDigest:function(e){return(0,i.yv)(n,void 0,void 0,function(){return(0,i.SO)(this,function(t){switch(t.label){case 0:return[4,s.refreshCookies({resource:e.url,expiration:e.expiration,claimsChallenge:e.claimsChallenge})];case 1:return t.sent(),[2,void 0]}})})}}:void 0;this._dataRequestor=new o.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:c,tokenProvider:u,noRedirect:l}),this._apiUrlHelper=new r.a({webAbsoluteUrl:c.webAbsoluteUrl})}return e.prototype.getToken=function(e){var t=e.name,n=e.resource,r=e.tokenType,o=e.apiQosName,f={resource:n,tokenType:r};if(!a.x9.isActivated("3985CFAD-51BE-4D3E-A7F9-F1C2ADFD85E4","09/18/2023","Validate that self-signed resource is in tenant")){var p=new c.b({context:this._pageContext}).getUrlParts({webUrl:n});if("SPO"===r&&p.geoRelation===c.a.unknown)throw new a.qt({code:"InvalidTenantForSelfSignedToken"})}var m=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return this._dataRequestor.getData((0,i.q5)((0,i.q5)({url:m},a.x9.isActivated("ECF051DF-4CDB-49D4-95EC-081750BF0F41")?{}:{webAbsoluteUrl:this._pageContext.webAbsoluteUrl}),{method:"POST",qosName:u?"AcquireToken."+t:"AcquireToken.getToken.".concat(t),additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},allowOAuth:!1,parseResponse:function(e,t){var n=JSON.parse(e),a=t.getCorrelationId();return(0,i.q5)((0,i.q5)({},n),{correlationId:a})},additionalPostData:JSON.stringify(f),telemetryHandler:function(e){var t=e.errorData,n=e.eventData,r=n;if(t){var c=t.code;if(c&&(c.indexOf("0x80070005")>-1||c.indexOf("10012")>-1)){if(a.x9.isActivated("CA0F7D1A-8CFF-448C-9522-D43AFF8278E2"))return{eventData:(0,i.q5)((0,i.q5)({},n),{resultType:s.a.ExpectedFailure})};r=(0,d.c)(r,{resultType:s.a.ExpectedFailure})}}return!l&&o&&(r=(0,d.c)(r,{objectType:o})),{eventData:r}}}))},e}(),p=n(5),m=n(379),_=n(189),h=(0,a._y)("acquireTokenFetcher",f,{pageContext:p.a,cookieRefresher:m.a.optional,noRedirect:_.a}),b=n(30),g=n(67),v=n(403),y=!a.x9.isActivated("6D3806B1-CBBF-4E34-A4CD-177A8E27D6EF"),S=n(183),D=n(7),I=a.x9.isActivated("EAFC78CF-880E-49EE-B4BB-4EC0F8D62A61"),x=a.x9.isActivated("4F1CD7E0-DB72-441F-B805-84BDF8650728"),C=a.x9.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),O=a.x9.isActivated("b34b53db-eebd-41ab-a952-cea4ecae7061"),w=a.x9.isActivated("FCE15EEB-B33F-48C7-B6B0-01C53F4E3F22"),E=new Set,A=0,L=["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",S.a];A<L.length;A++){var k=L[A];E.add(k)}var M=function(){function e(e,t){this._acquireTokenFetcher=t.acquireTokenFetcher,this._spHttpTokenFetcher=t.spHttpTokenFetcher,this._appPageContext=t.appPageContext,this._isMsalSupported=t.isMsalSupported,this._isSubstrateAcquireDisabled=t.isSubstrateAcquireDisabled}return e.prototype.getToken=function(e){var t;return(0,i.yv)(this,void 0,void 0,function(){var n,a;return(0,i.SO)(this,function(r){switch(r.label){case 0:return n=e.scopes,O||w||"oAuth-SA"===e.name||(n=(t=e).scopes,e=(0,i.dc)(t,["scopes"])),function(e,t){return!(!x&&!new D.a(e).authority)&&new c.b({context:t}).getUrlParts({path:e}).geoRelation!==c.a.unknown}(a=e.resource,this._appPageContext)?this._isMsalSupported()?(0,b.a)(g.d)?"SPO"!==e.tokenType&&"SharePoint"!==e.name&&"SharePoint_SelfIssued"!==e.name&&"SharePoint_MSAL"!==e.name?[3,2]:[4,this._spHttpTokenFetcher.getToken(e)]:[3,2]:[3,4]:[3,6];case 1:case 3:case 5:case 7:case 9:case 11:case 13:case 15:case 17:case 19:case 21:case 23:case 25:return[2,r.sent()];case 2:return"SharePoint_MSAL"!==e.name&&"oAuth-SA"!==e.name?[3,4]:[4,this._spHttpTokenFetcher.getToken(e)];case 4:case 24:return[4,this._acquireTokenFetcher.getToken(e)];case 6:return this._isMsalSupported()?a!==this._appPageContext.msGraphEndpointUrl&&"ms-graph"!==e.name?[3,10]:(0,b.a)(g.c)?[4,this._spHttpTokenFetcher.getToken(e)]:[3,8]:[3,22];case 8:return C?[3,10]:n&&(n.indexOf("InformationProtection.Read.All")>-1||n.indexOf("InformationProtectionPolicy.Read")>-1||n.indexOf("Calendars.Read")>-1)?[4,this._spHttpTokenFetcher.getToken(e)]:[3,10];case 10:return"SharePoint-mediaGPT"!==e.name||I?[3,12]:[4,this._spHttpTokenFetcher.getToken(e)];case 12:return this._isSubstrateAcquireDisabled()?a!==this._appPageContext.substrateEndpointUrl&&"ms-substrate"!==e.name&&"ms-substrate-search"!==e.name&&"ms-substrate-sti"!==e.name&&"ms-substrate-tenant-feedback"!==e.name&&"STI"!==e.tokenType?[3,14]:[4,this._spHttpTokenFetcher.getToken(e)]:[3,14];case 14:return(0,b.a)(g.b)?"power-platform"!==e.name&&"ms-augloop"!==e.name&&"ocps"!==e.name?[3,16]:[4,this._spHttpTokenFetcher.getToken(e)]:[3,16];case 16:return C||"az-nb"!==e.name&&"office-home"!==e.name?[3,18]:[4,this._spHttpTokenFetcher.getToken(e)];case 18:return I?[3,22]:"ms-mcu"!==e.name&&"ms-forms"!==e.name&&"pushchannel"!==e.name&&"teams-cmd"!==e.name&&"oAuth-SA"!==e.name&&"ocps"!==e.name&&"ms-augloop"!==e.name&&"ms-substrate-tenant-feedback"!==e.name&&"az-rms"!==e.name&&"power-platform"!==e.name&&"your-phone"!==e.name?[3,20]:[4,this._spHttpTokenFetcher.getToken(e)];case 20:return"oAuth"!==e.name?[3,22]:E.has(a)?[4,this._spHttpTokenFetcher.getToken(e)]:[3,22];case 22:return y&&(0,v.a)(a)?[4,this._spHttpTokenFetcher.getToken((0,i.q5)((0,i.q5)({},e),{scopes:["onedrive_implicit.access"]}))]:[3,24]}})})},e}(),P=!a.x9.isActivated("3CA3181A-AA3E-4895-BF73-D6089D92C8F5"),T=!a.x9.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32"),U=function(){function e(e,t){this._getSpHttpDataSource=t.getSpHttpDataSource}return e.prototype.getToken=function(e){return(0,i.yv)(this,void 0,void 0,function(){var t,n,r,o,s,c,d,l,u,f;return(0,i.SO)(this,function(p){switch(p.label){case 0:return t=e.name,n=e.resource,r=e.claimsChallenge,o=e.expiration,s=e.apiQosName,c=e.scopes,[4,this._getSpHttpDataSource()];case 1:return d=p.sent(),a.x9.isActivated("3B1DC6CF-0E94-43F6-B4BA-B539850368AF")?[3,3]:[4,d.fetchTokenData((0,i.q5)({resource:n,claims:null==r?void 0:r.claims,forceRefresh:!!o,tokenName:T?t:void 0,apiQosName:P?s:""},y?{scopes:c}:{}))];case 2:return l=p.sent(),f=l.accessToken,u=l.expiresOn,[2,{access_token:f,expires_on:null==u?void 0:u.toISOString()}];case 3:return[4,d.fetchToken((0,i.q5)({resource:n,claims:null==r?void 0:r.claims,forceRefresh:!!o,apiQosName:P?s:""},y?{scopes:c}:{}))];case 4:return[2,{access_token:f=p.sent()}]}})})},e}(),F=n(203),H=(0,a._y)("spHttpTokenFetcher",U,{getSpHttpDataSource:F.a.async.lazy.bypass}),R=new a.aF({name:"isMsalSupported",factory:new a.KS(function(){return!0})}),N=n(204),B=(0,a._y)("spHttpTokenFetcherWithAcquireFallback",M,{acquireTokenFetcher:h,spHttpTokenFetcher:H,appPageContext:p.a,isMsalSupported:R,isSubstrateAcquireDisabled:N.a}),j=new a.aF({name:"TokenFetcher.key",factory:a.x9.isActivated("FCE65CD8-35FD-4D3E-89B9-F9775A150B21")?new a.BS(h):new a.BS(B)})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n(66),i=function(){function e(){}return e.normalizeScale=function(e,t){void 0===t&&(t=1);var n=Math.pow(10,t);return Math.round(e*n)/n},e.normalizeScaleWithMinMaxScale=function(e,t,n){void 0===n&&(n=1);var a=Math.pow(10,n),i=Math.round(t*a)/a;return t/e>=1?Math.min(this._maxScale,i):Math.max(this._minScale,i)},e.setMinMaxScale=function(e,t){this._minScale=e,this._maxScale=t},e._minScale=a.v,e._maxScale=a.u,e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("react-lib"),i=a.createContext(void 0),r=function(){return a.useContext(i)},o=function(e){var t=e.children,n={enableFormFilling:e.enableFormFilling,formHandler:e.formHandler};return a.createElement(i.Provider,{value:n},t)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.r(t),n.d(t,{oneDriveDataSourceKey:()=>o});var a=n("odsp.util_152"),i=n(412),r=n(5),o=new a.aF({name:"OneDriveDataSource.key",factory:{dependencies:{pageContext:r.a},create:function(e){var t=e.pageContext,n=new i.default({},{pageContext:t});return{instance:n,disposable:n}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("fui.util_867"),i={AcceptMedium:"",Accounts:"",Add:"",AddFriend:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AppIconDefault:"",Ascending:"",Attach:"",AutomateFlow:"",Back:"",BackToWindow:"",Blocked12:"",Blocked2:"",BlockedSite:"",BlockedSiteSolid12:"",BooleanData:"",CalculatorAddition:"",CalculatorMultiply:"",Calendar:"",CalendarDay:"",CalendarWeek:"",CalendarWorkWeek:"",Cancel:"",CC:"",CCSolid:"",Chat:"",CheckboxComposite:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CheckMark:"",ChevronDown:"",ChevronDownSmall:"",ChevronLeft:"",ChevronLeftMed:"",ChevronLeftSmall:"",ChevronRight:"",ChevronRightMed:"",ChevronRightSmall:"",ChevronUp:"",ChoiceColumn:"",ChromeClose:"",CircleAdditionSolid:"",CirclePlus:"",CircleRing:"",Clear:"",ClearFilter:"",ClosePaneMirrored:"",CloudPrinter:"",Color:"",Comment:"",CommentAdd:"",CompassNW:"",Completed:"",CompletedSolid:"",Contact:"",Copy:"",CriticalErrorSolid:"",Currency:"",DateTime2:"",Delete:"",Descending:"",Diamond:"",Document:"",DocumentApproval:"",Down:"",Download:"",DynamicList:"",Edit:"",EditListPencil:"",EditNote:"",Embed:"",EntityExtraction:"",Error:"",ErrorBadge:"",ExcelDocument:"",ExcelLogo:"",FabricFolder:"",FabricFolderLink:"",FabricMovetoFolder:"",FabricOpenFolderHorizontal:"",Favicon:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileRequest:"",Filter:"",Flag:"",Flow:"",Folder:"",FullScreen:"",FullView:"",GenericScan:"",Glimmer:"",GlobalNavButton:"",Globe:"",Go:"",GridViewMedium:"",GripperBarVertical:"",GripperDotsVertical:"",GroupedList:"",GroupList:"",Handwriting:"",Heart:"",HeartFill:"",History:"",Home:"",HomeGroup:"",Info:"",InfoSolid:"",LargeGrid:"",Library:"",Lightbulb:"",Link:"",Link12:"",List:"",Lock:"",Mail:"",MailAttached:"",Market:"",Megaphone:"",MicrosoftTranslatorLogo:"",More:"",MoreVertical:"",Number:"",ODLink:"",OneDriveAdd:"",OpenFile:"",OpenFolderHorizontal:"",OpenPane:"",OpenPaneMirrored:"",OutlookLogo:"",Page:"",PDF:"",People:"",PeopleAdd:"",Photo2:"",Pin:"",Pinned:"",PinnedSolid:"",PinSolid12:"",PinSolidOff12:"",PinToTab:"",Play:"",PlayerSettings:"",PlaylistMusic:"",POI:"",PopExpand:"",PowerApps2Logo:"",PowerAutomateLogo:"",PowerPointDocument:"",ReadingMode:"",ReadOutLoud:"",RecycleBin:"",ReminderPerson:"",RemoveFilter:"",Rename:"",Reply:"",Ringer:"",SavedOffline:"",Search:"",SecurityGroup:"",Send:"",Settings:"",Share:"",ShareiOS:"",Signin:"",SingleBookmark:"",SingleBookmarkSolid:"",SingleColumnEdit:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",Snooze:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",Speech:"",SpeechOff:"",StackIndicator:"",StatusCircleCheckmark:"",Stop:"",Switch:"",SyncStatusSolid:"",SyncToPC:"",Tag:"",TagUnknown12:"",TagUnknown12Mirror:"",Taskboard:"",TeamsLogo:"",TextDocument:"",TextDocumentShared:"",Archive:"",TextField:"",Tiles:"",Trending12:"",UnavailableOffline:"",Undo:"",Uneditable2:"",Unknown:"",Unpin:"",Up:"",Upload:"",View:"",ViewAll:"",ViewList:"",VisioLogo:"",Warning12:"",WarningSolid:"",WordDocument:"",Work:""};function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(e,"odsp-next-icons-8165b040.woff') format('woff')")},icons:i};(0,a.fU)(n,t)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("CookieRefresher")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>d,c:()=>s,d:()=>c});var a=n("tslib_538"),i="ODSPPDF",r="WASM_CACHE",o=[r];function s(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return i=a.sent(),r=i.transaction([e],"readonly"),o=r.objectStore(e),s=o.get(t),[2,new Promise(function(e,a){s.onerror=function(){i.close(),a("Fail to retreive store by ".concat(t))},s.onsuccess=function(t){var a=t.target.result;a&&a.version===n?(i.close(),e(a.value)):(i.close(),e(void 0))}})]}})})}function c(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return n=a.sent(),i=n.transaction([e],"readwrite"),r=i.objectStore(e),o=r.put(t,t.key),[2,new Promise(function(e,a){o.onerror=function(){n.close(),a("Fail to update store by ".concat(t.key))},o.onsuccess=function(){n.close(),e()}})]}})})}function d(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,l()];case 1:return n=a.sent(),i=n.transaction([e],"readwrite"),r=i.objectStore(e),o=r.getAllKeys(),[2,new Promise(function(e,a){o.onsuccess=function(n){var a=n.target.result;null==a||a.forEach(function(e){e.startsWith(t)&&r.delete(e)}),e()},o.onerror=function(){n.close(),a("Fail to get all keys")}})]}})})}function l(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){if(!self.indexedDB)throw new Error("This browser doesn't support IndexedDB");return e=indexedDB.open(i,1),[2,new Promise(function(t,n){e.onupgradeneeded=function(){var t=e.result;o.forEach(function(e){t.objectStoreNames.contains(e)&&t.deleteObjectStore(e),t.createObjectStore(e)})},e.onerror=function(){n("Fail to open indexeddb ".concat(i))},e.onsuccess=function(){t(e.result)}})]})})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>s});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext(void 0),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)},s=function(){return i.useContext(r)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(159),i=n(191),r="textField",o=function(){var e,t=null===(e=document.activeElement)||void 0===e?void 0:e.className;return a.a.isActivated("EnableCJKInFormTextField")?t===i.b:t===i.a||t===r}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r,c:()=>a,d:()=>i}),(0,n("fui.util_867").ZW)([{rawString:".pdfOuter_27b1583c{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}.pdfViewer_27b1583c{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;overflow:auto;width:100%;height:100%;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.pdfContent_27b1583c{position:relative;overflow:hidden;min-width:100%;min-height:100%}.fillSize_27b1583c{width:100%;height:100%}.hidden_27b1583c{visibility:hidden}"}]);const a="pdfOuter_27b1583c",i="pdfViewer_27b1583c",r="pdfContent_27b1583c",o="fillSize_27b1583c"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_538"),i=n(75),r=n("react-lib");(0,n("fui.util_867").ZW)([{rawString:'.inputWrapper_e17f0b58{display:inline-block;height:100%}input{height:24px;border:1px solid;border-radius:2px;background-color:"#ffffff";color:"#323130"}input:focus{outline:none}'}]);var o=function(e){var t=e.visible,n=e.autoFocusOnInput,o=e.onEnterWhenFocused,s=e.onShiftEnterWhenFocused,c=e.inputProps,d=e.rootProps,l=e.outerRef,u=e.children,f=(0,a.pM)(r.useState(!1),2),p=f[0],m=f[1],_=r.useRef(null),h=r.useRef(null),b=(0,i.a)();r.useEffect(function(){var e,a;t&&n&&(null===(e=_.current)||void 0===e||e.focus(),m(!0),null===(a=h.current)||void 0===a||a.focus())},[n,t]);var g=r.useCallback(function(e){var t,n;switch(e.key){case"Enter":h.current===document.activeElement?e.shiftKey?null==s||s():null==o||o():(m(!0),null===(t=h.current)||void 0===t||t.focus());break;case"Escape":m(!1),null===(n=_.current)||void 0===n||n.focus(),e.stopPropagation(),e.preventDefault()}},[o,s]),v=r.useCallback(function(e){var t;null===(t=c.onBlur)||void 0===t||t.call(c,e),m(!1)},[c]);return r.createElement("div",{ref:l,className:"inputWrapper_e17f0b58"},r.createElement("div",(0,a.q5)({},d,{ref:_,"data-is-focusable":!0,onKeyDown:g}),r.createElement("input",(0,a.q5)({},c,{ref:h,style:{borderColor:b.semanticColors.inputBorder,backgroundColor:b.semanticColors.inputBackground,color:b.semanticColors.inputText},"data-is-focusable":p,onBlur:v})),r.createElement("style",null,"::placeholder {color: ".concat(b.semanticColors.inputPlaceholderText,"; }")),u))};o.defaultProps={visible:!0,autoFocusOnInput:!1}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("odsp.util_152"),i=n(86),r=n(389),o=n(390),s=new a.aF({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.a},create:function(e){var t=new r.a,n=new o.a(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_538");const i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.e2)(t,e),t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.trackSignal=function(e){return this.attach({dispose:function(){e.cancel()}}),e},t}(n(144).a)}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n("odsp.util_152"),i=n(464),r=function(){function e(e){this._value=e,this._observers=new Set}return e.prototype.get=function(){return this._value},e.prototype.set=function(e){this._value=e,this._observers.forEach(function(e){e()})},e.prototype.subscribe=function(e){var t=this;return this._observers.add(e),function(){t._observers.delete(e)}},e}(),o=function(){function e(e){this._observableValue=new i.a(e)}return e.prototype.get=function(){return this._observableValue.value},e.prototype.set=function(e){this._observableValue.value=e},e.prototype.subscribe=function(e){var t=this;return this._observableValue.subscribe(e,"set"),function(){t._observableValue.unsubscribe(e,"set")}},e}(),s=a.x9.isActivated("544e04a1-a11f-4d23-aedf-80ecb02d2818")?r:o}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152"),i=new a.aF({name:"cookieOrigin",factory:new a.KS(window.location.origin)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>d,b:()=>l});var a=n("tslib_538"),i=n("react-lib"),r=n(192),o=i.createContext(void 0),s={dirty:!1},c=function(e,t){var n;return t.type===r.a.Reset?s:{dirty:!0,annotTypeOfLatestEdit:null===(n=t.payload)||void 0===n?void 0:n.annotType}},d=function(e){var t=e.children,n=(0,a.pM)(i.useReducer(c,s),2),r=n[0],d=n[1],l=i.useMemo(function(){return{editState:r,dispatchEditAction:d}},[r]);return i.createElement(o.Provider,{value:l},t)},l=(o.Consumer,function(){return i.useContext(o)})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("engagementHandlers")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("getOneUpOnePlayerResources")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>a});var a={ODB:61471},i={ODB:61546}}
,,(e,t,n)=>{"use strict";var a=n("tslib_538"),i=n(416),r=n(417),o=n(6),s=n(220),c={webThemeProvider:function(e){return new r.a({pageContext:e,getThemeDataSource:function(){return function(e){return new o.c(function(t,a){window.require.specified("@ms/odsp-datasources/lib/dataSources/theming/spList/WebThemeDataSource"),n.e(70).then(n.bind(n,666)).then(s.a).then(function(n){t(new n(e))})})}(e)}})}};i.a.initializeTheme(c);var d=n(378),l=n("fui.util_867"),u=window.require.toUrl("odsp-media/fluenthybridfont/");(0,d.a)(u);var f={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(u,"patch/odsp-patch-icons-33e61432.woff') format('woff')")},icons:{PinOff:"",PinNavMenu:"",PinOffSolid:"",PinSolid:""}};(0,l.fU)(f);var p=n("react-lib"),m=n.n(p),_=n(426),h=n(427),b=n(419),g="".concat(l.fG,"/images/addToOneDrive/"),v=n(420),y=n(421),S=n(422),D=n(423),I=n(424),x=n(425),C="".concat(l.fG,"/"),O="".concat(C,"assets/item-types/"),w="".concat(C,"office-ui-fabric-react-assets/foldericons"),E="".concat(C,"assets/brand-icons/product/"),A=window.require.toUrl("odsp-media/images/addtoonedrive"),L=v.a,k=y.a;const M=n.p+"images/error_exclamation_v3_0c97827f.webp",P=n.p+"images/error_exclamation_v3_dark_4e4519b8.webp";(0,_.a)(O,{disableWarnings:!0}),(0,h.a)(w,{disableWarnings:!0}),(0,b.a)(E,{disableWarnings:!0}),function(e,t){void 0===e&&(e=g),(0,l.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_12.svg")})}},t),(0,l.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_16.svg")})}},t),(0,l.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_20.svg")})}},t),(0,l.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12_dark:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_12_dark.svg")})}},t),(0,l.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16_dark:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_16_dark.svg")})}},t),(0,l.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20_dark:p.createElement("img",{alt:"",src:"".concat(e,"/shortcutbadge_20_dark.svg")})}},t)}(A,{disableWarnings:!0}),(0,v.b)(L,{disableWarnings:!0}),(0,y.b)(k,{disableWarnings:!0}),(0,S.a)({disableWarnings:!0}),(0,D.a)({disableWarnings:!0}),(0,I.a)({disableWarnings:!0}),(0,x.a)({disableWarnings:!0}),(0,l.fU)({icons:{errorExclamation:p.createElement("img",{src:M,alt:""}),errorExclamationDark:p.createElement("img",{src:P,alt:""})}});var T=window.require.toUrl("odsp-media/fluenthybridfont/"),U=(n.e(20).then(n.bind(n,667)).then(function(e){(0,e.initializeIcons)(T,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)}),n("react-dom-lib"),n(649)),F=n(428),H=n("odsp.util_152"),R=n(5),N=n(49),B=n(387),j=n(132),V=n(81),z=n(456),G=n(121),K=n(85),W=n(457),q=n(363),Q=n(21),Y=n(458),J={crossDomainImageHelper:(0,H._y)("".concat("ThumbnailHelper",".crossDomainImageHelper"),Y.a,{apiUrlHelper:q.a}),itemUrlHelper:Q.c},X=new H.aF({name:"ThumbnailHelper",factory:{dependencies:J,create:function(e){var t=new Y.b(e);return{instance:t,disposable:t}}}}),Z=n(247),$=n(83),ee=(0,H._y)("MetaDataProcessor",Z.a,{pageContext:R.a,platformDetection:$.a}),te=n(459),ne=n(71),ae=n(202),ie=new H.aF({name:"updateThumbnailUrlCallback",factory:{dependencies:{},create:function(e){return{instance:function(e,t){e.itemsWaitingForCookies.map(function(n){var i=n.itemKey,r=(0,V.c)().consume(ne.b),o=null==r?void 0:r.getOneUpProperties();if(o&&i===o.focusItem.key){var s=t.authTokenV21,c=t.proofTokenV21,d=n.thumbnailUrl+"&access_token=".concat(s,"&prooftoken=").concat(c),l=e.thumbnailHelper.getThumbnail({baseUrl:d,itemKey:i,fileExtension:n.fileExtension,mediaServiceMetadata:n.mediaServiceMetadata});if(l){var u=(0,a.q5)({},o.focusItem);u.thumbnail=ae.replace(l),r.update({focusItem:u},"AuthCookieHelperUpdateThumbnail")}}})}}}}}),re=(0,H._y)("AuthCookieHelper",te.a,{thumbnailHelper:X,platformDetection:$.a,updateThumbnailUrlCallback:ie}),oe=n(460),se=(0,H._y)("AuthTokenStore",oe.a,{}),ce=new H.Rj(W.a,{pageContext:R.a,thumbnailHelper:X,metaDataProcessor:ee,authCookieHelper:re,authTokenStore:se}),de=new H.aF({name:"MicroServiceDataSource",factory:ce}),le=n(188),ue=new H.aF({name:"ItemCommentsDataSource.key",loader:new H.xT(function(){return n.e(34).then(n.bind(n,674)).then(function(e){return e.resourceKey})})}),fe=n(747),pe=new H.aF({name:"PeoplePickerDataSource.async.key",loader:new H.xT(function(){return n.e(65).then(n.bind(n,675)).then(function(e){return e.resourceKey})})});(0,l.ZW)([{rawString:"div[class*=OneUpModalSizing]>div.ms-Dialog-main{height:100vh!important;height:100dvh!important;width:100vw!important;max-width:unset!important;max-height:unset!important;min-height:unset!important;border-radius:0!important}div[class*=OneUpSafariMobile]>div.ms-Dialog-main{height:100%!important}"}]);var me,_e=n(621),he=n(461),be=n(72),ge=n(3),ve=n(82),ye=n(134),Se=n(462),De=n(138),Ie=n(260),xe=n(119),Ce=n(264),Oe=(0,Ce.a)(),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.e2)(t,e),t}(xe.a.withManager(Oe)),Ee=n(466),Ae=n(255),Le=n(12);function ke(e){if("object"==typeof e&&e){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];e[a]=ke(e[a])}return e}return"string"==typeof e&&e.match(/https?:\/\//)?"DATA_Sanitized":e}!function(e){e.next="next",e.previous="previous",e.close="close"}(me||(me={}));var Me={getValidViewerTypes:Se.c,isFastOneUp:De.e.optional,pageContext:R.a,itemUrlHelper:Q.c},Pe=new H.aF({name:"OneUpLoadingCustomerPromiseFunctionsKey",factory:{dependencies:Me,create:function(e){var t,n,i=void 0,r=e.pageContext,o=(null===(t=(0,Ie.b)(r))||void 0===t?void 0:t.toLowerCase())||"unknown",s="View";return{instance:{newLoadingCustomerPromise:function(t,r){void 0===i&&(n=t,i=new we({scenario:"OneUpLightSpeed.load",perfGoalInMs:ye.c,pillar:s,extraData:(0,a.q5)({oneUpRenderingMode:e.isFastOneUp?ye.e.fastOneUp:ye.e.inlineOneUpFirstPage,viewerName:e.getValidViewerTypes.getValidViewerTypes(t),fileExtension:t.extension,fileSize:t.size,fileSizeRange:(0,ye.g)(t.size),Ring:o,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList},r)}))},reportLoadingCXPSuccess:function(t){var r,c,d;null==i||i.end({resultType:ge.b.Success,extraData:(0,a.q5)((0,a.q5)({},t.extraData),{navigationOption:null===(r=t.navExtraData)||void 0===r?void 0:r.navigationOption,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList})}),i=void 0,t.navExtraData&&t.navExtraData.newItem&&(t.navExtraData.navigationOption===me.previous||t.navExtraData.navigationOption===me.next)&&(n=t.navExtraData.newItem,i=new we({scenario:"OneUpLightSpeed.load",perfGoalInMs:ye.c,pillar:s,extraData:{oneUpRenderingMode:ye.e.inlineOneUpSlide,viewerName:e.getValidViewerTypes.getValidViewerTypes(t.navExtraData.newItem),fileExtension:t.navExtraData.newItem.extension,fileSize:t.navExtraData.newItem.size,fileSizeRange:(0,ye.g)(t.navExtraData.newItem.size),Ring:o,isNavigating:!0,navigationOptions:t.navExtraData.navigationOption,navNewItemUniqueId:null===(d=null===(c=t.navExtraData.newItem)||void 0===c?void 0:c.properties)||void 0===d?void 0:d.uniqueId,isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList}}))},reportLoadingCXPFailure:function(t){var o,s,c,d,l,u,f=t.rawError,p=f.errorType,m=f.error,_=f.item,h=f.meTAQos;m instanceof H.qt?(d=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}((c=(0,ve.a)(m)).resultCode||"Unknown"),l=c.resultType,u=m.correlationId):m instanceof H.qt?(d=m.code||m.message,l=m.isExpected?ge.b.ExpectedFailure:ge.b.Failure,u=m.correlationId):(d=m.message,l=ge.b.Failure);var b,g="spdf"===(null===(o=r.cloudType)||void 0===o?void 0:o.toLowerCase()),v=(0,a.q5)((0,a.q5)((0,a.q5)({viewerName:_&&e.getValidViewerTypes.getValidViewerTypes(_)||Se.a.Unknown,extension:_&&_.extension||"Unknown",errorType:p,rawError:m,isPPE:g},null==c?void 0:c.extraData),{CorrelationId:u||(null==r?void 0:r.CorrelationId),isCrossList:e.itemUrlHelper.getItemUrlParts(n.key).isCrossList}),(0,Ae.a)(null===(s=t.rawError.extraData)||void 0===s?void 0:s.url));if((0,Le.ub)()){var y=ke(v);b=(0,a.q5)((0,a.q5)({},v),{diagnosticInfo:y})}else b=v;null==i||i.end({resultType:l,errorCode:d,extraData:b}),i=void 0,h&&(0,Ee.b)(h,{resultType:l,resultCode:d,extraData:b})}}}}}}),Te=n(356),Ue=n(24),Fe=n(99),He=n(257);(0,l.ZW)([{rawString:".OneUpHtml_e04bdda1{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIOS_e04bdda1{overflow:auto;position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIFrame_e04bdda1{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}.OneUpHtmlNewDesign_e04bdda1{position:absolute;top:0;width:75%;bottom:0;left:0;right:0;margin:auto;text-align:center;-webkit-overflow-scrolling:touch}"}]);var Re=n(251),Ne=n(405),Be=n(468),je=n(56);function Ve(e,t){if(e)try{return e.getResponseHeader(t)||void 0}catch(e){}}var ze=n(241),Ge={oneUpStore:ne.b,graphDataSource:He.a},Ke=new H.aF({name:"GetMeTAHeader.key",factory:{dependencies:Ge,create:function(e){var t=e.oneUpStore,n=e.graphDataSource;return{instance:function(e){return(0,a.yv)(this,void 0,void 0,function(){var i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(0,ze.a)()&&(null==(i=t.getOneUpProperties())?void 0:i.focusItem)?(r=null==e?void 0:e.forceRefresh,[4,n.getAccessToken(i.focusItem,{forceRefresh:r})]):[3,2];case 1:return o=a.sent(),s=void 0,o.metaPac&&(s={"X-SPOPacToken":o.metaPac}),[2,s];case 2:return[2]}})})}}}}});function We(e){var t=this,n=e.item;if(!n)return p.createElement(p.Fragment,null);var i=(0,V.c)(),r=i.consume(je.e),o=i.consume($.a).isIOS,s=i.consume(Ne.downloadDataSourceKey),c=p.useState(!1),d=c[0],l=c[1],u=p.useState(),f=u[0],m=u[1],_=p.useState(),h=_[0],b=_[1],g=p.useState(!1),v=g[0],y=g[1],S=p.createRef();p.useEffect(function(){return function(){h&&window.URL.revokeObjectURL(h)}},[]),p.useEffect(function(){if(o&&S&&S.current){var e=S.current,t=e.clientWidth,n=e.clientHeight;S.current.style.width="".concat(t,"px"),S.current.style.height="".concat(n,"px")}},[S]);var D=function(t,i){var o,s=i?(0,ye.o)(i):"",c=new H.qt({code:t.name,message:t.message,extraData:{rawError:JSON.stringify(t).concat("; ".concat(s))}});if(i)try{var d=i,l="",u="",f=void 0;if(d&&(l=t.name.concat("."+d.code),u=t.message.concat("."+d.message),d.data&&d.data.error))try{var p=d.data.error;l=l.concat("."+(null==p?void 0:p.code)),u=u.concat("."+(null===(o=null==p?void 0:p.message)||void 0===o?void 0:o.value)),f=p.stack}catch(e){}c=(0,a.q5)((0,a.q5)({},c),{code:l,message:u,correlationId:null==d?void 0:d.correlationId,stack:f,extraData:(0,a.q5)((0,a.q5)({},c.extraData),{status:null==d?void 0:d.status,statusText:null==d?void 0:d.statusText})})}catch(e){try{var m=i;c=(0,a.q5)((0,a.q5)({},c),{code:t.name.concat("."+m.name),message:t.message.concat("."+m.message),stack:m.stack})}catch(e){}}r.updateErrorState("oneupHtmlViewer",{errorType:ye.d.viewerInitLoadingError,error:c,item:n}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(c,"HTMLViewer")},I=function(e,t){var a=i.consume(He.a),r=(null==e?void 0:e.url)&&!(null==t?void 0:t.forceRefresh)?Promise.resolve({shouldRetryForceToken:!1,url:null==e?void 0:e.url}):a.getAuthenticationParams(n,t).then(function(e){return{shouldRetryForceToken:!1,url:"".concat(a.getItemUrl(n,{useDirectEndpoint:!0}),"/content?format=html&").concat((0,Ue.a)(e))}}).catch(function(e){var t,n,a;if(e&&e instanceof Error&&"AccessExpired"===e.name)return{shouldRetryForceToken:!0};try{if(e&&e instanceof XMLHttpRequest){var i=JSON.parse(e.responseText);if("unauthenticated"===(null===(t=i.error)||void 0===t?void 0:t.code)&&"AccessExpired"===(null===(a=null===(n=i.error)||void 0===n?void 0:n.innererror)||void 0===a?void 0:a.code))return{shouldRetryForceToken:!0}}var r=(0,ye.i)("error getting auth params for graph html conversion","HTMLGraphAuthParamError");return D(r,e),{shouldRetryForceToken:!1}}catch(t){return r=(0,ye.i)("error getting auth params parsed error for graph html conversion","HTMLGraphAuthParamParseError"),D(r,e),{shouldRetryForceToken:!1}}});return r},x=function(e,t){return Fe.a.startAndPostProcess({url:e,headers:t},function(e,t){return e.responseText})};p.useEffect(function(){d||function(e){return(0,a.yv)(t,void 0,void 0,function(){var t,r,o,c,d,l,u,f,p,m,_,h,b,g=this;return(0,a.SO)(this,function(v){switch(v.label){case 0:return t=e.extension,r=e.htmlConversion,o=t&&t.toLowerCase(),c=".htm"===o||".html"===o||".svg"===o,!r||c?[3,5]:(0,Le.Lb)()?(d=!1,r.url?[4,i.consume(Ke)()]:[3,2]):[3,3];case 1:if(l=v.sent(),!(0,ze.a)())try{(u=null===(b=r.url)||void 0===b?void 0:b.split("access_token=")[1].split("&")[0])&&(y=u.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),S=decodeURIComponent(window.atob(y).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")),f=JSON.parse(S),p=Date.now(),f.exp&&p-1e3*parseInt(f.exp,10)>=198e5&&(d=!0))}catch(e){}v.label=2;case 2:return m=I(r,{forceRefresh:!!d}),[2,Promise.resolve(m).then(function(e){return e.url?x(e.url,l):Promise.resolve(void 0)}).catch(function(e){var t,n,o;if(e)try{if(e&&e instanceof XMLHttpRequest&&r){var s=JSON.parse(e.responseText);if("unauthenticated"===(null===(t=s.error)||void 0===t?void 0:t.code)&&"AccessExpired"===(null===(o=null===(n=s.error)||void 0===n?void 0:n.innererror)||void 0===o?void 0:o.code)){var c=!!r.url,d=c&&(0,ze.a)()?m:I(void 0,{forceRefresh:!0});return Promise.resolve(d).then(function(e){return(0,a.yv)(g,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return c?[4,i.consume(Ke)({forceRefresh:!0})]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return[2,e.url?x(e.url,t):Promise.resolve(void 0)]}})})}).catch(function(e){var t=(0,ye.i)("error reattempting to get item conversion content url with token retry without htmlConversion prop","HTMLUrlPromiseTokenRetryWithoutHtmlConvError");return D(t,e),Promise.resolve(void 0)})}}var l=(0,ye.i)("error getting graph html conversion","HtmlConversionError");return D(l,e),Promise.resolve(void 0)}catch(t){var u=(0,ye.i)("error getting parsed error for graph html conversion","HTMLGraphHtmlConversionParseError");return D(u,e),Promise.resolve(void 0)}var f=(0,ye.i)("error calling to get item html content conversion ","HTMLConversionGeneralError");D(f)})];case 3:return _=i.consume(He.a),h=r.url||_.getAuthenticationParams(n).then(function(e){return"".concat(_.getItemUrl(n,{useDirectEndpoint:!0}),"/content?format=html&").concat((0,Ue.a)(e))}),[2,Promise.resolve(h).then(function(e){return Fe.a.startAndPostProcess({url:e},function(e,t){return e.responseText})})];case 4:return[3,6];case 5:return[2,s.getItemContents(n).then(function(e){return Be.c(e,"text/html").then(function(e){return e.text}).catch(function(e){var t=(0,ye.i)("error parsing content from blob","HTMLParseContentBlobError");throw D(t,e),new Error})}).catch(function(e){var t=(0,ye.i)("error getting item content from download datasource","HTMLGetItemContentsError");throw D(t,e),new Error})];case 6:return[2]}var y,S})})}(n).then(function(e){if(e)if((0,Re.a)())m(e),l(!0);else{var t=new Blob([e],{type:"text/html"}),n=void 0;try{n=window.URL.createObjectURL(t),b(n),l(!0)}catch(e){var a=(0,ye.i)("error creating object url from blob","HTMLCreateObjectUrlError");D(a,e)}}else a=(0,ye.i)("empty html file content","HTMLEmptyContentError"),D(a)},function(t){var a=ye.d.genericViewerLoadingError;if(t instanceof XMLHttpRequest){var i=function(e,t){var n=e&&e.status,a=e&&t&&-1!==t.indexOf(n),i=Ve(e,"x-errorcode")||Ve(e,"x-clienterrorcode");return new H.qt({isExpected:a,code:i||n.toString(),message:JSON.stringify(e.response)})}(t,[406]);a="HTMLErrorProcessingContent",r.updateErrorState("oneupHtmlViewer",{errorType:ye.d.viewerInitLoadingError,error:i,item:n})}else a="HTMLErrorRetrievingContent",r.updateErrorState("oneupHtmlViewer",{errorType:ye.d.viewerInitLoadingError,error:t,item:n});e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error(a),"HTMLViewer")})},[d,n]);var C=(0,be.a)(function(){v||(e.onViewerLoaded&&e.onViewerLoaded(),y(!0))}),O=(0,be.a)(function(t){if(0===e.offset){var n=(0,ye.i)("".concat(t.type," - Error loading HTML viewer"),"".concat(t.type," - HTMLIframeLoadError"));D(n)}});return d&&n?p.createElement("div",{className:o?"OneUpHtmlIOS_e04bdda1":"OneUpHtmlNewDesign_e04bdda1"},p.createElement("iframe",{ref:S,className:"OneUpHtmlIFrame_e04bdda1",sandbox:"",title:n.name,frameBorder:"0",src:h,srcDoc:f,onLoad:C,onError:O})):p.createElement(p.Fragment,null)}var qe=n(40),Qe=n(34),Ye=n(88),Je=H.x9.isActivated("033a2ec3-915d-4a0b-94d7-01220514a62b","05/13/2024","Use the blob approach for creating PDF web worker in non-embed scenarios"),Xe=H.x9.isActivated("441dc3a7-bbe8-456c-91fd-59e0e22bb611","08/26/2024","Add subpath for mpc in swproxy url to make it be processed in the farm where the user mysite is"),Ze=function(){function e(e,t){this._urlCache={};var n=t.window,a=void 0===n?window:n,i=t.urlDataSource,r=t.navigation;this._window=a,this._webAbsoluteUrl=t.pageContext.webAbsoluteUrl;var o=i.getPageType(r.viewParams);this._isEmbed=o===Ye.a.Embed}return e.prototype.getWorkerUrl=function(e,t){var n=this._window,a="".concat(n.location.protocol,"//").concat(n.location.host),i=new Qe.a(e);if(t||i.authority!==a){var r=new Qe.a(this._webAbsoluteUrl);if(a===r.authority&&(Je||this._isEmbed)){if(t){var o=Xe||"https://my.microsoftpersonalcontent.com"!==a?"":r.path;return"".concat(a).concat(o,"/_layouts/15/odspserviceworkerproxy.aspx?swManifestName=").concat(encodeURIComponent(t),"&debug=false&bypass=false")}return"".concat(a,"/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl=").concat(encodeURIComponent(e))}var s=this._urlCache;if(s[e])return s[e];var c=n.URL.createObjectURL(new Blob(["importScripts(".concat(JSON.stringify(e),");")],{type:"text/javascript"}));return s[e]=c,c}return e},e.prototype.dispose=function(){var e=this._urlCache;for(var t in e)e.hasOwnProperty(t)&&this._window.URL.revokeObjectURL(e[t])},e}(),$e=(0,H._y)("WorkerDataSource",Ze,{pageContext:R.a,urlDataSource:K.a,navigation:N.a}),et=n(160),tt=n(123),nt=n(159),at=n(74),it=n(481),rt=n(142),ot=n(55),st=n(469),ct=n(54),dt=n(147),lt="OpenPdfInBrowserAction",ut={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.XQ,platform:$.a,oneUpStateStore:je.e},ft=new H.aF({name:"OpenPdfInBrowserAction",factory:{dependencies:ut,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e){var t;return!!e&&function(e){return!!(e&&e.extension&&e.openUrl&&e.itemStatus!==dt.b.ConditionalAccessViewOnly&&e.itemStatus!==dt.b.ConditionalAccessBlocked&&ct.a.hasItemPermission(e,ct.a.openItems))}(e)&&".pdf"===(null===(t=e.extension)||void 0===t?void 0:t.toLowerCase())}(e.item);return{isAvailable:n,id:lt,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i,r;return(0,a.SO)(this,function(a){if(n=e.item,i=n.openUrl)return t.navigation.navigateTo({url:i,frameId:"_blank"}),[2,{resultType:ge.b.Success}];throw r=(0,ye.i)("no url"),t.oneUpStateStore.updateErrorState(lt,{errorType:ye.d.actionError,error:r,item:n}),r})})}}})}};var t}}}),pt=n(100),mt=n(96),_t=n(41),ht=n(94),bt=n(148),gt=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(23).then(n.bind(n,682))];case 1:return[2,e.sent().MalwareDetectedDialog]}})})}),vt={oneUpStateStore:je.e},yt=new H.aF({name:"ShowMalwareDetectedAction",factory:{dependencies:vt,create:function(e){return{instance:function(t){try{var n=p.createElement(gt,(0,a.q5)({},t));e.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!0,content:n})}catch(t){throw e.oneUpStateStore.updateErrorState("showMalwareDetectedDialog",{errorType:ye.d.actionError,error:t,item:void 0}),t}}}}}}),St=n(261),Dt="DownloadAction",It={pageContext:R.a,oneUpStore:ne.b,downloadDataSource:Ne.downloadDataSourceKey,resources:H.XQ,graphDataSource:He.a,oneUpStateStore:je.e,showMalwareDetectedDialog:yt,navigation:N.a,itemUrlHelper:Q.c},xt=new H.aF({name:"DownloadAction",factory:{dependencies:It,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n={isAvailable:Ct({item:e.item,appLevelPagecontext:t.pageContext,itemUrlHelper:t.itemUrlHelper,remoteWebPageContexts:t.oneUpStore.pageContexts,oneUpStateStore:t.oneUpStateStore}),id:Dt,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return(0,a.SO)(this,function(x){switch(x.label){case 0:return e=t.oneUpStore.getOneUpProperties(),n=null==e?void 0:e.focusItem,!0!==(null===(S=null==n?void 0:n.lifeCycleStatus)||void 0===S?void 0:S.isMalwareDetected)?[3,1]:(i={item:n,allowInfectedFileDownload:!!(null===(D=t.pageContext)||void 0===D?void 0:D.allowInfectedDownload),onDismiss:function(){t.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!1,content:void 0})},onDownload:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e;return(0,a.SO)(this,function(a){return e=t.downloadDataSource.getItemClassicDownloadLink(n),t.navigation.navigateTo({url:e,frameId:"_blank"}),[2]})})}},t.showMalwareDetectedDialog(i),[3,8]);case 1:return n&&n.type===mt.a.Folder&&n.urls?(r=n.urls[ht.a.itemUrl],St.a?[3,3]:[4,t.graphDataSource.getAccessToken(n)]):[3,5];case 2:return s=x.sent(),[3,4];case 3:s=t.graphDataSource.getAccessToken(n),x.label=4;case 4:return o=s,c=[{name:n.name,size:n.size,docId:"".concat(r).concat(-1!==r.indexOf("?")?"&":"?","access_token=").concat(o.accessToken),isFolder:!0}],d="",c&&1===c.length&&(d=c[0].name+".zip"),l=n.urls[ht.a.downloadAsZip],u=function(){var e=document.createElement("iframe");return e.id="zip-download-iframe",e.name=e.id,e.hidden=!0,e}(),document.body.appendChild(u),(f=document.createElement("form")).target=u.id,f.method="POST",f.action=l,f.style.display="none",(p=document.createElement("input")).type="hidden",p.name="files",p.value=JSON.stringify({items:c}),f.appendChild(p),(m=document.createElement("input")).type="hidden",m.name="guid",m.value=_t.a.generate(),f.appendChild(m),(_=document.createElement("input")).type="hidden",_.name="accessToken",_.value=o.accessToken,f.appendChild(_),(h=document.createElement("input")).type="hidden",h.name="zipFileName",h.value=d,f.appendChild(h),(b=document.createElement("input")).type="hidden",b.name="provider",b.value="spo",f.appendChild(b),(g=document.createElement("input")).type="submit",f.appendChild(g),null===(I=u.contentWindow)||void 0===I||I.document.body.appendChild(f),f.submit(),[3,8];case 5:return n&&n.type!==mt.a.Folder?(v={items:[n]},[4,t.downloadDataSource.downloadItems(v).then(function(){return{resultType:ge.b.Success}}).catch(function(e){throw t.oneUpStateStore.updateErrorState("download action",{errorType:ye.d.actionError,error:e,item:n}),e})]):[3,7];case 6:return x.sent(),[3,8];case 7:throw y=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(Dt,{errorType:ye.d.actionError,error:y,item:n}),y;case 8:return[2,{resultType:ge.b.Success}]}})})}};return n})}};var t}}});function Ct(e){var t=e.item,n=e.appLevelPagecontext,a=e.itemUrlHelper,i=e.remoteWebPageContexts,r=e.oneUpStateStore;if(!t||!t.key||!t.urls)return!1;if(r&&r.currentAppState&&r.currentAppState.renamedKeyInFastOneUp&&r.currentAppState.renamedKeyInFastOneUp===t.key)return!1;if(t.itemStatus===dt.b.ConditionalAccessBlocked||t.itemStatus===dt.b.ConditionalAccessViewOnly)return!1;if(t.type===mt.a.OneNote)return!1;if(!ct.a.hasItemPermission(t,ct.a.openItems))return!1;var o=n,s=a.getItemUrlParts(t.key);if(s.fullWebUrl&&s.serverRelativeListUrl){var c={webAbsoluteUrl:s.fullWebUrl,listUrl:s.serverRelativeListUrl};i&&i.get(c)&&(o=i.get(c))}return!(o&&(o.blockDownloadFileTypePolicyEnabled||o.blockDownloadsExperienceEnabled||o.viewOnlyExperienceEnabled)||(!t.urls[ht.a.downloadAsZip]||!t.urls[ht.a.itemUrl]||0===t.childCount||t.type!==mt.a.Folder)&&(t.isRootFolder||t.type!==mt.a.File&&t.type!==mt.a.Media&&t.type!==mt.a.Unknown))}var Ot={downloadActionProvider:xt},wt="downloadCommand",Et=new H.aF({name:"DownloadCommand",factory:{dependencies:Ot,create:function(e){var t=e.downloadActionProvider;return{instance:{id:wt,name:pt.w,title:pt.x,automationId:wt,iconProps:{iconName:"Download"},evaluateAction:t.evaluateAction}}}}}),At=n(139),Lt=n(471),kt=n(84),Mt="universalannotations",Pt="$batch",Tt="multipart/mixed;boundary=",Ut="application/json",Ft=function(){function e(e,t){this._token=null,this._layerPath="";var n=t.vroomDataRequestor,a=t.pageContext;this._dataRequestor=n,this._pageContext=a}return e.prototype.update=function(e,t,n){this._getSharePointToken=e,this._basePath="/drives/".concat(n,"/items/").concat(t),this._layerPath="".concat(this._basePath,"/").concat("annotationlayers")},e.prototype.createLayer=function(e){var t=e.title,n=e.mainFileVersion,a=void 0===n?"1.0":n,i=e.layerId,r=this._layerPath;return this._sendRequest({path:r,requestType:"POST",data:{title:t,mainFileVersion:a,id:i}})},e.prototype.deleteLayer=function(e){var t=e.layerId,n="".concat(this._layerPath,"/").concat(t);return this._sendRequest({path:n,requestType:"DELETE"})},e.prototype.getLayers=function(){var e=this._layerPath;return this._sendRequest({path:e,requestType:"GET"})},e.prototype.createAnnotation=function(e){var t=e.annotationId,n=e.layerId,a=e.content,i=e.partitionId,r=e.anchor,o=e.contentType,s=this._getAnnotationUrl(n);return this._sendRequest({path:s,requestType:"POST",data:{id:t,content:a,partitionId:i,anchor:r,contentType:o}})},e.prototype.getAnnotations=function(e){var t=e.layerId,n=e.partitionId,a=this._getAnnotationUrl(t);return n&&(a+="?partitionId=".concat(n)),this._sendRequest({path:a,requestType:"GET"})},e.prototype.deleteAnnotation=function(e){var t=e.layerId,n=e.partitionId,a=e.annotationId,i="".concat(this._getAnnotationUrl(t),"/").concat(a,"?partitionId=").concat(n);return this._sendRequest({path:i,requestType:"DELETE"})},e.prototype.batchCreateAnnotations=function(e){var t=e.payload;return(0,a.yv)(this,void 0,void 0,function(){var e,n,i=this;return(0,a.SO)(this,function(r){return e="batch_"+_t.a.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.layerId,r=e.annotationId,o=(0,a.dc)(e,["id","layerId","annotationId"]);return{path:"".concat(i._basePath,"/AnnotationLayers('").concat(n,"')/").concat(Mt),requestType:"POST",id:t,data:(0,a.q5)({id:r},o)}})),[2,this._sendRequest({path:"/".concat(Pt),requestType:"POST",headers:{"Content-Type":Tt+e},data:n})]})})},e.prototype.batchDeleteAnnotations=function(e){var t=e.payload;return(0,a.yv)(this,void 0,void 0,function(){var e,n,i=this;return(0,a.SO)(this,function(a){return e="batch_"+_t.a.generate(),n=this._createBatchBody(e,t.map(function(e){var t=e.id,n=e.annotationId,a=e.layerId,r=e.partitionId;return{path:"".concat(i._getAnnotationUrl(a),"/").concat(n,"?partitionId=").concat(r),requestType:"DELETE",id:t}})),[2,this._sendRequest({path:"/".concat(Pt),requestType:"POST",headers:{"Content-Type":Tt+e},data:n})]})})},Object.defineProperty(e.prototype,"hasLicense",{get:function(){return(0,Le.wb)(Le.V)?Boolean(this._pageContext.canUserUseSyntex)||Boolean(this._pageContext.isUserSyntexV2Licensed):Boolean(this._pageContext.canUserUseSyntex)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUniversalAnnotationDisabled",{get:function(){var e;return null!==(e=this._pageContext.isUniversalAnnotationDisabled)&&void 0!==e&&e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_server",{get:function(){return(0,At.b)(this._pageContext)},enumerable:!1,configurable:!0}),e.prototype._needRefreshToken=function(){return!this._token||!this._token.tokenExpiry||Date.now()>=this._token.tokenExpiry},e.prototype._getToken=function(){return(0,a.yv)(this,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return this._needRefreshToken()&&this._getSharePointToken?[4,this._getSharePointToken(this._server)]:[3,2];case 1:e=t.sent(),this._token=e,t.label=2;case 2:return[2,this._token||void 0]}})})},e.prototype._getAnnotationUrl=function(e){return"".concat(this._layerPath,"/").concat(e,"/").concat(Mt)},e.prototype._createBatchBody=function(e,t){var n,a="\r\n",i="changeset_".concat(_t.a.generate()),r=(0,Lt.b)(e,"".concat(Tt,'"').concat(i,'"'),"binary")+t.map(function(e){return n="--"+i+a,n+="Content-Type: application/http\r\n",n+="Content-Transfer-Encoding: binary\r\n",n+="Content-ID: "+(t=e).id+a,n+=a,n+=(0,Lt.a)(Ut,"".concat(Ut,";odata=verbose"),t.requestType,t.path),n+=a,t.data&&(n+=JSON.stringify(t.data)+a,n+=a),n;var t,n}).join("")+(n="--"+i+"--"+a,n+=a,n+="--"+e+"--"+a);return new Blob([r])},e.prototype._sendRequest=function(e){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r,o,s;return(0,a.SO)(this,function(c){switch(c.label){case 0:return[4,this._getToken()];case 1:return t=c.sent(),n=e.data,i=e.path,r=e.requestType,o=e.headers,s=n?n instanceof Blob?n:JSON.stringify(n):void 0,[2,this._dataRequestor.send({path:i,endpoint:"".concat(this._server,"/_api/v2.1"),headers:(0,a.q5)({Scenario:"Syntex_UniversalAnnotaion"},o),requestType:r,accessToken:t,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:s,expectedErrorCodes:{resourceModified:!0}})]}})})},e.dependencies={vroomDataRequestor:kt.a,pageContext:R.a},e}(),Ht=(0,H._y)("UniversalAnnotationDataSource",Ft),Rt=n(222),Nt=n(223),Bt=n(472),jt=n(199),Vt=n(35),zt=n(70),Gt="OneUpViewer";function Kt(e){return void 0===e&&(e="unknownViwer"),(0,j.e)("oneUp-".concat(e,".start"))}function Wt(e){return"number"==typeof e&&isNaN(e)?void 0:{data:e,needFlatten:!0}}var qt=function(){function e(e,t){var n=this;this.resetRumOneApiMeasurement=function(){n._rumone.undoAPIInstrument()},this._computeRenderTime=function(e){if(e){var t=e.startTime,n=e.endTime;if(!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t)return n-t}return 0},this._checkRenderTimeRequiredDataAvailable=function(e){if(e){var t=e.startTime,n=e.endTime;return!isNaN(t)&&null!==t&&!isNaN(n)&&null!==n&&n>t}return!1};var a=t.pageContext,i=e.loggerName,r=void 0===i?"oneup":i;this._pageContext=a,this._initialized=!1;var o=(0,Ce.a)();this._rumone=Rt.a.getRUMOneLogger({name:r,onLog:function(e,t){jt.a.withManager(o).logData({streamName:e,dictionary:t})}}),window.getRumOneForTAB=function(){return n._rumone}}return e.prototype.initRumoneLogger=function(){if(!this._initialized){this._initialized=!0;var e=this._pageContext&&this._pageContext.ariaCollectorUrl?new Qe.a(this._pageContext.ariaCollectorUrl).domain:"/Collector/3.0/";this._rumone.startAPIMeasurement({ignore:function(t){return t.indexOf(e)>=0},getAPIName:function(e){return e.toLowerCase().indexOf("/RenderListDataAsStream")?"RenderListDataAsStream":""}})}},e.prototype.logRumonePerformance=function(e,t){var n=this,i=e.viewerName,r=e.clientId,o=e.extension,s=e.fileSizeRange,c=e.embedStartLoadingTime,d=void 0===c?NaN:c,l=e.viewerStartTime,u=void 0===l?NaN:l,f=e.userClickTime,p=void 0===f?NaN:f,m=e.endTime,_=e.pageTransType,h=e.breakDownData,b=e.oneupScenario,g=e.isLightSpeed,v=e.isFullPageLogging,y=e.isServerSideTransfer,S=e.isFluentV9,D=e.isPdfNoTempAuth,I=e.isPdfUseToken,x=e.pdfSource,C=e.mip;d=this._regulateTime(d),p=this._regulateTime(p),m=this._regulateTime(m),u=this._regulateTime(u);var O=this._regulateTime(performance.timing.navigationStart),w=this._regulateTime(this._getResponseEnd()),E=this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")),A=p;isNaN(A)&&(A=d),isNaN(A)&&(A=O);var L=new Vt.b;if(this._rumone&&this._rumone.isRunning()){var k=v?"FullPageLoad":"Load",M=g?0===b?"ODSPEmbedLightSpeed.".concat(k):"ODSPOneUpLightSpeed.".concat(k):0===b?"ODSPEmbed.".concat(k):"ODSPOneUp.".concat(k);this._rumone.writeScenarioId(M),this._rumone.addExpectedControl(Gt),this._rumone.writePageTransitionType(void 0!==_?_:Nt.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();var P=location.href.toLowerCase().indexOf("embed.aspx")>=0;P&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext),(0,Le.ob)()&&e.isFastOneUp&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext);var T=new zt.a("OneUpRumOneHelper");T.on(this._rumone,"measureTTI",function(){var a=n._rumone.getPerformanceData();t&&t({EUPL:a.EUPL,TTI:a.TTI}),L.complete({FCI:a.TTI,FMP:a.EUPL,startTiming:n._regulateAbsoluteTime(A),AbsoluteFCI:n._regulateAbsoluteTime(a.TTI+A),AbsoluteFMP:e.endTime}),T.dispose()}),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:function(){return A}});var U=new Bt.a({controlId:Gt,startTime:A,endTime:m,renderTimeCalculator:this._computeRenderTime,renderTimeRequiredDataChecker:this._checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(U),h=(0,a.q5)((0,a.q5)({},h),{waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isEmbedASPXHosted:Wt(P),w3cResponseEnd:Wt(w-O),appStart:Wt(E-w),render:Wt(m-E),viewerRenderTime:Wt(m-u),oneUpViewer:Wt(i),oneUpClientId:Wt(r),oneUpFileExtension:Wt(o),oneUpFileSizeRange:Wt(s),beforeOneUpLoading:Wt(O-p),beforeOneUpLoadingIframeCost:Wt(O-d),beforeOneUpLoadingHostCost:Wt(d-p),userClickTime:Wt(p),embedStartLoadingTime:Wt(d),isLightSpeed:Wt(!!g),isServerSideTransfer:Wt(!!y),isFluentV9:Wt(!!S),isPdfNoTempAuth:void 0!==D?Wt(D):void 0,isPdfUseToken:void 0!==I?Wt(I):void 0,pdfSource:x&&Wt(x),mip:void 0!==C?Wt(C):void 0}),this._rumone.writeEUPLBreakdown(JSON.stringify(h))}return L.promise},e.prototype.resetRumOne=function(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)},e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()},e.prototype._regulateTime=function(e){return this._isDateTime(e)&&j.a?e-performance.timing.navigationStart:e},e.prototype._regulateAbsoluteTime=function(e){return!this._isDateTime(e)&&j.a?e+performance.timing.navigationStart:e},e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN},e}(),Qt=((0,H._y)("OneUpRumoneHelper",qt,{pageContext:R.a.optional}),new H.aF({name:"OneUpRumoneHelper",factory:{dependencies:{pageContext:R.a.optional},create:function(e){var t=e.pageContext;return{instance:{getOneUpRumoneLogger:function(e){return new qt(e,{pageContext:t})}}}}}})),Yt=n(250),Jt=n(473),Xt=new H.aF({name:"PdfSaveHelper.key",loader:new H.xT(function(){return n.e(53).then(n.bind(n,684)).then(function(e){return e.resourceKey})})});(0,l.ZW)([{rawString:".pdfWrapper_5bf134be{position:absolute;width:100%;height:100%}"}]);var Zt=n(39),$t=n(265),en=n(474),tn=n(73),nn=n(475),an={scale:1,rotation:0,currentScrollPosition:new tn.a(0,0),originalLayoutSize:{width:0,height:0},originalPageRects:[]},rn=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(15)]).then(n.bind(n,685))];case 1:return[2,e.sent().ESignWrapper]}})})},{useChildrenAsPlaceholder:!(0,Le.Hb)()}),on=n(58),sn=n(267),cn=n(149),dn=n(477),ln=n(231),un=n(42),fn=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(51)]).then(n.bind(n,686))];case 1:return[2,e.sent().PdfFilePicker]}})})}),pn=m().forwardRef(function(e,t){var n=e.filePickerProps,i=e.telemetryHandler,r=(0,a.dc)(e,["filePickerProps","telemetryHandler"]),o=r.mode,s=r.filename,c=void 0===s?"PDF":s,d=m().useState(""),l=d[0],u=d[1],f=m().useState(!1),p=f[0],_=f[1],h=m().useRef(),b=m().useRef(),g=m().useRef(),v=m().useRef([]),y=(0,dn.d)(t),S=(0,V.c)(),D=m().useCallback(function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i;return(0,a.SO)(this,function(a){return n=S.consume(R.a),i=S.consume(ln.a),[2,(0,sn.e)(e,n,i,t)]})})},[S]),I=(0,dn.c)(D),x=m().useMemo(function(){return c.endsWith(".pdf")?c.slice(0,-4):c},[c]),C=o===tt.a.Extract,O=m().useCallback(function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var i;return(0,a.SO)(this,function(a){return u("Extracted from ".concat(x)),null===(i=null==n?void 0:n.setMode)||void 0===i||i.call(n,"save"),h.current=e,b.current=t,[2]})})},[x,n]),w=m().useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t;return(0,a.SO)(this,function(a){return u("Encrypted from ".concat(x)),null===(t=null==n?void 0:n.setMode)||void 0===t||t.call(n,"save"),g.current=e,_(!0),[2]})})},[x,n]),E=m().useCallback(function(){var e;null===(e=null==n?void 0:n.setMode)||void 0===e||e.call(n,"close"),v.current=[]},[n]),A=m().useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t;return(0,a.SO)(this,function(r){switch(r.label){case 0:return null===(t=null==n?void 0:n.setMode)||void 0===t||t.call(n,"close"),[4,y({successText:cn.g,runningText:cn.f,failedText:cn.e,telemetryHandler:i,scenarioName:on.a.DocumentExtract,before:function(){var e;null===(e=b.current)||void 0===e||e.call(b)},runner:function(){return I(e,function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){return[2,null===(e=h.current)||void 0===e?void 0:e.call(h)]})})})}})];case 1:return r.sent(),[2]}})})},[n,I,y,i]),L=m().useCallback(function(e){var t;null===(t=null==n?void 0:n.setMode)||void 0===t||t.call(n,"close"),y({successText:cn.c,runningText:cn.b,failedText:cn.a,disableAutoHide:!0,telemetryHandler:i,scenarioName:on.a.DocumentEncrypt,runner:function(){return I(e,function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){return[2,null===(e=g.current)||void 0===e?void 0:e.call(g)]})})})}})},[n,I,y,i]),k=m().useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var r,o;return(0,a.SO)(this,function(s){switch(s.label){case 0:return Array.isArray(e)?(v.current=(0,a.lt)([],e,!0),u("Merged from ".concat(x)),null===(r=null==n?void 0:n.setMode)||void 0===r||r.call(n,"save"),[3,3]):[3,1];case 1:return null===(o=null==n?void 0:n.setMode)||void 0===o||o.call(n,"close"),[4,y({successText:cn.j,runningText:cn.i,failedText:cn.h,telemetryHandler:i,scenarioName:on.a.DocumentMerge,runner:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return[2,I(e,function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,i;return(0,a.SO)(this,function(r){switch(r.label){case 0:return[4,(0,sn.d)((0,a.lt)([],v.current,!0).map(function(e){return e.webDavUrl}),{credentials:"same-origin"})];case 1:return e=r.sent(),n=e.map(function(e){return new Uint8Array(e,0,e.byteLength)}),[2,null===(i=t.current)||void 0===i?void 0:i.merge(n)]}})})})]})})},after:function(){v.current=[]}})];case 2:s.sent(),s.label=3;case 3:return[2]}})})},[x,n,I,t,y,i]),M=m().useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return C?[4,A(e)]:[3,2];case 1:return t.sent(),[3,5];case 2:return p?(_(!1),L(e),[3,5]):[3,3];case 3:return[4,k(e)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},[p,C,L,A,k]),P=m().useMemo(function(){if(n){var e=S.consume(R.a),t=e.listId;t&&"{"===t[0]&&"}"===t[t.length-1]&&(t=t.substring(1,t.length-1));var i,r=n.item.parentKey;if(r){var o=new un.a({},{pageContext:e}).getItemUrlParts(r);i={entry:{sharePoint:{byPath:{web:o.serverRelativeWebUrl,list:o.fullListUrl,folder:o.listRelativeItemUrl}}},telemetry:{sessionId:null==e?void 0:e.CorrelationId}}}return(0,a.q5)((0,a.q5)({},n),{item:{listId:t,siteUrl:e.siteAbsoluteUrl,listItemId:n.item.listItemId},pickerPageUrl:"".concat(e.webAbsoluteUrl,"/").concat(e.layoutsUrl,"/FilePicker.aspx"),defaultNewFileName:l,options:i,onClose:E,onConfirm:M})}},[n,S,l,E,M]),T=m().useMemo(function(){return m().createElement(it.a,(0,a.q5)({ref:t},r,{execExtract:O,encryptDialogProps:r.encryptDialogProps&&(0,a.q5)((0,a.q5)({},r.encryptDialogProps),{execEncrypt:w})}))},[t,r,O,w]);return m().createElement(m().Fragment,null,T,P&&m().createElement(fn,(0,a.q5)({},P)))}),mn=m().memo(pn),_n=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(66).then(n.bind(n,706))];case 1:return[2,e.sent().UniversalAnnotationWrapper]}})})},{useChildrenAsPlaceholder:!(0,Le.Hb)()}),hn=p.memo(function(e){var t,n,i,r,o,s,c=p.useState(!1),d=c[0],l=c[1],u=p.useState(!1),f=u[0],m=u[1],_=p.useRef(null),h=p.useRef(null),b=p.useRef(null),g=p.useRef(null),v=e.universalAnnotationProps,y=e.eSignProps,S=(0,a.dc)(e,["universalAnnotationProps","eSignProps"]),D=S.itemId,I=S.onDocumentLoaded,x=S.height,C=S.addOnsEnabled,O=S.filename,w=S.fileSize,E=S.pdfItemViewer,A=void 0===E?mn:E,L=(0,$t.a)(function(){return S},S),k=(null==y?void 0:y.isEsignSidePanelActive)||(null==y?void 0:y.isEsignRecipient),M=p.useCallback(function(e){var t=e.pageCount,n=e.mip,a=e.isMipDecrypted,i=e.isAnnotAllowed,r=e.isFormFieldAllowed,o=e.isPrintAllowed,s=e.isFileEncrypted,c=e.isSigned;null==I||I({pageCount:t,mip:n,isMipDecrypted:a,isAnnotAllowed:i,isFormFieldAllowed:r,isPrintAllowed:o,isFileEncrypted:s,isSigned:c}),m(!0)},[I]),P=p.useCallback(function(){l(!0)},[]),T=function(e,t,n){var a=p.useState(en.d),i=a[0],r=a[1],o=p.useState(!1),s=o[0],c=o[1],d=p.useCallback(function(){var e,t,a,i,o=null!==(t=null===(e=n.current)||void 0===e?void 0:e.getPdfMetadata())&&void 0!==t?t:an;r({scale:(a=o).scale,rotation:a.rotation/en.k%4,currentScrollPosition:{x:a.currentScrollPosition.x,y:a.currentScrollPosition.y},originalLayoutSize:{height:a.originalLayoutSize.height,width:a.originalLayoutSize.width},originalPageRects:(i=a.originalPageRects,i.map(function(e){return{top:e.origin.y,left:e.origin.x,height:e.height,width:e.width}}))})},[n,n.current]);return(0,nn.a)(d),p.useEffect(function(){if(e&&t)return d(),void c(!0);e||c(!1)},[e,t]),{documentMetadataLoaded:s,documentMetadata:i}}(k||(null===(t=e.universalAnnotationProps)||void 0===t?void 0:t.isUniversalAnnotationActive),(0,Le.Hb)()?d&&f:f,_),U=T.documentMetadataLoaded,F=T.documentMetadata,H=(0,V.c)(),R=H.consume(Zt.resourceKey),N=p.useCallback(function(e,t){var n,a;(null==C?void 0:C.universalAnnotation)&&(null===(n=h.current)||void 0===n||n.updateScrollPosition(e,t)),(null==C?void 0:C.eSign)&&(null===(a=b.current)||void 0===a||a.updateScrollPosition(e,t))},[]),B=(0,be.a)(function(e){var t,n;(null==C?void 0:C.universalAnnotation)&&(null===(t=h.current)||void 0===t||t.zoom(e)),(null==C?void 0:C.eSign)&&(null===(n=b.current)||void 0===n||n.zoom(e))}),j=(0,be.a)(function(e){var t;(null==C?void 0:C.universalAnnotation)&&(null===(t=h.current)||void 0===t||t.updateCursorType(e))}),z=(0,be.a)(function(){var e,t;(null==C?void 0:C.universalAnnotation)&&(null===(e=h.current)||void 0===e||e.rotateClockwise()),(null==C?void 0:C.eSign)&&(null===(t=b.current)||void 0===t||t.rotateClockwise())}),G=p.useMemo(function(){return p.createElement("div",{ref:g,className:"pdfWrapper_5bf134be"},p.createElement(A,(0,a.q5)({},L,{height:(null==y?void 0:y.isEsignRecipient)?void 0:L.height,ref:_,onDocumentLoaded:M,onRenderViewport:(0,Le.Hb)()?P:void 0,enableToolbar:!((null==C?void 0:C.eSign)&&k),shouldPlaceToolbarOnTop:!0,onScrollPositionUpdated:N,onRotationChanged:z,onScaleChanged:B,onCursorUpdate:j})))},[A,L,null==y?void 0:y.isEsignRecipient,M,P,null==C?void 0:C.eSign,k,N,z,B,j]);if((null==C?void 0:C.universalAnnotation)&&v){var K=v.driveId,W=v.progressRegister,q=v.onPreloadFailure,Q=v.onPreloadSuccess,Y=v.isUniversalAnnotationActive,J=H.consume(Ht);o=p.createElement(_n,{pdfItemViewerRef:_,pdfAppRef:g,universalAnnotationRef:h,isUniversalAnnotationActive:Y,progressRegister:W,dataSource:J,driveId:K,itemId:D,onPreloadFailure:q,onPreloadSuccess:Q,viewerHeight:x,documentMetadataLoaded:U,documentMetadata:F},G)}if(null==C?void 0:C.eSign){var X=y||{},Z=X.uniqueId,$=X.isEsignSidePanelActive,ee=void 0!==$&&$,te=X.setIsEsignSidePanelActive,ne=X.parentItemPermission,ae=X.parentItemUri,ie=X.isEsignRecipient,re=X.documentUrl,oe=X.canSendToExternalRecipients,se=X.canAddNewExternalUser,ce=X.hasParentItemPermissionsLoaded,de=X.onUpdateToast,le=!!(Z&&O&&re&&w&&te&&(null===(n=_.current)||void 0===n?void 0:n.getEventHandlers)),ue=_.current||{},fe=ue.rotate,pe=ue.scrollTo,me=ue.getEventHandlers,_e=ue.hasSignature;((0,Le.Cb)()||le)&&(s=p.createElement(rn,{item:{itemId:Z||"",name:O||"",size:w||0,openUrl:re||"",parent:{permissions:ne,openUrl:ae||"",hasLoaded:ce}},esignWrapperRef:b,showCreatePanel:ee,isRecipient:ie,documentMetadataLoaded:U,documentMetadata:F,onCancelClick:function(){return null==te?void 0:te(!1)},getSessionToken:R.getOAuthSessionToken.bind(R),documentRotate:fe,documentScrollTo:pe,height:null!==(r=null!=x?x:null===(i=g.current)||void 0===i?void 0:i.clientHeight)&&void 0!==r?r:0,getEventHandlers:me,hasSignature:_e,isNewDesign:null==y?void 0:y.isNewOneup,creatorPermissions:{canAddExistingExternalRecipient:oe,canAddNewExternalRecipient:se},onUpdateToast:function(e){return null==de?void 0:de("eSign",(0,a.q5)((0,a.q5)({},e),{actionButtons:void 0}))}},o||G))}return s||o||G}),bn=n(86),gn=n(59),vn=n(513),yn=n(57),Sn=n(20),Dn=n(124),In=n(252),xn=n(253),Cn={"PDF Save Failed":["GetPdfStreamFailed","UploadFileDataFailed"],"PDF Load Failed: Init":["GetDocument","GetDownloadUrl","GetWasmAsset","WasmCacheFailed","WasmModuleInitFailed","WasmModuleNotFound"],"PDF Load Failed: Previewer":["PreviewerFailToFetchFile","PreviewerFailToLoadPage","PreviewerFailToLoadTask","PreviewerUnmounted"],"PDF Load Failed: WasmRuntime":["RuntimeError","WasmRuntimeError"],"PDF Load Failed: Others":["AnnotationAddFailed","EventHandleFailed","FileDownloadFailed","FontLoadFailed","InvalidPDF","PrintFailed","RangeDownloadSizeMismatch","RangeError","ShowThumbnailFailed","TypeError","PDFWorkerMismatch","ViewContextNotInitialized"]},On=function(e){switch(e){case"PDF.Edit":return"Edit";case"PDF.Load":return"View";default:return"None"}},wn=function(e){var t=function(){var t=e||"None";return t.endsWith("GetDocument")?"GetDocument":t.endsWith("GetDownloadUrl")?"GetDownloadUrl":t.endsWith("GetWasmAsset")?"GetWasmAsset":t}();return Object.keys(Cn).find(function(e){var n;return-1!==(null===(n=Cn[e])||void 0===n?void 0:n.indexOf(t))})||"None"},En=function(e,t){var n=this;this._qosEventMap={},this.logQosStart=function(e){var t=e.payload.name,i=function(e){switch(e){case on.a.DocumentSave:return"PDF.Edit";case on.a.DocumentLoad:return"PDF.Load";default:return}}(t),r={scenario:i||"PDF."+t,pillar:On(i),perfGoalInMs:18e5,extraData:(0,a.q5)((0,a.q5)({viewerName:"MSPdf"},n._initExtraData),e.payload.extraData)};n._qosEventMap[t]=new we(r)},this.logQosEnd=function(e){var t=e.payload,i=t.name,r=t.status,o=t.extraData,s=n._qosEventMap[i];if(s){var c;if(r===on.b.Succeed)c={resultType:xe.c.Success,extraData:(0,a.q5)((0,a.q5)({},n._initExtraData),o)};else{var d=n._resource.consume(bn.a.optional);An(e.payload,!!(null==d?void 0:d.offline));var l=e.payload,u=l.code,f=l.error,p=l.isExpected,m=(0,a.q5)((0,a.q5)((0,a.q5)({},n._initExtraData),e.payload.extraData),{error:f.message});c={resultType:p?xe.c.ExpectedFailure:xe.c.Failure,errorCode:u,veto:wn(u),extraData:(0,a.q5)((0,a.q5)({},m),{pdfDiagnosticInfo:ke(m)})}}s.end(c),n._qosEventMap[i]=void 0}},this.logError=function(e){var t=e.payload,n=t.error,a=t.extraData,i={};for(var r in a)if(a.hasOwnProperty(r)){var o=a[r];i[r]=JSON.stringify(o)}yn.a.logError(n,i)},this.logEngagement=function(e){var t=e.payload,n=t.name,i=t.extraData,r=t.actionScenario,o={location:"MsPdfViewer",usageType:vn.a[vn.a.Click],isIntentional:!0};Sn.a.logData((0,a.q5)((0,a.q5)({},o),{name:n,extraData:(0,a.q5)((0,a.q5)({},i),{actionScenario:r})}))},this.logVerbose=function(e){if(!(0,In.k)()&&!(0,xn.b)(Le.d.ECS)){var t=e.payload,n=t.name,a=t.message;Dn.a.logData({name:n,message:a})}},this._resource=e,this._initExtraData=t};function An(e,t){if(e.error.name===gn.d.NetworkError){var n=e.extraData,i=null==n?void 0:n.status,r=null==n?void 0:n.responseHeaders;e.isExpected=!!i&&(406===i||412===i)||t||e.isExpected,e.extraData=(0,a.q5)((0,a.q5)({},n),{correlationId:(null==r?void 0:r.get("SPRequestGuid"))||(null==r?void 0:r.get("X-Correlationid"))||void 0,requestId:(null==r?void 0:r.get("request-id"))||void 0})}}(0,l.ZW)([{rawString:".root_c10f3fe1{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}"}]);const Ln="root_c10f3fe1";var kn=n(254),Mn=n(262);function Pn(e){return e.ok||(t=e.status)>=400&&t<500;var t}var Tn=/&(?:access_|proof)token=[^&]*/g;function Un(e){var t=e.resources,n=e.thumbnailUrl,i=e.isRetry,r=e.viewerName,o=e.forceRefresh,s=void 0!==o&&o,c=e.isMeTA;return(0,a.yv)(this,void 0,void 0,function(){var e,o,d,l,u,f,p,m;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n?c?[4,t.consume(Ke)({forceRefresh:s})]:[3,2]:[2,{error:new Error("ThumbnailUrl is empty")}];case 1:e=a.sent(),a.label=2;case 2:return a.trys.push([2,10,,11]),[4,fetch(n||"",{headers:e})];case 3:return o=a.sent(),200!==(d=o.status)?[3,5]:[4,o.blob()];case 4:return l=a.sent(),[2,{blobUrl:URL.createObjectURL(l)}];case 5:return 401!==d&&400!==d||i?[3,8]:(u=n,(0,ze.a)()?[3,7]:[4,Nn(t,n)]);case 6:u=a.sent(),a.label=7;case 7:if(u)return[2,Un({resources:t,thumbnailUrl:u,isRetry:!0,viewerName:r,forceRefresh:!0,isMeTA:c})];a.label=8;case 8:return f=(0,kn.b)(o),p=f.correlationId,m=f.failureReason,[2,{error:new H.qt({isExpected:Pn(o),code:"".concat(d.toString(),": ").concat(r,"UrlFetchException"),correlationId:p,extraData:{failureReason:m}})}];case 9:return[3,11];case 10:return[2,{error:a.sent()}];case 11:return[2]}})})}function Fn(e,t){var n="isExpected"in e?!!e.isExpected:void 0,i="correlationId"in e?e.correlationId:void 0,r=Hn(e),o=Hn(t),s=Rn(e),c=Rn(t);return new H.qt({isExpected:n,code:"".concat(r,"_").concat(o),correlationId:i,extraData:(0,a.q5)((0,a.q5)({},s),c)})}function Hn(e){return"code"in e?e.code:"".concat(e.name,": ").concat(e.message)}function Rn(e){return"extraData"in e?e.extraData:void 0}function Nn(e,t){return(0,a.yv)(this,void 0,void 0,function(){var n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,e.consumeAsync(Mn.a)];case 1:return[4,a.sent().refreshAuthToken()];case 2:return(n=a.sent())?(i=n.authToken,r=n.proofToken,[2,t.replace(Tn,"&access_token=".concat(i).concat(r?"&prooftoken=".concat(r):""))]):[3,4];case 3:return a.sent(),[2];case 4:return[2]}})})}function Bn(e){var t,n=this,i=e.item,r=e.onViewerLoaded,o=e.isMainViewer,s=e.offset,c=p.useState((null===(t=null==i?void 0:i.thumbnail)||void 0===t?void 0:t.url)||""),d=c[0],l=c[1],u=p.useState(!0),f=u[0],m=u[1],_=(0,V.c)(),h=_.consume(je.e),b=!!_.consume(De.e.optional),g=p.useRef(),v=p.useRef(),y=p.useState(!0),S=y[0],D=y[1],I=p.useRef();p.useEffect(function(){o||g.current||(g.current=new we({scenario:"OneUpLightSpeed.thumbnailViewer",perfGoalInMs:ye.c,extraData:{oneUpRenderingMode:b?ye.e.fastOneUp:ye.e.inlineOneUpFirstPage}}))},[o,g,b]);var x=(0,be.a)(function(t){var n,r=(0,ve.a)(t),s=r.resultType,c=r.resultCode,d=r.extraData;o?(h.updateErrorState("oneupThumbnailViewer",{errorType:ye.d.viewerInitLoadingError,error:t,item:i,extraData:(0,a.q5)({viewer:Se.a.Thumbnail,extension:i&&i.extension||"",url:null===(n=null==i?void 0:i.thumbnail)||void 0===n?void 0:n.url},d),meTAQos:v.current}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(t,"ThumbnailViewer")):g.current&&(g.current.end({resultType:s,errorCode:c,extraData:(0,a.q5)({viewer:Se.a.Thumbnail,extension:i&&i.extension||""},d)}),g.current=void 0)}),C=(0,be.a)(function(e){return(0,a.yv)(n,void 0,void 0,function(){var t,n,r,o,s,c,d,u,f;return(0,a.SO)(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),(0,Le.$b)()&&i&&(v.current||(0,Le.Y)()&&!(null===(f=i.thumbnail)||void 0===f?void 0:f.url))?(t=i.thumbnail||{},n=t.width,r=t.height,o=n&&r?{width:n,height:r}:void 0,[4,_.consume(He.a).getThumbnailUrl(i,{useDirectEndpoint:!0,size:o})]):[3,2];case 1:if(s=a.sent()||{},c=s.blobUrl,d=s.error,!c)throw d?Fn(e,d):e;return l(c),m(!1),[3,3];case 2:throw e;case 3:return[3,5];case 4:return u=a.sent(),x(u),m(!1),[3,5];case 5:return[2]}})})});p.useEffect(function(){var e;if(0===s){var t=null===(e=null==i?void 0:i.thumbnail)||void 0===e?void 0:e.url,n=(0,kn.a)(t);n&&(v.current=(0,Ee.a)(Se.a.Thumbnail)),Un({resources:_,thumbnailUrl:t,viewerName:Se.a.Thumbnail,isMeTA:n}).then(function(e){var t,n=e.blobUrl,a=e.error;if(n)l(n),null===(t=g.current)||void 0===t||t.end({resultType:ge.b.Success,extraData:{viewer:Se.a.Thumbnail,extension:i&&i.extension||""}});else if(a)throw a;m(!1)}).catch(function(e){C(e).catch(function(){})})}},[_,s,C,i,r,o]);var O=(0,be.a)(function(){var e;if(S&&r){var t=I.current;if(t&&"code"in t&&(t.code="".concat(t.code,"-VroomLoadSuccess")),o){var n=v.current;v.current&&t&&((0,Ee.b)(v.current,void 0,t),n=void 0),r({extraData:{url:null===(e=i.thumbnail)||void 0===e?void 0:e.url},meTAQos:n})}D(!1)}}),w=(0,be.a)(function(e){var t=I.current;t?("code"in t&&(t.code="".concat(t.code,"-VroomLoadFail")),x(t)):x(new Error(e.type))});return 0===e.offset&&!f&&d?p.createElement("div",{className:Ln},p.createElement("img",{alt:"",src:d,onLoad:O,onError:w})):p.createElement(p.Fragment,null)}var jn=n(33),Vn=n(129),zn=n(366),Gn=function(e){var t;switch(e&&(null===(t=e.cloudType)||void 0===t?void 0:t.toLowerCase())){case"prod":case"prodbubble":case"ag08":case"ag09":case"chn":case"dod":case"gcch":case"gcc":return"396ef0b6-ae1c-4404-86ce-0a869d4d2987";default:return"9471276c-aa67-4dd2-bde2-291a033f3c3c"}};function Kn(e){var t=e.isSyntexESignatureEnabled,n=e.isSyntexPAYGEnabled;return!!((0,Le.wb)(Le.F)||t&&n)}function Wn(e){var t=e.webTemplate,n=e.listBaseTemplate;return!(t===jn.b.mySite.toString()||n===Vn.a.mySiteDocumentLibrary)}var qn=n(165),Qn=new H.aF({name:"IdentityDataSource.key",loader:new H.xT(function(){return Promise.resolve().then(n.bind(n,39)).then(function(e){return e.resourceKey})})}),Yn=function(){return{pdfDownloadTime:Wt(et.a.getDurationBetweenMarks("Start","Downloaded")),pdfOpenTime:Wt(et.a.getDurationBetweenMarks("Downloaded","Opened")),pdfFirstRenderTime:Wt(et.a.getDurationBetweenMarks("Opened","FirstRenderCompleted"))}},Jn=function(e){return ot.a.language.toLowerCase()===e||ot.a.cultureLCID.toLowerCase()===e||window.navigator.language.toLowerCase()===e},Xn=["NoConnection","expiredToken"];function Zn(e){var t,n,i,r,o=this;void 0===(r="MSPdf")&&(r="unknownViwer"),(0,j.f)("oneUp-".concat(r,".start"));var s=e.item,c=e.offset,d=e.parentItem,l=e.onViewerLoaded,u=e.onLogFullPageRumone,f=e.fallbackToOtherViewer,m=(0,je.f)("currentState",function(e){var t;return null!==(t=e.pdfAppMode)&&void 0!==t?t:tt.a.View})[0],_=(0,je.f)("currentState",function(t){var n,a,i;return e.item?null===(i=null===(a=null===(n=t.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===a?void 0:a.pdfViewerStates)||void 0===i?void 0:i.filePickerMode:"close"})[0],h=(0,je.f)("currentState",function(t){var n,a,i;return!!e.item&&(null===(i=null===(a=null===(n=t.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===a?void 0:a.pdfViewerStates)||void 0===i?void 0:i.isPdfMip)})[0],b=(0,V.c)(),g=b.consume(Yt.b),v=b.consume(Ht),y=b.consume(He.a),S=b.consume(je.e),D=b.consume(R.a),I=b.consumeAsync(Xt),x=b.consume(Et),C=b.consume(ft),w=b.consume(N.a),E=b.consume(bn.a.optional),A="ZXNpZ24"===w.viewParams[qe.b.navParamKey],L=(0,je.f)("currentState",function(e){return e.pdfEncryptDialogVisible})[0],k=(0,je.f)("currentState",function(e){return e.eSignData})[0],M=(0,je.f)("currentState",function(e){return e.annotationViewerState})[0],P=p.useState(!1),T=P[0],U=P[1],B=p.useState(!1),z=B[0],G=B[1],K=p.useState(!1),W=K[0],q=K[1],Q=p.useState(void 0),Y=Q[0],J=Q[1],X=p.useState({}),Z=X[0],$=X[1],ee=p.useRef(!1),te=p.useRef(Jn("zh-cn")),ne=p.useMemo(function(){return 0===c},[c]),ae=T&&ne?"OneUp-pdf OneUp-pdf--loaded":"OneUp-pdf",ie=p.useMemo(function(){return s?x.evaluateAction({item:s}):void 0},[x,s]),re=p.useMemo(function(){return s?C.evaluateAction({item:s}):void 0},[C,s]),oe=p.useRef();void 0===oe.current&&(oe.current=!g.isNotEmbed());var se=p.useRef();void 0===se.current&&(se.current=!oe.current&&(!(0,Le.Hb)()||function(e){return Wn(e)&&Kn(e)}(D)));var ce=p.useRef();void 0===ce.current&&(ce.current=(0,Le.wb)(Le.W)&&v.hasLicense&&!oe.current);var de=p.useRef();p.useEffect(function(){var e=new En(b,{pdfSource:g.getPdfSource(null==s?void 0:s.pdfConversion)});de.current=e,(0,nt.b)(H.x9.isActivated),(0,at.b)(e)},[b,null==s?void 0:s.key]);var le=(0,be.a)(function(){return(0,a.yv)(o,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,b.consumeAsync(Qn)];case 1:return e=t.sent(),[3,3];case 2:return t.sent(),[2,void 0];case 3:try{if(e.getAzRMSToken)return[2,e.getAzRMSToken().then(function(e){return e.accessToken})];throw new Error("Identity datasource not found for AzRMS token")}catch(e){if("handleError"===e.code)return[2,void 0];throw e}return[2]}})})}),ue=p.useRef(),fe=p.useRef(),pe=(0,be.a)(function(e){e.url===Z.url&&e.token===Z.token||($((0,a.q5)({},e)),(0,kn.a)(e.url)&&(fe.current=(0,Ee.a)(Se.a.MSPdf)))}),me=(0,be.a)(function(e,t){if(0===c){var n=e,i=n.code,r=!!n.isExpected||!!(null==E?void 0:E.offline)||-1!==Xn.indexOf(i||""),o="".concat(i||e.name||"UnknownError",".").concat(t),d=e instanceof H.qt?new H.qt((0,a.q5)((0,a.q5)({},e),{code:o,isExpected:r})):new H.qt({code:o,isExpected:r,message:e.details||e.message||JSON.stringify(e)});S.updateErrorState("oneupPDFViewer",{errorType:ye.d.viewerInitLoadingError,error:d,item:s}),f&&f(d,"MSPDFViewer")}}),_e=(0,be.a)(function(){z&&G(!1),T||U(!0)}),he=(0,be.a)(function(t){var n;_e(),e.item&&S.updateViewerState("updatePdfViewerLoaded",{key:e.item.key,options:{pdfViewerStates:{isOpened:!0,isPdfMip:null==t?void 0:t.mip,isAnnotAllowed:null==t?void 0:t.isAnnotAllowed,isPrintAllowed:(0,In.d)()||null===(n=null==t?void 0:t.isPrintAllowed)||void 0===n||n,isFileEncrypted:null==t?void 0:t.isFileEncrypted,isSigned:null==t?void 0:t.isSigned}}})}),ve=(0,be.a)(function(){_e(),e.item&&S.updateViewerState("updatePasswordProtectedPdf",{key:e.item.key,options:{pdfViewerStates:{isPdfPasswordProtected:!0}}})}),De=(0,be.a)(function(e){if(0===c){An(e,!!(null==E?void 0:E.offline));var t=e.code,n=e.isExpected,a=e.extraData,i=e.error,r=new H.qt({code:t,correlationId:null==a?void 0:a.correlationId,isExpected:n,message:i.message,innerError:i,extraData:a});S.updateErrorState("oneupPDFViewer",{errorType:ye.d.viewerInitLoadingError,error:r,item:s,meTAQos:fe.current,extraData:{url:Z.url}}),f&&f(r,"MSPDFViewer")}}),Ie=(0,be.a)(function(t){!(0,In.a)()&&t===tt.a.Edit&&(null==M?void 0:M.isActive)&&S.toggleAnnotationViewerVisiblity("OneUpMSPDFViewer"),e.item&&S.updatePdfState("updatePdfAppMode",t)}),xe=(0,be.a)(function(t){e.item&&S.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:t}}})}),Ce=p.useCallback(function(e){return(0,a.yv)(o,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,b.consumeAsync(Jt.b.optional)];case 1:switch(t=n.sent(),e){case Jt.a.Modified:null==t||t.notifyModified();break;case Jt.a.ExitEdit:null==t||t.notifyExitEdit()}return[2]}})})},[b]),Oe=(0,be.a)(function(e){e.dirty&&Ce(Jt.a.Modified)}),we=(0,be.a)(function(){Ce(Jt.a.Modified)}),ke=(0,be.a)(function(){return S.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!1)}),Me=(0,be.a)(function(){return S.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!0)}),Pe=(0,st.a)({register:function(){},start:function(){},setMaximum:function(e){},setCurrent:function(e){},succeed:function(){Me()},fail:function(){ke()}},[Me,ke]),Te=(0,be.a)(function(){return(0,a.yv)(o,void 0,void 0,function(){var e;return(0,a.SO)(this,function(t){switch(t.label){case 0:return s&&((0,In.e)()||g.isPdfEditAvailable(s)&&g.isPdfEditable(s))?(0,In.t)()?[3,1]:[2,y.getItemCurrentVersion(s,{useDirectEndpoint:!0})]:[2,Promise.resolve("")];case 1:return[4,I];case 2:return[2,(null==(e=t.sent())?void 0:e.getItemCurrentVersion(s,D))||Promise.resolve("")]}})})}),Fe=p.useCallback(function(){return(0,a.yv)(o,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,ue.current];case 1:return e=n.sent()||Promise.resolve(""),[4,Te()];case 2:return t=n.sent(),[2,!!e&&!!t&&t!==e]}})})},[Te]),Re=(0,be.a)(function(t){return(0,a.yv)(o,void 0,void 0,function(){var n,i,r,o,c,d,l;return(0,a.SO)(this,function(a){switch(a.label){case 0:return s&&t?oe.current?[4,b.consumeAsync(Jt.b.optional)]:[3,2]:[2,Promise.reject(new Error("Invalid document"))];case 1:return[2,null==(n=a.sent())?void 0:n.execSave(t)];case 2:return[4,I];case 3:return[4,a.sent().execSave({item:s,parentItem:e.parentItem,oneUpStateStore:S,pageContext:D,fileData:t})];case 4:return i=a.sent(),(null===(l=null==i?void 0:i.extraData)||void 0===l?void 0:l.schema)&&(r=i.extraData.schema,o=r.resultType,c=r.resultCode,d=r.extraData,o!==ge.b.Success)?[2,Promise.reject(new Error("errorCode:".concat(c,", extraData:").concat(JSON.stringify(d))))]:(ue.current=Te(),[2])}})})}),Ne=(0,be.a)(function(){var e;(null==ie?void 0:ie.isAvailable)&&(null===(e=ie.onExecute)||void 0===e||e.call(ie,{}))}),Be=(0,be.a)(function(){var e;(null==re?void 0:re.isAvailable)&&(null===(e=re.onExecute)||void 0===e||e.call(re,{}))}),Ve=(0,be.a)(function(){s&&(g.isPreviewerEnabled(s)||g.isProgressiveLoadingEnabled(s))&&(z&&G(!1),q(!0)),l&&l({perfData:{euplBreakDownData:et.a.getMarkerTime("Previewed")?{pdfTTI:Wt(et.a.getDurationBetweenMarks("Start","Previewed"))}:(0,a.q5)((0,a.q5)({},Yn()),{pdfTTI:Wt(et.a.getDurationBetweenMarks("Start","FirstRenderCompleted"))}),extraPerfData:(0,a.q5)((0,a.q5)({},g.getTempAuthLogData(Z)),{pdfSource:g.getPdfSource(null==s?void 0:s.pdfConversion),mip:null!=h&&h})},meTAQos:fe.current,extraData:{url:Z.url}})}),ze=(0,be.a)(function(){(0,In.m)()||null==u||u({perfData:{euplBreakDownData:Yn(),extraPerfData:(0,a.q5)((0,a.q5)({},g.getTempAuthLogData(Z)),{pdfSource:g.getPdfSource(null==s?void 0:s.pdfConversion),mip:null!=h&&h})}})}),Ge=(0,be.a)(function(){T||W||G(!0)});p.useEffect(function(){var e=setTimeout(function(){Ge()},1e4);return function(){return clearTimeout(e)}},[Ge]),p.useEffect(function(){if((0,In.v)()||!ee.current){var e=Yt.a.GetDownloadUrl,t=function(){return(0,a.yv)(o,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return(null===(t=s.pdfConversion)||void 0===t?void 0:t.url)?[4,y.getMetaPac(b,s)]:[3,2];case 1:if((e=n.sent()).metaPac)return[2,[{name:"X-SPOPacToken",value:e.metaPac}]];n.label=2;case 2:return[2,[]]}})})};(0,a.yv)(o,void 0,void 0,function(){var n,i,r,o,c;return(0,a.SO)(this,function(a){switch(a.label){case 0:return s?(ee.current=!0,(n=s.pdfConversion)?(i=n.url)?[2,{url:i,getAuthHeaders:(0,In.n)()||!(0,kn.a)(i)||(0,Ae.b)(i)?void 0:t}]:[4,y.getAuthenticationParams(s)]:[3,2]):[2,{}];case 1:return r=a.sent(),[2,{url:"".concat(y.getItemUrl(s,{useDirectEndpoint:!0}),"/content?format=pdf&").concat((0,Ue.a)(r))}];case 2:return g.isNoTempAuthEnabled()?[4,y.getDownloadUrl(s,{useDirectEndpoint:!0,excludeTempAuth:g.isTempAuthDeprecated(s)})]:[3,6];case 3:return o=a.sent(),g.isSameDomainEmbed(o)?[2,{url:o}]:(c=void 0,(0,Ae.b)(o)?[3,5]:(e=Yt.a.GetDownloadToken,[4,y.getDownloadToken({url:o,item:s})]));case 4:c=a.sent(),a.label=5;case 5:return[2,{url:o,token:c}];case 6:return[2,y.getDownloadUrl(s,{useDirectEndpoint:!0}).then(function(e){return{url:e}})]}})}).then(pe,function(t){return me(t,e)})}},[y,s,g,me,pe,b]),p.useEffect(function(){ue.current=Te()},[s,Te]),p.useEffect(function(){se.current&&A&&Ie(tt.a.Esign)},[Ie,A]),p.useEffect(function(){var e,t,n,i,r=(0,a.q5)((0,a.q5)({},qn.b),{semanticColors:(0,a.q5)((0,a.q5)({},qn.b.semanticColors),{bodyBackground:"transparent"})}),o=s?null===(e=g.getEmbedOptions())||void 0===e?void 0:e.allowEdit:void 0,c=s?g.isPdfEditAvailable(s)&&g.isPdfEditable(s)&&(!oe.current||o):void 0,l={enableDownload:null==ie?void 0:ie.isAvailable,enableOpenInBrowser:null==re?void 0:re.isAvailable,onDownload:Ne,onOpenInBrowser:Be},u=(0,Le.wb)(Le.m)?{enableOpenMip:!0,getMIPToken:le,mipDialogProps:l}:{enableOpenMip:!1,mipDialogProps:l},f=g.isPdfEncryptAvailable(s)?{closeEncryptDialog:function(){S.updatePdfEncryptDialogVisibleState("updatepdfEncryptDialogVisibleState",!1)},encryptVisible:L}:void 0,p=s?(0,a.q5)((0,a.q5)({url:"",filename:null==s?void 0:s.displayName,fileSize:s.size,mode:m,encryptDialogProps:f,enableThumbnailView:m===tt.a.Extract,telemetryHandler:de.current,enableEdit:c&&!h,enablePreRender:(0,Le.wb)(Le.u),enableProgressiveLoading:g.isProgressiveLoadingEnabled(s),enablePrint:(0,In.d)()||g.isPdfPrintable(s),darkMode:!0,theme:r,enablePreview:g.isPreviewerEnabled(s),shouldAutoFocus:!1,showOpenInNewWindow:!1,openUrl:"",toolbarAttributes:{"data-handle-special-keys":"Left Right Esc"},enableCopyByChunk:!(0,In.o)(),enableDebugString:(0,Le.wb)(Le.p)&&!oe.current,formAttributes:"data-suppresskeyboardbinding"},u),{shouldExitEditModeAfterSave:!oe.current,allowUnloadPageWithEdits:oe.current,enableCacheDisplayInfo:(0,Le.wb)(Le.o),uniqueId:null===(t=s.properties)||void 0===t?void 0:t.uniqueId,onDocumentLoaded:he,onNeedPassword:ve,onCurrentPageChanged:function(){},onInitError:De,onEditStateChanged:oe.current?Oe:void 0,onExitEditMode:oe.current?we:void 0,updateMode:Ie,execSave:Re,isFileVersionChanged:Fe,itemId:null===(n=s.graph)||void 0===n?void 0:n.itemId,onFirstRenderVisible:Ve,onDocumentFullyLoaded:ze,filePickerProps:{app:"OneDrive",mode:null!=_?_:"close",setMode:xe,getIconUrl:function(e){return"".concat(O).concat(e,"/").concat((0,rt.a)("pdf"),".png")},item:{listItemId:(null===(i=s.properties)||void 0===i?void 0:i.ID)||"",parentKey:d.key||""}}}):void 0;p&&(p=(0,a.q5)((0,a.q5)({},p),{addOnsEnabled:{eSign:se.current,universalAnnotation:ce.current}})),J(p)},[m,null==ie?void 0:ie.isAvailable,Re,_,le,he,Ne,Oe,we,De,ze,Ve,Be,xe,Ie,Fe,s,ve,null==re?void 0:re.isAvailable,d.key,g,de,S,L,h]);var Ke=window.require,We=Ke.toUrl?Ke.toUrl("item-viewer-pdf/"):void 0,Qe=null===(t=Ke.toUrl)||void 0===t?void 0:t.call(Ke,"pdf.worker.min.js"),Ye=null===(n=Ke.toUrl)||void 0===n?void 0:n.call(Ke,"pdfjs-dist/cmaps/");p.useEffect(function(){var e=b.consume($e),t=(0,Le.wb)(Le.m)?{mipWasmUrl:"".concat(We,"mspdf2.wasm"),mipWasmJsUrl:"".concat(We,"mspdf2.min.js")}:{},n=(0,a.q5)((0,a.q5)({workerUrl:e.getWorkerUrl("".concat(We,"index.worker.js"),g.getWorkerManifestName()),pdfJsWorkerUrl:Qe&&s&&g.isPreviewerEnabled(s)?e.getWorkerUrl(Qe,"pdfwebworker"):void 0,pdfJsCMapUrl:Ye,wasmUrl:"".concat(We,"mspdfkit.wasm"),wasmJsUrl:"".concat(We,"mspdfkit.min.js"),dataUrl:"".concat(We,"mspdfkit.data")},t),{parserWasmUrl:s&&(g.isPdfExtractAvailable(s)||g.isPdfEncryptAvailable(s))?"".concat(We,"mspdfparser.wasm"):void 0,parserWasmJsUrl:s&&(g.isPdfExtractAvailable(s)||g.isPdfEncryptAvailable(s))?"".concat(We,"mspdfparser.min.js"):void 0}),i="".concat(We,"media/fonts/"),r="arial.ttf",o=[{fontUrl:"".concat(i).concat(r),fontName:r}];te.current?(r="noto_sans_sc.ttf",o.push({fontUrl:"".concat(i).concat(r),fontName:r})):Jn("ja")||Jn("ja-jp")?(r="noto_sans_jp.otf",o.push({fontUrl:"".concat(i).concat(r),fontName:r})):Jn("ko")||Jn("ko-kr")?(r="noto_sans_ko.ttf",o.push({fontUrl:"".concat(i).concat(r),fontName:r})):!(0,In.j)()&&(Jn("zh-tw")||Jn("zh-hk")||Jn("zh-mo"))&&(r="noto_sans_tc.ttf",o.push({fontUrl:"".concat(i).concat(r),fontName:r}));var c={enableFreeText:(0,Le.wb)(Le.s)&&!te.current,enableFormFilling:(0,Le.wb)(Le.r)&&!te.current,enableEnhancedInk:(0,Le.wb)(Le.q),enableOptimizedPinch:(0,Le.wb)(Le.u)&&(0,Le.wb)(Le.t),enableNewAnnotationBar:(0,Le.wb)(Le.j),enableEncrypt:g.isPdfEncryptAvailable(s),enableMipSdkTelemetry:(0,Le.wb)(Le.i)};(0,it.b)(n,o,c)},[We,Ye,s,Qe,g,b]);var Je=p.useMemo(function(){var e;return{isUniversalAnnotationActive:0===c&&!!(null==M?void 0:M.isActive),driveId:null===(e=null==s?void 0:s.graph)||void 0===e?void 0:e.driveId,onPreloadFailure:ke,onPreloadSuccess:Me,progressRegister:function(){return Pe}}},[null==M?void 0:M.isActive,Pe,null===(i=null==s?void 0:s.graph)||void 0===i?void 0:i.driveId,ke,Me,c]);p.useEffect(function(){var e=d.permissions,t=d.openUrl;!(null==k?void 0:k.isCreateSidePanelActive)||e&&t||(0,F.a)(b)},[b,d.permissions,d.openUrl,null==k?void 0:k.isCreateSidePanelActive,d]);var Xe=p.useMemo(function(){var e;if(se.current&&s&&s.openUrl&&(null===(e=s.properties)||void 0===e?void 0:e.uniqueId)&&0===c)return{uniqueId:s.properties.uniqueId,documentUrl:s.openUrl,isEsignRecipient:m===tt.a.Esign,isEsignSidePanelActive:null==k?void 0:k.isCreateSidePanelActive,setIsEsignSidePanelActive:function(e){S.updateESignDataState("SetIsEsignSidePanelActive",{isCreateSidePanelActive:e})},parentItemPermission:d.permissions,parentItemUri:d.openUrl,isNewOneup:!(0,In.b)(),hasParentItemPermissionsLoaded:S.state.currentState.hasValidPermissionToParent,canSendToExternalRecipients:null==k?void 0:k.canAddExistingExternalUser,canAddNewExternalUser:null==k?void 0:k.canAddNewExternalUser,onUpdateToast:function(e,t){return S.updateToastState(e,(0,a.q5)((0,a.q5)({},t),{actionButtons:void 0}))}}},[s,c,m,null==k?void 0:k.isCreateSidePanelActive,null==k?void 0:k.canAddExistingExternalUser,null==k?void 0:k.canAddNewExternalUser,d.permissions,d.openUrl,S]),Ze=p.useMemo(function(){return ne&&Y&&Z.url&&""!==Z.url?p.createElement(hn,(0,a.q5)({},Y,{token:Z.token,getAuthHeaders:Z.getAuthHeaders,url:Z.url,eSignProps:Xe,universalAnnotationProps:Je})):p.createElement(p.Fragment,null)},[ne,Y,Z,Xe,Je]),ot=p.useRef();return ot.current||(ot.current={viewer:Se.a.MSPdf,extension:s&&s.extension||"unknown"}),p.createElement("div",{className:ae},p.createElement("div",{className:"newOneUpPdfContainer",role:"document"},Ze),z&&p.createElement(Bn,(0,a.q5)({mainViewerEngagementData:ot.current,isMainViewer:!1},e)))}var $n,ea=n(311),ta=n(314);function na(e){function t(t){var n,a=new ge.a({name:"OneUpLightSpeed.commandInvoked.".concat(t.id)}),i="Unhandled exception executing an action";try{if(e.onClickCallback&&e.onClickCallback(),t.action.onExecute)null===(n=t.action.onExecute({qosEvent:a}))||void 0===n||n.then(function(e){var t=e||{resultType:ge.b.Success};a.end(t)}).catch(function(t){e.updateErrorStateCallBack("Unhandled exception executing an action: ".concat(e.text));var n=t||new Error(i);a.end((0,ve.a)(n))});else{e.updateErrorStateCallBack("no available action for ".concat(t.name));var r=new Error("no available action for ".concat(t.name));a.end((0,ve.a)(r))}}catch(r){e.updateErrorStateCallBack("Unhandled exception executing an action: ".concat(e.text));var o=r||new Error(i);a.end((0,ve.a)(o))}}var n=qn.b;if(e.command.action.isDisabled)return p.createElement(p.Fragment,null);var i=p.createElement(p.Fragment,null);if(e.buttonType===$n.primary)i=p.createElement(ea.e,{className:Te.e,onClick:function(){return t(e.command)},disabled:!!e.command.action.isDisabled,title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);else if(e.buttonType===$n.iconButton){var r=n,o=r.palette,s=r.semanticColors,c="".concat(s.buttonBackground," !important"),d="".concat(s.buttonBackgroundHovered," !important"),l="".concat(s.buttonBackgroundPressed," !important"),u="".concat(s.buttonBorder," !important"),f={height:"".concat(40,"px"),width:"".concat(40,"px"),borderRadius:"25px",fontSize:"30px",zIndex:9999,color:o.black,border:"1px solid ".concat(u)},m={root:(0,a.q5)((0,a.q5)({},f),{backgroundColor:e.isActive?d:c,"&::before":{content:"''",width:"".concat(72,"px"),height:"".concat(72,"px"),position:"absolute",transform:"translate(-50%, calc(-50% + ".concat(20,"px))")}}),rootHovered:(0,a.q5)((0,a.q5)({},f),{backgroundColor:d,cursor:"pointer"}),rootPressed:(0,a.q5)((0,a.q5)({},f),{backgroundColor:l})};i=p.createElement(ea.d,{iconProps:{iconName:e.text},styles:m,disabled:!!e.command.action.isDisabled,onClick:function(){return t(e.command)},ariaLabel:e.toolTipText||e.command.title})}else i=p.createElement(ea.e,{className:"".concat(Te.d," ").concat(H.x9.isActivated("9038af9c-9d8f-4288-bff3-2b0ef5c72aa3","11/08/2023","Fix Download Button shim incorrect color (should be white)")?"":Te.c),disabled:!!e.command.action.isDisabled,onClick:function(){return t(e.command)},title:e.command.title,ariaLabel:e.toolTipText||e.command.title},e.text);return p.createElement(ta.a,{content:e.toolTipText?e.toolTipText:e.text},i)}!function(e){e[e.primary=0]="primary",e[e.iconButton=1]="iconButton",e[e.default=2]="default"}($n||($n={})),(0,l.ZW)([{rawString:".OneUpOther_443bfddc{position:absolute;width:100%;height:100%;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc{text-align:center}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherFileName_443bfddc{font-size:21px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherDownload_443bfddc{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherMessage_443bfddc{margin:15px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherMessageNewDesign_443bfddc{margin-top:15px;margin-bottom:15px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc{padding:4px 20px 6px 20px}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherActions_443bfddc .odButtonBarMain_443bfddc{float:none}.OneUpOther_443bfddc .OneUpOtherContent_443bfddc .OneUpOtherFileIcon_443bfddc .FileTypeIcon_443bfddc{outline:0}.OneUpOtherMalwareDetectedIcon_443bfddc{height:208px;width:208px}.OneUpOtherMalwareDetectedIconExperiment_443bfddc{height:256px;width:256px}"}]);var aa=n(534),ia={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.XQ,platform:$.a},ra=new H.aF({name:"OpenInOfficeOnlineAction",factory:{dependencies:ia,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i={isAvailable:!(!(n=e.item)||!n.appMap)&&n.itemStatus!==dt.b.ConditionalAccessBlocked&&n.itemStatus!==dt.b.ConditionalAccessViewOnly,id:"OpenInOfficeOnlineAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return[2,t.resources.consumeAsync(ln.a).then(function(n){var a,i=null===(a=t.oneUpStore.list)||void 0===a?void 0:a.id;if(i){var r=n.getOpenInOfficeOnlineUrl(e.item,i);return t.navigation.navigateTo({url:r,frameId:"_blank"}),{resultType:ge.b.Success}}return{resultType:ge.b.Failure}})]})})}};return i})}};var t}}}),oa={resources:H.XQ,navigation:N.a,oneUpUrlDataSource:ln.a},sa=new H.aF({name:"OpenInOtherViewerAction",factory:{dependencies:oa,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"OpenInOtherViewerAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e.item.folder?[3,2]:(n={urlType:"default"},i=t.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,n),[4,t.navigation.navigateTo({url:i,frameId:"_blank"})]);case 1:return a.sent(),[3,4];case 2:return n={urlType:"default"},"#"===(i=t.oneUpUrlDataSource.getDefaultClickUrlForOneUp(e.item,n)).charAt(0)&&(i="?"+i.substring(1)),[4,t.navigation.navigateTo({url:i,frameId:"_blank"})];case 3:a.sent(),a.label=4;case 4:return[2,{resultType:ge.b.Success}]}})})}};return n})};return{instance:n}}}}),ca=n(535),da=n(75),la=n(538),ua=["agent","copilot"],fa=H.x9.isActivated("3a3977b1-d189-4347-85b1-d19bb3ad8141");function pa(e){var t,n=e.iconName,a=e.iconFieldAriaLabel,i=e.desiredSize||16,r="";if(n){var o=e.iconSize||i,s=!fa&&-1!==ua.indexOf(n);r=s?la:function(e,t,n,a){return function(e,t,n,a){var i=a||"png",r=e;return"".concat(O).concat(n).concat(r?"_2x":"","/").concat(t,".").concat(i)}(n,e,t,a)}(n,o,!!(null===(t=e.platformDetection)||void 0===t?void 0:t.isRetinaSupported),e.fileExtention)}var c=e.className||"FileTypeIcon-icon";return p.useMemo(function(){return p.createElement("img",{className:c,src:r,alt:a,style:{width:"".concat(i,"px"),height:"".concat(i,"px")}})},[c,r,a,i])}var ma,_a=H.x9.isActivated("4F69420A-9950-45CF-8BD3-2E57ED1A714D"),ha=H.x9.isActivated("875099EF-AA79-4289-8864-F787C33E6577");function ba(e){var t,n,a=(0,V.c)(),i=e.item,r=e.viewerType,o=e.offset,s=e.onViewerLoaded,c=a.consume(xt),d=i?c.evaluateAction({item:i}):void 0,l=a.consume(ra),u=i?l.evaluateAction({item:i}):void 0,f=a.consume(sa),m=i?f.evaluateAction({item:i}):void 0,_=a.consume(R.a),h=a.consume($.a),b=void 0,g=void 0,v=null==i?void 0:i.extension,y=!!v&&(".fluid"===v||".loop"===v||".note"===v||".whiteboard"===v||".wbtx"===v),S=e.fallbackErrorCode,D=(0,da.a)(),I=D.palette;p.useEffect(function(){0===o&&s&&s()},[o,s]),p.useEffect(function(){var t,n;null===(n=null===(t=e.fallbackCxpRef)||void 0===t?void 0:t.current)||void 0===n||n.end({resultType:xe.c.Success,extraData:{viewer:Se.a.Other,extension:i&&i.extension||""}})},[]),i&&(d&&d.isAvailable&&(b={id:"downloadCommand",action:d}),(0,Se.b)(i).length>0&&(S=ma.UnsupportedFileType),(0,Le.Qb)()?r===Se.a.WAC&&u&&u.isAvailable||r===Se.a.Other&&(0,Se.b)(i).length>0&&(0,Se.b)(i)[0].originalViewer&&(0,Se.b)(i)[0].originalViewer===Se.a.WAC&&u&&u.isAvailable?g={id:"openCommand",action:u}:r===Se.a.Other&&!y&&m&&m.isAvailable&&(g={id:"openCommand",action:m}):r===Se.a.Other&&!y&&m&&m.isAvailable?g={id:"openCommand",action:m}:r===Se.a.WAC&&u&&u.isAvailable&&(g={id:"openCommand",action:u}));var x=a.consume(je.e),C=function(e){var t=(0,ye.i)(e);x.updateErrorState("otherViewerActionFailure: ".concat(e),{errorType:ye.d.actionError,error:t,item:i})},O=null!==(n=null===(t=null==i?void 0:i.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)&&void 0!==n&&n,w=!ha&&!_a,E=!!(null==_?void 0:_.allowInfectedDownload),A=!!(null==_?void 0:_.m365GroupsBlockDownloadsExperienceEnabled),L=aa.d,k=window.require,M=k.toUrl?k.toUrl("odsp-media/images/atp/malware_icon_208x208.svg"):void 0,P=void 0;if(w){var T=D&&D.isInverted?"_dark":"";P=k.toUrl?k.toUrl("odsp-media/images/error/web_warning_v3".concat(T,".webp")):void 0}return p.createElement("div",{className:"OneUpOther_443bfddc"},p.createElement("div",{className:"OneUpOtherContent_443bfddc"},w?p.createElement("img",{className:"OneUpOtherMalwareDetectedIconExperiment_443bfddc",src:P,alt:L}):O?p.createElement("img",{className:"OneUpOtherMalwareDetectedIcon_443bfddc",src:M,alt:L}):(null==i?void 0:i.iconName)?p.createElement("div",{className:"OneUpOtherFileIcon_443bfddc"},p.createElement(pa,{iconName:i.iconName,platformDetection:h,desiredSize:96})):null,p.createElement("div",{className:"OneUpOtherFileName_443bfddc",style:{color:null==I?void 0:I.black}},null==i?void 0:i.name),p.createElement("div",{className:"OneUpOtherMessageNewDesign_443bfddc",style:{color:null==I?void 0:I.black}},O?p.createElement(ca.a,{allowInfectedFileDownload:E}):(null==i?void 0:i.itemStatus)===dt.b.ConditionalAccessBlocked?A?aa.a:aa.b:function(e,t){switch(t){case ma.ZipTooLarge:return aa.i;case ma.UnsupportedFileType:return aa.h;default:return e?aa.e:aa.f}}(w,S)),p.createElement("div",{className:"OneUpOtherActions_443bfddc"},g&&i&&p.createElement(na,{command:g,text:aa.g,buttonType:$n.primary,updateErrorStateCallBack:C,toolTipText:aa.g}),b&&i&&p.createElement(na,{command:b,text:aa.c,buttonType:g?$n.default:$n.primary,updateErrorStateCallBack:C,toolTipText:aa.c}))))}!function(e){e[e.ZipTooLarge=0]="ZipTooLarge",e[e.UnsupportedFileType=1]="UnsupportedFileType"}(ma||(ma={}));var ga=n(410),va=n(18),ya=n(541),Sa=n(540);function Da(e){return!!e&&e.width>0&&e.height>0}function Ia(e){var t,n,i,r,o,s,c=this,d=e.size,l=e.scale,u=e.item,f=e.isMeTA,m=p.useState({localBlobImageUrl:"",scale:e.scale}),_=m[0],h=m[1],b={width:(null===(t=null==u?void 0:u.photo)||void 0===t?void 0:t.width)||0,height:(null===(n=null==u?void 0:u.photo)||void 0===n?void 0:n.height)||0},g=0===b.width||0===b.height,v=p.useState(g?void 0:b),y=v[0],S=v[1],D=p.useState(!0),I=D[0],x=D[1],C=(0,V.c)(),O=p.useState(!0),w=O[0],E=O[1],A=p.useRef(),L=(0,be.a)(function(){return g?{width:(null==y?void 0:y.width)||0,height:(null==y?void 0:y.height)||0}:b}),k=(0,be.a)(function(t){return(0,a.yv)(c,void 0,void 0,function(){var n,i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),(0,Le.$b)()&&u&&(f||(0,Le.Y)()&&!(null===(s=u.thumbnail)||void 0===s?void 0:s.url))?[4,C.consume(He.a).getThumbnailUrl(u,{useDirectEndpoint:!0,size:d})]:[3,2];case 1:if(n=a.sent()||{},i=n.blobUrl,r=n.error,A.current=t,!i)throw r?Fn(t,r):t;return h({localBlobImageUrl:i,scale:l}),E(!1),[3,3];case 2:throw t;case 3:return[3,5];case 4:return o=a.sent(),e.onImageLoadFail(o),E(!1),[3,5];case 5:return[2]}})})}),M=(0,be.a)(function(t){if(A.current){var n=A.current;"code"in n&&(n.code="".concat(n.code,"-VroomLoadFail")),e.onImageLoadFail(n)}else e.onImageLoadFail(new Error("img load fail"))}),P=(0,be.a)(function(e,t,n){return void 0===e&&(e=_.scale),void 0===t&&(t={width:1024,height:1024}),(0,a.yv)(c,void 0,void 0,function(){var i,r,o,s,c,d,l,u;return(0,a.SO)(this,function(a){switch(a.label){case 0:if(_.localBlobImageUrl&&e<=_.scale)return[2];i=n,r={width:Math.ceil(t.width*e*window.devicePixelRatio),height:Math.ceil(t.height*e*window.devicePixelRatio)},(o=i?new va.a(i):void 0)&&(s=L(),g&&r&&(s=r),o.setQueryParameter("width",(s.width||1024).toString()),o.setQueryParameter("height",(s.height||1024).toString()),i=o.toString()),a.label=1;case 1:return a.trys.push([1,3,,5]),[4,Un({resources:C,thumbnailUrl:i,viewerName:Se.a.Photo,isMeTA:f})];case 2:if(c=a.sent(),d=c.blobUrl,l=c.error,d)h({localBlobImageUrl:d,scale:e});else if(l)throw l;return E(!1),[3,5];case 3:return u=a.sent(),[4,k(u)];case 4:return a.sent(),[3,5];case 5:return[2]}})})}),T=_.localBlobImageUrl?_.localBlobImageUrl:null===(r=null===(i=e.item)||void 0===i?void 0:i.thumbnail)||void 0===r?void 0:r.url;if(p.useEffect(function(){var e;g||!_.localBlobImageUrl?P(l,d,null===(e=null==u?void 0:u.thumbnail)||void 0===e?void 0:e.url).catch(function(){}):E(!1)},[]),!d)return p.createElement(p.Fragment,null);var U=L(),F={width:d.width*l,height:d.height*l};return Da(U)&&Da(F)&&(s=(0,ya.b)({boundsSize:F,contentSize:U,mode:"contain",maxScale:1/0})),s&&y&&s.width>y.width&&s.height>y.height&&(s=l<=1?y:{width:y.width*l,height:y.height*l}),p.createElement("div",{className:Ln,"data-automation-id":"oneup-image-container"},!w&&p.createElement("img",{"data-automation-id":"oneup-image-frame","tab-index":0,alt:H.PN(Sa.a,null===(o=e.item)||void 0===o?void 0:o.displayName),src:T,style:y?{width:"".concat(null==s?void 0:s.width,"px"),height:"".concat(null==s?void 0:s.height,"px"),opacity:1}:{opacity:0},onLoad:function(t){if(I&&e.onViewerLoaded){var n=A.current;n&&"code"in n&&(n.code="".concat(n.code,"-VroomLoadSuccess")),e.onViewerLoaded(n),x(!1)}if(T&&0===T.indexOf("blob:")&&1===l&&!y){var a={width:t.currentTarget.offsetWidth,height:t.currentTarget.offsetHeight};S(a)}},onError:M}))}var xa=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(n,410))];case 1:return[2,e.sent().Projector]}})})});function Ca(e){var t,i,r=this,o=e.item,s=e.offset,c=e.fallbackToOtherViewer,d=e.onViewerLoaded,l=e.parentItem,u=(0,V.c)(),f=u.consume(je.e),m=(0,je.f)("currentState",function(e){return e.imageMode===je.c.edit})[0],_=!m&&(0,kn.a)(null===(t=null==o?void 0:o.thumbnail)||void 0===t?void 0:t.url),h=p.useRef(),b={url:null===(i=null==o?void 0:o.thumbnail)||void 0===i?void 0:i.url};p.useEffect(function(){_&&0===s&&(h.current=(0,Ee.a)(Se.a.Photo))},[_,s]);var g=(0,be.a)(function(e){return void 0===e&&(e=!1),(0,a.yv)(r,void 0,void 0,function(){return(0,a.SO)(this,function(e){return f.updateImageState("openImageEditor",je.c.view),[2]})})}),v=(0,be.a)(function(e){var t=h.current;h.current&&e&&((0,Ee.b)(h.current,void 0,e),t=void 0),d({meTAQos:t,extraData:b})}),y=(0,be.a)(function(e){0===s&&(f.updateErrorState("oneupPhotoViewer",{errorType:ye.d.viewerInitLoadingError,error:e,item:o,meTAQos:h.current,extraData:b}),c&&c(new Error("photoViewerFailToLoad"),"PhotoViewer"))}),S=(0,be.a)(function(e){if(0===s){var t=(0,ye.i)(e.message,e.id);f.updateErrorState("oneUpPhotoEditor",{errorType:ye.d.actionError,error:t,item:o}),c&&c(new Error("photoEditorFailToLoad"),"PhotoViewer")}});if(!o||0!==s)return p.createElement(p.Fragment,null);var D=p.createElement(xa,{mode:ga.ProjectorMode.preview},function(e){var t=e.size,n=e.transformV;return p.createElement(Ia,{item:o,size:t,scale:n.scale,onImageLoadFail:y,onViewerLoaded:v,isMeTA:_})}),I=(0,bt.a)(function(){return(0,a.yv)(r,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(41).then(n.bind(n,707))];case 1:return[2,e.sent().OneUpImageEditor]}})})});return p.createElement(p.Fragment,null,m&&o?p.createElement(I,{item:o,parentItem:l,resources:u,switchToView:g,onErrorCallBack:S}):D)}var Oa=n(125),wa=n(237);(0,l.ZW)([{rawString:".OneUpTextFileContent_04a30d0d{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-flow:column nowrap;align-items:stretch;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15);border-radius:5px}.OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{padding:6px 10px 0 0}.OneUpTextFileContent_04a30d0d .OneUpTextFileEditor_04a30d0d{position:relative;flex:1 1 auto;width:100%}.isFluentVNext_04a30d0d .OneUpTextFileContent_04a30d0d{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.isFluentVNext_04a30d0d .OneUpTextFileContent_04a30d0d .OneUpTextFileTitle_04a30d0d{border-top-left-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:";border-top-right-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUpTextFileContentLight_04a30d0d{background-color:#fff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpTextFileContainer_04a30d0d{position:relative;margin:auto;width:75%;height:100%}.oneUpTextEditor{height:100%}"}]);var Ea,Aa=n(411),La=n(207),ka=n(323),Ma=!H.x9.isActivated("5B8CD4DE-74E3-46DF-9A3E-B28C31F8BA71");function Pa(e){var t,n,a=e.focusItem,i=e.navigation,r=e.saveAction;return!(!Ma||!(null===(n=(t=i.beforeUnload).isHashNavDialogHandlerRegistered)||void 0===n?void 0:n.call(t)))&&!!a&&r.evaluateAction({item:a}).isAvailable&&i.beforeUnload.hasActiveBlock()}!function(e){e.Default="Default",e.OneUpTextFile="OneUpTextFile"}(Ea||(Ea={}));var Ta=!H.x9.isActivated("c0448c19-5a5d-49a7-818a-33485f56176e");function Ua(e){var t,i=this,r=e.closeCallback,s=(0,V.c)(),c=s.consume(je.e),d=s.consume(ne.b),l=s.consume(N.a),u=s.consume(De.d),f=p.useState(!1),m=f[0],_=f[1],h=p.useRef(e.editorContent),b=p.useState(e.editorContent),g=b[0],v=b[1],y=p.useState(void 0),S=y[0],D=y[1],I=s.consume(ka.a),x=!!e.item&&I.evaluateAction({item:e.item}).isAvailable;p.useEffect(function(){if(Ma){var e=function(e){var t,n;return(null===(n=(t=l.beforeUnload).isHashNavDialogHandlerRegistered)||void 0===n?void 0:n.call(t))&&x?Ea.OneUpTextFile:""},t=function(){return o.c.resolve(null==r?void 0:r(!0).then(function(){d.clean(),c.clean(),c.navClean()}))};return l.beforeUnload.registerHandler(e),l.beforeUnload.registerOnContinueHandler(t),function(){l.beforeUnload.unRegisterHandler(e),l.beforeUnload.unRegisterOnContinueHandler(t)}}},[x,l.beforeUnload,d,c,r]),p.useEffect(function(){window.innerWidth<1024&&!m?_(!0):window.innerWidth>=1024&&m&&_(!1)},[window.innerWidth]),p.useEffect(function(){e.editorContent!==g&&(v(e.editorContent),h.current=e.editorContent),e.item&&c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}})},[g,c,e.editorContent,e.item,null===(t=e.item)||void 0===t?void 0:t.key]);var C=(0,be.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){var t,i,r,o,c;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,n.e(1).then(n.bind(n,658))];case 1:return t=a.sent().resourceKey,i=s.consumeAsync(t),r=null,e.item&&e.parentItem?[4,i]:[3,3];case 2:r=a.sent().evaluateAction({item:e.item,parentItem:e.parentItem}),a.label=3;case 3:return r&&r.onExecute&&e.item&&(o=new ge.a({name:"OneUpLightSpeed.saveInvokedInEditor"}),null===(c=r.onExecute({qosEvent:o}))||void 0===c||c.then(function(){}).catch(function(e){})),[2]}})})}),O=(0,be.a)(function(t){e.setEditorLoaded(!0),t.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyS,function(){C()},""),h.current=g,t.onDidChangeModelContent(function(){var n=t.getValue();if(void 0!==h.current&&n!==h.current&&e.item){D(n);var a=new Blob([n],{type:e.item.textEditorMimeType});a.name=e.item.name;var i={extension:e.item.extension,iconName:"text",name:(e.item.name||"")+e.item.extension,size:n.length,_file:a,slice:function(e,t){return a}},r=c.getViewerState(e.item.key);r&&r.saveData&&(r.saveData.fileUpload=i),r&&r.saveData&&r.saveData.saveButtonVisible||c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!0,fileUpload:i}}})}else e.item&&n===g&&(D(n),c.updateViewerState("updateSaveStatus",{key:e.item.key,options:{saveData:{saveButtonVisible:!1}}}))})}),w=(0,a.q5)({wordWrap:"on",automaticLayout:!0,scrollbar:{alwaysConsumeMouseWheel:!1},minimap:{enabled:!m},readOnly:!e.isEditable,theme:u?"vs-dark":"vs"},Ta?{unicodeHighlight:{invisibleCharacters:!1,ambiguousCharacters:!1}}:{}),E="OneUpTextFileContent_04a30d0d";return u||(E+=" ".concat("OneUpTextFileContentLight_04a30d0d")),p.createElement("div",{className:E,"data-automationid":"OneUpTextFile-Content"},p.createElement("div",{className:"OneUpTextFileTitle_04a30d0d","data-automationid":"OneUpTextFile-Title"},e.editorTitle),p.createElement("div",{className:"OneUpTextFileEditor_04a30d0d"},p.createElement(Aa.a,{className:"oneUpTextEditor",editorDidMount:O,language:"plaintext",options:w,value:S||g,moduleType:La.a.ESM,getWorkerUrl:function(){return""},importESMModule:function(){return o.c.resolve(n.e(35).then(n.bind(n,708)))}})))}var Fa,Ha=new H.aF({name:"EncodingProviderAsyncKey",loader:new H.xT(function(){return n.e(13).then(n.bind(n,710)).then(function(e){return e.resourceKey})})}),Ra=!H.x9.isActivated("5bbf5cba-aaed-483d-82d0-a2629a658259"),Na=!H.x9.isActivated("960e7f41-3474-4923-a898-b4b542bd118e");function Ba(e){var t=this,n=(0,V.c)(),i=p.useState(""),r=i[0],s=i[1],c=p.useState(""),d=c[0],l=c[1],u=p.useState(!1),f=u[0],m=u[1],_=p.useState(Fa.shouldLoad),h=_[0],b=_[1],g=p.useState(!0),v=g[0],y=g[1],S=p.useState(!1),D=S[0],I=S[1],x=n.consume(R.a),C=n.consume(je.e),O=e.item,w=e.offset,E=e.fallbackToOtherViewer,A=e.parentItem,L=(0,be.a)(function(e){0===w&&(C.updateErrorState("oneupTextViewer",{errorType:ye.d.viewerInitLoadingError,error:e,item:O}),E&&E(new Error("textViewerFailToLoad"),"TextViewer"))}),k=(0,be.a)(function(t){if(t)h!==Fa.loaded&&b(Fa.loaded),v&&e.onViewerLoaded&&f&&(e.onViewerLoaded(),y(!1));else{var n=new Error("Error loading monaco editor");L(n)}}),M=(0,be.a)(function(e){var i=e.extension?(0,Oa.c)(e.extension):void 0;return o.c.resolve(n.consumeAsync(Ne.downloadDataSourceKey)).then(function(t){return t.getItemContents(e)}).then(function(e){return(0,a.yv)(t,void 0,void 0,function(){var t,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e&&i?Ra?[4,n.consumeAsync(Ha)]:[3,2]:[3,3];case 1:return t=a.sent(),r=t.getEncoding(),[2,Be.a(e,i,r)];case 2:return[2,Be.c(e,i)];case 3:return[2]}})})}).then(function(e){s((null==e?void 0:e.text)||""),m(!0),I(!1)}).catch(function(e){var t=e;if(Na&&(null==e?void 0:e.status)){var n=e.status,i=e.code,r=e.correlationId,o=e.data,s=(0,a.dc)(e,["status","code","correlationId","data"]);delete s.authenticate,delete s.targetUrl,delete s.redirectUrl,t=new H.qt({code:"".concat(n,"_").concat(i),correlationId:r,extraData:(0,a.q5)({innerError:o},s)})}L(t),I(!1)})}),P=(0,be.a)(function(e){var t=e.displayName||e.name;l(t||"")});p.useEffect(function(){f&&h===Fa.loaded&&k(!0)},[k,h,f]),p.useEffect(function(){!f&&O&&(M(O),P(O)),setTimeout(function(){f||I(!0)},5e3)},[f,O,M,P,h]);var T=(0,be.a)(function(){return(!O||!O.extension||".osts"!==O.extension)&&!!O&&function(e,t,n){var a;if(!ct.a.hasItemPermission(e,ct.a.editListItems))return!1;if(!t)return!1;var i=null===(a=null==n?void 0:n.list)||void 0===a?void 0:a.isForceCheckout;return!((0,wa.a)(e,t.userId)||i&&!(0,wa.b)(e,t.userId))}(O,x,e.list)}),U=p.createElement("div",{className:"OneUpTextFileContainer_04a30d0d"},p.createElement(Ua,{editorTitle:d,editorContent:f?r:void 0,isEditable:T(),setEditorLoaded:k,item:O,parentItem:A,closeCallback:e.closeCallback})),F=p.useRef();return F.current||(F.current={viewer:Se.a.TextFile,extension:O&&O.extension||"unknown"}),D&&!f&&(U=p.createElement(Bn,(0,a.q5)({mainViewerEngagementData:F.current,isMainViewer:!1},e))),U}!function(e){e[e.shouldLoad=0]="shouldLoad",e[e.loading=1]="loading",e[e.loaded=2]="loaded",e[e.error=3]="error"}(Fa||(Fa={})),(0,l.ZW)([{rawString:".OneUpWacFullScreen_19e64d4d{width:100%;height:100%;border:0}.OneUpWacNinetyPercent_19e64d4d{width:90%;height:100%;border:0;margin:auto}"}]);const ja="OneUpWacFullScreen_19e64d4d";var Va,za=function(){function e(e,t){var n=t.platformDetection;this._wordAction=n.isMobile&&!n.isIPad?"mobileview":"embedview"}return e.prototype.getWopiFrameUrl=function(e,t){var n="ms-word"===e.appMap,a=e.wopiFrameUrl,i=n?this._wordAction:"embedview",r=a&&a.replace(/action=([^&]+)/,"action=".concat(i,"&wdnc=1&nobg=1&wdhostscenario=oneuplightspeed"));return r&&!H.ov.isFeatureEnabled({ODB:60385})&&(r=null==r?void 0:r.concat("&bypassowl=true")),n&&!H.x9.isActivated("feaac491-2c3c-48e6-b23a-701bb912ce09")&&(r=null==r?void 0:r.concat("&wdignorefpo=1")),!H.x9.isActivated("53193300-5ac6-4cf5-a3a0-882ac3497e79","10/31/2024","Update wopiembedframe.aspx to doc.aspx for embedview action")&&H.ov.isFeatureEnabled({ODB:62222})&&t?r?r.replace("Doc.aspx","doc2.aspx"):void 0:r?r.replace(/\/_layouts\/[^?]+/i,"/_layouts/15/".concat(t?"WopiEmbedFrame":"doc",".aspx")):void 0},e}(),Ga=(0,H._y)("WopiFrameDataSource",za,{platformDetection:$.a}),Ka=new H.aF("wopiToken"),Wa=n(245),qa=n(69),Qa=n(52),Ya=n(213);function Ja(e){var t,n=!H.x9.isActivated("2c617684-fdeb-4e99-91af-9f322f25818d","7/18/2024","Killswitch to use channel message to communicate WAC page with parent frame")&&H.ov.isFeatureEnabled({ODB:61620}),i=e.item,r=(0,V.c)(),o=r.consume(Ga),s=r.consume(Ka.optional),c=r.consume(je.e),d=r.consume(R.a),l=p.useState(!1),u=l[0],f=l[1],m=p.useState(),_=m[0],h=m[1],b=p.useState(""),g=b[0],v=b[1],y=p.createRef(),S=p.useRef(!1),D=p.useState(Math.random().toFixed(16))[0],I=p.useState(),x=I[0],C=I[1],O=function(t,n,r){c.updateErrorState("oneupWacViewer",{errorType:ye.d.viewerInitLoadingError,error:t,item:n,extraData:(0,a.q5)((0,a.q5)({},r),{extension:null==i?void 0:i.extension,appMap:null==i?void 0:i.appMap})}),e.fallbackToOtherViewer&&e.fallbackToOtherViewer(t,"WacViewer")},w=function(t,r,o,s,c,l){var u=ge.b.Success,f=JSON.stringify(o);if(t)try{u=ge.b[t]}catch(e){u=ge.b.Failure,f="Additional Error: Failed to convert WAC Event Data resultType to known result type, using default of Failure. Original WAC errorInfo: "+f}var p={hostSessionId:s,loadResultSource:n?"wacChannelMessaging":"wacWindowPostMessage"};if(u!==ge.b.Success||-1!==(null==t?void 0:t.toLowerCase().indexOf("failure"))){var m=new H.qt({code:r||"oneupWacLoadGenericFailure",message:f,correlationId:c||(null==d?void 0:d.CorrelationId),isExpected:u===ge.b.ExpectedFailure,extraData:(0,a.q5)((0,a.q5)({},p),{stack:o?JSON.stringify(o):"",rawError:JSON.stringify(l)})});O(m,i,(0,a.q5)({},l))}else e.onViewerLoaded&&e.onViewerLoaded({extraData:(0,a.q5)((0,a.q5)({},p),l)})},E=function(e){var t,n,r,o;try{o=e.data}catch(t){var s=(0,ye.i)("Error loading Wac viewer iframe - cannot parse wac message","WacInitIframeError.ProcessWacMessage");return O(s,i,(0,a.q5)((0,a.q5)({},e),{e:t})),void(S.current=!0)}o.messageId===Va.WacHostInitialized&&w(null===(t=o.values)||void 0===t?void 0:t.resultType,null===(n=o.values)||void 0===n?void 0:n.resultCode,null===(r=o.values)||void 0===r?void 0:r.errorInfo,o.hostSessionId,o.correlationId||(null==d?void 0:d.CorrelationId),o),S.current=!0};p.useEffect(function(){i&&!u&&function(e){var t=void 0;if(s&&s.then(function(e){t=e}),i&&e&&""!==t){var a=o.getWopiFrameUrl(i,t);if(!a||/^javascript:\/\//i.test(a.trim()))return C=void 0,C=a?(0,ye.i)("wopiframeurl is not acceptable format","WacUrlFormatError"):(0,ye.i)("wopiframeurl is empty","WacUrlEmptyError"),void O(C,i);var r=Wa.a(d);r&&(a+="&wdorigin="+encodeURIComponent(String(r)));var c="OfficeDocClickTime",l=new qa.a("",Qa.a.local),u=l.getValue(c,Qa.a.session),p=u?new Date(u):void 0;l.setValue(c,"",Qa.a.session),p&&(a+="&CT="+encodeURIComponent(String(p)));var m=new Ya.b,_=m&&m.viewParams.uih;_&&(a+="&uih="+_);var b=new URL(a).origin;if(v(b),n){var S={wdskipfccheck:"true",appName:"OneUp",origin:window.location.origin,channelId:D,app:"OneUp",scenario:"OneUpWacViewer"};a+=new URLSearchParams(S)}if(t){var I=m&&m.viewParams.EmbeddingPageOrigin,x=m&&m.viewParams.EmbeddingPageSessionInfo;!function(e){var t,n;if(y&&(null===(t=y.current)||void 0===t?void 0:t.contentDocument)){var a=y&&(null===(n=y.current)||void 0===n?void 0:n.contentDocument);a.body||a.createElement("body");var r=a.createElement("form");r.action=e.url,r.method="POST",r.style.visibility="hidden",r.target="_self";var o=e.postdata;for(var s in o)if(s&&o[s]){var c=a.createElement("input");c.type="hidden",c.name=s,c.value=o[s],r.appendChild(c)}a.body.appendChild(r),r.submit(),f(!0)}else{var d=(0,ye.i)("missing iframe reference for form post","WacIFrameReferenceError");O(d,i)}}({url:a,postdata:{access_token:t,EmbeddingPageOrigin:I||g,EmbeddingPageSessionInfo:x||""}})}else h(a),f(!0)}else{var C=(0,ye.i)("missing item or wopitokenval","WacItemOrTokenError");O(C,i)}}(i)},[u,i,s]),p.useEffect(function(){var e,t,a=null===(e=null==y?void 0:y.current)||void 0===e?void 0:e.contentWindow;function i(e){if(e.source&&a&&e.source===a){var t=e.data;if("initialize"===t.type&&t.channelId===D){var n=e.ports[0];n&&C(n)}}}if(n&&!x&&a)return t=window.setInterval(function(){a.postMessage({type:"identify-parent",channelId:D},g)},1e3),window.addEventListener("message",i),function(){t&&(clearInterval(t),t=void 0),window.removeEventListener("message",i)}},[x,y,_,D,n,g]),p.useEffect(function(){function e(e){!function(e){var t,n,a;if("notification"===e.type){var i=e.data;"page-loaded"===i.notification&&w(null===(t=i.result)||void 0===t?void 0:t.resultType,null===(n=i.result)||void 0===n?void 0:n.resultCode,null===(a=i.result)||void 0===a?void 0:a.errorInfo,i.hostSessionId,i.correlationId||(null==d?void 0:d.CorrelationId),i)}S.current=!0}(e.data)}if(x&&n)return x.addEventListener("message",e),x.start(),x.postMessage({type:"activate"}),function(){x.removeEventListener("message",e)}},[x,n]),p.useEffect(function(){n||window.addEventListener("message",E,!1)},[]),p.useEffect(function(){return function(){n||window.removeEventListener("message",E,!1)}},[]);var A=(0,be.a)(function(){var e=24e4;setTimeout(function(){if(!S.current){var t=(0,ye.i)("Error loading Wac viewer iframe - no response from wac in callbacktimeout ".concat(e,"ms"),"WacInitIframeError.WacCallbackTimeout");O(t,i)}},e)}),L=(0,be.a)(function(){A()}),k=(0,be.a)(function(){if(0===e.offset){var t=(0,ye.i)("Error loading Wac viewer iframe","WacInitIframeError.IFrameLoadError");O(t,i)}}),M=e.isFallback?"fallback":"",P="ms-excel"===(null===(t=e.item)||void 0===t?void 0:t.appMap),T=u&&i?p.createElement("div",{className:"oneup-wac-container ".concat(P?"OneUpWacNinetyPercent_19e64d4d":ja," ").concat(M),"data-automation-id":"oneup-wac-container"},p.createElement("iframe",{"data-automation-id":"oneup-wac-frame",className:"oneup-wac-frame ".concat(ja),ref:y,title:i.name,onLoad:L,onError:k,src:_})):p.createElement(p.Fragment,null);return(0,Le.nc)()?0===e.offset?T:p.createElement(p.Fragment,null):T}!function(e){e.WacHostInitialized="WacHost_initialized"}(Va||(Va={}));var Xa=function(){function e(e,t){this._makeXHR=t.makeXHR||Fe.a.start,this._offlineDetection=t.offlineDetection,this._getMeTAHeader=t.getMeTAHeader}return e.prototype.getContents=function(e,t){var n=this,i=new ge.a({name:"OneUpZipDataSourceGetContents"});return this._getMeTAHeader().then(function(e){return n._makeXHR({url:t,headers:e})}).then(function(t){var n=t.status;if(!(n>=200&&n<300)){var r={code:"".concat(n,".InvalidStatus"),message:"getContents xhr status unacceptable range",status:n,statusText:t.statusText,responseType:t.responseType,response:t.response,responseTxt:t.responseText};return i.end({resultType:ge.b.Failure,extraData:(0,a.q5)({},r)}),o.c.reject(t)}try{var s=JSON.parse(t.responseText).metadata,c=s.delimiter,d=s.error,l=s.list,u=void 0===l?[]:l;return e.dateModified&&e.extension&&e.name&&i.end({resultType:ge.b.Success}),{delimiter:c,error:d,root:{children:u,date:e.dateModified||"",extension:e.extension||"",isFolder:!0,name:e.name||"",childCount:u.length,parentFolder:void 0,path:"",size:0}}}catch(e){return i.end({resultType:ge.b.ExpectedFailure,extraData:{e,code:"".concat(n,".InvalidResponse")}}),o.c.reject(new H.qt({code:"".concat(n,".InvalidResponse"),message:e&&e.message,correlationId:Za(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(function(e){if(e instanceof H.qt)return i.end({resultType:ge.b.Failure,extraData:{error:e,code:"".concat(e.code,".XhrExceptionApiErr")}}),o.c.reject(e);var t,a=!1,r=e&&e.message,s="GetZipContents";if(e instanceof XMLHttpRequest){var c=e&&e.status;a=!!c&&c>=400&&c<500,c&&!n._offlineDetection.offline||(a=!0),t=Za(e),s=e.getResponseHeader("X-ErrorCode")||"";try{for(var d=JSON.parse(e.responseText),l=d&&d.error;l.innererror;)l=l.innererror;l&&(r=l.message,s=l.code)}catch(t){r=e.responseText?"Invalid JSON response":"Empty response",a=!0}s="".concat(c,".").concat(s)}return i.end({resultType:a?ge.b.ExpectedFailure:ge.b.Failure,extraData:{code:"".concat(s,".XhrException"),error:e,resultCode:s,errorMessage:r,correlationId:t}}),o.c.reject(new H.qt({code:s,message:r,isExpected:a,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})},e}();function Za(e){return e.getResponseHeader("X-CorrelationId")||void 0}var $a=(0,H._y)("OneUpZipDataSource",Xa,{makeXHR:void 0,offlineDetection:bn.a,getMeTAHeader:Ke}),ei=n(546);(0,l.ZW)([{rawString:".OneUpZipContainer_cf15865b{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;height:95%}.OneUpZipHeader_cf15865b{height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.OneUpZipImage_cf15865b{height:130px;width:135px}.OneUpZipNumber_cf15865b{position:absolute;top:83px;font-size:medium;width:113px}html[dir=ltr] .OneUpZipNumber_cf15865b{text-align:right}html[dir=rtl] .OneUpZipNumber_cf15865b{text-align:left}.OneUpZipList_cf15865b{padding:0 20px;overflow:auto}"}]);var ti=n(547);(0,l.ZW)([{rawString:".odZipContentListBreadcrumb_fe46f3dc{margin-bottom:20px}.odZipContentListLink_fe46f3dc{cursor:pointer;text-decoration:none;font-size:12px}.odZipContentListLink_fe46f3dc:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}"}]);var ni=n(550),ai=n(324),ii=n(80),ri=n(551),oi=n(326),si=n(295),ci=n(556),di=n(549),li=n(14),ui=n(302),fi=function(e){function t(t){var n=e.call(this,t)||this,a=t.root;n._onItemInvoked=n._onItemInvoked.bind(n),n._onBreadcrumbClick=n._onBreadcrumbClick.bind(n),n._onDetailsListUpdated=n._onDetailsListUpdated.bind(n),n._columns=n._getAllColumns(),n.state={ancestors:[a],crumbs:n._appendBreadcrumb([],a.name),initialLoadComplete:!1};var i=n._selection=new ai.a({selectionMode:ii.c.single,onSelectionChanged:function(){var e=n.state.ancestors;n.props.onSelect(i.getSelection(),e[e.length-1])}});return i.setItems(a.children,!0),n}return(0,a.e2)(t,e),t.prototype.render=function(){var e=!!this.props.allowSelection,t=this.state.ancestors,n=this.state.crumbs.reduce(function(e,t){return e?H.PN(di.a,t.text,e):t.text},""),a=t[t.length-1].childCount,i=H.at(di.i,di.h,a),r=i?H.PN(i,a):"";return p.createElement(si.a,null,p.createElement(ni.a,{className:"odZipContentListBreadcrumb_fe46f3dc",ariaLabel:H.PN(di.b,n),items:this.state.crumbs,maxDisplayedItems:5}),p.createElement(ri.a,{className:"od-ZipContent-DetailsList",items:t[t.length-1].children,columns:this._columns,checkboxVisibility:e?oi.a.onHover:oi.a.hidden,selectionMode:e?ii.c.multiple:ii.c.none,layoutMode:oi.e.fixedColumns,onItemInvoked:this._onItemInvoked,selection:this._selection,constrainMode:oi.d.horizontalConstrained,selectionPreservedOnEmptyClick:!0,ariaLabel:r,onDidUpdate:this._onDetailsListUpdated}))},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;this.props!==e&&e.root!==this.props.root&&this.setState(function(e,n){var a=n.root;return t._selection.setItems(a.children,!0),{ancestors:[a],crumbs:t._appendBreadcrumb([],a.name)}})},t.prototype._onDetailsListUpdated=function(){this.state.initialLoadComplete||(this.setState({initialLoadComplete:!0}),this.props.onLoad&&this.props.onLoad())},t.prototype._onItemInvoked=function(e){var t=this;e.isFolder&&this.setState(function(n){var i=n.crumbs,r=i.length;return t._selection.setItems(e.children,!0),t.props.onNavigate(e),{ancestors:n.ancestors.concat([e]),crumbs:t._appendBreadcrumb((0,a.lt)((0,a.lt)([],i.slice(0,-1),!0),[(0,a.q5)((0,a.q5)({},i[r-1]),{isCurrentItem:!1})],!1),e.name)}})},t.prototype._onBreadcrumbClick=function(e,t){var n=this;if(t){var a=parseInt(t.key,10);this.setState(function(e){var t=e.ancestors[a];return n._selection.setItems(t.children,!0),n.props.onNavigate(t),{ancestors:e.ancestors.slice(0,a+1),crumbs:n._appendBreadcrumb(e.crumbs.slice(0,a),t.name)}})}else console.log("no item available for breadCrumbClick")},t.prototype._appendBreadcrumb=function(e,t){var n=e.length;return(0,a.lt)((0,a.lt)([],e,!0),[{text:t,key:"".concat(n),isCurrentItem:!0,onClick:this._onBreadcrumbClick}],!1)},t.prototype._getAllColumns=function(){return[{key:"zipIcon",fieldName:void 0,minWidth:20,maxWidth:20,name:"",onRender:pi.bind(this)},{key:"zipName",fieldName:void 0,isResizable:!0,minWidth:200,name:di.d,onRender:mi.bind(this,"name")},{key:"zipDateModified",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:di.c,onRender:mi.bind(this,"date")},{key:"zipFileSize",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:di.e,onRender:function(e,t,n){return e?p.createElement("div",null,e.size?ti.a.getDisplayString(e.size,{language:ot.a.language,ignoreZero:!0}):""):p.createElement(p.Fragment,null)}}]},t}(p.Component);function pi(e,t,n){if(!e)return p.createElement(p.Fragment,null);var i=e.extension,r={extension:i,size:20,type:e.isFolder?l.HO.folder:void 0},o=(0,ui.a)(r);return p.createElement(li.a,(0,a.q5)({},o,{style:{width:"20px",height:"20px"},title:e.isFolder?di.f:H.PN(di.g,i)}))}function mi(e,t,n,a){var i=this;return t?"name"===e&&!0===t.isFolder?p.createElement(ci.a,{className:"odZipContentListLink_fe46f3dc",onClick:function(){return i._onItemInvoked(t)}},t[e]):p.createElement("div",null,t[e]):p.createElement(p.Fragment,null)}const _i=fi;var hi=n(560);function bi(e){var t=e.item,n=(0,V.c)(),i=n.consume($.a).isRetinaSupported,r=n.consume(je.e),o=p.useState(!1),s=o[0],c=o[1],d=p.useState(),l=d[0],u=d[1],f=p.useState(),m=f[0],_=f[1],h=window.require,b=(null==h?void 0:h.toUrl)&&(null==h?void 0:h.toUrl("odsp-media/images/oneupzip/zipicon.svg")),g=p.useContext(hi.d),v={extension:(null==t?void 0:t.extension)||"unknown",viewer:Se.a.Zip,engagementContext:g},y=function(e,t){},S=function(e){u(e.childCount),(0,hi.g)("".concat(hi.c,".").concat("ZipNavigateNested"),v)};p.useEffect(function(){!s&&t&&function(o){var s=o.zip&&o.zip.zipMetaDataUrl,d=n.consume($a);if(!s){var l=(0,ye.i)("zip url is null","ZipEmptyMetadataUrl");return r.updateErrorState("oneupZipViewer",{errorType:ye.d.viewerInitLoadingError,error:l,item:t}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(l,"ZipViewer"))}var f=(0,kn.a)(s)?(0,Ee.a)(Se.a.Zip):void 0,p={hasZipUrl:!!s};d.getContents(o,s).then(function(n){if(!n||n.error&&""!==n.error){var a=(0,ye.i)(n.error||"Missing zip contents","ZipErrorRetrievingContents");return r.updateErrorState("oneupZipViewer",{errorType:ye.d.viewerInitLoadingError,error:a,item:t,meTAQos:f,extraData:p}),void(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(a,"ZipViewer"))}u(n.root.childCount),_({allowSelection:!1,root:n.root,onNavigate:S,onSelect:y,isRetinaEnabled:i,onLoad:function(){e.onViewerLoaded&&e.onViewerLoaded({meTAQos:f,extraData:p})}}),c(!0)}).catch(function(n){var i,o,s;if(s=n&&n instanceof H.qt?n:n&&n instanceof Error?new H.qt({code:n.name||"ZipErrorRetrievingContents",message:n.message,extraData:(0,a.q5)((0,a.q5)({},p),{rawError:JSON.stringify(n)})}):new H.qt({code:"ZipErrorRetrievingContents",extraData:(0,a.q5)((0,a.q5)({},p),{rawError:JSON.stringify(n)})}),r.updateErrorState("oneupZipViewer",{errorType:ye.d.viewerInitLoadingError,error:s,item:t,meTAQos:f,extraData:p}),n)try{var c=n;-1!==(null===(i=c.code)||void 0===i?void 0:i.indexOf("Sandbox_FileTooLarge"))?e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer",ma.ZipTooLarge):c.isExpected&&-1!==(null===(o=c.extraData)||void 0===o?void 0:o.toString().indexOf("notSupported"))&&e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer",ma.UnsupportedFileType)}catch(t){e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer")}else e.fallbackToOtherViewer&&e.fallbackToOtherViewer(n,"ZipViewer")})}(t)},[s,t]);var D=(0,da.a)().palette;return s&&t&&m?p.createElement("div",{className:"OneUpZipContainer_cf15865b",style:{backgroundColor:null==D?void 0:D.white}},p.createElement("div",{className:"OneUpZipHeader_cf15865b",style:{backgroundColor:null==D?void 0:D.neutralLight},role:"heading"},p.createElement("img",{className:"OneUpZipImage_cf15865b",src:b,alt:ei.a}),p.createElement("span",{className:"OneUpZipNumber_cf15865b",style:{color:null==D?void 0:D.white}},l)),p.createElement("div",{className:"OneUpZipList_cf15865b",style:{backgroundColor:null==D?void 0:D.white},role:"presentation","data-is-scrollable":"true"},p.createElement(_i,(0,a.q5)({},m)))):p.createElement(p.Fragment,null)}(0,l.ZW)([{rawString:".container{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}.od-Error{text-align:center;position:absolute}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var gi=n(561);function vi(e){var t,n=(0,V.c)().consume(je.e),a=e.errorTitle,i=e.errorDetailedText,r=e.correlationId,o=e.errorCode,s=e.actionUrl,c=e.actionText,d=(t=0===(t=Math.ceil(3*Math.random()))?1:t,window.require.toUrl("odsp-media/images/error/error".concat(t,".svg"))),l=p.useCallback(function(){window.open(s,"_blank")},[s,!0]);return p.useEffect(function(){e.itemKey&&n.updateViewerState("errorViewerAfterDelete",{key:e.itemKey,options:{showMainCommands:!1,showTitle:!0}})},[n,e.itemKey]),p.createElement("div",{className:"container"},p.createElement("div",{className:"od-Error"},p.createElement("div",{className:"od-Error-image"},p.createElement("img",{className:"od-Error-imageTag",src:d,alt:a})),p.createElement("div",{role:"alert"},p.createElement("p",{className:"od-Error-title"},a),i&&p.createElement("p",{className:"od-Error-subText"},i),r&&p.createElement("p",{className:"od-Error-code"},H.PN(gi.b,r)),o&&p.createElement("p",{className:"od-Error-code"},H.PN(gi.a,o)),s&&p.createElement("p",{className:"od-Error-code"},p.createElement(ea.c,{href:s,text:c,onClick:l})))))}var yi=n(256);(0,l.ZW)([{rawString:".OneUpFileHandlerIFrame_2477f919{width:100%;height:100%;border:0}"}]);var Si=n(562);function Di(e){var t,n=(0,je.f)("currentState",function(e){return e.fileHandlerOptions?e.fileHandlerOptions.data.actions.preview:void 0})[0],a=p.useState(),i=a[0],r=a[1],o=(0,V.c)(),s=o.consume(yi.a),c=o.consume(je.e),d=o.consume(R.a),l=p.createRef(),u=d.userLoginName,f=d.currentUICultureName||d.currentCultureName||"en-US",m=p.useState(!1),_=m[0],h=m[1],b=(0,be.a)(function(){_||(e.onViewerLoaded&&e.onViewerLoaded(),h(!0))}),g=(0,be.a)(function(t){0===e.offset&&(e.fallbackToOtherViewer&&e.fallbackToOtherViewer(new Error("FileHandlerIframeLoadError"),"FileHandlerViewer"),c.updateErrorState("oneupFileHandlerViewer",{errorType:ye.d.viewerInitLoadingError,error:t,item:e.item}))});return p.useEffect(function(){n&&e.item&&s.getCorrespondingPreviewFileHandlerPostData(e.item).then(function(e){e&&(r(e),b())}).catch(function(e){g(e)})},[null===(t=e.item)||void 0===t?void 0:t.key,n,s,b,g]),p.useEffect(function(){var e;if(l&&(null===(e=l.current)||void 0===e?void 0:e.contentDocument)&&i)try{var t={cultureName:f,client:"OneUp",domainHint:"organizations",userId:u,appId:i.handler.appId,items:JSON.stringify(i.itemUrls)};(0,Si.a)({url:i.url,postdata:t,document:l.current.contentDocument})}catch(e){g(e)}},[l,i,u,f,g]),p.createElement("iframe",{className:"OneUpFileHandlerIFrame_2477f919",ref:l,allow:"clipboard-read; clipboard-write",sandbox:"allow-scripts allow-same-origin allow-forms allow-top-navigation allow-popups allow-popups-to-escape-sandbox"})}var Ii=n(563),xi=n(566),Ci=new H.aF({name:"isCopilotAgentBillingAvailableAsyncKey",loader:new H.xT(function(){return n.e(6).then(n.bind(n,714)).then(function(e){return e.copilotAgentBillingDataSourceKey})})}),Oi={pageContext:R.a,getCopilotAgentBillingDataSource:Ci.async.lazy},wi=new H.aF({name:"isCopilotAgentBillingAvailable",factory:{dependencies:Oi,create:function(e){var t=e.pageContext,n=e.getCopilotAgentBillingDataSource,a=H.ov.isFeatureEnabled({ODB:62330})&&!H.x9.isActivated("37051AB0-8881-4429-9EF0-2016312BCC4A")&&(0,xi.a)({pageContext:t,getCopilotAgentBillingDataSource:n});return{instance:function(){return a}}}}}),Ei=n(194),Ai=n(568),Li={isUserCopilotLicensed:Ei.a,isCopilotAgentBillingAvailable:wi},ki=!H.x9.isActivated("0F710A94-5239-46C8-8DD0-E02D3B7E4BA6"),Mi=new H.aF({name:"shouldBlockCopilotViewer",factory:{dependencies:Li,create:function(e){var t=e.isUserCopilotLicensed,n=e.isCopilotAgentBillingAvailable;return{instance:function(){if(!(t()||H.ov.isFeatureEnabled({ODB:62330})&&!H.x9.isActivated("8B678DCC-BB1A-423D-A06A-E217D891D8AE")&&n()))return{errorTitle:Ai.f,actionText:Ai.a,actionUrl:"https://techcommunity.microsoft.com/t5/microsoft-365-copilot/microsoft-365-copilot-wave-2-ai-innovations-in-sharepoint-and/ba-p/4245159"}}}}}}),Pi=n(332),Ti=H.x9.isActivated("5EB3A0F2-70A9-4420-BC71-4E623B94CF83"),Ui=function(e,t,n){var a=!0;return t.map(function(t){ct.a.hasPermission(e,t)||(a=!1)}),a},Fi=[ct.a.insertListItems,ct.a.editListItems],Hi=[ct.a.reviewListItems],Ri=[ct.a.openItems],Ni=[ct.a.viewListItems],Bi=[ct.a.fullMaskWithoutACP],ji=function(e){return e?!Ti&&Ui(e,Bi)?Pi.a.owner:Ui(e,Fi)?Pi.a.edit:Ui(e,Hi)?Pi.a.review:Ui(e,Ri)?Pi.a.view:Ui(e,Ni)?Pi.a.restrictedview:Pi.a.none:Pi.a.none};function Vi(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}function zi(e){var t,i=this,r=e.item,o=(0,V.c)(),s=p.useContext(hi.d),c=o.consume(De.e.optional),d=p.useRef(o.consume(Se.c)),l=o.consume(Q.c),u=p.useState(!1),f=u[0],m=u[1],_=p.useState(),h=_[0],b=_[1],g=d.current.getValidViewerTypes,v=p.useState(g(r)),y=v[0],S=v[1],D=o.consume(Ii.a),I=p.useRef(void 0);p.useEffect(function(){e.setIsLoaded(!0)},[e]);var x=(0,je.f)("currentState",function(e){return e.viewerStates})[0],C=(0,je.f)("currentState",function(e){return e.deletedKeys})[0],O=(0,je.f)("currentState",function(e){return e.imageMode===je.c.edit})[0],w=(0,je.f)("currentState",function(e){return e.fileHandlerOptions})[0];p.useEffect(function(){S(g(r))},[w,r,g]);var E=null==x?void 0:x.get(r.key),A=p.useRef(),L=(0,be.a)(function(t){var n,i,c,d,u=o.consume(De.i.optional),f=r?D.evaluateAction({item:r}):void 0;s.isCopilotAvailable=null==f?void 0:f.isAvailable;var p=(null==t?void 0:t.extraData)||{},m=p.url,_=(0,a.dc)(p,["url"]),h=(0,Ae.a)(m),b="unknown";if(!Ti){var g=ji(r.permissions);void 0!==g&&(b=Pi.a[g])}if(0!==e.offset&&e.offset||!u)u&&(0,hi.g)("".concat(hi.c,".").concat(hi.f),{extension:r.extension||"unknown",viewer:y,isInitalLoad:!1,engagementContext:s,userRole:b});else{var v=o.consume(ne.b),S=null===(n=v.focusItemSet)||void 0===n?void 0:n.map(function(e){var t;return null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.uniqueId});u({viewer:y,extension:r.extension,isCrossList:l.getItemUrlParts(r.key).isCrossList,fileSizeRange:Vi(r.size),euplBreakDownData:null===(i=null==t?void 0:t.perfData)||void 0===i?void 0:i.euplBreakDownData,extraPerfData:null===(c=null==t?void 0:t.perfData)||void 0===c?void 0:c.extraPerfData,extraData:(0,a.q5)((0,a.q5)({},_),h),itemSetIds:S,focusItemUniqueId:null===(d=null==r?void 0:r.properties)||void 0===d?void 0:d.uniqueId,index:v.currentIndex}),(0,hi.g)("".concat(hi.c,".").concat(hi.f),{extension:r.extension||"unknown",viewer:y,isInitalLoad:!0,engagementContext:s,userRole:b})}(null==t?void 0:t.meTAQos)&&(0,Ee.c)(t.meTAQos,(0,a.q5)({},h))}),k=(0,be.a)(function(t){var n,a,i=o.consume(De.h.optional);0!==e.offset&&e.offset||!i||i({viewer:y,extension:r.extension,isCrossList:l.getItemUrlParts(r.key).isCrossList,fileSizeRange:Vi(r.size),euplBreakDownData:null===(n=null==t?void 0:t.perfData)||void 0===n?void 0:n.euplBreakDownData,extraPerfData:null===(a=null==t?void 0:t.perfData)||void 0===a?void 0:a.extraPerfData})}),M=(0,be.a)(function(t,n,a){0!==e.offset||f||(I.current=new we({scenario:"OneUpLightSpeed.fallBackToOtherViewer",perfGoalInMs:ye.c,extraData:{errorMessage:t.message,from:n,extension:r.extension,isFastOneUp:c}}),m(!0),b(a))});(c||O)&&e.setIsPanningEnabled?e.setIsPanningEnabled(!1):0===e.offset&&e.setIsPanningEnabled&&(y===Se.a.Thumbnail||y===Se.a.Photo||y===Se.a.Other?e.setIsPanningEnabled(!0):e.setIsPanningEnabled(!1));var P=(0,a.q5)((0,a.q5)({},e),{viewerType:y,onViewerLoaded:L,onLogFullPageRumone:k,fallbackToOtherViewer:M}),T=function(t){var s=t.viewerType,c=t.key,d=t.offset,l=t.mode,u=t.parentItem,f=t.list,m=t.isFallBackToOtherViewer,_=t.deletedKeysMap,h=t.errorViewerDisplayName,b=t.fallbackErrorCode,g=p.createElement(p.Fragment,null);if(A.current||(A.current={viewer:y,extension:r.extension||"unknown"}),_&&_.get(c))g=p.createElement(vi,{errorTitle:pt.zb,itemKey:c,fileName:h});else if(m)g=p.createElement(ba,(0,a.q5)({},P,{isErrorFallBack:!0,fallbackCxpRef:I,fallbackErrorCode:b}));else if(0===d||s!==Se.a.MSPdf&&s!==Se.a.ThreeD&&s!==Se.a.TextFile)switch(s){case Se.a.FileHandler:g=p.createElement(Di,(0,a.q5)({},P));break;case Se.a.Html:g=l&&l===je.b.edit?p.createElement(Ba,(0,a.q5)({},P)):p.createElement(We,(0,a.q5)({},P));break;case Se.a.Image360:var v=(0,bt.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(40)]).then(n.bind(n,677))];case 1:return[2,e.sent().OneUpImage360Viewer]}})})});g=p.createElement(v,(0,a.q5)({},P));break;case Se.a.MSPdf:f&&u&&(g=p.createElement(Zn,(0,a.q5)({},P)));break;case Se.a.Photo:g=p.createElement(Ca,(0,a.q5)({},P));break;case Se.a.TextFile:g=p.createElement(Ba,(0,a.q5)({},P));break;case Se.a.ThreeD:if((0,Le.wb)(Le.oc)){var S=(0,bt.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(36)]).then(n.bind(n,678))];case 1:return[2,e.sent().OneUp3DViewer]}})})});g=p.createElement(S,(0,a.q5)({},P))}else S=(0,bt.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(36)]).then(n.bind(n,679))];case 1:return[2,e.sent().OneUp3DViewer]}})})}),g=p.createElement(S,(0,a.q5)({},P));break;case Se.a.WAC:g=p.createElement(Ja,(0,a.q5)({},P));break;case Se.a.Zip:g=p.createElement(bi,(0,a.q5)({},P));break;case Se.a.Copilot:if(ki){var D=o.consume(Mi)();if(D){g=p.createElement(vi,(0,a.q5)({},D));break}}var x=(0,bt.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(38)]).then(n.bind(n,680))];case 1:return[2,e.sent().OneUpCopilotViewer]}})})});g=p.createElement(x,(0,a.q5)({},P));break;case Se.a.OnePlayerVideo:case Se.a.OnePlayerAudio:if(0===d){var C=(0,bt.a)(function(){return(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(46).then(n.bind(n,681))];case 1:return[2,e.sent().OneUpVideoViewer]}})})});g=p.createElement(C,(0,a.q5)({},P));break}g=p.createElement(ba,(0,a.q5)({},P,{isErrorFallBack:!1,fallbackCxpRef:I}));break;case Se.a.Error:var O=(0,a.q5)({},e.item.error);p.createElement(vi,(0,a.q5)({},O));break;case Se.a.Thumbnail:g=p.createElement(Bn,(0,a.q5)({isMainViewer:!0,mainViewerEngagementData:A.current},P));break;default:g=p.createElement(ba,(0,a.q5)({},P,{isErrorFallBack:!1,fallbackCxpRef:I}))}else g=p.createElement(Bn,(0,a.q5)({isMainViewer:!1,mainViewerEngagementData:A.current},P));return g},U={viewerType:y,key:e.item.key,offset:e.offset,mode:null==E?void 0:E.htmlMode,parentItem:e.parentItem,list:e.list,isFallBackToOtherViewer:f,deletedKeysMap:C,errorViewerDisplayName:e.item.displayName,fallbackErrorCode:h},F=p.useMemo(function(){return T(U)},[y,e.item.key,e.offset,null==E?void 0:E.htmlMode,e.parentItem,e.list,f,C,e.item.displayName,null===(t=e.item.thumbnail)||void 0===t?void 0:t.url,h]);return(0,Le.Pb)()?F:T(U)}var Gi=n(569);function Ki(e,t,n){return(0,a.yv)(this,void 0,void 0,function(){var i,r,o;return(0,a.SO)(this,function(a){return i=t.consume(De.c.optional),r=t.consume(N.a),i?(o=i.getDefaultClickUrl(e,n),r.navigateTo({url:o,ignoreHistory:!0}),[2,{resultType:ge.b.Success}]):[2,t.consumeAsync(ln.a).then(function(a){var i=t.consume(je.e);(null==n?void 0:n.hasNavigationBlock)||i.navClean();var o=a.getDefaultClickUrlForOneUp(e,n);return r.navigateTo({url:o,ignoreHistory:!0}),{resultType:ge.b.Success}}).catch(function(){return{resultType:ge.b.Failure}})]})})}var Wi=n(570),qi=n(571),Qi="PreviousAction",Yi={oneUpStore:ne.b,navigation:N.a,resources:H.XQ,oneUpStateStore:je.e,oneUpLoadingCustomerPromiseFunctions:Pe},Ji=new H.aF({name:"PreviousAction",factory:{dependencies:Yi,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=t.oneUpStore.getOneUpProperties(),r={isDisabled:(n=i,!(n&&n.currentIndex&&n.focusItemSet&&n.focusItemSet.length)||0===n.currentIndex),isAvailable:!!i,id:Qi,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return i&&i.currentIndex&&i.focusItemSet&&i.focusItemSet.length?(e=i.focusItemSet[i.currentIndex-1],t.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:me.previous,newItem:e}}),[4,Ki(e,t.resources,{parentItem:(null===(r=i.parentStoreKey)||void 0===r?void 0:r.key)?{key:null===(o=i.parentStoreKey)||void 0===o?void 0:o.key}:i.parentItem,urlType:"focus"})]):[3,2];case 1:return a.sent(),[2,{resultType:ge.b.Success}];case 2:throw n=(0,ye.i)("no focusItemSet"),t.oneUpStateStore.updateErrorState(Qi,{errorType:ye.d.actionError,error:n,item:void 0}),n}})})}};return r})};return{instance:n}}}}),Xi="NextAction",Zi={oneUpStore:ne.b,navigation:N.a,resources:H.XQ,oneUpStateStore:je.e,oneUpLoadingCustomerPromiseFunctions:Pe},$i=new H.aF({name:"NextAction",factory:{dependencies:Zi,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=t.oneUpStore.getOneUpProperties(),r={isDisabled:(n=i,!(n&&void 0!==n.currentIndex&&n.focusItemSet&&n.focusItemSet.length)||n.currentIndex+1>=n.focusItemSet.length),isAvailable:!!i,id:Xi,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return i&&void 0!==i.currentIndex&&i.focusItemSet&&i.focusItemSet.length?(e=i.focusItemSet[i.currentIndex+1])?(t.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:me.next,newItem:e}}),[4,Ki(e,t.resources,{parentItem:(null===(r=i.parentStoreKey)||void 0===r?void 0:r.key)?{key:null===(o=i.parentStoreKey)||void 0===o?void 0:o.key}:i.parentItem,urlType:"focus"})]):[3,2]:[3,4];case 1:return a.sent(),[2,{resultType:ge.b.Success}];case 2:return[2,{resultType:ge.b.Failure,extraData:{errorType:"noNextItem"}}];case 3:return[3,5];case 4:throw n=(0,ye.i)("no focusItemSet"),t.oneUpStateStore.updateErrorState(Xi,{errorType:ye.d.actionError,error:n,item:void 0}),n;case 5:return[2]}})})}};return r})};return{instance:n}}}}),er=n("fui.core_802"),tr=!H.x9.isActivated("2beb39f3-1076-486e-b9a7-e673102fc285"),nr=(0,er.N3o)(),ar="oneUpCarousel";function ir(e){var t=this,n=(0,V.c)(),i=(0,qi.a)(),r=p.useContext(hi.d),o=p.useState(!1),s=o[0],c=o[1],d=p.useState(!0),l=d[0],u=d[1],f=p.useState(),m=f[0],_=f[1],h=p.useRef(""),b=p.useRef(n.consume(Se.c)).current.getValidViewerTypes,g=n.consume(Ji),v=(null==i?void 0:i.focusItem)?g.evaluateAction({item:null==i?void 0:i.focusItem}):void 0,y=n.consume($i),S=(null==i?void 0:i.focusItem)?y.evaluateAction({item:null==i?void 0:i.focusItem}):void 0,D=v?{id:"previousCommandNewDesign",action:v}:void 0,I=S?{id:"nextCommandNewDesign",action:S}:void 0;l&&((0,hi.g)("".concat(hi.c,".Load"),{isInitalLoad:!0,viewer:Se.a.Unknown,extension:"unknown",engagementContext:r}),u(!1));var x,C=(0,je.f)("currentState",function(e){return e.imageMode!==je.c.edit&&[tt.a.Edit,tt.a.Esign].every(function(t){return t!==e.pdfAppMode})&&!e.eSignData.isCreateSidePanelActive})[0],O=p.useCallback(function(e){c(e)},[]),w=p.useCallback(function(t){return t&&(null==t?void 0:t.item)&&t.item.parentItem&&t.item.listItem?p.createElement(zi,{item:t.item.currentItem,parentItem:t.item.parentItem,list:t.item.listItem,offset:t.offset,itemIndex:t.itemIndex,setIsLoaded:t.setIsLoaded,setIsPanningEnabled:O,closeCallback:e.closeCallback}):null},[]),E=(x=i)?{key:x.focusItem.key,currentItem:x.focusItem,parentItem:x.parentItem,listItem:x.list}:void 0,A=(0,a.q5)({extension:(null==E?void 0:E.currentItem.extension)||"",viewer:(null==E?void 0:E.currentItem)?b(null==E?void 0:E.currentItem):Se.a.Unknown},r),L=p.useRef(),k=p.useState(),M=k[0],P=k[1],T=p.useCallback(function(e){tr&&(P(e),L.current&&clearTimeout(L.current),L.current=setTimeout(function(){P(void 0),L.current=void 0},500))},[]),U=(0,be.a)(function(e,i,r){return(0,a.yv)(t,void 0,void 0,function(){var t,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t={parentItem:null==e?void 0:e.parentItem,urlType:"focus"},A.commandName="UnknownItemInvoked",(i=r)&&i.key===(nr?"ArrowLeft":"ArrowRight")?(T("next"),A.commandName=null==I?void 0:I.id):i&&i.key===(nr?"ArrowRight":"ArrowLeft")&&(T("previous"),A.commandName=null==D?void 0:D.id),(0,hi.g)("".concat(hi.c,".").concat(hi.a),A),e?[4,Ki(e.currentItem,n,t)]:[3,2];case 1:return a.sent(),[3,2];case 2:return[2]}})})});return p.useEffect(function(){E&&(h.current=H.PN(Wi.d,null==E?void 0:E.currentItem.displayName),m||_(E))},[E,m]),p.createElement("div",{className:Te.J},p.createElement("div",{"aria-live":"polite","tab-index":"-1",role:"alert",className:Te.b},h.current),C&&D&&D.action.isAvailable&&function(e,t,n){return p.createElement("div",{className:Te.K},p.createElement(na,{command:e,onClickCallback:function(){return or(e.id,t)},text:"ChevronLeft",buttonType:$n.iconButton,updateErrorStateCallBack:function(){},toolTipText:Wi.b,isActive:n}))}(D,A,"previous"===M),p.createElement(Gi.a,{rootProps:{id:ar,role:"main"},items:rr(i),item:E,onRenderSlide:w,onItemInvoked:U,isEnabled:s,slideAllocationCount:5}),C&&I&&I.action.isAvailable&&function(e,t,n){return p.createElement("div",{className:Te.a},p.createElement(na,{command:e,onClickCallback:function(){return or(e.id,t)},text:"ChevronRight",buttonType:$n.iconButton,updateErrorStateCallBack:function(){},toolTipText:Wi.a,isActive:n}))}(I,A,"next"===M))}function rr(e){var t=[];if(e&&e.focusItemSet&&e.focusItemSet.length>0)for(var n=0;n<e.focusItemSet.length;n++)t.push({key:e.focusItemSet[n].key,currentItem:e.focusItemSet[n],parentItem:e.parentItem,listItem:e.list});return t}function or(e,t){t.commandName=e||"UnknownClicked",(0,hi.g)("".concat(hi.c,".").concat(hi.a),t)}var sr=new H.aF({name:"OpenInfoPaneActionAsync.key",loader:new H.xT(function(){return n.e(50).then(n.bind(n,718)).then(function(e){return e.openInfoPaneActionKey})})}),cr=new H.aF({name:"OpenAboutThisCopilotPaneActionAsync.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(48)]).then(n.bind(n,719)).then(function(e){return e.openAboutThisCopilotPaneActionKey})})}),dr=new H.aF({name:"VersionHistoryActionExecutorAsync.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(69)]).then(n.bind(n,720)).then(function(e){return e.versionHistoryActionExecutorKey})})}),lr=new H.aF({name:"CommentsPaneActionAsync.key",loader:new H.xT(function(){return n.e(4).then(n.bind(n,721)).then(function(e){return e.commentsPaneActionKey})})}),ur=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(44).then(n.bind(n,717))];case 1:return[2,e.sent().OneUpRightPaneWithError]}})})});function fr(){var e=this,t=(0,V.c)(),n=(0,je.f)("currentState",function(e){return e.rightPane})[0],i=t.consume(je.e),r=(0,qi.a)(),o=null==r?void 0:r.focusItem,s=(0,be.a)(function(n){return(0,a.yv)(e,void 0,void 0,function(){var e,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,t.consumeAsync(sr)];case 1:return e=a.sent(),(i=e.evaluateAction({item:n})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new ge.a({name:"openInfoPane"})})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}),c=(0,be.a)(function(n){return(0,a.yv)(e,void 0,void 0,function(){var e,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,t.consumeAsync(cr)];case 1:return e=a.sent(),(i=e.evaluateAction({item:n})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new ge.a({name:"openAboutThisCopilotPane"})})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}),d=(0,be.a)(function(n){return(0,a.yv)(e,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,t.consumeAsync(dr)];case 1:return[4,e.sent().executeOpenVersionHistory({item:n})];case 2:return e.sent(),[2]}})})}),l=(0,be.a)(function(n){return(0,a.yv)(e,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,t.consumeAsync(lr)];case 1:return[4,e.sent().evaluateAction({item:n,isAnnotateAction:!0})];case 2:return e.sent(),[2]}})})}),u=(0,be.a)(function(){i.updateRightPaneState("closeRightPane",{type:je.d.none,content:void 0})}),f=(0,be.a)(function(t){return(0,a.yv)(e,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:switch(null==n?void 0:n.type){case je.d.detailPane:return[3,1];case je.d.copilotDetailPane:return[3,3];case je.d.versionHistory:return[3,5];case je.d.commentsPane:return[3,7];case je.d.none:return[3,9]}return[3,9];case 1:return[4,s(t)];case 2:case 4:case 6:case 8:return e.sent(),[3,10];case 3:return[4,c(t)];case 5:return[4,d(t)];case 7:return[4,l(t)];case 9:return u(),[3,10];case 10:return[2]}})})});p.useEffect(function(){var e=new ge.a({name:"retriggerRightPane"});o&&f(o).then(function(){return e.end({resultType:ge.b.Success})}).catch(function(t){e.end({resultType:ge.b.Failure,extraData:{error:t}})})},[null==o?void 0:o.key,f]),p.useEffect(function(){if((null==n?void 0:n.firstFocusableTarget)&&(0,Le.Yb)()){var e=null;"string"==typeof n.firstFocusableTarget?e=document.querySelector(n.firstFocusableTarget):n.firstFocusableTarget&&(e=n.firstFocusableTarget()),null==e||e.focus()}},[n]);var m=p.useMemo(function(){return void 0!==(null==n?void 0:n.type)&&n.type!==je.d.none?p.createElement(ur,{errorType:n.type,onClose:u}):p.createElement(p.Fragment,null)},[null==n?void 0:n.type,u]),_={borderRadius:5,overflow:"hidden",margin:8,backgroundColor:qn.a};return p.createElement(p.Fragment,null,((null==n?void 0:n.content)||(null==n?void 0:n.hasError))&&p.createElement("div",{className:function(){if(!n)return"";switch(n.type){case je.d.detailPane:case je.d.copilotDetailPane:case je.d.commentsPane:case je.d.copilotPane:return Te.A;case je.d.versionHistory:return Te.I;default:return""}}(),style:_},function(){if(n)switch(n.type){case je.d.detailPane:case je.d.copilotDetailPane:case je.d.commentsPane:case je.d.copilotPane:case je.d.versionHistory:return(0,Le.Vb)()&&n.hasError?m:n.content||void 0;default:return}}()))}var pr=n(572),mr=(0,n(4).a)(pr.a,function(e){var t,n=e.className,a=e.theme;return{root:[a.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:"transparent",padding:"0 8px 0 8px",height:44},n],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:(0,Le.ic)()?"1":"unset",display:"flex",alignItems:"stretch",flexBasis:(0,Le.ic)()?"25%":"unset",zIndex:1,color:a.palette.themePrimary}],middleSet:["ms-CommandBar-middleCommand",(t={display:"flex",justifyContent:"center",alignItems:"stretch",flexGrow:(0,Le.ic)()?"2":"1",flexBasis:(0,Le.ic)()?"50%":"unset"},t["@media (max-width: ".concat(er.jyi,"px)")]={display:"none"},t.color=a.palette.themePrimary,t)],secondarySet:["ms-CommandBar-secondaryCommand",{display:"flex",alignItems:"stretch",justifyContent:"flex-end",flexGrow:(0,Le.ic)()?"1":"unset",flexBasis:(0,Le.ic)()?"25%":"unset",color:a.palette.themePrimary,marginRight:"-6px"}]}},void 0,{scope:"CommandBar"}),_r="mainDividerCommand";function hr(e){return{id:_r,isAvailable:!0,isDisabled:!0}}var br=new H.aF({name:"DividerNonInteractiveCommand",factory:{dependencies:{},create:function(){return{instance:{id:_r,automationId:_r,iconProps:{iconName:"Separator",iconStyle:"color: white !important"},ariaLabel:pt.v,buttonStyles:{root:{width:"20px !important",color:"white",background:"transparent",minWidth:"20px"}},evaluateAction:hr}}}}}),gr=n(575),vr=n(126);function yr(e){for(var t=this,n=e.definitions,i=e.item,r=e.parentItem,o=[],s=!0,c=function(e){var c=n[e],d=c.evaluateAction,l=c.evaluateSubCommands,u=c.subCommands,f=c.getSubCommands,p=(0,a.dc)(c,["evaluateAction","evaluateSubCommands","subCommands","getSubCommands"]),m=d({item:i,parentItem:r});if(!m.isAvailable)return"continue";var _=void 0;if((null==u?void 0:u.length)&&(_=yr({definitions:u,item:i})),l){var h=l(i);(null==h?void 0:h.length)&&(_=yr({definitions:h,item:i}))}var b=void 0;return f&&(b=function(){return(0,a.yv)(t,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return e=yr,t={},[4,f()];case 1:return[2,e.apply(void 0,[(t.definitions=n.sent(),t.item=i,t)])]}})})}),!_||_.length||b||c.isSplit?c.isDivider&&(s||e===n.length-1)?"continue":(s=!!c.isDivider,void o.push((0,a.q5)((0,a.q5)((0,a.q5)((0,a.q5)({},p),{name:c.evaluateCommandName?c.evaluateCommandName(i):c.name,title:c.evaluateTitle?c.evaluateTitle(i):c.title,iconProps:c.evaluateIconProps?c.evaluateIconProps(i):c.iconProps,buttonStyles:c.evaluateButtonStyles?c.evaluateButtonStyles(i):c.buttonStyles,action:m}),_?{subCommands:_}:{}),b?{getSubCommands:b}:{}))):"continue"},d=0;d<n.length;d++)c(d);return o}var Sr,Dr={main:[],far:[],overflow:[]},Ir=function(){function e(e){var t=this;this.isContextual=function(){return!1},this.onDisplaySetChange=function(e){return t._eventMC.subscribe("displaySetChange",function(t){e(t.detail.displaySet)})},this.getDisplaySetCommand=function(e){for(var n=0,a=[t._displaySet.main,t._displaySet.far,t._displaySet.overflow];n<a.length;n++)for(var i=0,r=a[n];i<r.length;i++){var o=r[i];if(o.id===e)return o}},this.getWorkingSetCommand=function(e){for(var n=0,a=[t._workingSetOverride.main,t._workingSetOverride.far,t._workingSetOverride.overflow];n<a.length;n++)for(var i=0,r=a[n];i<r.length;i++){var o=r[i];if(o.id===e)return o}};var n=e.item,a=e.workingSet,i=e.showCommands,r=void 0===i||i;this._item=n,this._parentItem=void 0,this._workingSet=a,this._showCommands=r,this._workingSetOverride=a,this._workingSetOverrides=new Set,this._displaySetOverrides=new Set,this._eventMC=new vr.a,this._displaySet=this._generateDisplaySet([]),this.updateWorkingSetOverride({publisher:"commandBarInitialLoad"})}return Object.defineProperty(e.prototype,"workingSet",{get:function(){return this._workingSet},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"displaySet",{get:function(){return this._showCommands?this._displaySet:Dr},enumerable:!1,configurable:!0}),e.prototype.updateWorkingSetOverride=function(e){var t=this,n=(0,gr.a)({suspensibles:Array.from(this._workingSetOverrides.values()),onRetry:function(){return t.updateWorkingSetOverride(e)}});n&&(this._workingSetOverride=this._generateWorkingSet(n),this.updateDisplaySet(e))},e.prototype.updateDisplaySet=function(e){var t=this,n=(0,gr.a)({suspensibles:Array.from(this._displaySetOverrides.values()),onRetry:function(){return t.updateDisplaySet(e)}});if(n){var a=e.publisher,i=e.item;i&&(this._item=i),this._displaySet=this._generateDisplaySet(n),this._setShowCommands(!0),this._eventMC.publish("displaySetChange",{publisher:a,displaySet:this.displaySet})}},e.prototype.calcDisplaySet=function(e,t){this._item=e,this._parentItem=t,this._displaySet=this._generateDisplaySet([])},e.prototype.addWorkingSetOverride=function(e){var t=this;return this._workingSetOverrides.add(e),function(){return t._workingSetOverrides.delete(e)}},e.prototype.addDisplaySetOverride=function(e){var t=this;return this._displaySetOverrides.add(e),function(){return t._displaySetOverrides.delete(e)}},e.prototype.dispose=function(){this._eventMC.dispose(),this._displaySetOverrides.clear(),this._workingSetOverrides.clear()},e.prototype._generateWorkingSet=function(e){for(var t=this._workingSet,n=0,a=e;n<a.length;n++)t=(0,a[n])(t);return t},e.prototype._generateDisplaySet=function(e){for(var t=this._item,n=this._parentItem,a=function(e){var t=e.commandDefinitionSet,n=e.item,a=e.parentItem;return{main:yr({definitions:t.main,item:n,parentItem:a}),far:yr({definitions:t.far,item:n,parentItem:a}),overflow:yr({definitions:t.overflow,item:n,parentItem:a})}}({commandDefinitionSet:this._workingSetOverride,item:t,parentItem:n}),i=0,r=e;i<r.length;i++)a=(0,r[i])({displaySet:a,item:t});return a},e.prototype._setShowCommands=function(e){this._showCommands=e},e}(),xr=n(180),Cr=n(137),Or=!H.x9.isActivated("520D3434-B1DD-43EC-9350-065337C1E8E0"),wr={oneUpStore:ne.b,navigation:N.a,resources:H.XQ,oneUpStateStore:je.e,oneUpLoadingCustomerPromiseFunctions:Pe,saveAction:ka.a,isFastOneUpKey:De.e.optional,itemUrlHelper:Q.c},Er=function(e){var t=e.navigation,n=e.oneUpStore,i=e.oneUpStateStore,r=e.saveAction;return function(o){var s={isAvailable:!0,id:"CloseAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var s,c,d,l,u,f,p,m,_,h,b,g,v,y;return(0,a.SO)(this,function(S){return s=Pa({saveAction:r,navigation:t,focusItem:o.item}),c=function(){var n={},i=t.viewParams;if(i){for(var r=0,s=Object.keys(i);r<s.length;r++){var c=s[r];if(c===qe.b.queryParamKey||c===qe.b.searchScopeKey||c===qe.b.meetingIdKey||c===qe.b.personIdKey||c===qe.b.emailIdKey||c===qe.b.pageParamKey||c===qe.b.viewIdKey||c===qe.b.queryTypeParamKey||qe.c.test(c)||c===qe.b.sortFieldKey||c===qe.b.isAscendingKey||c===qe.b.groupByKey||c===qe.b.listUrlKey||Or&&c===qe.b.remoteItem)if(c===qe.b.listUrlKey){var d=i[qe.b.parentQueryTypeParamKey],l=(0,xr.h)(i);d&&"0"!==d||l||(n[c]=i[c])}else n[c]=i[c]}if(!(0,Le.Nb)()){var u=(0,xr.c)({key:o.item.key,viewParams:i,defaultRootItemId:e.itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||""});delete u[qe.b.idParamKey],n=(0,a.q5)((0,a.q5)({},n),u)}}return n},d=n.getOneUpProperties()||{},l=d.parentItem,u=d.parentStoreKey,s||(n.clean(),i.clean()),f=null===(y=e.navigation.viewParams)||void 0===y?void 0:y.parentview,p="",m={},f&&(m=(0,a.q5)((0,a.q5)({},m),((h={})[qe.b.queryTypeParamKey]="".concat(f),h))),u?(null==u?void 0:u.id)&&(m=(0,a.q5)((0,a.q5)({},m),((b={})[qe.b.idParamKey]="".concat(null==u?void 0:u.id),b))):m=(0,a.q5)((0,a.q5)({},m),((g={})[qe.b.idParamKey]="".concat(null==l?void 0:l.id),g)),_={},(0,Cr.a)()&&(null==l?void 0:l.mainLinkInfo)&&((v={})[qe.b.shareTokenKey]=l.mainLinkInfo.ShareTokenString,_=v),p=(0,Ue.a)((0,a.q5)((0,a.q5)((0,a.q5)({},m),c()),_)),p="".concat(e.isFastOneUpKey?"?":"#").concat(p),e.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:me.close}}),e.navigation.navigateTo({url:p,ignoreHistory:!0}),[2,{resultType:ge.b.Success}]})})}};return s}},Ar=new H.aF({name:"CloseAction",factory:{dependencies:wr,create:function(e){return{instance:{evaluateAction:Er(e)}}}}}),Lr={actionProvider:Ar},kr="closeCommand",Mr=new H.aF({name:"CloseCommand",factory:{dependencies:Lr,create:function(e){var t=e.actionProvider;return{instance:{id:kr,buttonStyles:{root:{margin:"auto 6px"}},automationId:kr,title:pt.i,iconProps:{iconName:"Cancel"},evaluateAction:t.evaluateAction}}}}}),Pr=n(576),Tr=n(136),Ur=n(30),Fr=!H.x9.isActivated("59A6C6C6-E122-4867-8174-C3939EF88BD6"),Hr={ODB:-1434},Rr={pageContext:R.a},Nr=function(e){var t=e.pageContext,n=!(0,Pr.a)(t)&&!(0,Tr.b)()&&(Fr||!(0,Ie.i)(null==t?void 0:t.env2)&&!(0,Ie.d)(null==t?void 0:t.env2))&&!(0,Ur.a)(Hr);return Nr=function(){return n},n},Br=new H.aF({name:"isFavoritesEnabled",factory:{dependencies:Rr,create:function(e){return{instance:function(){return Nr(e)}}}}}),jr=n(577),Vr=n(118),zr=n(578),Gr=n(181),Kr=n(11),Wr=n(579),qr=n(377),Qr=!H.x9.isActivated("477a83b0-a601-4574-a95c-87b89e0949a7");!function(e){e[e.Favorite=0]="Favorite",e[e.Unfavorite=1]="Unfavorite"}(Sr||(Sr={}));var Yr={pageContext:R.a,oneUpStore:ne.b,resources:H.XQ,urlDataSource:ln.a,oneUpStateStore:je.e,isFavoritesEnabled:Br,offlineDetection:bn.a,navigation:N.a,identityDataSource:Zt.resourceKey,oneDriveDataSource:qr.oneDriveDataSourceKey,onClickFavoriteSpartan:De.g.optional};function Jr(e,t,i,r,o,s,c){var d,l=this,u="",f=(0,bt.a)(function(){return(0,a.yv)(l,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(64).then(n.bind(n,659))];case 1:return[2,e.sent().ToastActionButton]}})})});if(i)switch(r){case Sr.Favorite:u=p.createElement(p.Fragment,null,zr.a,p.createElement("span",{style:{fontWeight:"bold"}},o||zr.e),zr.h),d=c?p.createElement(p.Fragment,null,p.createElement(f,{theme:s,key:"openFavorites",text:zr.f,onClick:function(){window.open(c,"_blank")}})):void 0;break;case Sr.Unfavorite:default:u=p.createElement(p.Fragment,null,zr.g,p.createElement("span",{style:{fontWeight:"bold"}},o||zr.e),zr.d)}else switch(r){case Sr.Favorite:u=p.createElement(p.Fragment,null,zr.c,p.createElement("span",{style:{fontWeight:"bold"}},o||zr.e),zr.b);break;case Sr.Unfavorite:default:u=p.createElement(p.Fragment,null,zr.j,p.createElement("span",{style:{fontWeight:"bold"}},o||zr.e),zr.i)}e.oneUpStateStore.updateToastState("favoriteAction",{visible:!0,actionStatus:i?t.ToastActionStatus.succeed:t.ToastActionStatus.error,displayText:u,actionButtons:d})}var Xr={actionProvider:new H.aF({name:"FavoriteAction",factory:{dependencies:Yr,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var i,r,o=t.offlineDetection,s=!!t.pageContext&&function(e,t){return e()&&!t}(t.isFavoritesEnabled,o.offline),c=t.oneUpStore.getOneUpProperties(),d=void 0!==t.oneUpStateStore.currentAppState.isFocusItemFavorited,l=t.oneUpStateStore.currentAppState.isFocusItemFavorited||!1,u=(i=e.item,r=l,(0,jr.a)({extension:i.extension,isList:!1,isMountPoint:!!i.mountPoint})&&!r),f=l,p={isAvailable:(0,Le.wb)(Le.ib)&&s&&(t.oneUpStateStore.currentAppState.isFocusItemFavorited?f:u),id:"FavoriteAction",isDisabled:!d};return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(45).then(n.bind(n,651))];case 1:return[2,e.sent()]}})}).then(function(i){p.onExecute=function(){return(0,a.yv)(void 0,void 0,void 0,function(){var r,o,s,d,u,f,p,m,_,h,b,g,v,y,S;return(0,a.SO)(this,function(D){switch(D.label){case 0:return[4,n.e(18).then(n.bind(n,723))];case 1:return r=D.sent(),[4,t.resources.consumeAsync(r.resourceKey)];case 2:return o=D.sent(),s=new Kr.b({context:t.pageContext}),d=(0,H.Ho)(e.item.key),u=d.id,f=d.listurl,p=s.getUrlParts({listUrl:f,path:u}),m=p.fullWebUrl,[4,(I=t,x=m,x?I.identityDataSource.getSharePointToken(x).then(function(e){return e}):new Promise(function(){}))];case 3:return _=D.sent(),h={webAbsoluteUrl:m,listUrl:p.serverRelativeListUrl},b=null===(y=null==c?void 0:c.pageContexts)||void 0===y?void 0:y.get(h),g=(0,Wr.a)(),v={items:[{siteId:(null==b?void 0:b.siteId)||t.pageContext.siteId,webId:(null==b?void 0:b.webId)||t.pageContext.webId,listId:(null==b?void 0:b.listId)||t.pageContext.listId,listItemUniqueId:null===(S=e.item.properties)||void 0===S?void 0:S.uniqueId}],accessToken:_},function(e){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return Qr?[4,e.oneDriveDataSource.getPersonalUrl()]:[3,2];case 1:return"/"!==(t=a.sent()).charAt(t.length-1)&&(t=t.concat("/")),[2,t.concat("_layouts/15/onedrive.aspx?view=","".concat(Vr.a.Favorites))];case 2:return n=e.urlDataSource.getPageType(e.navigation.viewParams),i={},n!==Ye.a.Files&&(i[qe.b.pageParamKey]=n),i[qe.b.queryTypeParamKey]="".concat(Vr.a.Favorites||""),r="#"+(0,Gr.b)(i,void 0,!0),[2,Promise.resolve("".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(r))]}})})}(t).then(function(n){var a,r,s;if(!(v.items[0].siteId&&v.items[0].webId&&v.items[0].listId&&v.items[0].listItemUniqueId))return t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:ye.d.actionError,error:{name:"favoriteAction.MissingItemProperties",message:"Missing required item properties for favorite-unfavorite call"},item:e.item}),{resultType:ge.b.Failure};if(l?o.unfavoriteItems(v).then(function(){return Jr(t,i,!0,Sr.Unfavorite,e.item.name,g,n),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!1),{resultType:ge.b.Success}}).catch(function(a){return Jr(t,i,!1,Sr.Unfavorite,e.item.name,g,n),t.oneUpStateStore.updateErrorState("favoriteAction.Unfavorite",{errorType:ye.d.actionError,error:a,item:e.item}),{resultType:ge.b.Failure}}):o.favoriteItems(v).then(function(){return Jr(t,i,!0,Sr.Favorite,e.item.name,g,n),t.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!0),{resultType:ge.b.Success}}).catch(function(a){return Jr(t,i,!1,Sr.Favorite,e.item.name,g,n),t.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:ye.d.actionError,error:a,item:e.item}),{resultType:ge.b.Failure}}),!(0,Le.Gb)()){if(!t.onClickFavoriteSpartan||!(null===(a=e.item.properties)||void 0===a?void 0:a.ID))return{resultType:ge.b.Failure,extraData:{error:"onClickFavoriteSpartan or item id not available, item id is ".concat(null===(s=e.item.properties)||void 0===s?void 0:s.ID)}};var c={isFavorited:l,listItemId:null===(r=e.item.properties)||void 0===r?void 0:r.ID};t.onClickFavoriteSpartan(c)}}).catch(function(n){return t.oneUpStateStore.updateErrorState("favoriteAction.GetFavoritesEndpoint",{errorType:ye.d.actionError,error:n,item:e.item,extraData:{isCurrentOneDrive:t.oneDriveDataSource.isCurrentOneDrive}}),{resultType:ge.b.Failure,error:n.name,extraData:{error:n,item:e.item,isCurrentOneDrive:t.oneDriveDataSource.isCurrentOneDrive}}}),[2]}var I,x})})}}).catch(function(e){p.isAvailable=!1}),p})}};var t}}}),oneUpStateStore:je.e},Zr="favoriteCommand",$r=new H.aF({name:"FavoriteCommand",factory:{dependencies:Xr,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:Zr,name:pt.F,automationId:Zr,evaluateTitle:function(e){return n.currentAppState.isFocusItemFavorited?pt.Tb:pt.G},evaluateIconProps:function(e){return n.currentAppState.isFocusItemFavorited?{iconName:"FavoriteStarFill"}:{iconName:"FavoriteStar"}},evaluateAction:t.evaluateAction}}}}}),eo=n(581);function to(e){if(e)switch((0,eo.a)(e)){case"ms-word":return"Word";case"ms-excel":return"Excel";case"ms-powerpoint":return"PowerPoint";case"ms-visio":return"Visio";case"ms-project":return"Project";case"ms-publisher":return"Publisher";case"ms-access":return"Access";case"onenote|UsePlain":return"OneNote"}}var no={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.XQ,platform:$.a};function ao(e){if(e)switch((0,eo.a)(e)){case"ms-word":return{iconName:"svg/word_16x1.svg",className:Te.h};case"ms-excel":return{iconName:"svg/excel_16x1.svg",className:Te.h};case"ms-powerpoint":return{iconName:"svg/powerpoint_16x1.svg",className:Te.h};case"ms-visio":return{iconName:"svg/visio_16x1.svg",className:Te.h};case"ms-project":return{iconName:"ProjectDocument",className:Te.h};case"ms-publisher":return{iconName:"PublisherLogo",className:Te.h};case"ms-access":return{iconName:"AccessLogo",className:Te.h};case"onenote|UsePlain":return{iconName:"svg/onenote_16x1.svg",className:Te.h}}}var io={actionProvider:new H.aF({name:"OpenInOfficeClientAction",factory:{dependencies:no,create:function(e){return{instance:{evaluateAction:(t=e,function(e){return{isAvailable:(n=e.item,i=t.platform,!!((i.isMac||i.isWindows||i.isIOS||i.isWinPhone||i.isAndroid)&&n&&ct.a.hasItemPermission(n,ct.a.openItems)&&n.openUrl&&n.appMap&&n.itemStatus!==dt.b.ConditionalAccessBlocked&&n.itemStatus!==dt.b.ConditionalAccessViewOnly)),id:"OpenInOfficeClientAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return[2,t.resources.consumeAsync(ln.a).then(function(n){var a=n.getOpenInOfficeClientUrl(e.item,t.navigation.viewParams);return t.navigation.navigateTo({url:a,frameId:"_blank"}),{resultType:ge.b.Success}})]})})}};var n,i})}};var t}}}),oneUpStore:ne.b},ro="openInOfficeClientCommand";function oo(e){return to(e.extension)?H.PN(pt.ib,to(e.extension)):pt.ab}var so=new H.aF({name:"OpenInOfficeClientCommand",factory:{dependencies:io,create:function(e){return{instance:{id:ro,automationId:ro,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:function(e){return ao(e.extension)},evaluateCommandName:function(e){return oo(e)},evaluateTitle:function(e){return oo(e)}}}}}}),co={actionProvider:ra,oneUpStore:ne.b},lo="openInOfficeOnlineCommand";function uo(e,t){return to(e.extension)?t?H.PN(pt.cb,to(e.extension)):H.PN(pt.ob,to(e.extension)):t?pt.sb:pt.rb}var fo=new H.aF({name:"OpenInOfficeOnlineCommand",factory:{dependencies:co,create:function(e){return{instance:{id:lo,automationId:lo,evaluateAction:e.actionProvider.evaluateAction,evaluateIconProps:function(e){return ao(e.extension)},evaluateCommandName:function(e){return uo(e)},evaluateTitle:function(e){return uo(e,!0)}}}}}}),po=n(582),mo=n(583);function _o(e){var t=new H.K3;if(e.item&&e.item.urls&&e.item.urls[ht.b.immersiveReaderUrl]){var n=e.item.urls[ht.b.immersiveReaderUrl],a=(0,po.a)({url:n,qosName:"OneUpLightSpeed.OpenInImmersiveReader.GetReaderOptions"}).getImmersiveReaderContext,i=new H.K3;if(a){var r=new ge.a({name:"OneUpLightSpeed.OpenInImmersiveReader.Launch"});return(0,mo.a)({getImmersiveReaderContext:a,options:{onExit:function(){i.resolve(),e.onClose&&e.onClose()}}}).then(function(){return e.onRender&&e.onRender(),i.promise.then(function(){r.end({resultType:ge.b.Success})}).catch(function(t){r.end({resultType:ge.b.Failure,extraData:{error:t.message,stack:t.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(t)})}).catch(function(t){r.end({resultType:ge.b.Failure,extraData:{error:t.message,stack:t.stack,extension:e.item.extension,fileSize:e.item.size}}),e.onError&&e.onError(t)})}e.onError&&e.onError({name:"IM.MissingReaderContext",message:"IM context options missing"})}else e.onError&&e.onError({name:"IM.ItemMissingProps",message:"Item missing required properties"});return t.promise}var ho=new H.aF({name:"ShowImmersiveReader",factory:{dependencies:{},create:function(e){return{instance:{showImmersiveReader:_o}}}}}),bo=n(584),go="OpenInImmersiveReaderAction",vo=[".docx",".txt",".html"],yo={getExecutor:ho.async.lazy,pageContext:R.a,oneUpStore:ne.b,resources:H.XQ,oneUpStateStore:je.e},So={actionProvider:new H.aF({name:"OpenInImmersiveReaderAction",factory:{dependencies:yo,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=e.item,i=function(e){return!(!e.extension||!e.size)&&!(!e.urls||!e.urls[ht.b.immersiveReaderUrl])&&-1!==vo.indexOf(e.extension)&&(0,bo.a)(e.size)}(n),r={isAvailable:i,id:go,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var i,r,o;return(0,a.SO)(this,function(s){switch(s.label){case 0:return[4,t.getExecutor()];case 1:i=s.sent(),r=new Vt.b,o=(0,a.q5)((0,a.q5)({},e),{onClose:function(){},onRender:function(e){r.complete()},onError:function(e){e.name="IMLaunchFailure.".concat(e.name),t.oneUpStateStore.updateErrorState(go,{errorType:ye.d.actionError,error:e,item:n}),r.error(e)}}),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,i.showImmersiveReader(o)];case 3:case 4:return s.sent(),[3,5];case 5:return[2,r.getPromise()]}})})}};return r})}};var t}}})},Do="openInImmersiveReaderCommand",Io=new H.aF({name:"OpenInImmersiveReaderCommand",factory:{dependencies:So,create:function(e){var t=e.actionProvider;return{instance:{id:Do,name:pt.tb,title:pt.nb,automationId:Do,iconProps:{iconName:"ReadOutLoud"},evaluateAction:t.evaluateAction}}}}}),xo={pageContext:R.a,oneUpStore:ne.b,resources:H.XQ,oneUpStateStore:je.e,getValidViewerTypesFromResource:Se.c},Co={actionProvider:new H.aF({name:"OpenInHtmlViewerAction",factory:{dependencies:xo,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=!!i&&i.htmlMode===je.b.edit;return{isAvailable:n===Se.a.Html&&r,id:"OpenInHtmlViewerAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return t.oneUpStateStore.updateViewerState("updateHtmlModeView",{key:e.item.key,options:{htmlMode:je.b.view}}),[2,{resultType:ge.b.Success}]})})}}})}}}}})},Oo="openInHtmlViewerCommand",wo=new H.aF({name:"OpenInHtmlViewerCommand",factory:{dependencies:Co,create:function(e){var t=e.actionProvider;return{instance:{id:Oo,name:pt.eb,automationId:Oo,iconProps:{iconName:"View"},evaluateAction:t.evaluateAction}}}}}),Eo={pageContext:R.a,oneUpStore:ne.b,resources:H.XQ,oneUpStateStore:je.e,getValidViewerTypesFromResource:Se.c},Ao={actionProvider:new H.aF({name:"OpenInTextEditorAction",factory:{dependencies:Eo,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),i=t.oneUpStateStore.getViewerState(e.item.key),r=void 0===(null==i?void 0:i.htmlMode)||(null==i?void 0:i.htmlMode)===je.b.view;return{isAvailable:n===Se.a.Html&&r&&".msg"!==e.item.extension,id:"OpenInTextEditorAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return t.oneUpStateStore.updateViewerState("updateHtmlModeEdit",{key:e.item.key,options:{htmlMode:je.b.edit}}),[2,{resultType:ge.b.Success}]})})}}})}}}}})},Lo="openInTextEditorCommand",ko=new H.aF({name:"OpenInTextEditorCommand",factory:{dependencies:Ao,create:function(e){var t=e.actionProvider;return{instance:{id:Lo,name:pt.lb,automationId:Lo,iconProps:{iconName:"Edit"},evaluateAction:t.evaluateAction}}}}}),Mo=!H.x9.isActivated("1cbefa0c-46a0-4a8e-90f8-0831761b38fb"),Po={navigation:N.a,getValidViewerTypesFromResource:Se.c},To=new H.aF({name:"OpenInStreamAction",factory:{dependencies:Po,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),r=e.item.openUrl,o=Mo&&(0,kn.a)(null===(n=e.item.urls)||void 0===n?void 0:n[ht.b.video])||!Mo,s=(i===Se.a.OnePlayerVideo||i===Se.a.OnePlayerAudio)&&o&&!!r,c=-1===(null==r?void 0:r.indexOf("?"))?"?web=1":"&web=1",d="".concat(r).concat(c,"&referrer=OneUpViewer.web&referrerScenario=OpenFile.view"),l={isAvailable:s,id:"OpenInStreamAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,t.navigation.navigateTo({url:d,frameId:"_blank"})];case 1:return e.sent(),[2,{resultType:ge.b.Success}]}})})}};return l})};return{instance:n}}}}),Uo=n(585),Fo={actionProvider:To,oneUpStore:ne.b},Ho="openInStreamCommand";(0,l.fU)({icons:{OpenRegular:p.createElement("svg",{fill:"currentColor",width:"16",height:"16",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M6 4a2 2 0 0 0-2 2v8c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-2.5a.5.5 0 0 1 1 0V14a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h2.5a.5.5 0 0 1 0 1H6Zm5-.5c0-.28.22-.5.5-.5h5c.28 0 .5.22.5.5v5a.5.5 0 0 1-1 0V4.7l-4.15 4.15a.5.5 0 0 1-.7-.7L15.29 4H11.5a.5.5 0 0 1-.5-.5Z"}))}});var Ro=new H.aF({name:"OpenInStreamCommand",factory:{dependencies:Fo,create:function(e){var t=e.actionProvider;return{instance:{id:Ho,name:Uo.a?pt.$:pt.db,title:Uo.a?pt.$:pt.db,automationId:Ho,evaluateAction:t.evaluateAction,iconProps:{iconName:Uo.a?"OpenRegular":"svg/stream_16x1.svg",className:Te.h}}}}}}),No=n(152),Bo=n(29),jo={oneUpStateStore:je.e,pageContext:R.a,fileHandlerHelper:yi.a},Vo=new H.aF({name:"OpenInFileHandleCommand",factory:{dependencies:jo,create:function(e){function t(t){var n,i=this,r={imageProps:{src:null===(n=t.handler.appIcon)||void 0===n?void 0:n.svg,title:t.handler.actionMenuDisplayName,imageFit:No.b.contain}},o=t.handler.actionMenuDisplayName||t.displayName,s={id:"fileHandlerOpen",name:o,title:t.handler.actionMenuDisplayName,automationId:"fileHandlerOpen",iconProps:r,extraData:{handlerName:o},evaluateAction:function(n){var r=n.item,s={isAvailable:zo(t.availableOn,n.item.extension,!1),id:"fileHandlerOpenAction-".concat(o),onExecute:function(){return(0,a.yv)(i,void 0,void 0,function(){var i,o,s,c,d,l,u,f,p,m;return(0,a.SO)(this,function(_){switch(_.label){case 0:i=Number(e.pageContext.webTemplate)===jn.b.mySite,o=(0,Le.Wb)()?i?"OneDrive":"SharePoint":"OneUp",s={cultureName:e.pageContext.currentUICultureName||e.pageContext.currentCultureName||"en-US",client:o,domainHint:"organizations",userId:e.pageContext.userLoginName},c=function(e){var t=window.open({}.url||"","_blank");return t&&(t.opener=null),t||void 0}(),d=!!t.handler.isPromoted,_.label=1;case 1:return _.trys.push([1,3,,4]),[4,e.fileHandlerHelper.getFileHandlerItemUrl(n.item,t,d)];case 2:return l=_.sent(),[3,4];case 3:return f=_.sent(),u=f,[3,4];case 4:if(l&&l.length>0){if(p=(0,a.q5)((0,a.q5)({},s),{appId:t.handler.appId,items:JSON.stringify(l)}),c&&c.document)return c.opener=null,(0,Si.a)({url:t.url,postdata:p,document:c.document}),[2,{resultType:Bo.a.Success}];throw m=(0,ye.i)("No target window available to invoke File Handler"),e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:ye.d.actionError,error:m,item:r}),m}throw m=u||(0,ye.i)("unknown error calling getFileHandlerItemUrl"),e.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:ye.d.actionError,error:m,item:r}),m}})})}};return s}};return s}return{instance:function(n){var a=[],i=n||e.oneUpStateStore.getFileHandlerOptions();if(i)for(var r=i.data.actions.open,o=0;o<r.length;o++){var s=t(r[o]);a.push(s)}return a}}}}});function zo(e,t,n){var a=e.file,i=e.folder,r=e.file&&e.file.extensions||void 0;if(n)return!!i;if(a&&t){var o="."!==t.charAt(0)?"."+t:t;return!r||-1!==r.indexOf(o.toLowerCase())||-1!==r.indexOf("*")||-1!==r.indexOf(".*")}return!1}var Go=n(586),Ko=n(587),Wo=n(128),qo=n(362),Qo=function(e){return function(t){var n,i=e.oneUpStore.getOneUpProperties(),r=null==i?void 0:i.parentItem,o=!!t.item&&!!t.item.key&&!!e.pageContext&&function(e,t){var n,a,i,r=null!==(n=null==t?void 0:t.canUserUseClipchamp)&&void 0!==n&&n,o=(0,Le.wb)({ODB:1344}),s=(0,Le.wb)({ODB:61399}),c=null!==(a=t&&t.listBaseTemplate===Wo.a.webPageLibrary)&&void 0!==a&&a,d=ct.a.hasItemPermission(e,ct.a.insertListItems);return(0,Go.b)(null!==(i=e.extension)&&void 0!==i?i:"",!0)&&d&&o&&!c&&(r||s)}(t.item,e.pageContext),s=(0,Go.a)(null==r?void 0:r.graph,e.pageContext.webAbsoluteUrl,{referrer:e.clientName||"OneUp",referrerScenario:"EditInClipchamp",video:null===(n=t.item)||void 0===n?void 0:n.graph});return{isAvailable:o,id:"EditInClipchampAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){return(0,Ko.a)(s,{forceInSameWindow:!1}),[2,{resultType:ge.b.Success}]})})}}}},Yo={oneUpStore:ne.b,navigation:N.a,pageContext:R.a,clientName:qo.a.optional},Jo={actionProvider:new H.aF({name:"EditInClipchampAction",factory:{dependencies:Yo,create:function(e){return{instance:{evaluateAction:Qo(e)}}}}}),oneUpStore:ne.b},Xo="editInClipchampCommand",Zo=window.require,$o=Zo&&Zo.toUrl?Zo.toUrl("odsp-media/images/clipchamp/clipchamp_256x.svg"):"",es=new H.aF({name:"EditInClipchampCommand",factory:{dependencies:Jo,create:function(e){var t=e.actionProvider;return{instance:{id:Xo,name:pt.A,title:pt.A,automationId:Xo,evaluateAction:t.evaluateAction,iconProps:{imageProps:{src:$o,styles:{root:{width:"16px",height:"16px",display:"flex !important"}}}}}}}}}),ts=new H.aF({name:"OpenInAppDataSourceAsync.key",loader:new H.xT(function(){return n.e(49).then(n.bind(n,724)).then(function(e){return e.openInAppDataSourceKey})})}),ns=function(e){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,e.resources.consumeAsync(ts)];case 1:return[4,t.sent().openInApp(e.item,e.pageContexts)];case 2:return t.sent(),[2]}})})},as=new H.aF({name:"OpenInAppActionExecutor",factory:{dependencies:{},create:function(e){return{instance:{executeOpenInApp:ns}}}}}),is="OpenInAppAction",rs={oneUpStore:ne.b,platform:$.a,oneUpStateStore:je.e,itemUrlHelper:Q.c,getValidViewerTypesFromResource:Se.c,getExecutor:as.async.lazy,resources:H.XQ},os={actionProvider:new H.aF({name:"OpenInAppAction",factory:{dependencies:rs,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i,r,o=(n=e.item,i=t.platform,r=t.getValidViewerTypesFromResource.getValidViewerTypes(e.item),!(!(i.isWindows||i.isWinPhone||i.isAndroid||i.isIOS||i.isMac)||!n||r===Se.a.Copilot||!ct.a.hasItemPermission(n,ct.a.openItems)||n.appMap||n.itemStatus===dt.b.ConditionalAccessBlocked||(r===Se.a.MSPdf||r===Se.a.Pdf||r===Se.a.Photo)&&ct.a.hasItemPermission(n,ct.a.insertListItems)&&ct.a.hasItemPermission(n,ct.a.editListItems))),s=t.oneUpStore.getOneUpProperties(),c={isAvailable:o,id:is,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=(e=s).focusItem,i=e.parentItem,r=e.focusItemSet,s&&r&&r.length&&n&&i?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeOpenInApp({item:n,pageContexts:s.pageContexts,resources:t.resources})];case 2:return a.sent(),[2,{resultType:ge.b.Success}];case 3:throw o=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(is,{errorType:ye.d.actionError,error:o,item:n}),o}})})}};return c})}};var t}}}),oneUpStore:ne.b},ss="OpenInAppCommand",cs=new H.aF({name:"OpenInAppCommand",factory:{dependencies:os,create:function(e){return{instance:{id:ss,name:pt._,title:pt._,automationId:ss,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}}}}}),ds=n(170),ls={openInOfficeClientCommand:so,openInOfficeOnlineCommand:fo,openInImmersiveReaderCommand:Io,openInHtmlViewerCommand:wo,openInTextEditorCommand:ko,openInStreamCommand:Ro,openInFileHandlerCommands:Vo,editInClipchampCommand:es,openInAppCommand:cs},us="openCommandGroup",fs=function(e){return{isAvailable:!0}},ps=new H.aF({name:"OpenGroupCommand",factory:{dependencies:ls,create:function(e){return{instance:function(){var t=e.openInOfficeClientCommand,n=e.openInImmersiveReaderCommand,i=e.openInOfficeOnlineCommand,r=e.openInTextEditorCommand,o=e.openInHtmlViewerCommand,s=e.openInStreamCommand,c=e.editInClipchampCommand,d=e.openInAppCommand,l=e.openInFileHandlerCommands();return{id:us,name:pt.Z,automationId:us,subCommands:(0,a.lt)((0,a.lt)([t,i,r,o,n,s],l,!0),[c,d],!1),evaluateAction:fs,buttonStyles:(0,ds.a)(),evaluateIconProps:function(e){return ao(e.extension)||{iconName:"OpenInNewWindow"}}}}}}}}),ms={openInfoPaneActionAsync:sr.async,oneUpStateStore:je.e},_s=new H.aF({name:"OnClickInfoButtonAction",factory:{dependencies:ms,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"onClickInfoButtonAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==je.d.detailPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("onClickInfoButton",{type:je.d.none}),[3,5]);case 1:return[4,t.openInfoPaneActionAsync()];case 2:return n=a.sent(),(i=n.evaluateAction({item:e.item})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new ge.a({name:"openInfoPane"})})]:[3,4];case 3:return a.sent(),[3,5];case 4:throw new Error("openInfoPaneAction is not available");case 5:return[2]}})})}};return n})};return{instance:n}}}}),hs=n(588),bs={actionProvider:_s},gs="InfoPaneCommand",vs=new H.aF({name:"InfoPaneCommand",factory:{dependencies:bs,create:function(e){var t,n=e.actionProvider;return{instance:(0,a.q5)((0,a.q5)({id:gs,name:pt.U,title:pt.V,ariaLabel:pt.U+", "+pt.V,properties:(t={},t["aria-label"]="".concat(pt.U,", ").concat(pt.V),t),automationId:gs},hs.a?{}:{iconProps:{iconName:"Info"}}),{evaluateAction:n.evaluateAction})}}}}),ys=n(413),Ss=new H.aF({name:"OnPickCopyFileAsync.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(47)]).then(n.bind(n,725)).then(function(e){return e.onPickCopyFileKey})})}),Ds=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(19)]).then(n.bind(n,655))];case 1:return[2,e.sent().Sdk80FilePickerHostModal]}})})});function Is(e){var t=new H.K3;return e.onRender(p.createElement(xs,(0,a.q5)({},e))),t.promise}function xs(e){var t=(0,V.c)(),n="".concat(e.pageContext.webAbsoluteUrl,"/").concat(e.pageContext.layoutsUrl,"/FilePicker.aspx"),a={title:pt.o,selection:{mode:"pick"},commands:{pick:{label:pt.n}},typesAndSources:{mode:"folders"},entry:{sharePoint:{byPath:{web:e.web,list:e.list,folder:e.folder}}}},i=(0,be.a)(function(t){return e.onClose(),Promise.resolve()}),r=(0,be.a)(function(e){return Promise.resolve()}),o=(0,be.a)(function(n){var a=new ge.a({name:"OneUpCopyToOnPick"}),i=t.consumeAsync(Ss);return e.onClose(),i.then(function(t){t(n,e.folder).then(function(){return a.end({resultType:ge.b.Success})}).catch(function(e){a.end({resultType:ge.b.Failure,error:e})})}).catch(function(e){a.end({resultType:ge.b.Failure,error:e})}),Promise.resolve()});return p.createElement(Ds,{pickerPageUrl:n,app:e.clientName,scenario:"MoveCopy",options:a,onPick:o,onClose:i,onLoad:r})}var Cs=new H.aF({name:"ShowFilePicker",factory:{dependencies:{},create:function(e){return{instance:{showFilePicker:Is}}}}}),Os=function(e){return function(t){var n={isAvailable:ws(t.item),id:"copyToAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i,r,o,s,c,d;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0}),[4,e.getExecutor()];case 1:return n=a.sent(),i=e.itemUrlHelper.getItemUrlParts(t.item.key),r=e.oneUpStore.parentItem?e.itemUrlHelper.getItemUrlParts(e.oneUpStore.parentItem.key):void 0,o=i.fullListUrl,s=i.fullWebUrl,c=null==r?void 0:r.fullItemUrl,d={pageContext:e.pageContext,clientName:e.clientName||"OneUp",onClose:function(){e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!1})},onRender:function(t){e.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0,content:t})},list:o,web:s,folder:c},[4,n.showFilePicker(d)];case 2:return a.sent(),[2,{resultType:ge.b.Success}]}})})}};return n}};function ws(e){var t;return e.itemStatus!==dt.b.ConditionalAccessBlocked&&e.itemStatus!==dt.b.ConditionalAccessViewOnly&&!!ct.a.hasItemPermission(e,ct.a.openItems)&&!e.isRootFolder&&!(null===(t=e.lifeCycleStatus)||void 0===t?void 0:t.isMalwareDetected)}var Es={getExecutor:Cs.async.lazy,pageContext:R.a,clientName:qo.a.optional,oneUpStateStore:je.e,itemUrlHelper:Q.c,oneUpStore:ne.b},As={actionProvider:new H.aF({name:"CopyToAction",factory:{dependencies:Es,create:function(e){return{instance:{evaluateAction:Os(e)}}}}})},Ls="copyToCommand",ks=new H.aF({name:"CopyToCommand",factory:{dependencies:As,create:function(e){var t=e.actionProvider;return{instance:{id:Ls,name:pt.o,title:pt.p,automationId:Ls,iconProps:{iconName:"Copy"},evaluateAction:t.evaluateAction}}}}}),Ms=n(589),Ps=new H.aF({name:"DeleteActionExecutor.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(10)]).then(n.bind(n,726)).then(function(e){return e.deleteActionExecutorKey})})}),Ts="DeleteAction",Us={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.XQ,platform:$.a,oneUpStateStore:je.e,getExecutor:Ps.async.lazy},Fs={actionProvider:new H.aF({name:"DeleteAction",factory:{dependencies:Us,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n,i=(n=e.item,ct.a.hasItemPermission(n,ct.a.deleteListItems)),r=t.oneUpStore.getOneUpProperties(),o={isAvailable:i,id:Ts,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,i,o,s,c,d,l,u,f,p;return(0,a.SO)(this,function(m){switch(m.label){case 0:return i=(n=r).focusItem,o=n.parentItem,s=n.focusItemSet,c=n.currentIndex,d=n.list,r&&s&&s.length&&i&&o?(l={parentKey:o.key,items:[e.item],deletionType:Ms.a.Recycle,allowUndo:!1,emptyRecycleBin:!1,listId:null===(p=null==d?void 0:d.list)||void 0===p?void 0:p.id,overrideLock:!0,enforceETag:!1},u=o,u=void 0!==c&&c+1<s.length?s[c+1]:c&&c-1>=0?s[c-1]:o,[4,t.getExecutor()]):[3,2];case 1:return m.sent().executeDelete({deleteItemsContext:l,resources:t.resources,oneUpStateStore:t.oneUpStateStore,item:e.item}).then(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e?((n=t.oneUpStateStore.currentAppState.deletedKeys)?n.set(i.key,!0):(n=new Map).set(i.key,!0),t.oneUpStateStore.updateDeletedKeysState("DeleteAction",n),u.key!==o.key?[3,3]:[4,(0,H.Ri)(5e3)]):[3,5];case 1:return a.sent(),[4,Ki(u,t.resources,{urlType:"focus"})];case 2:return a.sent(),[3,5];case 3:return[4,Ki(u,t.resources,{parentItem:r.parentItem,urlType:"focus"})];case 4:a.sent(),a.label=5;case 5:return[2,{resultType:ge.b.Success}]}})})}).catch(function(e){throw t.oneUpStateStore.updateErrorState("delete action",{errorType:ye.d.actionError,error:e,item:i}),e}),[3,3];case 2:throw f=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(Ts,{errorType:ye.d.actionError,error:f,item:i}),f;case 3:return[2]}})})}};return o})}};var t}}})},Hs="deleteCommand",Rs=new H.aF({name:"DeleteCommand",factory:{dependencies:Fs,create:function(e){var t=e.actionProvider;return{instance:{id:Hs,name:pt.r,title:pt.s,automationId:Hs,iconProps:{iconName:"Delete"},evaluateAction:t.evaluateAction}}}}}),Ns=n(355),Bs="AnnotateAction",js={oneUpStateStore:je.e,uaDataSource:Ht,pdfHelper:Yt.b,itemUrlHelper:Q.c,openCommentsPaneActionAsyncKey:lr.async},Vs=function(e){return function(t){var n={id:Bs,isAvailable:Gs(t.item,e),isDisabled:Ns.i&&e.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return e.oneUpStateStore.toggleAnnotationViewerVisiblity(Bs),(0,Le.wb)(Le.C)?[4,zs(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2,{resultType:ge.b.Success}]}})})}};return n}};function zs(e,t){var n;return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return(null===(n=t.oneUpStateStore.state.currentState.annotationViewerState)||void 0===n?void 0:n.viewerVisiblity)!==je.a.On?[3,3]:[4,t.openCommentsPaneActionAsyncKey()];case 1:return[4,a.sent().evaluateAction({item:e.item,isAnnotateAction:!0})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function Gs(e,t){var n,a,i;if(!(0,Le.wb)(Le.W))return!1;var r=t.uaDataSource.isUniversalAnnotationDisabled;if((0,Le.wb)(Le.Q)&&r)return!1;if(null===(i=null===(a=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.key))||void 0===a?void 0:a.pdfViewerStates)||void 0===i?void 0:i.isPdfMip)return!1;if(!t.pdfHelper.isSupportedFileType(e))return!1;if(t.itemUrlHelper.getItemUrlParts(e.key).geoRelation!==Q.a.sameGeo)return!1;if(!t.pdfHelper.isMsPdfViewerAvailable(e)||!t.pdfHelper.isMsPdfViewerSupported(e.size))return!1;var o=t.oneUpStateStore.getESignData().isCreateSidePanelActive;return!(!Ns.i&&o||!t.uaDataSource.hasLicense||!t.pdfHelper.isNotEmbed())}var Ks={actionProvider:new H.aF({name:"AnnotateAction",factory:{dependencies:js,create:function(e){return{instance:{evaluateAction:Vs(e)}}}}}),oneUpStateStore:je.e},Ws="annotateCommand",qs=new H.aF({name:"AnnotateCommand",factory:{dependencies:Ks,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:Ws,automationId:Ws,name:pt.e,iconProps:{iconName:"InkingTool"},evaluateTitle:function(e){return n.currentAppState.annotationViewerState.isActive?pt.S:pt.Eb},evaluateAction:t.evaluateAction}}}}}),Qs=n(590),Ys=n(591),Js={openCommentsPaneActionAsync:lr.async,oneUpStateStore:je.e},Xs=new H.aF({name:"OnClickCommentsButtonAction",factory:{dependencies:Js,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={id:"onClickCommentsButtonAction",isAvailable:(0,Qs.a)(e.item),onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==je.d.commentsPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("onClickCommentsButton",{type:je.d.none}),(0,Ys.b)(Ys.a.CloseCommentsFromCommandBar,e.item.extension),[3,4]);case 1:return[4,t.openCommentsPaneActionAsync()];case 2:return[4,n.sent().evaluateAction({item:e.item,isAnnotateAction:!1})];case 3:n.sent(),(0,Ys.b)(Ys.a.OpenCommentsFromCommandBar,e.item.extension),n.label=4;case 4:return[2]}})})}};return n})};return{instance:n}}}}),Zs={actionProvider:Xs,oneUpStateStore:je.e},$s="commentCommand",ec=new H.aF({name:"CommentsCommand",factory:{dependencies:Zs,create:function(e){var t=e.actionProvider,n=e.oneUpStateStore;return{instance:{id:$s,automationId:$s,buttonStyles:(0,ds.a)(),iconProps:{iconName:"Comment"},evaluateTitle:function(e){return n.currentAppState.rightPane.type===je.d.commentsPane?pt.T:pt.Ab},evaluateAction:t.evaluateAction}}}}});const tc=n.p+"images/sharepoint_16x1_9891ae75.svg",nc=n.p+"images/adobeAcrobatSign_6ded66ba.svg",ac=n.p+"images/docuSign_e53ed1dc.svg",ic=n.p+"images/signature_c0654d5b.svg",rc=n.p+"images/signatureHighContrast_e67cc86d.svg";var oc=n(195);function sc(e,t,n,a,i,r){var o,s;return!!t&&!(n||t.isExternalGuestUser||".pdf"!==(null===(o=null==e?void 0:e.extension)||void 0===o?void 0:o.toLowerCase())||!(null==i?void 0:i())||r||a||!Wn(t)||!function(e){if(!e)return!1;switch(e){default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(null===(s=t.cloudType)||void 0===s?void 0:s.toLowerCase()))}function cc(e,t,n,a,i,r,o){var s,c,d=!!oc.b||!!(null==n?void 0:n.isSyntexESignatureEnabled),l=d&&!(!(null==n?void 0:n.isSyntexPAYGEnabled)||!(null===(s=null==n?void 0:n.syntexEsignatureThirdPartyEnabledProviders)||void 0===s?void 0:s.some(function(e){return e===zn.b.Adobe}))),u=d&&!(!(null==n?void 0:n.isSyntexPAYGEnabled)||!(null===(c=null==n?void 0:n.syntexEsignatureThirdPartyEnabledProviders)||void 0===c?void 0:c.some(function(e){return e===zn.b.Docusign})));return sc(t,n,a,i,r,o)&&e===zn.a.Adobe?l:e===zn.a.Docusign&&u}var dc,lc=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(14)]).then(n.bind(n,727))];case 1:return[2,e.sent().ESignGatewayWrapper]}})})}),uc=function(e){return!!e&&e.viewerVisiblity===je.a.On},fc={oneUpStore:ne.b,oneUpStateStore:je.e,pageContext:R.a,pdfHelper:Yt.b,identityDataSource:Zt.resourceKey,itemUrlHelper:Q.c,platformDetection:$.a},pc=function(e,t){return function(n){var i,r,o,s=n.item,c=e.oneUpStore,d=e.oneUpStateStore,l=e.pageContext,u=e.pdfHelper,f=e.platformDetection,m=e.identityDataSource,_=uc(d.currentAppState.annotationViewerState),h=null===(r=null===(i=d.currentAppState.viewerStates)||void 0===i?void 0:i.get(s.key))||void 0===r?void 0:r.pdfViewerStates,b="create_".concat(t,"RequestAction"),g=null!==(o=c.focusItem)&&void 0!==o?o:s,v=Ct({item:g,appLevelPagecontext:e.pageContext,itemUrlHelper:e.itemUrlHelper,remoteWebPageContexts:e.oneUpStore.pageContexts}),y={isAvailable:cc(t,g,l,_,(null==h?void 0:h.isPdfPasswordProtected)||(null==h?void 0:h.isPdfMip),function(){return!!g&&u.isMsPdfViewerAvailable(g)},f.isMobile),id:b,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,i,r;return(0,a.SO)(this,function(o){switch(o.label){case 0:return d.updateESignDataState(b,{isCreateSidePanelActive:!1}),[4,m.getOAuthSessionToken(Gn(l))];case 1:return e=o.sent(),n={provider:t,item:{name:g.displayName,driveId:null===(i=g.graph)||void 0===i?void 0:i.driveId,openUrl:g.openUrl,size:g.size,permissions:g.permissions,policies:{canDownload:v}},sessionToken:(0,a.q5)((0,a.q5)({},e),{correlationId:null!==(r=e.correlationId)&&void 0!==r?r:(c=function(){var e=btoa(_t.a.generate().match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""));return"".concat(e.replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}(),u={},s=u[c]||0===u[c]?u[c]+1:0,u[c]=s,"".concat(c,".").concat(s))})},d.updateModalState(b,{showModal:!0,content:p.createElement(lc,(0,a.q5)({key:n.sessionToken.correlationId},n))}),[2,{resultType:Bo.a.Success}]}var s,c,u})})}};return y}},mc=new H.aF({name:"create3PESignRequestAction",factory:{dependencies:fc,create:function(e){return{instance:{evaluateAction:pc(e,zn.a.Adobe)}}}}}),_c=new H.aF({name:"create3PESignRequestAction",factory:{dependencies:fc,create:function(e){return{instance:{evaluateAction:pc(e,zn.a.Docusign)}}}}}),hc=n(333),bc={oneUpStore:ne.b,oneUpStateStore:je.e,pageContext:R.a,platformDetection:$.a,pdfHelper:Yt.b},gc=function(e){return function(t){var n,i,r=t.item,o=e.oneUpStateStore,s=e.oneUpStore,c=e.pageContext,d=e.platformDetection,l=e.pdfHelper,u=uc(o.currentAppState.annotationViewerState),f=null===(i=null===(n=o.currentAppState.viewerStates)||void 0===n?void 0:n.get(r.key))||void 0===i?void 0:i.pdfViewerStates,p={id:"toggleESignAction",isAvailable:sc(s.focusItem,c,u,(null==f?void 0:f.isPdfPasswordProtected)||(null==f?void 0:f.isPdfMip),function(){return!!s.focusItem&&l.isMsPdfViewerAvailable(s.focusItem)},d.isMobile)&&Kn(c),isDisabled:Ns.i&&!(null==f?void 0:f.isOpened),onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){return e=!(null===(t=o.currentAppState.eSignData)||void 0===t?void 0:t.isCreateSidePanelActive),o.updateESignDataState("ToggleESign",{isCreateSidePanelActive:e}),e&&Ns.e&&function(e,t,n){(0,a.yv)(void 0,void 0,void 0,function(){var i,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),i=e.listId?e.listId.replace(/^\{|\}$/g,""):"",[4,new hc.a({pageContext:e,getParentListId:function(){return i},itemProvider:{invalidateItem:function(){}}}).getSharingInformation(t)];case 1:return r=a.sent(),o=null===(s=n.currentAppState.eSignData)||void 0===s?void 0:s.isCreateSidePanelActive,n.updateESignDataState("ToggleESign",{isCreateSidePanelActive:o,canAddExistingExternalUser:r.canAddExistingExternalPrincipal,canAddNewExternalUser:r.canAddExternalPrincipal}),[3,3];case 2:return a.sent(),[3,3];case 3:return[2]}})})}(c,r,o),[2,{resultType:Bo.a.Success}]})})}};return p}},vc={syntexSignActionProvider:new H.aF({name:"createSyntexSignRequestAction",factory:{dependencies:bc,create:function(e){return{instance:{evaluateAction:gc(e)}}}}}),adobeSignActionProvider:mc,docuSignActionProvider:_c,pageContext:R.a},yc=new H.aF({name:"ToggleESignCommand",factory:{dependencies:vc,create:function(e){var t=e.syntexSignActionProvider,n=e.adobeSignActionProvider,a=e.docuSignActionProvider,i=function(e){var t=e.isSyntexESignatureEnabled,n=e.syntexEsignatureThirdPartyEnabledProviders,a=t?["SPeSign"]:[],i=(null==n?void 0:n.filter(function(e){return e===zn.b.Adobe||e===zn.b.Docusign}))||[];return a.concat(i)}(e.pageContext),r=[{id:"GetSyntexSignatures",name:pt.P,title:pt.Q,automationId:"GetSyntexSignatures",groupHeader:pt.E,iconProps:{imageProps:{src:tc}},evaluateAction:t.evaluateAction},{id:"GetAdobeSignatures",name:pt.J,title:pt.K,automationId:"GetAdobeSignatures",groupHeader:pt.E,iconProps:{imageProps:{src:nc}},evaluateAction:n.evaluateAction},{id:"GetDocusignSignatures",name:pt.L,title:pt.M,automationId:"GetDocusignSignatures",groupHeader:pt.E,iconProps:{imageProps:{src:ac}},evaluateAction:a.evaluateAction}],o=window.matchMedia&&window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia&&window.matchMedia("(forced-colors: active)").matches,s=i.length>1,c=function(e){var t;return 1!==e.length?{commandName:pt.N,commandTitle:pt.O}:((t={}).SPeSign={commandName:pt.P,commandTitle:pt.Q},t[zn.b.Adobe]={commandName:pt.J,commandTitle:pt.K},t[zn.b.Docusign]={commandName:pt.L,commandTitle:pt.M},t)[e[0]]}(i),d={id:"GetSignatures",name:c.commandName,title:c.commandTitle,automationId:"GetSignatures",iconProps:{imageProps:{src:o?rc:ic}},evaluateAction:function(){var e;return((e={}).SPeSign=t.evaluateAction,e[zn.b.Adobe]=n.evaluateAction,e[zn.b.Docusign]=a.evaluateAction,e)[i[0]]||t.evaluateAction}(),subCommands:s?r:[],buttonStyles:s?{root:{".ms-Icon":{margin:"0 2px"}},flexContainer:{padding:"0 6px"}}:void 0};return{instance:d}}}}),Sc=new H.aF({name:"UniversalActionExecutor.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(67)]).then(n.bind(n,728)).then(function(e){return e.universalPrintActionExecutorKey})})}),Dc="UniversalPrintAction",Ic={pageContext:R.a,oneUpStore:ne.b,resources:H.XQ,platform:$.a,oneUpStateStore:je.e,getExecutor:Sc.async.lazy,pdfViewerHelper:Yt.b},xc=new H.aF({name:"UniversalPrintAction",factory:{dependencies:Ic,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t,n){var a,i,r,o,s,c,d;if(e&&e.extension&&e.openUrl&&e.itemStatus!==dt.b.ConditionalAccessViewOnly&&e.itemStatus!==dt.b.ConditionalAccessBlocked&&ct.a.hasItemPermission(e,ct.a.openItems)&&!(null===(r=null===(i=null===(a=n.currentAppState.viewerStates)||void 0===a?void 0:a.get(e.key))||void 0===i?void 0:i.pdfViewerStates)||void 0===r?void 0:r.isPdfMip)&&(null===(d=null===(c=null===(s=null===(o=n.currentAppState.viewerStates)||void 0===o?void 0:o.get(e.key))||void 0===s?void 0:s.pdfViewerStates)||void 0===c?void 0:c.isPrintAllowed)||void 0===d||d)){var l=(0,eo.a)(e.extension);if(l&&"ms-word"===l&&n.currentAppState.isUniversalPrintLicenseValid)return!0;if(t.isSupportedFileType(e))return!0}return!1}(e.item,t.pdfViewerHelper,t.oneUpStateStore),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:Dc,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=(e=i).focusItem,r=e.parentItem,o=e.focusItemSet,i&&o&&o.length&&n&&r?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeUniversalPrint({item:n,resources:t.resources,oneUpStateStore:t.oneUpStateStore})];case 2:return a.sent(),[2,{resultType:ge.b.Success}];case 3:throw s=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(Dc,{errorType:ye.d.actionError,error:s,item:n}),s}})})}};return r})}};var t}}}),Cc={actionProvider:(0,Le.wb)({ODB:61495})?xc:ft},Oc="printCommand",wc=new H.aF({name:"PrintCommand",factory:{dependencies:Cc,create:function(e){var t,n=e.actionProvider;return{instance:{id:Oc,name:pt.gb,title:pt.vb,automationId:Oc,iconProps:{iconName:"Print"},evaluateAction:n.evaluateAction,properties:(t={},t["aria-label"]="".concat(pt.vb,", ").concat(pt.qb),t)}}}}}),Ec={pdfViewerHelper:Yt.b,oneUpStateStore:je.e},Ac=new H.aF({name:"ExtractAction",factory:{dependencies:Ec,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r=t.pdfViewerHelper,o=null===(i=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===i?void 0:i.pdfViewerStates;return{isAvailable:r.isPdfExtractAvailable(e.item)&&r.isPdfEditable(e.item)&&!(null==o?void 0:o.isFileEncrypted)&&!(null==o?void 0:o.isSigned)&&!(null==o?void 0:o.isPdfMip),id:"PdfExtract",isDisabled:!(null==o?void 0:o.isOpened)||Ns.i&&t.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return t.oneUpStateStore.state.currentState.annotationViewerState.viewerVisiblity===je.a.On&&t.oneUpStateStore.toggleAnnotationViewerVisiblity(Bs),t.oneUpStateStore.updatePdfState("updatePdfAppMode",tt.a.Extract),t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:"close"}}}),[2]})})}}})};return{instance:n}}}}),Lc=!1,kc=!1,Mc=function(){kc||((0,l.fU)({icons:{PdfEncryptLock:p.createElement("svg",{width:"14",height:"16",viewBox:"0 0 14 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M7 11C7.55229 11 8 10.5523 8 10C8 9.44771 7.55229 9 7 9C6.44771 9 6 9.44771 6 10C6 10.5523 6.44771 11 7 11ZM3 4H4V3C4 1.34315 5.34315 0 7 0C8.65685 0 10 1.34315 10 3V4H11C12.6569 4 14 5.34315 14 7V13C14 14.6569 12.6569 16 11 16H3C1.34315 16 0 14.6569 0 13V7C0 5.34315 1.34315 4 3 4ZM7 1C5.89543 1 5 1.89543 5 3V4H9V3C9 1.89543 8.10457 1 7 1ZM13 7C13 5.89543 12.1046 5 11 5H3C1.89543 5 1 5.89543 1 7V13C1 14.1046 1.89543 15 3 15H11C12.1046 15 13 14.1046 13 13V7Z",fill:"currentColor"})),PdfEncryptUnlock:p.createElement("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M7 12C7.55229 12 8 11.5523 8 11C8 10.4477 7.55229 10 7 10C6.44771 10 6 10.4477 6 11C6 11.5523 6.44771 12 7 12ZM12 1C10.8954 1 10 1.89543 10 3V5H11C12.6569 5 14 6.34315 14 8V14C14 15.6569 12.6569 17 11 17H3C1.34315 17 0 15.6569 0 14V8C0 6.34315 1.34315 5 3 5H9V3C9 1.34315 10.3431 0 12 0C13.6569 0 15 1.34315 15 3V3.5C15 3.77614 14.7761 4 14.5 4C14.2239 4 14 3.77614 14 3.5V3C14 1.89543 13.1046 1 12 1ZM11 6H3C1.89543 6 1 6.89543 1 8V14C1 15.1046 1.89543 16 3 16H11C12.1046 16 13 15.1046 13 14V8C13 6.89543 12.1046 6 11 6Z",fill:"currentColor"}))}}),kc=!0)},Pc={actionProvider:Ac},Tc="pdfExtractCommand",Uc=new H.aF({name:"PdfExtractCommand",factory:{dependencies:Pc,create:function(e){var t=e.actionProvider,n={id:Tc,automationId:Tc,title:pt.mb,name:pt._b,iconProps:{iconName:"PdfExtract"},evaluateAction:t.evaluateAction};return Lc||((0,l.fU)({icons:{PdfExtract:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 17",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M4 0C2.89543 0 2 0.895431 2 2V12C2 13.1046 2.89543 14 4 14H5.20703C5.11588 13.6777 5.05337 13.3434 5.02242 13H4C3.44772 13 3 12.5523 3 12V2C3 1.44772 3.44772 1 4 1H10C10.5523 1 11 1.44772 11 2V7.02242C11.3434 7.05337 11.6777 7.11588 12 7.20703V2C12 0.89543 11.1046 0 10 0H4ZM3.5 15H5.59972C5.78261 15.3578 6.00354 15.6929 6.25717 16H3.5C1.567 16 0 14.433 0 12.5V4.00001C0 3.25973 0.402199 2.61339 1 2.26758V12.5C1 13.8807 2.11929 15 3.5 15ZM10.5 8C12.9853 8 15 10.0147 15 12.5C15 14.9853 12.9853 17 10.5 17C8.01472 17 6 14.9853 6 12.5C6 10.0147 8.01472 8 10.5 8ZM12.8532 12.854L12.8557 12.8514C12.9026 12.804 12.938 12.7495 12.9621 12.6914C12.9861 12.6333 12.9996 12.5697 13 12.503L13 12.5L13 12.497C12.9996 12.4303 12.9861 12.3667 12.9621 12.3086C12.9377 12.2496 12.9015 12.1944 12.8536 12.1464L10.8536 10.1464C10.6583 9.95118 10.3417 9.95118 10.1464 10.1464C9.95118 10.3417 9.95118 10.6583 10.1464 10.8536L11.2929 12H8.5C8.22386 12 8 12.2239 8 12.5C8 12.7761 8.22386 13 8.5 13H11.2929L10.1464 14.1464C9.95118 14.3417 9.95118 14.6583 10.1464 14.8536C10.3417 15.0488 10.6583 15.0488 10.8536 14.8536L12.8532 12.854Z",fill:"currentColor"})),PdfMerge:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 10",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M0 0.5C0 0.223858 0.223858 0 0.5 0H2.1528C3.15253 0 4.10455 0.427517 4.76873 1.17473L6.97867 3.66091C7.45309 4.19463 8.1331 4.5 8.8472 4.5H13.2929L9.64645 0.853554C9.45118 0.658291 9.45118 0.341709 9.64645 0.146447C9.84171 -0.0488154 10.1583 -0.0488154 10.3536 0.146447L14.8536 4.64645C15.0488 4.84171 15.0488 5.15829 14.8536 5.35355L10.3536 9.85355C10.1583 10.0488 9.84171 10.0488 9.64645 9.85355C9.45118 9.65829 9.45118 9.34171 9.64645 9.14645L13.2929 5.5H8.8472C8.1331 5.5 7.45309 5.80537 6.97867 6.33909L4.76873 8.82527C4.10455 9.57248 3.15253 10 2.1528 10H0.5C0.223858 10 0 9.77614 0 9.5C0 9.22386 0.223858 9 0.5 9H2.1528C2.8669 9 3.54691 8.69463 4.02133 8.16091L6.23127 5.67473C6.46908 5.40718 6.7438 5.18062 7.0444 5C6.7438 4.81938 6.46908 4.59282 6.23127 4.32527L4.02133 1.83909C3.54691 1.30537 2.8669 1 2.1528 1H0.5C0.223858 1 0 0.776142 0 0.5Z",fill:"currentColor"}))}}),Lc=!0),{instance:n}}}}),Fc={pdfViewerHelper:Yt.b,oneUpStateStore:je.e},Hc=new H.aF({name:"MergeAction",factory:{dependencies:Fc,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r=t.pdfViewerHelper,o=null===(i=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===i?void 0:i.pdfViewerStates;return{isAvailable:r.isPdfExtractAvailable(e.item)&&r.isPdfEditable(e.item)&&!(null==o?void 0:o.isFileEncrypted)&&!(null==o?void 0:o.isSigned)&&!(null==o?void 0:o.isPdfMip),id:"PdfMerge",isDisabled:!(null==o?void 0:o.isOpened),onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){return t.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:e.item.key,options:{pdfViewerStates:{filePickerMode:"merge"}}}),[2]})})}}})};return{instance:n}}}}),Rc={actionProvider:Hc},Nc="pdfMergeCommand",Bc=new H.aF({name:"PdfMergeCommand",factory:{dependencies:Rc,create:function(e){var t=e.actionProvider;return{instance:{id:Nc,automationId:Nc,title:pt.hb,name:pt.bb,iconProps:{iconName:"PdfMerge"},evaluateAction:t.evaluateAction}}}}}),jc={getExecutor:dr.async.lazy,oneUpStateStore:je.e},Vc=new H.aF({name:"onClickVersionHistoryAction",factory:{dependencies:jc,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n={isAvailable:!0,id:"openVersionHistoryAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(n){switch(n.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==je.d.versionHistory?[3,1]:(t.oneUpStateStore.updateRightPaneState("closeVersionHistory",{type:je.d.none}),[3,3]);case 1:return[4,t.getExecutor()];case 2:return[2,n.sent().executeOpenVersionHistory({item:e.item})];case 3:return[2]}})})}};return n})};return{instance:n}}}}),zc={actionProvider:Vc},Gc="VersionHistoryCommand",Kc=new H.aF({name:"VersionHistoryCommand",factory:{dependencies:zc,create:function(e){var t,n=e.actionProvider;return{instance:{id:Gc,name:pt.Ub,title:pt.Fb,ariaLabel:pt.Ub+", "+pt.Fb,properties:(t={},t["aria-label"]="".concat(pt.Ub,", ").concat(pt.Fb),t),automationId:Gc,iconProps:{iconName:"StackIndicator"},evaluateAction:n.evaluateAction}}}}}),Wc=new H.aF({name:"EmbedDialogExecutor.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(12)]).then(n.bind(n,729)).then(function(e){return e.embedDialogExecutorKey})})}),qc="EmbedAction",Qc={pageContext:R.a,oneUpStore:ne.b,navigation:N.a,resources:H.XQ,platform:$.a,oneUpStateStore:je.e,getExecutor:Wc.async.lazy,getValidViewerTypesFromResource:Se.c},Yc={actionProvider:new H.aF({name:"EmbedAction",factory:{dependencies:Qc,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t){return!(!e||5===e.queryType||13===e.queryType||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||t.getValidViewerTypesFromResource.getValidViewerTypes(e)===Se.a.Copilot)}(e.item,t),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:qc,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var n,r,o,s,c,d;return(0,a.SO)(this,function(a){switch(a.label){case 0:return r=(n=i).focusItem,o=n.parentItem,s=n.focusItemSet,c=n.list,i&&s&&s.length&&r&&o&&c?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeEmbedDialog({item:e.item})];case 2:return a.sent(),[2,{resultType:ge.b.Success}];case 3:throw d=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(qc,{errorType:ye.d.actionError,error:d,item:r}),d}})})}};return r})}};var t}}})},Jc="embedCommand",Xc=new H.aF({name:"EmbedCommand",factory:{dependencies:Yc,create:function(e){var t=e.actionProvider;return{instance:{id:Jc,name:pt.C,title:pt.D,automationId:Jc,iconProps:{iconName:"Embed"},evaluateAction:t.evaluateAction}}}}}),Zc={pageContext:R.a,navigation:N.a},$c={actionProvider:new H.aF({name:"ViewOriginalImageAction",factory:{dependencies:Zc,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e){var t,n=null===(t=e.photo)||void 0===t?void 0:t.originalUrl;return n&&n.replace(/#/g,"%23")}(e.item),i=!!n&&function(e,t){return!t.blockDownloadsExperienceEnabled&&!t.viewOnlyExperienceEnabled&&ct.b.hasItemPermission(e,ct.b.openItems)}(e.item,t.pageContext),r={isAvailable:i,id:"ViewOriginalImageAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return n?[4,t.navigation.navigateTo({url:n,frameId:"_blank"})]:[2,{resultType:ge.b.Failure}];case 1:return e.sent(),[2,{resultType:ge.b.Success}]}})})}};return r})}};var t}}}),oneUpStore:ne.b},ed="viewOriginalImageCommand",td=new H.aF({name:"ViewOriginalImageCommand",factory:{dependencies:$c,create:function(e){var t,n=e.actionProvider;return{instance:{id:ed,name:pt.Hb,title:pt.Hb,automationId:ed,iconProps:{iconName:"Picture"},evaluateAction:n.evaluateAction,properties:(t={},t["aria-label"]="".concat(pt.Hb,", ").concat(pt.qb),t)}}}}}),nd=new H.aF({name:"RequestMoreAccessAction",factory:{dependencies:{},create:function(){return{instance:{evaluateAction:function(){return{isAvailable:!0,id:"RequestMoreAccessAction",onExecute:function(){}}}}}}}}),ad=new H.aF({name:"ShowRequestMoreAccessDialog.key",loader:new H.xT(function(){return n.e(58).then(n.bind(n,730)).then(function(e){return e.showRequestMoreAccessDialogKey})})}),id=function(e){switch(e){case Pi.a.review:case Pi.a.restrictedview:case Pi.a.view:return!0;default:return!1}},rd=function(e){var t=e.oneUpStore,n=e.oneUpStateStore,i=e.pageContext,r=e.resources,o=e.getExecutor;return function(){var e,s=ji(null===(e=t.focusItem)||void 0===e?void 0:e.permissions),c={isAvailable:!i.isAnonymousGuestUser&&id(s),id:"EditRequestAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(e=t.getOneUpProperties())&&s?[4,o()]:[3,3];case 1:return[4,a.sent().showRequestMoreAccessDialog({item:e.focusItem,pageContext:i,itemRole:s,requestRole:Pi.a.edit,resources:r,onClose:function(){n.updateModalState("editRequestCommand",{showModal:!1,content:void 0})},onRender:function(e){n.updateModalState("editRequestCommand",{showModal:!0,content:e})}})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}};return c}},od={oneUpStore:ne.b,oneUpStateStore:je.e,pageContext:R.a,resources:H.XQ,getExecutor:ad.async.lazy},sd=new H.aF({name:"EditRequestAction",factory:{dependencies:od,create:function(e){return{instance:{evaluateAction:rd(e)}}}}}),cd={actionProvider:sd},dd="editRequestMoreAccessCommand",ld=new H.aF({name:"EditRequestMoreAccessCommand",factory:{dependencies:cd,create:function(e){var t=e.actionProvider;return{instance:{id:dd,name:pt.yb,automationId:dd,iconProps:{iconName:"Lock"},evaluateAction:t.evaluateAction}}}}}),ud={actionProvider:nd,editRequestMoreAccessCommand:ld,oneUpStore:ne.b},fd="requestMoreAccessCommand",pd=new H.aF({name:"RequestMoreAccessCommand",factory:{dependencies:ud,create:function(e){var t,n=e.oneUpStore,a=e.actionProvider,i=e.editRequestMoreAccessCommand,r=function(e){switch(e){case Pi.a.none:return{label:pt.W,icon:""};case Pi.a.review:return{label:pt.Sb,icon:"Feedback"};case Pi.a.view:case Pi.a.restrictedview:return{label:pt.Rb,icon:"View"};default:return{label:pt.W,icon:""}}}(ji(null===(t=n.focusItem)||void 0===t?void 0:t.permissions)),o=r.label,s={iconName:r.icon};return{instance:{id:fd,automationId:fd,buttonStyles:(0,ds.a)(),iconProps:s,subCommands:[i],evaluateAction:a.evaluateAction,evaluateCommandName:function(){return o}}}}}}),md=n(594),_d={oneUpStateStore:je.e,resources:H.XQ,oneUpStore:ne.b,pageContext:R.a},hd=new H.aF({name:"FeedbackAction",factory:{dependencies:_d,create:function(e){var t,i={evaluateAction:(t=e,function(e){var i=t.resources,r=t.pageContext,o={isAvailable:t.oneUpStateStore.currentAppState.isFeedbackEnabled||!1,id:"Feedback",isDisabled:!1,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return r?[3,1]:(o=(0,ye.i)("FeedbackAction: missing pagecontext"),t.oneUpStateStore.updateErrorState("feedbackAction.onExecute",{errorType:ye.d.actionError,error:o,item:e.item}),[2,{resultType:ge.b.Failure}]);case 1:return[4,Promise.all([n.e("ondemand.resx"),n.e(39)]).then(n.bind(n,654))];case 2:a.sent().showOneUpFeedback(e.item,i,r).then(function(){return{resultType:ge.b.Success}}).catch(function(n){return t.oneUpStateStore.updateErrorState("feedbackAction.showOneUpFeedback",{errorType:ye.d.actionError,error:n,item:e.item}),n instanceof H.qt&&n.isExpected?{resultType:ge.b.ExpectedFailure}:{resultType:ge.b.Failure}}),a.label=3;case 3:return[2]}})})}};return o})};return{instance:i}}}}),bd=!1,gd=function(){bd||((0,l.fU)({icons:{QuestionCircleRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10 13.5C10.4142 13.5 10.75 13.8358 10.75 14.25C10.75 14.6642 10.4142 15 10 15C9.58579 15 9.25 14.6642 9.25 14.25C9.25 13.8358 9.58579 13.5 10 13.5ZM10 5.5C11.3807 5.5 12.5 6.61929 12.5 8C12.5 8.72959 12.1848 9.40774 11.6513 9.8771L11.4967 10.0024L11.2782 10.1655L11.1906 10.2372C11.1348 10.2851 11.0835 10.3337 11.0346 10.3859C10.6963 10.7464 10.5 11.2422 10.5 12C10.5 12.2761 10.2761 12.5 10 12.5C9.72386 12.5 9.5 12.2761 9.5 12C9.5 10.988 9.79312 10.2475 10.3054 9.70162C10.4165 9.5832 10.532 9.47988 10.6609 9.37874L10.9076 9.19439L11.0256 9.09468C11.325 8.81435 11.5 8.42206 11.5 8C11.5 7.17157 10.8284 6.5 10 6.5C9.17157 6.5 8.5 7.17157 8.5 8C8.5 8.27614 8.27614 8.5 8 8.5C7.72386 8.5 7.5 8.27614 7.5 8C7.5 6.61929 8.61929 5.5 10 5.5Z",fill:"#F3F2F1"}))),PersonFeedbackRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M10.5 12C11.3284 12 12 12.6716 12 13.5V14C12 15.9714 10.1405 18 7 18C3.85951 18 2 15.9714 2 14V13.5C2 12.6716 2.67157 12 3.5 12H10.5ZM10.5 13H3.5C3.22386 13 3 13.2239 3 13.5V14C3 15.4376 4.43216 17 7 17C9.56784 17 11 15.4376 11 14V13.5C11 13.2239 10.7761 13 10.5 13ZM7 5.5C8.51878 5.5 9.75 6.73122 9.75 8.25C9.75 9.76878 8.51878 11 7 11C5.48122 11 4.25 9.76878 4.25 8.25C4.25 6.73122 5.48122 5.5 7 5.5ZM16 2C17.0544 2 17.9182 2.81588 17.9945 3.85074L18 4V6C18 7.05436 17.1841 7.91817 16.1493 7.99451L16 8H14.499L13.301 9.59979C12.7716 10.306 11.6965 10.0199 11.5243 9.22426L11.5066 9.11264L11.5008 9L11.5 7.935L11.4224 7.91532C10.697 7.69685 10.1452 7.07753 10.0246 6.3148L10.0055 6.14926L10 6V4C10 2.94564 10.8159 2.08183 11.8507 2.00549L12 2H16ZM7 6.5C6.0335 6.5 5.25 7.2835 5.25 8.25C5.25 9.2165 6.0335 10 7 10C7.9665 10 8.75 9.2165 8.75 8.25C8.75 7.2835 7.9665 6.5 7 6.5ZM16 3H12C11.4872 3 11.0645 3.38604 11.0067 3.88338L11 4V6C11 6.51284 11.386 6.93551 11.8834 6.99327L12 7H12.5008V9L14 7H16C16.5128 7 16.9355 6.61396 16.9933 6.11662L17 6V4C17 3.48716 16.614 3.06449 16.1166 3.00673L16 3Z",fill:"#F3F2F1"}))),LearningAppRegular:p.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},p.createElement("g",{id:"Fluent-icon"},p.createElement("path",{id:"Shape",d:"M6 3H14C14.5523 3 15 3.44772 15 4V9.02242C15.3434 9.05337 15.6777 9.11588 16 9.20703V4C16 2.89543 15.1046 2 14 2H6C4.89543 2 4 2.89543 4 4V16C4 17.1046 4.89543 18 6 18H10.2572C10.0035 17.6929 9.78261 17.3578 9.59971 17H6C5.44772 17 5 16.5523 5 16H9.20703C9.11588 15.6777 9.05337 15.3434 9.02242 15H5V4C5 3.44772 5.44772 3 6 3ZM7 4C6.44772 4 6 4.44772 6 5V6C6 6.55228 6.44772 7 7 7H13C13.5523 7 14 6.55228 14 6V5C14 4.44772 13.5523 4 13 4H7ZM13 5V6H7V5H13ZM19 14.5C19 16.9853 16.9853 19 14.5 19C12.0147 19 10 16.9853 10 14.5C10 12.0147 12.0147 10 14.5 10C16.9853 10 19 12.0147 19 14.5ZM14.0203 12.534C13.9423 12.4811 13.8559 12.4546 13.7609 12.4546C13.6948 12.4546 13.6321 12.4687 13.5728 12.4969C13.5134 12.5234 13.4617 12.5596 13.4177 12.6054C13.3736 12.6513 13.338 12.7051 13.3108 12.7668C13.2854 12.8286 13.2727 12.8938 13.2727 12.9626V16.0374C13.2727 16.1045 13.2854 16.1689 13.3108 16.2306C13.338 16.2924 13.3736 16.347 13.4177 16.3947C13.4634 16.4405 13.516 16.4776 13.5753 16.5058C13.6346 16.5323 13.6965 16.5455 13.7609 16.5455C13.8101 16.5455 13.8559 16.5384 13.8983 16.5243C13.9423 16.5102 13.9856 16.489 14.028 16.4608L16.3242 14.8943C16.3937 14.8485 16.448 14.7867 16.4869 14.7091C16.5259 14.6315 16.5454 14.5503 16.5454 14.4656C16.5454 14.3774 16.5251 14.2963 16.4844 14.2222C16.4437 14.1463 16.3878 14.0855 16.3166 14.0396L14.0203 12.534Z",fill:"#F3F2F1"})))}}),bd=!0)},vd={actionProvider:hd},yd="feedbackCommand",Sd=new H.aF({name:"FeedbackCommand",factory:{dependencies:vd,create:function(e){var t=e.actionProvider;return gd(),{instance:{id:yd,automationId:yd,title:pt.H,name:pt.H,iconProps:{iconName:"PersonFeedbackRegular"},evaluateAction:t.evaluateAction}}}}}),Dd={oneUpStateStore:je.e},Id={actionProvider:new H.aF({name:"TutorialFreAction",factory:{dependencies:Dd,create:function(e){var t;return{instance:{evaluateAction:(t=e,function(e){var n=t.oneUpStateStore.currentAppState.isOneUpFreOpen;return{isAvailable:!0,id:"TutorialFre",isDisabled:n,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){return n||t.oneUpStateStore.updateOneUpShellFreIsOpen("tutorialFreAction",!0),[2]})})}}})}}}}})},xd="tutorialFreCommand",Cd=new H.aF({name:"TutorialFreCommand",factory:{dependencies:Id,create:function(e){var t=e.actionProvider;return gd(),{instance:{id:xd,automationId:xd,title:pt.Pb,name:pt.Pb,iconProps:{iconName:"LearningAppRegular"},evaluateAction:t.evaluateAction}}}}}),Od={feedbackCommand:Sd,tutorialFreCommand:Cd},wd="helpCommandGroup",Ed=function(e){return{isAvailable:!0}},Ad=new H.aF({name:"HelpGroupCommand",factory:{dependencies:Od,create:function(e){var t=e.feedbackCommand,n=e.tutorialFreCommand;return gd(),{instance:{id:wd,name:pt.R,title:pt.R,automationId:wd,subCommands:[t,n],evaluateAction:Ed,iconProps:{iconName:"QuestionCircleRegular"}}}}}}),Ld=n(595),kd=!1,Md=function(e){var t=e.oneUpStore,n=e.oneUpStateStore,i=e.pageContext,r=e.resources,o=e.getExecutor;return function(){var e,s,c=ji(null===(e=t.focusItem)||void 0===e?void 0:e.permissions),d={isAvailable:!i.isAnonymousGuestUser&&(s=c,s===Pi.a.restrictedview),id:"DownloadRequestAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(e=t.getOneUpProperties())&&c?[4,o()]:[3,3];case 1:return[4,a.sent().showRequestMoreAccessDialog({item:e.focusItem,pageContext:i,itemRole:c,requestRole:Pi.a.view,resources:r,onClose:function(){n.updateModalState("downloadRequestCommand",{showModal:!1,content:void 0})},onRender:function(e){n.updateModalState("downloadRequestCommand",{showModal:!0,content:e})}})];case 2:a.sent(),a.label=3;case 3:return[2]}})})}};return d}},Pd={oneUpStore:ne.b,oneUpStateStore:je.e,pageContext:R.a,resources:H.XQ,getExecutor:ad.async.lazy},Td={actionProvider:new H.aF({name:"DownloadRequestAction",factory:{dependencies:Pd,create:function(e){return{instance:{evaluateAction:Md(e)}}}}})},Ud="downloadRequestMoreAccessCommand",Fd=function(e){var t=e.onClick,n=e.dismissMenu,a=(0,l.kF)(),i=p.useCallback(function(){t(),n(void 0,!0)},[]),r=p.useCallback(function(){n(void 0,!0)},[]);return p.createElement("div",{id:"RequestDownload-container",style:{display:"flex",flexDirection:"row",padding:"8px",backgroundColor:"#292827"}},p.createElement(li.a,{iconName:"InfoSolid",styles:{root:{paddingRight:"8px",paddingTop:"8px",color:"white"}}}),p.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:"20px",paddingTop:"5px"}},p.createElement("div",{id:"RequestDownload-title",style:{fontWeight:600,color:"white"}},pt.y),p.createElement("div",null,p.createElement(ea.a,{id:"RequestDownload-button",styles:{root:{padding:"7px 0px",height:"auto",color:"#2899F5"},rootHovered:{textDecoration:"underline"},label:{margin:"0"}},onClick:i,ariaLabel:"".concat(pt.y," ").concat(pt.yb)},pt.yb))),p.createElement(ea.d,{id:"RequestDownload-cancel",onClick:r,iconProps:{iconName:"Cancel"},styles:{root:{color:a.palette.white}},ariaLabel:pt.h}))},Hd=new H.aF({name:"DownloadRequestCommand",factory:{dependencies:Td,create:function(e){var t=e.actionProvider;return{instance:{id:Ud,name:pt.w,automationId:Ud,iconProps:{iconName:"Feedback"},contextualMenuStyles:{title:{},root:{backgroundColor:"#292827"},list:{padding:"0"},header:{},container:{},subComponentStyles:{menuItem:{},callout:{calloutMain:{backgroundColor:"#292827"}}}},evaluateAction:t.evaluateAction,evaluateRenderMenuList:function(e){return function(t,n){return p.createElement(Fd,{onClick:e,item:t,dismissMenu:n})}}}}}}}),Rd={blockDownloadActionProvider:new H.aF({name:"BlockDownloadAction",factory:{dependencies:{},create:function(){return{instance:{evaluateAction:function(){return{isAvailable:!0,id:"BlockDownloadAction",onExecute:function(){}}}}}}}}),downloadRequestMoreAccessCommand:Hd},Nd="blockDownloadCommand",Bd=new H.aF({name:"BlockDownloadCommand",factory:{dependencies:Rd,create:function(e){var t=e.blockDownloadActionProvider,n=e.downloadRequestMoreAccessCommand,a={id:Nd,name:pt.f,title:pt.g,automationId:Nd,subCommands:[n],buttonStyles:{menuIcon:{display:"none"}},iconProps:{iconName:"BlockDownload"},evaluateAction:t.evaluateAction};return kd||((0,l.fU)({icons:{BlockDownload:p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),kd=!0),{instance:a}}}}),jd="EditInAppAction",Vd={oneUpStore:ne.b,platform:$.a,oneUpStateStore:je.e,itemUrlHelper:Q.c,getValidViewerTypesFromResource:Se.c,resources:H.XQ,getExecutor:as.async.lazy},zd={actionProvider:new H.aF({name:"EditInAppAction",factory:{dependencies:Vd,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=function(e,t,n){if(!(t.isWindows||t.isMac||(0,In.c)()&&(t.isWinPhone||t.isAndroid||t.isIOS))||!e)return!1;if(n===Se.a.Copilot)return!1;var a=!!ct.a.hasItemPermission(e,ct.a.openItems);return(n===Se.a.MSPdf||n===Se.a.Pdf||n===Se.a.Photo)&&a&&!e.appMap&&ct.a.hasItemPermission(e,ct.a.insertListItems)&&ct.a.hasItemPermission(e,ct.a.editListItems)}(e.item,t.platform,t.getValidViewerTypesFromResource.getValidViewerTypes(e.item)),i=t.oneUpStore.getOneUpProperties(),r={isAvailable:n,id:jd,onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,n,r,o,s;return(0,a.SO)(this,function(a){switch(a.label){case 0:return n=(e=i).focusItem,r=e.parentItem,o=e.focusItemSet,i&&o&&o.length&&n&&r?[4,t.getExecutor()]:[3,3];case 1:return[4,a.sent().executeOpenInApp({item:n,pageContexts:i.pageContexts,resources:t.resources})];case 2:return a.sent(),[2,{resultType:ge.b.Success}];case 3:throw s=(0,ye.i)("no parent view/item"),t.oneUpStateStore.updateErrorState(jd,{errorType:ye.d.actionError,error:s,item:n}),s}})})}};return r})}};var t}}}),oneUpStore:ne.b},Gd="EditInAppCommand",Kd=new H.aF({name:"EditInAppCommand",factory:{dependencies:zd,create:function(e){return{instance:{id:Gd,name:pt._,title:pt._,automationId:Gd,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:e.actionProvider.evaluateAction}}}}}),Wd=new H.aF({name:"isImageEditableInOneUp.key",factory:new H.KS(function(){return!0})}),qd={oneUpStateStore:je.e,getValidViewerTypesFromResource:Se.c,pdfViewerHelper:Yt.b,isImageEditable:Wd},Qd=new H.aF({name:"EditAction",factory:{dependencies:qd,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r,o,s,c=(0,t.getValidViewerTypesFromResource.getValidViewerTypes)(e.item),d=c===Se.a.Photo&&ct.a.hasItemPermission(e.item,ct.a.editListItems)&&t.isImageEditable(),l=t.oneUpStateStore.currentAppState,u=(null===(n=l.eSignData)||void 0===n?void 0:n.isCreateSidePanelActive)||(null===(i=l.annotationViewerState)||void 0===i?void 0:i.isActive);if(c===Se.a.MSPdf){var f=null===(o=null===(r=l.viewerStates)||void 0===r?void 0:r.get(e.item.key))||void 0===o?void 0:o.pdfViewerStates;d=t.pdfViewerHelper.isPdfEditAvailable(e.item)&&t.pdfViewerHelper.isPdfEditable(e.item)&&!(null==f?void 0:f.isPdfMip)&&!u&&!!(null==f?void 0:f.isOpened)&&(null===(s=null==f?void 0:f.isAnnotAllowed)||void 0===s||s)}return{isAvailable:d,id:"EditAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){return t.oneUpStateStore.currentAppState.rightPane.type!==je.d.none&&t.oneUpStateStore.updateRightPaneState("closeRightPane",{type:je.d.none,content:void 0}),c===Se.a.MSPdf?t.oneUpStateStore.updatePdfState("updatePdfAppMode",tt.a.Edit):t.oneUpStateStore.updateImageState("openImageEditor",je.c.edit),[2]})})}}})};return{instance:n}}}}),Yd={editInClipchampCommand:es,editInAppCommand:Kd,actionProvider:Qd},Jd="editSplitCommand",Xd=H.x9.isActivated("cf60fb7c-d5d8-4232-9286-0ee6464b542a","07/11/2024","Refine style of the edit split button when no subcommands are available"),Zd={splitButtonMenuButton:{width:"24px !important"},label:{textOverflow:"ellipsis",overflow:"hidden"},flexContainer:{padding:"0px 8px !important"}},$d=new H.aF({name:"EditSplitCommand",factory:{dependencies:Yd,create:function(e){var t,n=e.editInClipchampCommand,i=e.editInAppCommand,r=e.actionProvider,o=[n,i];return{instance:(0,a.q5)((0,a.q5)({id:Jd,name:pt.z,automationId:Jd,subCommands:o,evaluateAction:r.evaluateAction,isSplit:!0,splitButtonAriaLabel:pt.B,title:pt.z},Xd?{buttonStyles:Zd}:{evaluateButtonStyles:function(e){return o.some(function(t){return t.evaluateAction({item:e}).isAvailable})?Zd:(0,ds.a)()}}),{iconProps:{iconName:"Edit"},properties:(t={},t["aria-roledescription"]=pt.Lb,t)})}}}}),el=new H.aF({name:"SyntexTranslateExecutor.key",loader:new H.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(62)]).then(n.bind(n,734)).then(function(e){return e.translateActionExecutorKey})})}),tl=H.x9.isActivated("48b367b1-f71c-4fcc-bf00-9ebcbe2665ff","04/11/2024","Settings check for syntex translation in ODB My files"),nl=H.x9.isActivated("0b19576b-e1ee-476a-9abd-e85702207850","09/19/2024","Enabling translation command in Syntex Content Center Libraries"),al={oneUpStateStore:je.e,getExecutor:el.async.lazy,oneUpStore:ne.b,pageContext:R.a},il=new Set([".csv",".doc",".docx",".htm",".html",".markdown",".md",".msg",".odp",".ods",".pdf",".ppt",".pptx",".rtf",".txt",".xls",".xlsx"]),rl=function(e){return function(t){var n,i=e.pageContext,r=e.oneUpStore.getOneUpProperties(),o=null==r?void 0:r.focusItem,s=null!==(n=null==o?void 0:o.extension)&&void 0!==n?n:"",c=!1,d=(null==i?void 0:i.listBaseTemplate)===Wo.a.contentCenterPrimeLibrary||(null==i?void 0:i.listBaseTemplate)===Wo.a.contentCenterSampleLibrary;tl?c=(0,Le.wb)(Le.P)&&!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isSyntexTranslationEnabled)&&((null==i?void 0:i.listBaseTemplate)===Wo.a.documentLibrary||(null==i?void 0:i.listBaseTemplate)===Wo.a.mySiteDocumentLibrary||!nl&&d)&&il.has(s):(null==i?void 0:i.listBaseTemplate)===Wo.a.mySiteDocumentLibrary?c=!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isODBSyntexTranslationEnabled)&&(0,Le.wb)(Le.P)&&il.has(s):((null==i?void 0:i.listBaseTemplate)===Wo.a.documentLibrary||!nl&&d)&&(c=!!(null==i?void 0:i.isSyntexPAYGEnabled)&&!!(null==i?void 0:i.isSyntexTranslationEnabled)&&(0,Le.wb)(Le.P)&&il.has(s));var l=null==i?void 0:i.listPermsMask,u=!!l&&ct.b.hasPermission(l,ct.b.manageLists),f={isAvailable:c&&u,id:"syntexTranslateAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n;return(0,a.SO)(this,function(a){switch(a.label){case 0:if(!o)return[3,5];t={item:o,pageContext:i,onRender:function(t){e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!0,content:t})},onClose:function(){e.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!1,content:void 0})}},a.label=1;case 1:return a.trys.push([1,4,,5]),[4,e.getExecutor()];case 2:return[4,a.sent().showTranslationDialog(t)];case 3:return a.sent(),[2,{resultType:Bo.a.Success}];case 4:return n=a.sent(),[2,{resultType:Bo.a.Failure,exception:n}];case 5:return[2]}})})}};return f}},ol={actionProvider:new H.aF({name:"SyntexTranslateAction",factory:{dependencies:al,create:function(e){return{instance:{evaluateAction:rl(e)}}}}})},sl="syntexTranslateCommand",cl=new H.aF({name:"SyntexTranslateCommand",factory:{dependencies:ol,create:function(e){var t=e.actionProvider;return{instance:{id:sl,name:pt.kb,title:pt.Mb,automationId:sl,iconProps:{iconName:"MicrosoftTranslatorLogo"},evaluateAction:t.evaluateAction}}}}}),dl=n(51);function ll(){return!H.x9.isActivated("38e570f6-99f2-4061-8d53-4bbfa2e7c692","09/03/2024","RMA dialog KS")&&(!!(0,Le.jb)()||!!dc&&1===dc.variantToDisplay)}var ul=!H.x9.isActivated("e4f01914-f051-4eb2-8366-597bdb8113f3"),fl=n(607),pl={openAboutThisCopilotPaneActionAsync:cr.async,oneUpStateStore:je.e},ml=new H.aF({name:"OnClickAboutThisCopilotButtonAction",factory:{dependencies:pl,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n=e.item,i=n.extension||"",r={isAvailable:(0,fl.a)(i),id:"onClickAboutThisCopilotButtonAction",onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==je.d.copilotDetailPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("onClickAboutThisCopilotButton",{type:je.d.none}),[3,5]);case 1:return[4,t.openAboutThisCopilotPaneActionAsync()];case 2:return e=a.sent(),(i=e.evaluateAction({item:n})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:new ge.a({name:"openAboutThisCopilotPane"})})]:[3,4];case 3:return a.sent(),[3,5];case 4:throw new Error("openAboutThisCopilotPaneAction is not available");case 5:return[2]}})})}};return r})};return{instance:n}}}}),_l={actionProvider:ml},hl="AboutThisCopilotPaneCommand",bl=new H.aF({name:"AboutThisCopilotPaneCommand",factory:{dependencies:_l,create:function(e){var t,n=e.actionProvider;return{instance:{id:hl,name:pt.a,title:pt.b,ariaLabel:pt.a+", "+pt.b,properties:(t={},t["aria-label"]="".concat(pt.a,", ").concat(pt.b),t),automationId:hl,evaluateAction:n.evaluateAction}}}}}),gl=n(331),vl={openInfoPaneCommand:vs,openAboutThisCopilotPaneCommand:bl},yl="infoPaneCommandGroup",Sl=function(e){return{isAvailable:!0}},Dl=new H.aF({name:"InfoGroupCommand",factory:{dependencies:vl,create:function(e){var t,n,a,i,r,o=e.openInfoPaneCommand,s=e.openAboutThisCopilotPaneCommand;return{instance:{id:yl,name:pt.U,title:pt.V,ariaLabel:pt.U+", "+pt.V,properties:(t={},t["aria-label"]="".concat(pt.U,", ").concat(pt.V),t),automationId:yl,iconProps:{iconName:"Info"},evaluateAction:Sl,isFlatten:!0,subCommands:[s,o],buttonStyles:(n=qn.b,a=n.palette,i=n.semanticColors,r={background:"".concat(i.buttonBackground," !important"),padding:"0px",margin:"4px 2px",color:a.black,height:"32px",width:"auto",border:"none",".ms-Button-menuIcon":{marginTop:"2px",color:a.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important",alignItems:"center",justifyContent:"center",padding:"0px 4px"}},(0,gl.a)(r))}}}}}),Il={pdfViewerHelper:Yt.b,oneUpStateStore:je.e},xl=new H.aF({name:"EncryptAction",factory:{dependencies:Il,create:function(e){var t,n={evaluateAction:(t=e,function(e){var n,i,r=t.pdfViewerHelper,o=null===(i=null===(n=t.oneUpStateStore.currentAppState.viewerStates)||void 0===n?void 0:n.get(e.item.key))||void 0===i?void 0:i.pdfViewerStates;return{isAvailable:r.isPdfEncryptAvailable(e.item)&&r.isPdfEditable(e.item)&&!(null==o?void 0:o.isFileEncrypted)&&!(null==o?void 0:o.isSigned)&&!(null==o?void 0:o.isPdfMip),id:"Pdf",isDisabled:!(null==o?void 0:o.isOpened),onExecute:function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){return t.oneUpStateStore.updatePdfEncryptDialogVisibleState("updatepdfEncryptDialogVisibleState",!0),[2]})})}}})};return{instance:n}}}}),Cl={actionProvider:xl},Ol="pdfEncryptCommand",wl=new H.aF({name:"PdfEncryptCommand",factory:{dependencies:Cl,create:function(e){var t=e.actionProvider,n={id:Ol,automationId:Ol,title:pt.fb,name:pt.pb,iconProps:{iconName:"PdfEncryptLock"},evaluateAction:t.evaluateAction};return Mc(),{instance:n}}}}),El=!H.x9.isActivated("e716b6d4-f575-4940-bc25-37eee28d93a","04/15/2024","Display translate command in 1-up viewer"),Al=(0,a.q5)((0,a.q5)({oneUpStore:ne.b,oneUpStateStore:je.e,pageContext:R.a,dividerCommand:br,openInfoPaneCommand:vs},hs.a?{infoPaneGroupCommand:Dl}:{}),{closeCommand:Mr,downloadCommand:Et,favoriteCommand:$r,blockDownloadCommand:Bd,openGroupCommand:ps,editSplitCommand:$d,saveCommand:ys.saveCommandKey,copyToCommand:ks,deleteCommand:Rs,annotateCommand:qs,commentsCommand:ec,toggleESignCommand:yc,printCommand:wc,pdfExtractCommand:Uc,pdfMergeCommand:Bc,pdfEncryptCommand:wl,openVersionHistoryCommand:Kc,embedCommand:Xc,viewOriginalImageCommand:td,openCopilotPaneCommand:Ii.a,requestMoreAccessCommand:pd,presenceCommand:md.a,shareGroupCommand:Ld.a,translateCommand:cl,helpCommandGroup:Ad}),Ll=new H.aF({name:"GenerateOneUpCommandBarWorkingSet",factory:{dependencies:Al,create:function(e){var t=e.oneUpStateStore,n=e.pageContext,a=e.dividerCommand,i=e.openInfoPaneCommand,r=e.infoPaneGroupCommand,o=e.closeCommand,s=e.downloadCommand,c=e.favoriteCommand,d=e.blockDownloadCommand,l=e.openGroupCommand,u=e.editSplitCommand,f=e.saveCommand,p=e.copyToCommand,m=e.deleteCommand,_=e.annotateCommand,h=e.commentsCommand,b=e.printCommand,g=e.toggleESignCommand,v=e.pdfExtractCommand,y=e.pdfMergeCommand,S=e.pdfEncryptCommand,D=e.openVersionHistoryCommand,I=e.embedCommand,x=e.viewOriginalImageCommand,C=e.openCopilotPaneCommand,O=e.requestMoreAccessCommand,w=e.presenceCommand,E=e.shareGroupCommand,A=e.translateCommand,L=e.helpCommandGroup;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){var e=[];return e.push(f,s),(0,Le.wb)(Le.ib)&&e.push(c),ll()&&e.push(d),e.push(m,a,_,g,v,y,S),hs.a&&r?e.push(r):e.push(i),e},generateOverflowWorkingSet:function(){var e=[];return El&&e.push(A),e.push(p,b,x,I,D),(0,Le.wb)(Le.cb)&&e.push(L),e},generateFarWorkingSet:function(){var e=[],a=n.hidePeoplePreviewingFiles;return(!ul||!a&&!t.state.currentState.siteHidePeoplePreviewingFiles)&&(0,Le.wb)(Le.l)&&e.push(w),(0,Le.wb)(Le.C)&&e.push(h),e.push(C),ll()&&e.push(O),e.push(l(),u,E,o),e}}}}}}),kl={generateOneUpCommandBarWorkingSet:Ll},Ml=new H.aF({name:"FileHandlerCommandsWorkingSetOverrideFunc",factory:{dependencies:kl,create:function(e){return{instance:{read:function(){return function(){return e.generateOneUpCommandBarWorkingSet.generateWorkingSets()}}}}}}}),Pl={oneUpStore:ne.b,generateOneUpCommandBarWorkingSet:Ll,fileHandlerCommandWorkingSetOverrideFunc:Ml},Tl=new H.aF({name:"OneUpCommandBarManager",factory:{dependencies:Pl,create:function(e){var t=e.generateOneUpCommandBarWorkingSet.generateWorkingSets(),n=e.oneUpStore.focusItem?new Ir({item:e.oneUpStore.focusItem,showCommands:!0,workingSet:t}):void 0;return(0,Le.db)()&&(null==n||n.addWorkingSetOverride(e.fileHandlerCommandWorkingSetOverrideFunc)),{instance:n,disposable:n}}}}),Ul=n(608);(0,l.ZW)([{rawString:".OneUpNonInteractiveCommandWrapper_156f96ef{justify-content:center;align-items:center;line-height:40px;font-size:16px;display:flex;flex-wrap:nowrap}.OneUpNonInteractiveCommandSpan_156f96ef{display:contents;justify-content:center;align-items:center}.OneUpNonInteractiveCommand_156f96ef{cursor:default;color:"},{theme:"black",defaultValue:"#000"},{rawString:";vertical-align:top;line-height:40px}.OneUpNonInteractiveCommandNewDesign_156f96ef{cursor:default;color:#fff;vertical-align:top;line-height:40px}.OneUpNonInteractiveIconNewDesign_156f96ef{margin:0 4px;color:#fff}.OneUpNonInteractiveTitleIcon_156f96ef{margin:0 6px}"}]);const Fl="OneUpNonInteractiveCommandWrapper_156f96ef";var Hl=function(e){var t=e.icon,n=(0,da.a)();return Mc(),m().createElement(ta.a,{content:pt.ub},m().createElement(li.a,{className:"OneUpNonInteractiveTitleIcon_156f96ef",style:{color:n.semanticColors.messageText},iconName:"lock"===t?"PdfEncryptLock":"PdfEncryptUnlock"}))},Rl=function(){return function(e){var t;return m().createElement("div",{className:Fl,role:"menuitem",id:e.id,"aria-label":e.ariaLabel,tabIndex:-1,"aria-disabled":!0},(null===(t=e.iconProps)||void 0===t?void 0:t.iconName)?m().createElement("span",{className:"OneUpNonInteractiveCommandSpan_156f96ef"},m().createElement(li.a,{className:"OneUpNonInteractiveIconNewDesign_156f96ef",iconName:e.iconProps.iconName})):m().createElement(m().Fragment,null))}},Nl=n(77),Bl=n(209),jl=H.x9.isActivated("675a5397-4561-4df2-a9d8-cb730d9c9b88"),Vl=H.x9.isActivated("f40289e8-e08d-43e8-b00b-47201fb0c49e"),zl=!H.x9.isActivated("3ABC5518-5FF8-4C10-BE93-F6A2D40DB92B");function Gl(e,t,i,r){var o=this;void 0===t&&(t="none");var s=e.displayName,c=!1;if(s)if(jl)s.length>23&&(s=null==s?void 0:s.replace(/(.{21}).+(\..+)/,"$1...$2"),c=!0);else{var d=Array.from(s);if(d&&d.length>23){var u=Math.floor(11.5),f=d.slice(0,u).join(""),_=d.slice(d.length-u).join("");s="".concat(f,"...").concat(_),c=!0}}if(!Vl&&(0,Le.wb)({ODB:62312})){var h=(0,bt.a)(function(){return(0,a.yv)(o,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(43)]).then(n.bind(n,722))];case 1:return[2,e.sent().OneUpRename]}})})});return{key:"title",id:"titleCommand",title:c?e.displayName:void 0,iconProps:{iconName:e.iconName},onRender:function(){return p.createElement("div",{style:{paddingBottom:"0px",marginInline:"60px"}}," ",p.createElement(h,{item:e,engagementContext:i,activeViewer:r}))},data:{automationid:"titleCommand"}}}return{key:"title",id:"titleCommand",text:s,title:c?e.displayName:void 0,iconProps:{iconName:e.iconName},icon:t,commandBarButtonAs:function(e){var t,n=m().createElement(Ul.a,{className:(0,l.zf)("OneUpNonInteractiveCommandNewDesign_156f96ef","OneUpCommandBarTitle")},e.text),a="OneUpNonInteractiveTitleIcon_156f96ef";return m().createElement("div",{className:(0,l.zf)(Fl,"OneUpCommandBarTitleWrapper"),style:"none"!==e.icon?{transform:"translateX(13px)"}:void 0,role:"menuitem"},m().useMemo(function(){var t;return(null===(t=e.iconProps)||void 0===t?void 0:t.iconName)?m().createElement(pa,{iconName:e.iconProps.iconName,desiredSize:17,iconSize:32,fileExtention:"svg",className:a,iconFieldAriaLabel:pt.Zb}):m().createElement(m().Fragment,null)},[a,null===(t=e.iconProps)||void 0===t?void 0:t.iconName]),e.title?m().createElement(ta.a,{content:e.title},n):n,"none"!==e.icon&&m().createElement(Hl,{icon:e.icon}))},data:{automationid:"titleCommand"}}}function Kl(e){var t=e.command,n=e.onClickQos,a=e.onClickCustomerPromise,i=e.computeVeto;if(t.action.onExecute){var r=t.action.onExecute({qosEvent:n});r&&r.then(function(e){var t=e||{resultType:ge.b.Success};n.end(t),null==a||a.end(t)}).catch(function(e){var r=new H.qt({code:"OneUpCommandException",innerError:e,extraData:{commandId:t.id}}),o=(0,ve.a)(r);n.end(o),a&&Yl(r,a,o,i)})}else{var o=new H.qt({code:"NoAvailableAction",extraData:{commandId:t.id}});n.end((0,ve.a)(o)),null==a||a.end((0,ve.a)(o))}}function Wl(e,t,n,i){var r=e.action.customerPromise||{},o=r.startSchema,s=r.computeVeto,c="OneUpLightSpeed.commandInvoked.".concat(e.id),d=new ge.a({name:c,extraData:(0,a.q5)({extention:t.extension,viewer:t.viewer},n)}),l=new we((0,a.q5)((0,a.q5)({scenario:c,perfGoalInMs:ye.b},o||{}),{extraData:(0,a.q5)((0,a.q5)({extention:t.extension,viewer:t.viewer},(null==o?void 0:o.extraData)||{}),n)}));t.commandName=(null==e?void 0:e.id)||(null==e?void 0:e.name)||(null==e?void 0:e.title)||"UnknownCmdBar",(0,hi.g)("".concat(hi.c,".").concat(hi.a),t);var u={command:e,onClickQos:d,onClickCustomerPromise:l,computeVeto:s,fallbackErrorMsg:"Unhandled exception executing an action"};try{"CloseAction"===e.action.id&&e.action.isAvailable&&i?i().then(function(){Kl(u)}).catch(function(){}):Kl(u)}catch(e){var f=new H.qt({code:"commandExecutionError",innerError:e}),p=(0,ve.a)(f);d.end(p),l&&Yl(f,l,p,s)}}function ql(e,t,n,i){var r,o,s,c,d,l=[];if(e&&e.length>0)for(var u=function(u){var f,p,m=!!i||!e[u].name,_=!!(e[u].isSplit&&e[u].subCommands&&(null===(r=e[u].subCommands)||void 0===r?void 0:r.length))||void 0,h=(0,a.q5)((f={key:e[u].id,id:e[u].id,iconOnly:m,iconProps:e[u].iconProps,text:e[u].name,title:m?void 0:e[u].title,disabled:e[u].action.isDisabled,onRender:e[u].onRender,onClick:function(){var a;return Wl(e[u],t,null===(a=e[u])||void 0===a?void 0:a.extraData,n)},buttonStyles:e[u].buttonStyles,split:_,splitButtonAriaLabel:e[u].splitButtonAriaLabel},f["data-automation-id"]=e[u].automationId||e[u].action.id,f.ariaLabel=(null===(o=e[u].properties)||void 0===o?void 0:o["aria-label"])||e[u].title||e[u].name,f.data=((p={automationid:e[u].automationId||e[u].action.id})["aria-label"]=(null===(s=e[u].properties)||void 0===s?void 0:s["aria-label"])||e[u].title||e[u].name,p),f.tooltipHostProps={content:e[u].title||e[u].name},f),null===(c=e[u])||void 0===c?void 0:c.properties);h.iconProps=(0,a.q5)((0,a.q5)({},h.iconProps),{style:(0,a.q5)((0,a.q5)({},null===(d=h.iconProps)||void 0===d?void 0:d.style),{color:"inherit"})});var b=e[u].subCommands;if(b&&b.length>0){var g=function(e,t){for(var n,a,i,r=[],o={},s=function(s){var c,d=(c={key:e[s].id,iconProps:e[s].iconProps,text:e[s].name,title:e[s].title,disabled:e[s].action.isDisabled,onRender:e[s].onRender,onClick:function(){var n;return Wl(e[s],t,null===(n=e[s])||void 0===n?void 0:n.extraData)}},c["data-automation-id"]=e[s].automationId||e[s].action.id,c.ariaLabel=(null===(n=e[s].properties)||void 0===n?void 0:n["aria-label"])||e[s].title||e[s].name,c),l=e[s].evaluateRenderMenuList;l&&(d.onRender=l(function(){var n;return Wl(e[s],t,null===(n=e[s])||void 0===n?void 0:n.extraData)})),a=e[s].contextualMenuStyles,(i=e[s].groupHeader)&&!o[i]&&(r.push({key:i,itemType:2,text:i}),o[i]=!0),r.push(d)},c=0;c<e.length;c++)s(c);return{items:r,styles:a,ariaLabel:i}}(b,t);if(zl&&e[u].isFlatten&&1===b.length){var v=g.items[0];h.onClick=v.onClick}else h.subMenuProps=g}l.push(h)},f=0;f<e.length;f++)u(f);return l}function Ql(e,t,n,a){e.calcDisplaySet(t.focusItem,t.parentItem);var i=e.displaySet,r=[],o=[];return i&&i.main&&i.main.length>0&&(r=ql(i.main,n,void 0,!0)),i&&i.overflow&&i.overflow.length>0&&(o=ql(i.overflow,n)),i&&i.far&&i.far.length>0?{main:r,overflow:o,far:ql(i.far,n,a)}:{main:r,overflow:o,far:[]}}function Yl(e,t,n,a){var i=(0,Bl.a)(e,{computeVeto:a,qosEndSchema:n});t.end(i)}var Jl=function(e){return p.createElement(ta.a,{content:pt.Y},p.createElement(ea.b,(0,a.q5)({},e)))};function Xl(e){var t,i=this,r=(0,V.c)(),o=r.consume(ne.b),s=p.useContext(hi.d),c=p.useRef(r.consume(Se.c)).current.getValidViewerTypes,d=p.useState(o.getOneUpProperties()),l=d[0],u=d[1],f=p.useState(!0),m=f[0],_=f[1],h=p.useState(!0),b=h[0],g=h[1],v=p.useRef(void 0),y=p.useCallback(function(){if(l){var t=(0,a.q5)({extension:l.focusItem.extension||"",viewer:c(l.focusItem)},s),n=v.current?Ql(v.current,l,t,e.onCloseCallback):void 0;if(n)return n}return{main:[],overflow:[],far:[]}},[l,v]),S=p.useCallback(function(){return y()},[y]),D=p.useCallback(function(){return y().main},[y]),I=p.useCallback(function(){return y().overflow},[y]),x=D(),C=p.useState(x),O=C[0],w=C[1],E=I(),A=p.useState(E),L=A[0],k=A[1],M=p.useState(function(){if(l){var t=(0,a.q5)({extension:l.focusItem.extension||"Unknown",viewer:c(l.focusItem)},s),n=v.current?Ql(v.current,l,t,e.onCloseCallback):void 0;if(n)return n.far}return[]}),P=M[0],T=M[1],U=p.useCallback(function(){return function(e){var t=e.map(function(e){return e.key}).indexOf("mainDividerCommand");if(t>-1){var n=e[t];n=(0,a.q5)((0,a.q5)({},n),{iconOnly:!0,disabled:!0,ariaLabel:pt.v,commandBarButtonAs:Rl(),onRender:function(e){return function(e,t){if(e.renderedInOverflow||t<1)return p.createElement(p.Fragment,null);var n=ea.b,i=(0,Nl.a)(Rl(),n);return p.createElement(i,(0,a.q5)({},e))}(e,t)}}),e[t]=n}}(O),[O,P]},[O,P]),F=(0,be.a)(function(e,t){if(e&&t){var n=t.get(e);if(n){_(void 0===n.showMainCommands||n.showMainCommands),g(void 0===n.showTitle||n.showTitle);var a=S();w(a.main),k(a.overflow),T(a.far)}else _(!0),g(!0)}else _(!0),g(!0)}),H=(0,je.f)("currentState",function(e){return e.viewerStates})[0];p.useEffect(function(){F(null==l?void 0:l.focusItem.key,H)},[H,l,F]);var R=(0,je.f)("currentState",function(e){return e.eSignData})[0],N=(0,je.f)("currentState",function(e){return e.annotationViewerState})[0];p.useEffect(function(){var e=y();w(e.main),k(e.overflow),T(e.far)},[R,N,y]);var B=(0,je.f)("currentState",function(e){return e.isFocusItemFavorited})[0],j=(0,je.f)("currentState",function(e){return e.isFeedbackEnabled})[0];p.useEffect(function(){if(null==l?void 0:l.focusItem){if((0,Le.wb)(Le.ib)){var e=y();w(e.main)}(0,Le.wb)(Le.cb)&&(e=y(),k(e.overflow))}},[B,j]);var z=(0,je.f)("currentState",function(e){return e.isUniversalPrintLicenseValid})[0];p.useEffect(function(){if((null==l?void 0:l.focusItem)&&(0,Le.wb)({ODB:61495})){var e=y();w(e.main)}},[z]);var G=(0,je.f)("currentState",function(e){return e.renamedKeyInFastOneUp===(null==l?void 0:l.focusItem.key)})[0];p.useEffect(function(){if((null==l?void 0:l.focusItem)&&(0,Le.wb)(Le.x)){var e=y();w(e.main)}},[G]);var K=(0,je.f)("currentState",function(e){return e.fileHandlerOptions})[0];p.useEffect(function(){if(K){(0,Le.db)()&&v.current&&v.current.updateWorkingSetOverride({publisher:"fileHandlerData"});var e=y();T(e.far)}},[K,y,r]),p.useEffect(function(){return function(){(0,Le.wb)(Le.cb)&&(0,a.yv)(i,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(39)]).then(n.bind(n,654))];case 1:return[4,e.sent().dispose()];case 2:return e.sent(),[2]}})}).then(function(){}).catch(function(){})}},[]);var W=null===(t=null==H?void 0:H.get((null==l?void 0:l.focusItem.key)||""))||void 0===t?void 0:t.pdfViewerStates,q=p.useMemo(function(){if(l&&b){var e=(0,Le.wb)(Le.H)&&(null==W?void 0:W.isPdfPasswordProtected)?(null==W?void 0:W.isOpened)?"unlock":"lock":"none";return[Gl(l.focusItem,e,s,c(l.focusItem))]}return[]},[null==l?void 0:l.focusItem,W]);(0,qi.b)({updateOneUpStatus:function(t){if("update"in t.detail&&t.detail.update&&"publisher"in t.detail){var n=t.detail.update;v.current||(v.current=r.consume(Tl));var i=(0,a.q5)({extension:n.focusItem.extension||"Unknown",viewer:c(n.focusItem)},s),o=v.current?Ql(v.current,n,i,e.onCloseCallback):void 0;if(u(n),null==o?void 0:o.main){var d=o.main;w(d),(null==o?void 0:o.overflow)&&k(o.overflow)}(null==o?void 0:o.far)&&T(o.far)}}},ne.a.oneUpItemCacheUpdate);var Q=U(),Y={id:"oneupCommandBarOverflow","data-automationid":"overflowButton",menuProps:{items:[],id:"oneupCommandBarOverflowMenu",isBeakVisible:!1},"aria-label":pt.Y};return p.createElement(mr,{id:"OneUpCommandBar",items:m&&Q?Q[0]:[],overflowItems:m?L:[],middleItems:q,farItems:Q?Q[1]:[],overflowButtonProps:Y,overflowButtonAs:Jl,styles:{root:{overflowY:"hidden"}}})}(0,l.ZW)([{rawString:".reatOneUpToast_dbebf17a{position:absolute;bottom:12px;left:50%;transform:translate(-50%,0)}"}]);var Zl=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(45).then(n.bind(n,651))];case 1:return[2,e.sent().ToastComponent]}})})}),$l=function(e){var t,n,a=e.toastData;return a?p.createElement("div",{className:"reatOneUpToast_dbebf17a","data-automation-id":"ReactOneUpToastContainer"},(t=[],n=0,a.forEach(function(e,a){t.push(p.createElement(Zl,{index:n++,visible:e.visible,actionStatus:e.actionStatus,displayText:e.displayText,toastKey:e.toastKey,actionButtons:e.actionButtons}))}),t)):p.createElement(p.Fragment,null)},eu=n(335),tu=!H.x9.isActivated("058098C5-2E70-4392-980F-D2B0F0E85353"),nu=p.lazy(function(){return n.e(54).then(n.bind(n,715))}),au=p.lazy(function(){return Promise.all([n.e("ondemand.resx"),n.e(21)]).then(n.bind(n,716))});function iu(){var e=(0,je.f)("currentState",function(e){return e.modal})[0];return e&&(null==e?void 0:e.showModal)?p.createElement("div",{id:"OneUpModalContainer"},e.content):p.createElement(p.Fragment,null)}function ru(){var e=this,t=(0,je.f)("currentState",function(e){return e.imageMode!==je.c.edit&&e.pdfAppMode!==tt.a.Edit&&e.pdfAppMode!==tt.a.Esign&&e.pdfAppMode!==tt.a.Extract})[0],i=(0,je.f)("currentState",function(e){return e.toast})[0],r=(0,je.f)("currentState",function(e){return e.errorState})[0];!function(){var e=(0,V.c)(),t=(0,qi.a)(),n=window.location.search.substring(1),a=(0,H.Ho)(n),i="true"===a.openShare,r="true"===a.openRMA;m().useEffect(function(){var n,a,o;if(i&&t){var s=t.focusItem;n=(c=e.consume(eu.d).evaluateAction({item:s})).isAvailable,a=c.onExecute,o=new Error("no available action for ".concat(eu.d.name))}else if(ll()&&r&&t){var c;n=(c=e.consume(sd).evaluateAction()).isAvailable,a=c.onExecute,o=new Error("no available action for ".concat(sd.name))}if(t&&(i||ll()&&r)){var d=new ge.a({name:"OneUpLightSpeed.autoActionExecutorInvoked"}),l="Unhandled exception executing an auto action";try{if(n&&a){var u=a({qosEvent:d});u&&u.then(function(e){var t=e||{resultType:ge.b.Success};d.end(t)}).catch(function(e){var t=e||new Error(l);d.end((0,ve.a)(t))})}else d.end((0,ve.a)(o))}catch(e){var f=e||new Error(l);d.end((0,ve.a)(f))}}},[t])}();var o=(0,hi.h)(),s=window.matchMedia("(prefers-reduced-motion: reduce)"),c=!s||s.matches?0:300,d=Te.k,u=Te.l,f=p.useState(""),_=f[0],h=f[1],b=p.useState(!0),g=b[0],v=b[1],y=p.useState(!1),S=y[0],D=y[1],I=(0,qi.a)(),x=(0,V.c)(),C=x.consume(N.a),O=x.consume(Ar),w=x.consume(ka.a),E=x.consume(Mr),A=p.useRef(null),L=p.useRef(!1),k=!1;(0,Le.Db)()&&De.f&&(k=x.consume(De.f.optional)||!1);var M=p.useCallback(function(e){return!e&&Pa({navigation:C,saveAction:w,focusItem:null==I?void 0:I.focusItem})?Promise.resolve():(h(u),new Promise(function(e){setTimeout(e,c)}))},[C,w,I]),P=(0,be.a)(function(e){var t;if(I.focusItem&&"Escape"===e.key&&"Escape"===e.key&&(null==I?void 0:I.parentItem)){var n=new ge.a({name:"OneUpLightSpeed.commandInvoked.".concat(E.id)});if(tu){var a=O.evaluateAction({item:I.focusItem});M().then(function(){var e;null===(e=a.onExecute({qosEvent:n}))||void 0===e||e.then(function(e){var t=e||{resultType:ge.b.Success};n.end(t)}).catch(function(e){var t=e;n.end((0,ve.a)(t))})}).catch(function(){})}else null===(t=O.evaluateAction({item:I.focusItem}).onExecute({qosEvent:n}))||void 0===t||t.then(function(e){var t=e||{resultType:ge.b.Success};n.end(t)}).catch(function(e){var t=e;n.end((0,ve.a)(t))})}}),T=(0,be.a)(function(t,n){return(0,a.yv)(e,void 0,void 0,function(){var e,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:return sr?[4,x.consumeAsync(sr)]:[3,3];case 1:return e=a.sent(),(i=e.evaluateAction({item:t})).isAvailable&&i.onExecute?[4,i.onExecute({qosEvent:n})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})});return p.useEffect(function(){if((0,Le.Db)()&&k&&A&&A.current&&I&&I.focusItem&&!S){var e=new ge.a({name:"OneUpLightSpeed.commandInvoked.".concat(vs.id)});T(I.focusItem,e).then(function(t){var n=t||{resultType:ge.b.Success};e.end(n),D(!0)}).catch(function(t){var n=t;e.end((0,ve.a)(n))})}},[I,A,A.current,T,k]),p.useEffect(function(){var e;A&&A.current&&I&&(null===(e=A.current)||void 0===e||e.focus(),A.current.addEventListener("keydown",P))},[A,A.current,P]),p.useEffect(function(){setTimeout(function(){return h(d)},10)},[]),p.useEffect(function(){var t;if((0,Le.wb)(Le.cb)&&(null==I?void 0:I.focusItem)&&!L.current){var i=x.consume(ne.b),r=x.consume(R.a),o=x.consume(je.e),s=i.getOneUpProperties(),c=new Kr.b({context:r}),d=(0,H.Ho)(null==I?void 0:I.focusItem.key),l=d.id,u=d.listurl,f=c.getUrlParts({listUrl:u,path:l}),p={webAbsoluteUrl:f.fullWebUrl,listUrl:f.serverRelativeListUrl},m=null===(t=null==s?void 0:s.pageContexts)||void 0===t?void 0:t.get(p);(0,a.yv)(e,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,Promise.all([n.e("ondemand.resx"),n.e(39)]).then(n.bind(n,654))];case 1:return e=a.sent(),(t=e.getInitializationStatus()).isInitialized&&void 0!==t.isAvailable?[2,t.isAvailable]:[3,2];case 2:return[4,e.initOneUpFeedback(null==I?void 0:I.focusItem,x,m||r)];case 3:return[2,a.sent().isAvailable]}})}).then(function(e){o.setIsFeedbackEnabled("feedbackAction",e),L.current=!0}).catch(function(){o.setIsFeedbackEnabled("feedbackAction",!1),L.current=!0})}},[I]),p.useEffect(function(){_===u&&setTimeout(function(){return v(!1)},c)},[_]),p.useEffect(function(){r&&r.errorType===ye.d.rldsApiError&&v(!1)},[r]),p.createElement(p.Fragment,null,g&&p.createElement("div",(0,a.q5)({id:"oneUpRoot"},(0,Le.Ub)()&&{"data-suppresskeyboardbinding":"true"},{className:(0,l.zf)(Te.B,_),ref:A}),p.createElement(hi.d.Provider,{value:o},t&&p.createElement(Xl,{onCloseCallback:M}),p.createElement("div",{className:(0,l.zf)(t?Te.E:Te.D,Te.C)},p.createElement(ir,{closeCallback:M}),p.createElement(fr,null),i&&p.createElement($l,{toastData:i})),p.createElement(iu,null),(0,Le.wb)(Le.cc)&&p.createElement("div",null,p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(nu,null))),((0,Le.wb)(Le.sc)||(0,Le.wb)(Le.cb))&&p.createElement("div",null,p.createElement(p.Suspense,{fallback:p.createElement(p.Fragment,null)},p.createElement(au,null))))))}var ou={isFastOneUp:De.e.optional,pageContext:R.a},su=new H.aF({name:"OneUpBootCustomerPromiseFunctionsKey",factory:{dependencies:ou,create:function(e){var t,n=void 0,i=e.pageContext,r=(null===(t=(0,Ie.b)(i))||void 0===t?void 0:t.toLowerCase())||"unknown";return{instance:{newBootCustomerPromise:function(t){void 0===n&&(n=new we({scenario:"OneUpLightSpeed.Boot",perfGoalInMs:ye.a,pillar:"View",extraData:(0,a.q5)({oneUpRenderingMode:e.isFastOneUp?ye.e.fastOneUp:ye.e.inlineOneUpFirstPage,Ring:r,correlationId:null==i?void 0:i.CorrelationId},t)}))},reportBootCXPSuccess:function(e){null==n||n.end({resultType:ge.b.Success,extraData:(0,a.q5)({},e)}),n=void 0},reportBootCXPFailure:function(e){var t=e.rawError,i=t.errorType,r=t.error,o=(0,ve.a)(r),s=function(e){return e&&"string"==typeof e?e.split(",").join("_"):JSON.stringify(e)}(o.resultCode||"Unknown"),c=o.resultType;null==n||n.end({resultType:c,errorCode:s,extraData:(0,a.q5)({errorType:i,rawError:r},o.extraData)}),n=void 0}}}}}});function cu(){var e,t=(0,V.c)(),n=(0,je.f)("currentState",function(e){return e.errorState})[0],a=p.useState(!1),i=a[0],r=a[1],o=(0,qi.a)(),s=(0,hi.h)();(0,p.useEffect)(function(){var e=t.consume(su);(null==o?void 0:o.focusItem)&&(e.reportBootCXPSuccess({engagementContext:s}),t.consume(Pe).newLoadingCustomerPromise(o.focusItem,s))},[null==o?void 0:o.focusItem.key,t]),(0,p.useEffect)(function(){var e=t.consume(su),a=t.consume(Pe);(null==n?void 0:n.errorType)===ye.d.viewerInitLoadingError&&a.reportLoadingCXPFailure({rawError:n}),(null==n?void 0:n.errorType)===ye.d.rldsApiError&&(e.reportBootCXPFailure({rawError:n}),r(!0)),(null==n?void 0:n.errorType)===ye.d.rldsApiErrorNoAccess&&r(!0),(null==n?void 0:n.errorType)===ye.d.processOneUpItemError&&e.reportBootCXPFailure({rawError:n})},[n,t]);var c=null===(e=null==n?void 0:n.error)||void 0===e?void 0:e.message;return c||(c=(null==n?void 0:n.errorType)===ye.d.rldsApiErrorNoAccess?Wi.f:Wi.e),i&&n?p.createElement("div",null,p.createElement(vi,{errorTitle:c})):p.createElement(p.Fragment,null)}var du=n(613),lu=n(616);function uu(){(0,j.f)("OneUpLightSpeed");var e,t,n,i=(0,V.c)(),r=i.consume($.a),o=i.consume(R.a),s=r.isSafari&&r.isMobile,c=(0,be.a)(function(e,t){var n={errorType:ye.d.reactRenderError,error:e.name?e:new Error("ReactRenderError"),extraData:{info:t.toString(),error:e.toString()}};i.consume(Pe).reportLoadingCXPFailure({rawError:n})}),d=qn.b;H.x9.isActivated("662e8b03-bcd7-47a7-9520-1f9801974b7b")||(t={aadUserId:(e=o).aadUserId,experimentData:e.experimentData,experimentDataLookup:e.experimentDataLookup,serverTime:e.serverTime,siteId:e.siteId},null==(dc=(0,dl.b)(90304,t))||dc.logExposure()),n=H.x9.isActivated("28a7c449-3563-4201-b8a9-60840b5f6222")?s?"100%":"100vh":"100dvh";var l=!H.x9.isActivated("3cf1a381-4d99-4581-870e-fca14d0a3884"),u={height:l?"".concat(n," !important"):n,width:l?"100vw !important":"100vw",maxWidth:l?"unset !important":"unset",maxHeight:l?"unset !important":"unset",minHeight:l?"unset !important":"unset",borderRadius:l?"0px !important":"0px"},f=!H.x9.isActivated("d231628a-6f44-4d6f-a8a0-6e4c58723989");u=(0,a.q5)((0,a.q5)((0,a.q5)({},u),{background:d.semanticColors.bodyBackground}),f?{overflow:"hidden"}:{});var m="";!H.x9.isActivated("f91e6032-6933-42ff-b732-5f0af7c73f1c")&&(m="OneUpModalSizing ".concat(s?"OneUpSafariMobile":""));var _=(0,a.q5)((0,a.q5)({},d),{components:du.a});return p.createElement(lu.a,{theme:_},p.createElement(he.a,{componentName:"OneUpLightSpeed",onError:c},p.createElement(_e.a,{className:"".concat(Te.s," ").concat(m),allowTouchBodyScroll:!0,isOpen:!0,focusTrapZoneProps:{firstFocusableTarget:"#".concat(ar)},layerProps:{eventBubblingEnabled:!0},styles:{main:u,layer:{zIndex:1e3}}},p.createElement(cu,null),p.createElement(ru,null),p.createElement("div",{id:"oneupFeedbackHostNode"}))))}for(var fu=n(196),pu=n(640),mu=n(641),_u=H.x9.isActivated("3C8E1B8A-96C9-4AC3-ACAA-0A79AA85F566"),hu={ITEMSVIEWDEMO:"ItemsViewDemo",LISTALLITEMS:"ListAllItems",LISTSHOME:"ListsHome","ODB WEB":"ODB Web",ONEDRIVELTI:"OneDriveLti",SPARTANLIST:"SpartanList","SPLIST WEB":"SPList Web",TEAMS:"Teams",TEAMSLIST:"Teams.List",TEAMSFILE:"Teams.File",TEAMSPAGE:"Teams.Page",YAMMER:"Yammer"},bu={LISTS:"Lists"},gu=0,vu=["Word","Excel","PowerPoint","OneNote","Visio"];gu<vu.length;gu++){var yu=vu[gu],Su="WACHost.".concat(yu);hu[Su.toUpperCase()]=Su;for(var Du=0,Iu=["Teams"];Du<Iu.length;Du++){var xu="".concat(Iu[Du],".UnifiedUiHost.").concat(yu);hu[xu.toUpperCase()]=xu}}var Cu=n(197),Ou=n(172),wu=n(642),Eu=n(122);function Au(e){var t=(0,fu.a)(),n=t.manifest,a=t.version,i=e.pageContext,r=e.clientName,o=e.ashaProduct,s=Number(i.webTemplate)===jn.a.mySite;return{Product:o||(s?"Files":"Lists"),Manifest:n,Version:a,ClientName:r}}(0,Ce.a)();var Lu,ku=void 0,Mu=n(643),Pu=n(644),Tu=n(359),Uu=n(645),Fu=(0,bt.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(55).then(n.bind(n,661))];case 1:return[2,e.sent().OnePlayerHost2]}})})}),Hu=new H.aF({name:"".concat("fluent2Theme.key",".Fluent2Theme"),factory:new H.KS({})}),Ru=n(646),Nu=new H.aF({name:"".concat("oneDriveFluent2Theme.key",".Fluent2Theme"),factory:{dependencies:{},create:function(){return{instance:(0,Ru.a)({semanticColors:{bodyBackground:Ru.b.neutralLighterAlt}})}}}}),Bu=new H.aF({name:"DeferredSetupTasks.key",loader:new H.xT(function(){return n.e(9).then(n.bind(n,735)).then(function(e){return e.resourceKey})})}),ju=n(647),Vu=n(648),zu=(0,H._y)("FileHandlerResourceKeys",Vu.a,{pageContext:R.a}),Gu={fileHandlerService:(0,H._y)("FileHandlerResourceKeys",ju.a,{dataRequestor:kt.a,localFileHandlerProvider:zu}),oneUpStateStore:je.e,pageContext:R.a,itemUrlHelper:Q.c},Ku=new H.aF({name:"OneUpFileHandlerProvider",factory:{dependencies:Gu,create:function(e){return{instance:{getFileHandlerDataThruAPI:function(){return(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,e.fileHandlerService.getFileHandlerData({includePromotedApp:!0})];case 1:return[2,t.sent()]}})})},getFileHandlerDataThruLocalStorage:function(){if("localStorage"in window){var e=this.getFileHandlerCacheKey();if(localStorage.getItem(e))return JSON.parse(localStorage.getItem(e)||"")}},isCacheDataValid:function(e){return Date.now()-e.lastModified<864e5},getFileHandlerEndpoint:function(){return new Qe.a(e.pageContext.webAbsoluteUrl).authority+"/_api/v2.0"},getFileHandlerCacheKey:function(){return"".concat("fileHandlerCache_").concat(JSON.stringify({endpoint:this.getFileHandlerEndpoint(),driveId:""}))},setDataToLocalStorage:function(e){if("localStorage"in window)try{var t=this.getFileHandlerCacheKey();localStorage.setItem(t,JSON.stringify(e))}catch(e){}},getFileHandlerData:function(){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStateStore.getFileHandlerOptions())&&this.isCacheDataValid(t)?[2]:[3,1];case 1:return(n=this.getFileHandlerDataThruLocalStorage())&&this.isCacheDataValid(n)?(e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n),[3,4]):[3,2];case 2:return[4,this.getFileHandlerDataThruAPI()];case 3:(i=a.sent())&&(r={data:i,lastModified:Date.now(),signature:{driveId:"",endpoint:this.getFileHandlerEndpoint(),includePromotedApp:!0}},this.setDataToLocalStorage(r),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",r)),a.label=4;case 4:return[2]}})})}}}}}}),Wu={oneUpFileHandlerProvider:Ku,oneUpStateStore:je.e},qu=new H.aF({name:"GetFileHandlerData",factory:{dependencies:Wu,create:function(e){return{instance:{getFileHandlerDataForOneUp:function(){return(0,a.yv)(this,void 0,void 0,function(){var t,n,i,r;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(t=e.oneUpStateStore.getFileHandlerOptions())&&e.oneUpFileHandlerProvider.isCacheDataValid(t)?[2]:[3,1];case 1:return(n=e.oneUpFileHandlerProvider.getFileHandlerDataThruLocalStorage())&&e.oneUpFileHandlerProvider.isCacheDataValid(n)?(e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",n),[3,4]):[3,2];case 2:return[4,e.oneUpFileHandlerProvider.getFileHandlerDataThruAPI()];case 3:(i=a.sent())&&(r={data:i,lastModified:Date.now(),signature:{driveId:"",endpoint:e.oneUpFileHandlerProvider.getFileHandlerEndpoint(),includePromotedApp:!0}},e.oneUpFileHandlerProvider.setDataToLocalStorage(r),e.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",r)),a.label=4;case 4:return[2]}})})}}}}}}),Qu={urlDataSource:K.a},Yu=new H.aF({name:"isImageEditableInOneUp",factory:{dependencies:Qu,create:function(e){return{instance:function(){return e.urlDataSource.getQueryType()!==Vr.a.AllMyPhotos}}}}}),Ju=new H.aF({name:"onRenderOnePlayerHost",loader:new H.xT(function(){return n.e(55).then(n.bind(n,737)).then(function(e){return e.onRenderOnePlayerHostKey})})}),Xu=n(394),Zu=new H.aF({name:"getOneUpOnePlayerResources",loader:new H.xT(function(){return n.e(55).then(n.bind(n,738)).then(function(e){return e.getOneUpOnePlayerResourcesKey})})}),$u=n(186),ef={pageContext:R.a,navigation:N.a},tf=new H.aF({name:"AshaHelper",factory:{dependencies:ef,create:function(e){return{instance:{getASHAProductName:function(){var t=e.navigation.viewParams;return(0,$u.a)(t)===Vr.a.AllMyPhotos?"Photos":Number(e.pageContext.webTemplate)===jn.b.mySite?"Files":"SPO DocLib"}}}}}}),nf=n(395),af={ODB:-61546},rf=n(415),of=void 0,sf=n(455),cf=n(120),df=n(351),lf=new H.aF({name:"PushNotifierAsync.key",loader:new H.xT(function(){return n.e(16).then(n.bind(n,739)).then(function(e){return e.pushNotifierKey})})});(0,_.a)(),performance.mark("EUPL.AppStart");var uf=new H.xR({owner:"ODBOneUpLightSpeed",useFactoriesOnKeys:!0}),ff=window._spPageContextInfo,pf=sf.a?function(e){if(!of){!function(){var e=window.g_oneUpPathAndQueryString;if(e){var t=new URL(e);t.searchParams&&t.searchParams.get("ga")&&window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",e)}}();var t=function(e){var t;return!!(null===(t=null==e?void 0:e.serverRequestPath)||void 0===t?void 0:t.toLowerCase().includes("onedrive.aspx"))}(e)&&function(e){var t=e.platformDetection,n=e.spPageContext;return!(!((0,Ur.a)(nf.b)&&n&&n.isMySiteOwner)||(0,Pr.a)(n)||t.isPWA||((0,Ur.a)(nf.a)?(location.pathname.toLowerCase().includes("onedrive.aspx")&&history.replaceState(null,"","/".concat(location.search).concat(location.hash)),0):((0,Ur.a)(af)&&"/"===location.pathname&&history.replaceState(null,"","".concat(n.webServerRelativeUrl,"/_layouts/15/onedrive.aspx").concat(location.search).concat(location.hash)),1)))}({platformDetection:new H.rC,spPageContext:e}),n=t?rf.a:void 0;a=(of=new B.a({prettyPathMap:n})).viewParams,Lu||(Lu=a),of.updateViewParams({},{ignoreHistory:!0})}var a;return of}(ff):new B.b,mf=uf.consume(Qt),_f=mf.getOneUpRumoneLogger({});uf.expose(R.a,window._spPageContextInfo),uf.expose(N.a,pf);var hf,bf=uf.consume(su);bf.newBootCustomerPromise({clientName:Sf(),view:(hf=pf.viewParams[qe.b.queryTypeParamKey],hf?"view=".concat(hf):""),hidePeoplePreviewingFiles:ff.hidePeoplePreviewingFiles}),_f.initRumoneLogger(),(0,Le.Mb)()&&(0,dl.b)(90198,ff);var gf,vf=function(e){uf.consumeAsync(Bu).then(function(e){e.setupDeferredComponents(uf)});var t,n=pf.viewParams.ga,i=!!window.g_oneUpPathAndQueryString,r=(0,a.q5)({viewerName:e.viewer,isShareLinkRedeeming:void 0!==n,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFluentV9:(0,df.a)()},e.extraData);t=(0,Le.ub)()?ke(r):r;var o=(0,a.q5)((0,a.q5)((0,a.q5)({oneupScenario:1,endTime:Date.now(),pageTransType:Nt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:Sf(),viewerStartTime:Kt(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:i},t),{diagnosticInfo:t}),e.extraPerfData);j.f("EUPL.glass"),_f.logRumonePerformance(o,function(e){uf.consume(je.e).updatePerfButtonState("FastOneUp-OnSlideLoaded",e)}),uf.consume(Pe).reportLoadingCXPSuccess({extraData:(0,a.q5)((0,a.q5)({},t),{diagnosticInfo:t})})},yf=function(e){var t=mf.getOneUpRumoneLogger({loggerName:"fullPage"}),n=!!window.g_oneUpPathAndQueryString;t.initRumoneLogger(),t.logRumonePerformance((0,a.q5)({oneupScenario:1,endTime:Date.now(),pageTransType:Nt.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:Sf(),viewerStartTime:Kt(e.viewer),breakDownData:e.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:n,viewerName:e.viewer,extension:e.extension||"unknown",fileSizeRange:e.fileSizeRange,isCrossList:e.isCrossList,isFullPageLogging:!0,isFluentV9:(0,df.a)()},e.extraPerfData))};!function(e){if(e.spPageContext){var t=(0,a.q5)((0,a.q5)({},function(e){var t,n=e.viewParams,i=e.onGetContext,r=n.app,o=n.scenario;if(r){var s=hu[r.toUpperCase()]||!H.x9.isActivated("B750D979-8389-4419-9DFE-79EAE5360404","05/03/2022","Allow all host-provided app values")&&r||"Unknown";t=(0,a.q5)((0,a.q5)({},n),{app:s})}if(!_u&&o){var c=bu[o.toUpperCase()]||o||"Unknown";t=(0,a.q5)((0,a.q5)({},t||n),{scenario:c})}var d=t?(0,a.q5)((0,a.q5)({},e),{viewParams:t}):e,l=(0,mu.a)(d);return i?i({context:l,viewParams:d.viewParams}):l}({viewParams:e.viewParams,clientName:e.clientName})),e.context||{});e.initDefaultHandler&&(0,fu.b)((0,pu.a)({sourceName:"oneup-lightspeed",tokens:Ou.a,initOneDS:!0,pageContext:e.spPageContext,context:t})),ku&&"dispose"in ku&&(null==ku||ku.dispose());var i=function(e){var t,i=(0,fu.a)().ariaEnvironment,r=e.pageContext,o=e.initOneDS,s=e.tokens,c=e.resultTypeWhenUnload,d=void 0===c?ge.b.ExpectedFailure:c,l=Number(r.webTemplate)===jn.a.mySite;t=s?"prod"===i?s.prod:s.ppe:"prod"===i?l?Ou.a.prod:Ou.b.prod:l?Ou.a.ppe:Ou.b.ppe;var u=e.customerPromiseManager||(0,Eu.a)(),f=function(e){var t=void 0;if(!H.x9.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&"unload"===(t=(0,a.q5)({resultType:d},d===ge.b.ExpectedFailure||d===ge.b.Failure?{errorCode:"unload"}:{})).errorCode)switch(null==e?void 0:e.data.pillar){case"Create":t.veto="unload (create)";break;case"Boot":t.veto="unload (boot)";break;case"View":t.veto="unload (view)";break;case"Edit":t.veto="unload (edit)";break;case"Delete":t.veto="unload (delete)";break;case"Share":t.veto="unload (share)";break;case"Freshness":t.veto="unload (freshness)";break;case"Social":t.veto="unload (social)";break;case"Upload":t.veto="unload (upload)";break;case"Search":t.veto="unload (search)"}e.end(!H.x9.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&t?t:(0,a.q5)({resultType:d},d===ge.b.ExpectedFailure||d===ge.b.Failure?{errorCode:"unload"}:{}))};if(u.addOnBeforeUnloadHandler(f),o){var p=function(e){var t=Au(e);return(0,wu.a)(e.pageContext,t)}(e),m=r.oneDsCollectorUrl,_=new Cu.a({sourceName:"odsp-spo",tenantToken:t,context:{context:p,oneDsCollectorUrl:m}});return _.attach(u),{dispose:function(){u.removeOnBeforeUnloadHandler(f),_.dispose()},handler:_}}var h=Au(e),b=(0,wu.b)({ariaLoader:function(){return n.e(2).then(n.t.bind(n,185,23))},pageContext:r,customerContext:h,tenantToken:t}),g=b.attach(u);return{dispose:function(){u.removeOnBeforeUnloadHandler(f),g()},handler:b}}({pageContext:e.spPageContext,clientName:"".concat(e.clientName,"-").concat(e.viewParams[qe.b.queryTypeParamKey]),initOneDS:!0,customerPromiseManager:(0,Ce.a)(),tokens:Ou.a}).handler;ku=i}}({clientName:"OneUpLightSpeed-fastOneUp",viewParams:pf.viewParams,spPageContext:ff,initDefaultHandler:!0}),function(e){try{if(ff){try{var t=window&&"true"===window.localStorage.getItem("isODBDarkMode");e.expose(De.d,t)}catch(e){}e.exposeFactory(G.a,new H.BS(de)),e.exposeFactory(K.a,new H.BS(ln.a)),e.exposeFactory(fe.a,new H.BS(pe)),e.exposeFactory(le.a,new H.BS(ue)),e.expose(De.e,!0),e.expose(De.i,vf),e.expose(De.h,yf);var i=function(){if(ku&&"dispose"in ku)return ku}(),r=e.consume(tf).getASHAProductName();null==i||i.updateContext({product:r}),e.expose(qo.a,Sf()),H.x9.isActivated("B34E3F01-04D5-4161-9629-4B783CA48830","01/23/2024","Customize image editing in one up")||e.exposeFactory(Wd,new H.BS(Yu)),St.a?function(e){var t=this;e.expose(Pu.a,function(){return(0,a.yv)(t,void 0,void 0,function(){var t,i,r,o,s,c;return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,Promise.all([n.e(55).then(n.bind(n,662)),n.e(55).then(n.bind(n,405)),n.e(55).then(n.bind(n,215)),Promise.resolve().then(n.bind(n,39)),n.e(55).then(n.bind(n,663))])];case 1:return t=a.sent(),i=t[0].resourceKey,r=t[1].downloadDataSourceKey,o=t[2].legacyGraphDataSourceKey,s=t[3].resourceKey,c=t[4].isOnePlayerEnabledResourceKey,e.exposeFactory(Tu.f,new H.BS(i)),e.exposeFactory(Tu.a,new H.BS(r)),e.exposeFactory(Tu.b,new H.BS(o)),e.exposeFactory(Tu.e,new H.BS(ln.a)),e.exposeFactory(Tu.c,new H.BS(s)),e.exposeFactory(Uu.a,new H.BS(c)),[2]}})})}),e.expose(Mu.b,Fu)}(e):e.exposeFromPack(((o=new H.Nj).addAlias(Xu.a,Zu),o.addAlias(Mu.a,Ju),o)),ff.webTemplate===jn.b.mySite.toString()&&e.exposeFactory(Hu,new H.BS(Nu)),H.x9.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")||e.exposeFactory(cf.a,new H.BS(Zt.resourceKey)),H.x9.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/25/2024","bentsai - enable host theme resource key")||e.expose(De.b,(0,l.kF)())}else bf.reportBootCXPFailure({rawError:{errorType:ye.d.processOneUpItemError,error:new H.qt({code:"fastOneUp-NoPageContext"})}})}catch(e){bf.reportBootCXPFailure({rawError:{errorType:ye.d.processOneUpItemError,error:new H.qt({code:"fastOneUp-initResourcesException",innerError:e})}})}var o}(uf);try{(0,F.b)(uf),function(e){(0,a.yv)(this,void 0,void 0,function(){return(0,a.SO)(this,function(t){switch(t.label){case 0:return[4,e.consume(qu).getFileHandlerDataForOneUp()];case 1:return t.sent(),[2]}})})}(uf),gf=uf,ul&&ff.hidePeoplePreviewingFiles||!(0,Le.wb)(Le.l)||gf.consumeAsync(lf)}catch(e){uf.consume(je.e).updateErrorState("fastOneUpAdapterException",{errorType:ye.d.rldsApiError,error:e,item:void 0})}function Sf(){return Number(ff.webTemplate)===jn.b.mySite?"ODB Web":"SPList Web"}j.f("EUPL.BeforeWaitForDomReady"),(0,z.a)(function(){j.f("EUPL.AfterWaitForDomReady"),function(){try{var e=document.getElementById("od-oneup");e&&document.body.removeChild(e),(e=document.createElement("div")).setAttribute("id","od-oneup"),document.body.appendChild(e);var t=p.createElement(V.a,{resources:uf},p.createElement(uu,null));U.a(t,document.getElementById("od-oneup"))}catch(e){bf.reportBootCXPFailure({rawError:{errorType:ye.d.processOneUpItemError,error:new H.qt({code:"fastOneUp-initizationException",innerError:e})}})}}()}).catch(function(e){console.log("dom error: ",e)})}
,,(e,t,n)=>{"use strict";new Date}
,,,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f,downloadDataSourceKey:()=>p});var a=n(467),i=n("odsp.util_152"),r=n(748);function o(e){if(void 0!==e)return e}var s=n(21),c=n(7),d=n(39),l=n(5),u=function(){function e(e,t){this._common=new a.a(t.pageContext),this._dataRequestor=new t.dataRequestorType({}),this._itemUrlHelper=t.itemUrlHelper,this._identityDataSource=t.identityDataSource}return e.prototype.getDownloadUrl=function(e,t){return void 0===t&&(t={}),this._common.getDownloadUrl(o(e),o(void 0),t)},e.prototype.getItemClassicDownloadLink=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"},e.prototype.downloadItems=function(e){var t=this,n=e.items[0];return this.getDownloadRequestParameters(n,0).then(function(e){var n=t._initIframe(e.url);setTimeout(function(){window.document.body.removeChild(n)},2e4)})},e.prototype.getItemContents=function(e){var t=this;return this.getDownloadRequestParameters(e,2).then(function(e){var n=e.headers,a=n&&n.Authorization,i=a&&a.slice(7);return t._dataRequestor.getData({url:e.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:i})})},e.prototype.getDownloadRequestParameters=function(e,t,n){var a=this,i=this._itemUrlHelper.getItemUrlParts(e.key),r=new c.a(i.normalizedItemUrl);return i.isCrossDomain?this._identityDataSource.getSharePointToken(r.authority).then(function(n){var i=n.accessToken;return a.getDownloadUrl(e,{downloadType:t,authToken:i}).then(function(e){return{url:e,headers:{Authorization:"bearer ".concat(i)}}})}):this.getDownloadUrl(e,{downloadType:t}).then(function(e){return{url:e,withCredentials:!0}})},e.prototype._initIframe=function(e){var t=document.createElement("iframe");return t.src=e,t.style.display="none",window.document.body.appendChild(t),t},e}();const f=u;var p=(0,i._y)("DownloadDataSource",u,{dataRequestorType:r.b,pageContext:l.a,itemUrlHelper:s.c,identityDataSource:d.resourceKey})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>tt});var a=n("tslib_538"),i=n(161),r=n(482),o=["currentPageNumberAria","lastPagePrompt","firstPagePrompt","focusOnVirtualFormOverlay","textSelectedAria","rotationAria","formFieldAria","Copy","freeTextFoucs","freeTextAdded","inkDelBtnTooltip","inkDelBtnAria"],s=n(269),c=n(751),d=n("react-lib"),l=n.n(d),u=n(352),f=n(367),p=n(182),m=["needsPasswordLabel","saveAs","encryptDialogFooter","userPasswordMsg","encryptDialogTitle","encryptionPwdConfirmPlaceHolder","encryptionPwdEnterPlaceHolder","encryptionPwdErrMsg","arialLabelHidePwd","arialLabelShowPwd","encryptionPwdErrMsgForMatching","encryptionOwnerPasswordMsg","restrictPermission","enterPassword","enterPasswordDialogLabel","printing","changingTheDoc","docAssembly","contentCopying","commentingFillingInFormFields","signingFillingInFormFields","protection","invalidPasswordPrompt","security","dialogOk","dialogCancel","zoomPageFitSize","zoomPageFitWidth","previousPageTooltip","nextPageTooltip","zoomTooltip","zoomOutTooltip","zoomInTooltip","rotateTooltip","openInNewWindowTooltip","searchTooltip","previousTooltip","nextTooltip","upCommandAria","downCommandAria","zoomCommandAria","zoomOutCommandAria","zoomInCommandAria","rotateCommandAria","openInNewWindowCommandAria","searchCommandAria","closeSearchCommandAria","searchQueryAria","searchInputAria","noSearchResultAria","noSearchResultPrompt","searchResultAria","previousResultCommandAria","nextResultCommandAria","pageNumberAria","pageInputAria","searchInputPlaceholder","printModalAria","printProgressLabel","mipPdfTitle","mipPdfMessage","download","openInBrowser","saveChanges","save","saveTooltip","saveAria","exitEditTooltip","clearExtractTooltip","clearExtractAria","exitExtractAria","exitExtractTooltip","fileHeaderSuffixInEditMode","unsavedChangesTitle","unsavedChangesMessage","discard","discardTooltip","discardAria","versionChangeTitle","versionChangeMessage","editToastText","previewToastText","previewToastFinishedText","doExtract","doExtractTooltip","doExtractAria","extractCommandBarTitle","thumbnailItemAria","selectExtractPageTip","searchTotalCount","searchIndex","displayInfo","freeTextPlaceHolder","freeTextDeleteButtonTooltip","freeTextDeleteButtonAria","freeTextDeleted","freeTextDecFontSizeTooltip","freeTextDecFontSizeAria","freeTextFontSizeInputAria","freeTextIncFontSizeTooltip","freeTextIncFontSizeAria","freeTextFontSizeChanged","freeTextColorPickerTooltip","freeTextColorPickerAria","freeTextMoved","focusFreeTextHandle","focusFreeTextFontSizeInput","focusFreeTextFontSizeReachMinLimit","focusFreeTextFontSizeReachMaxLimit","docNeedPermissionTitle","docNeedPermissionMessage","docShowPermissionTitle","docPermissionAllowAnnot","docPermissionAllowCopy","docPermissionAllowCopyAccessible","docPermissionAllowEdit","docPermissionAllowFormField","docPermissionAllowPrint","docPermissionAllowSign","protectedByMip","protectedByPassword","viewDocPermission","havePermissionAria","noPermissionAria","permissionDialogAria","closeButtonAria"],_=n("fui.util_867");(0,_.ZW)([{rawString:".root_58dd2d21{width:100%;height:100%;position:relative;overflow:hidden}"}]);var h=n(506),b=n(354),g=n(31),v=n(65),y=n(306),S=n(59),D=n(74),I=n(58),x=n(381),C=n(14),O=n(111),w=n(63),E=n(43),A=n(302),L=n(176),k=n(75),M=n(483),P=n("fui.core_802"),T={display:"flex",alignItems:"center"},U=(0,_.VH)(function(e,t){var n=e.palette,i={root:{height:44,flexShrink:0,padding:"0 14px",backgroundColor:e.semanticColors.menuBackground,border:"".concat(1,"px solid ").concat(n.neutralLight),boxSizing:"content-box",overflow:"hidden"},center:(0,a.q5)((0,a.q5)({},T),{justifyContent:"center",padding:"0 15px","@media (max-width: 460px)":{display:"none"}})};return(0,P.Akq)(i,t)}),F=(0,a.q5)((0,a.q5)({},T),{flexBasis:"33.3%"}),H=(0,a.q5)((0,a.q5)({},T),{justifyContent:"flex-end",flexBasis:"33.3%"}),R=function(e){var t=e.leftItems,n=void 0===t?[]:t,a=e.centerItems,i=void 0===a?[]:a,r=e.rightItems,o=void 0===r?[]:r,s=e.styles,c=(0,k.a)(),l=U(c,s);return d.createElement(M.a,{horizontal:!0,styles:{root:l.root}},d.createElement(M.a.Item,{style:F,grow:!0},n),d.createElement(M.a.Item,{styles:{root:l.center},grow:!0},i),d.createElement(M.a.Item,{style:H,grow:!0},o))},N=n(276),B=l().memo(function(e){var t=e.disabled,n=e.text,a=e.onClick,i=(0,u.c)(),r=(0,k.a)(),o=r.semanticColors,s=l().useCallback(function(){a(),D.a.logEngagement({name:"SaveChanges",actionGesture:"Click"})},[a]);return l().createElement(N.a,{text:n||i.get("save"),title:i.get("saveTooltip"),disabled:t,theme:r,onClick:s,styles:{label:{whiteSpace:"nowrap",textOverflow:"ellipsis"},rootDisabled:{color:o.buttonTextDisabled,borderColor:o.buttonBackgroundHovered,borderWidth:"1px",borderStyle:"solid"}}})}),j=n(150),V=l().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,u.c)(),i=(0,k.a)(),r=l().useCallback(function(){n(),D.a.logEngagement({name:"DiscardChanges",actionGesture:"Click"})},[n]);return l().createElement(j.a,{text:a.get("discard"),title:a.get("discardTooltip"),ariaLabel:a.get("discardAria"),disabled:t,theme:i,onClick:r})}),z=n(497),G=n(298),K=n(299),W={isBlocking:!0,isModeless:!0,styles:{main:{"@media (min-width: 640px)":{width:480,maxWidth:480},minWidth:320}},layerProps:{styles:{root:{zIndex:15e5}}}},q=function(e){var t=e.hidden,n=e.contentTitle,a=e.contentSubText,i=e.children,r=e.onDismiss,o=(0,k.a)();return l().createElement(z.a,{hidden:t,theme:o,dialogContentProps:{type:G.a.normal,title:n,subText:a},modalProps:W,onDismiss:r},l().createElement(K.a,null,i))},Q=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,u.c)();return l().createElement(q,{hidden:t,contentTitle:r.get("unsavedChangesTitle"),contentSubText:r.get("unsavedChangesMessage"),onDismiss:i},l().createElement(B,{onClick:n}),l().createElement(V,{onClick:a}))},Y=function(e){var t=e.hidden,n=e.onSave,a=e.onDiscard,i=e.onDismiss,r=(0,u.c)();return l().createElement(q,{hidden:t,contentTitle:r.get("versionChangeTitle"),contentSubText:r.get("versionChangeMessage"),onDismiss:i},l().createElement(B,{onClick:n}),l().createElement(V,{onClick:a}))};(0,_.ZW)([{rawString:"html[dir=ltr] .saveBtn_00e42b0f{padding-left:16px}html[dir=rtl] .saveBtn_00e42b0f{padding-right:16px}.fileHeader_00e42b0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;text-align:center;padding:10px}.fileHeader_00e42b0f>*{padding:0 4px}.fileHeader_00e42b0f .fileTitle_00e42b0f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;max-width:200px;line-height:1}.fileHeader_00e42b0f .fileTitle_00e42b0f>div{white-space:nowrap}.fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-right:4px}html[dir=rtl] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-left:4px}.closeButton_00e42b0f{color:inherit}"}]);var J=function(e){void 0===e&&(e="");var t=e.match(/^([^\\]*)\.(\w+)$/);return t?t[2]:".pdf"},X=d.lazy(function(){return n.e(26).then(n.bind(n,653)).then(function(e){return{default:e.InkingToolbarNext}})}),Z=d.forwardRef(function(e,t){var n=e.hasEdits,i=e.filename,r=e.allowUnloadPageWithEdits,o=e.inkingToolbarProps,s=e.onSave,c=e.onClose,l=e.onDiscard,f=e.isFileVersionChanged,p=(0,a.pM)(d.useState(!1),2),m=p[0],_=p[1],h=(0,a.pM)(d.useState(!1),2),b=h[0],y=h[1],I=(0,u.c)(),k=(0,x.b)(),M=k.pdfViewer,P=k.annotMode,T=(0,L.a)(function(){n?_(!0):c()});d.useEffect(function(){var e=function(e){n&&!r&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[r,n]),d.useImperativeHandle(t,function(){return{close:T}},[T]);var U=(0,L.a)(function(){D.a.logEngagement({name:"ExitEditMode",actionGesture:"Click",extraData:{hasEdits:n}}),T()}),F=(0,L.a)(function(){null==M||M.triggerInkComposing(),window.setTimeout(function(){U()},200)}),H=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n,i;return(0,a.SO)(this,function(a){switch(a.label){case 0:_(!1),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null==f?void 0:f()];case 2:return e=a.sent(),[3,4];case 3:return t=a.sent(),n=(null==t?void 0:t.message)||JSON.stringify(t),i=new S.c(void 0,"Fail to check file version when saving, reason: ".concat(n)),D.a.logError(i.toCaughtError()),[3,4];case 4:return e?y(!0):s(),[2]}})})},[f,s]),N=(0,L.a)(function(){var e;!(null===(e=g.a.features)||void 0===e?void 0:e.enableEnhancedInk)||P!==v.a.Ink&&P!==v.a.Highlight?U():F()}),j=d.useCallback(function(){_(!1),l(),c()},[c,l]),V=d.useCallback(function(){_(!1)},[]),z=d.useCallback(function(){y(!1)},[]),G=d.useMemo(function(){return[d.createElement("div",{key:"Save",className:"saveBtn_00e42b0f"},d.createElement(B,{disabled:!n,text:I.get("saveChanges"),onClick:H}))]},[n,I,H]),K=I.get("fileHeaderSuffixInEditMode"),W=d.useMemo(function(){return o?[d.createElement(d.Suspense,{fallback:d.createElement("div",null),key:"inkingToolbar"},d.createElement(X,(0,a.q5)({key:(null==o?void 0:o.defaultToolType)||"",actionScenario:"PdfAnnotationNext",isHorizontal:!0},o)))]:[d.createElement("div",{key:"FileHeader",className:"fileHeader_00e42b0f",tabIndex:0,"aria-label":"".concat(i,", ").concat(K),"data-is-focusable":!0},d.createElement(C.a,(0,a.q5)({},(0,A.a)({extension:J(i),size:16}))),d.createElement("div",{className:"fileTitle_00e42b0f"},d.createElement("div",{className:"fileName_00e42b0f"},i),d.createElement("div",null,"- ".concat(K))))]},[K,i,o]),q=d.useMemo(function(){return[d.createElement(O.a,{key:"Cancel",iconProps:{iconName:"Cancel"},title:I.get("exitEditTooltip"),role:"button",onClick:N,className:"closeButton_00e42b0f"})]},[I,N]),Z=d.useMemo(function(){return o?{center:{"@media (max-width: 460px)":{display:"flex"}}}:void 0},[o]);return d.createElement("div",{role:"menubar"},d.createElement(w.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:E.b.all,direction:E.a.horizontal},d.createElement(R,{leftItems:G,centerItems:W,rightItems:q,styles:Z})),d.createElement(Q,{hidden:!m,onSave:H,onDiscard:j,onDismiss:V}),d.createElement(Y,{hidden:!b,onSave:s,onDiscard:j,onDismiss:z}))});Z.displayName="EditCommandBar";var $=n(291),ee=l().memo(function(e){var t=e.disabled,n=e.onClick,a=(0,u.c)(),i=(0,k.a)(),r=l().useCallback(function(){n(),D.a.logEngagement({name:"DoExtract",actionGesture:"Click"})},[n]);return l().createElement(N.a,{text:a.get("doExtract"),title:a.get("doExtractTooltip"),ariaLabel:a.get("doExtractAria"),disabled:t,theme:i,onClick:r})});(0,_.ZW)([{rawString:"html[dir=ltr] .saveBtn_edd24649{padding-left:16px}html[dir=rtl] .saveBtn_edd24649{padding-right:16px}.title_edd24649{display:inline-block;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.rightDivider_edd24649{height:16px;margin:0 20px}.selectionCounter_edd24649{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.closeButton_edd24649{color:inherit}"}]);const te="closeButton_edd24649";var ne=d.forwardRef(function(e,t){var n=e.onSave,i=e.onClose,r=e.viewerRef,o=(0,u.c)(),s=(0,a.pM)(d.useState([]),2),c=s[0],l=s[1],p=(0,f.c)(),m=d.useMemo(function(){return c.filter(function(e){return e}).length},[c]),_=m>0;d.useEffect(function(){return p.setMode("Select"),p.subscribe(function(e){l(e)}),function(){var e;null===(e=p.unsubscribe)||void 0===e||e.call(p)}},[p]),d.useEffect(function(){var e=function(e){_&&(e.preventDefault(),e.returnValue=!1)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}},[_]);var h=d.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),D.a.logEngagement({name:"DiscardExtractSelections",actionGesture:"Click"})},[p]),b=d.useCallback(function(){var e;null===(e=p.resetPageSelection)||void 0===e||e.call(p),p.toggle(!1),i(),D.a.logEngagement({name:"CancelExtract",actionGesture:"Click"})},[i,p]),g=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,i,o,s;return(0,a.SO)(this,function(a){return e=null===(s=null===(o=r.current)||void 0===o?void 0:o.getViewer())||void 0===s?void 0:s.extract,p&&e?0===(t=(null==c?void 0:c.map(function(e,t){return e?t:null}).filter(function(e){return null!==e}))||[]).length?[2]:(i=function(){return e(t)},[2,null==n?void 0:n(i,b)]):[2]})})},[n,b,c,p,r]);d.useImperativeHandle(t,function(){return{close:b}},[b]);var v=d.useMemo(function(){return[d.createElement("div",{key:"Save",className:"saveBtn_edd24649"},d.createElement(ee,{disabled:!_,onClick:g}))]},[_,g]),y=d.useMemo(function(){return[d.createElement("div",{key:"Title",className:"title_edd24649"},o.get("extractCommandBarTitle"))]},[o]),S=d.useMemo(function(){return[d.createElement("div",{key:"Discard",className:"selectionCounter_edd24649"},d.createElement(O.a,{className:te,iconProps:{iconName:"Cancel"},ariaLabel:o.get("clearExtractAria",[m]),title:o.get("clearExtractTooltip"),role:"button",onClick:h,disabled:0===m}),d.createElement("span",{style:{marginLeft:"6px"}},m," selected")),d.createElement($.a,{key:"Divider",className:"rightDivider_edd24649"}),d.createElement(O.a,{key:"Cancel",className:te,iconProps:{iconName:"Cancel"},ariaLabel:o.get("exitExtractAria"),title:o.get("exitExtractTooltip"),role:"button",onClick:b})]},[o,b,h,m]);return d.createElement(R,{leftItems:v,centerItems:y,rightItems:S})}),ae=n(190),ie=n(304),re=n(361),oe=n(162);(0,_.ZW)([{rawString:".spinner_c7f02c9d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;max-width:50%;padding:12px 15px;border-radius:33px;z-index:99}"}]);var se=function(e){return{root:{backgroundColor:e.semanticColors.menuBackground},circle:{animationDuration:"0.7s",minWidth:20},label:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.palette.neutralPrimary,padding:"0 2px"}}},ce=function(){var e=(0,re.b)().contentViewer,t=(0,k.a)();return d.createElement(oe.a,{styles:se(t),className:"spinner_c7f02c9d",label:e.getFilename(),labelPosition:"right"})};(0,_.ZW)([{rawString:".root_72829470{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mainWrapper_72829470{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1}.saveModal_72829470{position:absolute;bottom:0;width:100%;height:100%;background:rgba(0,0,0,.2)}.main_72829470{position:relative;height:100%}"}]);var de=n(365);(0,_.ZW)([{rawString:".bottomToolArea_75fe92b9{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:16px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.placeBottomToolOnTop_75fe92b9{z-index:99}.inkBar_75fe92b9{position:absolute;top:50%;-webkit-transform:translate(0, -50%);transform:translate(0, -50%)}html[dir=ltr] .inkBar_75fe92b9{left:20px}html[dir=rtl] .inkBar_75fe92b9{right:20px}.topArea_75fe92b9{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:0px;width:100%}"}]);var le=function(e){var t=e.onDownload,n=e.onOpenInBrowser,i=e.enableDownload,r=e.enableOpenInBrowser,o=(0,a.pM)(d.useState(!0),2),s=o[0],c=o[1],l=(0,u.c)(),f=(0,k.a)(),p=d.useCallback(function(){c(!1)},[]),m=d.useCallback(function(){t(),p()},[t,p]),_=d.useCallback(function(){n(),p()},[n,p]);return d.createElement(z.a,{hidden:!s,minWidth:480,theme:f,dialogContentProps:{type:G.a.normal,title:l.get("mipPdfTitle"),subText:l.get("mipPdfMessage")},modalProps:{isBlocking:!0,isModeless:!0,layerProps:{styles:{root:{zIndex:15e5}}}},onDismiss:p},d.createElement(K.a,null,d.createElement(j.a,{onClick:m,text:l.get("download"),disabled:!i}),d.createElement(N.a,{onClick:_,text:l.get("openInBrowser"),disabled:!r})))},ue=n(274),fe=n(61),pe=n(309),me=n(112),_e={background:"#323130",runningIcon:"#FAF9F8",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#EDEBE9",link:"#71ADE2",text:"#EDEBE9",hoveredButtonBackground:"#484644",barColor:"#FAF8F8",barBackground:"#605E5C"},he={background:"#F3F2F1",runningIcon:"#292827",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#292827",link:"#71ADE2",text:"#292827",hoveredButtonBackground:"#EDEBE9",barColor:"#292827",barBackground:"#A19F9D"};(0,_.ZW)([{rawString:".wrapper_9c898eca{padding:0 10px;z-index:99;width:352px;border-radius:4px;display:block;overflow:hidden;-webkit-transform-origin:center;transform-origin:center;will-change:transform;-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipShow_9c898eca 300ms ease 1;animation:tooltipShow_9c898eca 300ms ease 1}.hidden_9c898eca{-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipHide_9c898eca 300ms ease forwards 1;animation:tooltipHide_9c898eca 300ms ease forwards 1}.displayNone_9c898eca{display:none}@-webkit-keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.rotate_9c898eca{-webkit-animation:rotating_9c898eca 1s linear infinite;animation:rotating_9c898eca 1s linear infinite}.toastInfo_9c898eca{gap:8px;padding:6px 4px}.toastLeadIconContainer_9c898eca,.toastPostIconContainer_9c898eca{width:24px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toastLeadIconContainer_9c898eca{font-size:16px}.toastPostIconContainer_9c898eca{font-size:14px;cursor:pointer;border-radius:5px}.toastText_9c898eca{padding:4px 0}@-webkit-keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@-webkit-keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}@keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}"}]);var be=d.memo(function(e){var t=e.darkMode,n=void 0!==t&&t,i=(0,p.d)(),r=(0,p.c)(),o=r.type,s=r.text,c=r.link,l=r.linkText,u=r.percentComplete,f=r.infoIconName,m=r.shouldAutoFocus,b=void 0===m||m,g=r.disableAutoHide,v=void 0!==g&&g,y=r.onClickButton,S=d.useMemo(function(){return n?he:_e},[n]),D=d.useMemo(function(){return function(e,t,n){switch(e){case p.b.Error:return{iconName:"StatusErrorFull",iconButtonName:"clear",iconColor:t.errorIcon};case p.b.Success:return{iconName:"SkypeCircleCheck",iconButtonName:"clear",iconColor:t.successIcon};case p.b.Info:return{iconName:n||"Info",iconButtonName:"clear",iconColor:t.infoIcon};case p.b.Running:default:return{iconName:"SyncStatusSolid",iconButtonName:"FullScreen",iconColor:t.runningIcon}}}(o,S,f)},[S,f,o]),I=D.iconName,x=D.iconButtonName,C=D.iconColor,w=d.useRef(p.b.Hidden),E=(0,a.pM)(d.useState(o===p.b.Hidden),2),A=E[0],L=E[1],k=d.useRef(null),P=(o===p.b.Success||o===p.b.Error)&&c&&l,T=d.useCallback(function(){setTimeout(function(){i({type:p.b.Hidden})},5e3)},[i]);d.useEffect(function(){w.current!==p.b.Running||o!==p.b.Success||v?w.current!==p.b.Hidden&&o===p.b.Hidden?setTimeout(function(){L(!0)},500):w.current===p.b.Hidden&&o!==p.b.Hidden&&(L(!1),(o===p.b.Info||o===p.b.Success&&!v)&&T()):T(),w.current=o},[T,v,A,o]),d.useEffect(function(){var e;A||(b&&o!==p.b.Info&&o!==p.b.Hidden&&(null===(e=k.current)||void 0===e||e.focus()),ie.a.read(s))},[A,b,s,o]);var U=d.useMemo(function(){return{root:{width:24,height:24},icon:{color:S.text,width:14,height:14,fontSize:14},rootHovered:{backgroundColor:S.hoveredButtonBackground},rootPressed:{backgroundColor:S.hoveredButtonBackground},rootExpanded:{backgroundColor:S.hoveredButtonBackground}}},[S.hoveredButtonBackground,S.text]);return d.createElement("div",{style:{background:S.background,color:S.text},className:(0,_.zf)("wrapper_9c898eca",o===p.b.Hidden&&"hidden_9c898eca",A&&"displayNone_9c898eca"),tabIndex:0,"data-is-focusable":!0,ref:k},d.createElement(M.a,{className:"toastInfo_9c898eca",horizontal:!0,horizontalAlign:"space-between",verticalAlign:"start"},d.createElement(ue.a,{className:(0,_.zf)("toastLeadIconContainer_9c898eca",o===p.b.Running&&"rotate_9c898eca")},d.createElement(fe.a,{style:{color:C},"aria-label":o,iconName:I})),d.createElement(ue.a,{grow:!0,className:"toastText_9c898eca"},d.createElement(M.a,null,d.createElement(ue.a,null,d.createElement(pe.a,{style:{color:S.text}},s)),P&&d.createElement(ue.a,null,d.createElement(me.a,{style:{color:S.link},href:c,target:"_blank"},l)))),d.createElement(ue.a,{className:"toastPostIconContainer_9c898eca"},y&&d.createElement(O.a,{onClick:y,styles:U,iconProps:{iconName:x}}))),o===p.b.Running&&d.createElement(h.a,{styles:{itemProgress:{paddingTop:0,paddingBottom:4},progressBar:{background:u?S.barColor:"linear-gradient(to right, ".concat(S.barBackground," 0%, ").concat(S.barColor," 50%, ").concat(S.barBackground," 100%)")},progressTrack:{backgroundColor:S.barBackground}},percentComplete:u}))}),ge=n(163),ve=function(e){var t=e.semanticColors.menuIcon,n={backgroundColor:e.semanticColors.menuItemBackgroundHovered,color:t};return{root:{backgroundColor:e.semanticColors.menuBackground,color:t},rootHovered:n,rootPressed:n,rootExpanded:n}},ye={root:{verticalAlign:"baseline",display:"inline-block"}};(0,_.ZW)([{rawString:".toolIcon_66e857e6{height:0;padding:15px 20px;margin:calc(7px) 0;border-radius:5px}.menuIcon_66e857e6{height:0;padding:15px calc(8px);margin:calc(7px) 0}"}]);const Se="toolIcon_66e857e6";var De=function(){document.activeElement instanceof HTMLButtonElement&&document.activeElement.blur()},Ie=function(e){var t=(0,k.a)();return e.hidden?d.createElement(d.Fragment,null):d.createElement(ge.a,{content:e.tooltip,styles:ye},d.createElement(O.a,(0,a.q5)({},e,{iconProps:{iconName:e.iconName},className:Se,styles:ve(t),onMouseUp:De})))},xe=n(36),Ce=function(){return null},Oe=function(e){var t=e.iconName,n=e.tooltip,i=e.items,r=e.defaultCheckedKey,o=e.uncheckAll,c=e.onClickMenuItem,l=e.onOpen,u=e.onDismiss,f=(0,a.pM)(d.useState([]),2),p=f[0],m=f[1],h=(0,a.pM)(d.useState(""),2),b=h[0],g=h[1],v=(0,k.a)();return d.useEffect(function(){var e=[],t=function(e,t){var n,r;if(t){var o=void 0;try{for(var s=(0,a.BW)(i),d=s.next();!d.done;d=s.next()){var l=d.value;if(l.key===t.key){o=l.value;break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}null==c||c.call(void 0,o),g(t.key)}};i.forEach(function(n){e.push({key:n.key,text:n.text,canCheck:!0,checked:n.key===b,onClick:t})}),m(e)},[i,b,c]),d.useEffect(function(){g(r||"")},[r]),d.useEffect(function(){o&&g("")},[o]),d.createElement(ge.a,{content:n,styles:ye},d.createElement(O.a,(0,a.q5)({},e,{iconProps:{iconName:t},className:(0,_.zf)(Se,"menuIcon_66e857e6"),styles:ve(v),persistMenu:!0,menuProps:{shouldFocusOnMount:!0,shouldFocusOnContainer:!0,items:p,focusZoneProps:{handleTabKey:0},directionalHint:(0,s.a)()?xe.a.topRightEdge:xe.a.topLeftEdge,directionalHintFixed:!0,styles:{root:{".ms-ContextualMenu-itemText":{flexGrow:0}}},onMenuOpened:l,onMenuDismissed:u},onRenderMenuIcon:Ce})))},we=n(384);(0,_.ZW)([{rawString:".root_fa619dc3{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;bottom:calc(61px);border-radius:21px 21px 0 0;border-bottom:1px solid}.fadeOut_fa619dc3{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_fa619dc3{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.keyword_fa619dc3{display:inline-table;border-collapse:separate;border-spacing:8px}.keyword_fa619dc3 input{display:table-cell;width:100%;text-indent:5px}html[dir=ltr] .keyword_fa619dc3 input{padding-left:4px}html[dir=rtl] .keyword_fa619dc3 input{padding-right:4px}html[dir=ltr] .keyword_fa619dc3 input{padding-right:2px}html[dir=rtl] .keyword_fa619dc3 input{padding-left:2px}html[dir=ltr] .keyword_fa619dc3 input{text-align:left}html[dir=rtl] .keyword_fa619dc3 input{text-align:right}.keyword_fa619dc3 .result_fa619dc3{display:table-cell;text-align:center}html[dir=ltr] .keyword_fa619dc3 .result_fa619dc3{padding-left:10px}html[dir=rtl] .keyword_fa619dc3 .result_fa619dc3{padding-right:10px}"}]);var Ee=function(e){var t=e.visible,n=e.width,i=(0,a.pM)(d.useState(0),2),r=i[0],o=i[1],s=(0,a.pM)(d.useState(0),2),c=s[0],l=s[1],f=(0,a.pM)(d.useState(""),2),p=f[0],m=f[1],h=d.useRef(!1),b=(0,re.b)().contentViewer.getViewer(),g=(0,u.c)(),v=(0,k.a)();d.useEffect(function(){t||(null==b||b.stopSearch(),o(0),l(0),m(""))},[t,b]);var y=d.useCallback(function(e){o(0),l(0);var t=0,n=0;null==b||b.startSearch(e,void 0,void 0,{onHitIndexUpdate:function(a){-1===a?null==b||b.goToNextSearchResult(!0):(l(a),n&&ie.a.read(g.get("searchIndex",[e,a+1,t])))},onTotalResultUpdate:function(a,i){o(a),t=a,n=i,ie.a.read(g.get("searchTotalCount",[e,a]))}})},[g,b]),S=d.useCallback(function(e){var t=e.target.value;m(t),h.current||y(t)},[y]),D=d.useCallback(function(){h.current=!0},[]),I=d.useCallback(function(){h.current=!1,y(p)},[p,y]),x=d.useCallback(function(e){void 0===e&&(e=!0),null==b||b.goToNextSearchResult(e)},[b]),C=d.useCallback(function(){x(!1)},[x]),O=d.useCallback(function(){x(!1)},[x]),w=d.useCallback(function(){x(!0)},[x]);return d.createElement("div",{className:(0,_.zf)("root_fa619dc3",t?"fadeIn_fa619dc3":"fadeOut_fa619dc3"),style:{backgroundColor:v.semanticColors.menuBackground,borderBottomColor:v.semanticColors.menuDivider},role:"menubar"},d.createElement(we.a,{visible:t,autoFocusOnInput:!0,rootProps:{className:"keyword_fa619dc3",style:{color:v.semanticColors.disabledText,width:n?"".concat(n-100,"px"):"auto"},role:"menuitem","aria-label":g.get("searchQueryAria")},inputProps:{type:"text",value:p,placeholder:g.get("searchInputPlaceholder"),maxLength:100,role:"textbox","aria-label":g.get("searchInputAria"),onChange:S,onCompositionStart:D,onCompositionUpdate:D,onCompositionEnd:I},onEnterWhenFocused:x,onShiftEnterWhenFocused:C},d.createElement("div",{className:"result_fa619dc3",style:r?{color:v.semanticColors.menuItemText}:void 0,"aria-label":r?g.get("searchResultAria",[c+1,r]):g.get("noSearchResultAria")},d.createElement("span",null,r?c+1:0),"/",d.createElement("span",null,r))),d.createElement(Ie,{iconName:"ChevronLeft",tooltip:g.get("previousTooltip"),role:"menuitem",ariaLabel:g.get("previousResultCommandAria"),onClick:O}),d.createElement(Ie,{iconName:"ChevronRight",tooltip:g.get("nextTooltip"),role:"menuitem",ariaLabel:g.get("nextResultCommandAria"),onClick:w}))};(0,_.ZW)([{rawString:".root_5a88b9b2{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;border-radius:33px;-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13)}.fadeOut_5a88b9b2{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_5a88b9b2{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.pagination_5a88b9b2{display:inline-table}html[dir=ltr] .pagination_5a88b9b2{margin-left:10px}html[dir=rtl] .pagination_5a88b9b2{margin-right:10px}html[dir=ltr] .pagination_5a88b9b2{padding-right:10px}html[dir=rtl] .pagination_5a88b9b2{padding-left:10px}.pagination_5a88b9b2 input{display:table-cell;width:30px;padding:0 2px;text-align:center}.pagination_5a88b9b2 .status_5a88b9b2{display:table-cell;text-align:center}.slash_5a88b9b2{padding:0 5px}.expanded_5a88b9b2{border-radius:0 0 21px 21px;-webkit-box-shadow:none;box-shadow:none}.shadowBox_5a88b9b2{-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:21px}"}]);var Ae=/^[0-9\b]+$/,Le=[.5,.75,1,1.25,1.5,2,3,4],ke={height:"16px",margin:"14px 10px"},Me=function(e){e.stopPropagation()},Pe=function(e){e.currentTarget.select()},Te=d.forwardRef(function(e,t){var n=e.visible,i=e.disableSearch,r=e.currentIndex,o=e.showOpenInNewWindow,s=e.dataAttributes,c=e.defaultScale,l=e.onAutoHide,f=e.onOpenInNewWindow,p=(0,a.pM)(d.useState(0),2),m=p[0],h=p[1],b=(0,a.pM)(d.useState(!1),2),g=b[0],y=b[1],S=(0,a.pM)(d.useState(!1),2),I=S[0],x=S[1],C=d.useRef(),O=d.useRef(!1),A=d.useRef(!1),L=d.useRef(!1),M=d.useRef(null),P=d.useRef(null),T=(0,re.b)().contentViewer.getViewer(),U=(0,u.c)(),F=(0,k.a)(),H=d.useCallback(function(){C.current&&window.clearTimeout(C.current)},[]),R=d.useCallback(function(){A.current||O.current||L.current||I||(H(),C.current=window.setTimeout(function(){l()},4e3))},[l,I,H]),N=d.useCallback(function(){T&&(m>=0&&m<T.pageCount?(T.goToPage(m),D.a.logEngagement({name:"GoToCertainPage",actionGesture:"Click",extraData:{pageIndex:m}})):h(r))},[m,T,r]);d.useEffect(function(){return n&&R(),function(){H()}},[n,R,H]),d.useEffect(function(){h(r)},[r]),d.useImperativeHandle(t,function(){return{focus:function(){window.setTimeout(function(){var e;null===(e=M.current)||void 0===e||e.focus()})},uncheckZoomMenu:function(){y(!0)}}},[]);var B=d.useCallback(function(){O.current=!0,H()},[H]),j=d.useCallback(function(){O.current=!1,R()},[R]),V=d.useCallback(function(){A.current=!0,H()},[H]),z=d.useCallback(function(){A.current=!1,R()},[R]),G=d.useCallback(function(e){void 0===e&&(e=!0);var t=e?r+1:r-1;null==T||T.goToPage(t),D.a.logEngagement({name:e?"GoToNextPage":"GoToPreviousPage",actionGesture:"Click"})},[r,T]),K=d.useCallback(function(){N()},[N]),W=d.useCallback(function(e){var t=e.target.value;t?Ae.test(t)&&h(parseInt(t,10)-1):h(-1)},[]),q=d.useCallback(function(e){"Enter"===e.key&&N()},[N]),Q=d.useCallback(function(e){null==T||T.zoom(e),y(!1),D.a.logEngagement({name:"SelectZoomOption",actionGesture:"Click",extraData:{zoomOption:e}})},[T]),Y=d.useCallback(function(){var e=[],t=0;return e.push({key:"".concat(t++),text:U.get("zoomPageFitSize"),value:v.g.FitSize}),e.push({key:"".concat(t++),text:U.get("zoomPageFitWidth"),value:v.g.FitWidth}),Le.forEach(function(n){e.push({key:"".concat(t++),text:"".concat(100*n,"%"),value:n})}),e},[U]),J=d.useCallback(function(){var e="number"==typeof c?"".concat(100*c,"%"):"",t=(null==T?void 0:T.zoomOpt)||e,n=Y().find(function(e){return e.value===t});return n?n.key:""},[c,Y,T]),X=d.useCallback(function(){L.current=!0,H(),D.a.logEngagement({name:"OpenZoomMenu",actionGesture:"Click"})},[H]),Z=d.useCallback(function(){L.current=!1,R()},[R]),ee=d.useCallback(function(){null==T||T.rotate(),D.a.logEngagement({name:"Rotate",actionGesture:"Click"})},[T]),te=d.useCallback(function(){null==f||f(),D.a.logEngagement({name:"OpenInNewWindow",actionGesture:"Click"})},[f]),ne=d.useCallback(function(){x(function(e){return!e}),H(),D.a.logEngagement({name:"ToggleSearchBar",actionGesture:"Toggle"})},[H]),ae=d.useCallback(function(){var e;return null===(e=M.current)||void 0===e?void 0:e.getBoundingClientRect().width},[]),ie=d.useCallback(function(){G(!1)},[G]),oe=d.useCallback(function(){G(!0)},[G]);return d.createElement("div",(0,a.q5)({},s,{className:I?"shadowBox_5a88b9b2":""}),d.createElement(w.a,{direction:E.a.horizontal,shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:E.b.all},d.createElement(Ee,{visible:I,width:ae()})),d.createElement(w.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:E.b.all,direction:E.a.horizontal},d.createElement("div",{className:(0,_.zf)("root_5a88b9b2",n||I?"fadeIn_5a88b9b2":"fadeOut_5a88b9b2",I?"expanded_5a88b9b2":""),style:{backgroundColor:F.semanticColors.menuBackground},ref:M,tabIndex:0,role:"menubar",onMouseEnter:B,onMouseLeave:j,onClick:Me,onMouseDown:Me,onMouseMove:Me,onFocus:V,onBlur:z},d.createElement(Ie,{iconName:"ChevronUp",tooltip:U.get("previousPageTooltip"),role:"menuitem",ariaLabel:U.get("upCommandAria"),onClick:ie}),d.createElement(Ie,{iconName:"ChevronDown",tooltip:U.get("nextPageTooltip"),role:"menuitem",ariaLabel:U.get("downCommandAria"),onClick:oe}),d.createElement(we.a,{rootProps:{className:"pagination_5a88b9b2",role:"menuitem","aria-label":U.get("pageNumberAria",[r+1,(null==T?void 0:T.pageCount)||1]),style:{color:F.semanticColors.menuItemText}},inputProps:{type:"text",value:m>=0?m+1:"",autoComplete:"off","aria-label":U.get("pageInputAria",[(null==T?void 0:T.pageCount)||1]),onFocus:Pe,onBlur:K,onChange:W,onKeyDown:q},outerRef:P},d.createElement("div",{className:"status_5a88b9b2"},d.createElement("span",{className:"slash_5a88b9b2"},"/"),d.createElement("span",null,(null==T?void 0:T.pageCount)||1))),d.createElement($.a,{styles:{divider:ke}}),d.createElement(Oe,{iconName:"ZoomIn",tooltip:U.get("zoomTooltip"),role:"menuitem",ariaLabel:U.get("zoomCommandAria"),items:Y(),defaultCheckedKey:J(),uncheckAll:g,onClickMenuItem:Q,onOpen:X,onDismiss:Z}),d.createElement(Ie,{iconName:"Rotate",tooltip:U.get("rotateTooltip"),role:"menuitem",ariaLabel:U.get("rotateCommandAria"),onClick:ee}),!i&&d.createElement(Ie,{iconName:"Search",tooltip:U.get("searchTooltip"),role:"menuitem",ariaLabel:I?U.get("closeSearchCommandAria"):U.get("searchCommandAria"),"aria-expanded":I,onClick:ne}),d.createElement(Ie,{iconName:"OpenInNewTab",tooltip:U.get("openInNewWindowTooltip"),role:"menuitem",ariaLabel:U.get("openInNewWindowCommandAria"),onClick:te,hidden:!o}))))});Te.defaultProps={defaultScale:v.g.FitSize};var Ue=n(123),Fe=d.lazy(function(){return n.e(63).then(n.bind(n,701)).then(function(e){return{default:e.ThumbnailView}})}),He=d.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(25)]).then(n.bind(n,657)).then(function(e){return{default:e.InkingToolbar}})}),Re=d.lazy(function(){return n.e(28).then(n.bind(n,702)).then(function(e){return{default:e.MipNeedPermissionDialog}})}),Ne=d.lazy(function(){return n.e(29).then(n.bind(n,703)).then(function(e){return{default:e.EncryptDialog}})}),Be=d.lazy(function(){return n.e(31).then(n.bind(n,704)).then(function(e){return{default:e.PrintDialog}})}),je=d.lazy(function(){return n.e(28).then(n.bind(n,705)).then(function(e){return{default:e.PermissionBanner}})}),Ve=d.memo(d.forwardRef(function(e,t){var n,i=e.enableToolbar,r=e.enableThumbnailView,o=e.enableToast,s=e.mode,c=e.mipDialogProps,l=e.encryptDialogProps,u=e.toolbarProps,m=e.inkingToolbarProps,h=e.darkMode,b=void 0!==h&&h,g=e.enableAnnotation,v=void 0!==g&&g,y=e.mipAuthFailed,S=void 0!==y&&y,D=e.enablePrint,I=(0,a.pM)(d.useState(!1),2),x=I[0],C=I[1],O=(0,a.pM)(d.useState(!1),2),w=O[0],E=O[1],A=(0,a.pM)(d.useState(!1),2),L=A[0],k=A[1],M=(0,a.pM)(d.useState(!1),2),P=M[0],T=M[1],U=(0,f.b)(),F=(0,f.c)(),H=(0,p.d)(),R=d.useRef(null),N=(0,re.b)().contentViewer.getViewer();d.useEffect(function(){U({toggle:function(e){E(e??function(e){return!e})}})},[U]),d.useImperativeHandle(t,function(){return{print:function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){return D?(C(!0),n={onPrintEnd:function(){window.setTimeout(function(){C(!1)})}},null==N||N.print(e,t,n),[2]):[2]})})},getThumbnailView:function(){return F},getToolbar:function(){return R.current||{}},getToastOperation:function(){return H}}},[D,N,F,H]);var B=d.useCallback(function(){D&&(C(!1),null==N||N.cancelPrint())},[D,N]);d.useEffect(function(){(null==N?void 0:N.isMip)&&!N.isMipDecrypted&&(T(S),k(!S))},[S,N]);var j=(null==m?void 0:m.defaultToolType)||"";return d.createElement("div",null,r&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(Fe,{visible:!!w})),d.createElement("div",{className:(0,_.zf)("bottomToolArea_75fe92b9",u.shouldPlaceToolbarOnTop&&"placeBottomToolOnTop_75fe92b9")},i&&d.createElement(Te,(0,a.q5)({ref:R},u)),o&&d.createElement(be,{darkMode:b})),d.createElement("div",{className:(0,_.zf)("topArea_75fe92b9")},N&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(je,{pdfViewer:N}))),m&&v&&s===Ue.a.Edit&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement("div",{className:"inkBar_75fe92b9"},d.createElement(He,(0,a.q5)({key:j,actionScenario:"PdfAnnotationNext"},m)))),L&&c&&d.createElement(le,(0,a.q5)({},c)),P&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(Re,null)),D&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(Be,{hidden:!x,onCancelPrint:B})),(null===(n=de.a.features)||void 0===n?void 0:n.enableEncrypt)&&l&&l.encryptVisible&&d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(Ne,(0,a.q5)({},l))))}));Ve.displayName="PdfViewerControls",(0,_.ZW)([{rawString:".enterPanel_c6d49072{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);text-align:center}.prompt_c6d49072{margin-bottom:10px;font-size:16px}"}]);var ze=n(510),Ge={isBlocking:!0,styles:{main:{padding:15}},layerProps:{styles:{root:{zIndex:15e5}}}},Ke=function(e){var t=(0,a.pM)(d.useState(!0),2),n=t[0],i=t[1],r=(0,a.pM)(d.useState(!0),2),o=r[0],s=r[1],c=d.useRef(null),l=(0,re.b)().contentViewer,f=(0,u.c)(),p=d.useCallback(function(){var e;l.verifyPassword((null===(e=c.current)||void 0===e?void 0:e.value)||"",function(){var e;s(!1),null===(e=c.current)||void 0===e||e.select()})},[l]),m=d.useCallback(function(e,t){o||s(!0),i(!t)},[o]);return d.createElement(z.a,{hidden:e.hidden,dialogContentProps:{type:G.a.normal,title:f.get("enterPasswordDialogLabel")},modalProps:Ge,onDismiss:e.onClose},d.createElement(ze.a,{type:"password",errorMessage:o?"":f.get("invalidPasswordPrompt"),autoComplete:"off",autoFocus:!0,componentRef:c,ariaLabel:n?f.get("enterPasswordDialogLabel"):"",onChange:m}),d.createElement(K.a,null,d.createElement(N.a,{onClick:p,text:f.get("dialogOk"),disabled:n}),d.createElement(j.a,{onClick:e.onClose,text:f.get("dialogCancel")})))},We=function(){var e=(0,a.pM)(d.useState(!1),2),t=e[0],n=e[1],i=(0,re.b)().contentViewer,r=(0,u.c)(),o=d.useCallback(function(){n(!0)},[]),s=d.useCallback(function(){n(!1)},[]);return d.createElement("div",{className:"enterPanel_c6d49072"},d.createElement("div",{className:"prompt_c6d49072"},r.get("needsPasswordLabel",[i.getFilename()])),d.createElement(N.a,{onClick:o,text:r.get("enterPassword")}),d.createElement(Ke,{hidden:!t,onClose:s}))},qe=d.lazy(function(){return Promise.all([n.e("odsp.react.lib"),n.e(25)]).then(n.bind(n,687)).then(function(e){return{default:e.FreeTextContainer}})}),Qe=function(e){return d.createElement(d.Suspense,{fallback:d.createElement("div",null)},d.createElement(qe,(0,a.q5)({},e)))},Ye=d.memo(d.forwardRef(function(e,t){var n,i=e.mode,r=void 0===i?Ue.a.View:i,o=e.defaultScale,s=void 0===o?v.g.FitSize:o,c=e.showLoadingSpinner,l=void 0===c||c,f=e.disableSearch,m=void 0!==f&&f,_=e.enableToolbar,h=void 0===_||_,b=e.enableGripperContextualMenu,y=void 0===b||b,S=e.enableToast,D=void 0===S||S,I=e.darkMode,x=void 0!==I&&I,C=e.enableEdit,O=void 0!==C&&C,w=e.enablePreview,E=e.enableProgressiveLoading,A=e.annotParams,L=e.hasAnnotationPermission,M=e.contentViewerRef,P=e.controlsRef,T=e.onNeedPassword,U=e.onDocumentLoaded,F=e.onCurrentPageChanged,H=e.onScaleChanged,R=(0,a.pM)(d.useState(!1),2),N=R[0],B=R[1],j=(0,a.pM)(d.useState(!1),2),V=j[0],z=j[1],G=(0,a.pM)(d.useState(!1),2),K=G[0],W=G[1],q=(0,a.pM)(d.useState(!1),2),Q=q[0],Y=q[1],J=(0,a.pM)(d.useState(0),2),X=J[0],Z=J[1],$=(0,a.pM)(d.useState(h),2),ee=$[0],te=$[1],ne=(0,a.pM)(d.useState(!1),2),oe=ne[0],se=ne[1],de=!!w&&!E,le=d.useRef(de?0:E?1:-1),ue=(0,u.c)(),fe=(0,k.a)(),pe=O&&L,me=(null===(n=g.a.features)||void 0===n?void 0:n.enableFreeText)&&pe,_e=d.useCallback(function(e){!Q&&Math.sqrt(Math.pow(e.movementX,2)+Math.pow(e.movementY,2))>30&&Y(!0)},[Q]);d.useImperativeHandle(t,function(){return{getEventHandlers:function(){return{onMouseMove:_e}}}},[_e]);var he=d.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t,n,i,r,o;return(0,a.SO)(this,function(a){switch(a.label){case 0:return e.altKey&&"T"===e.key.toUpperCase()?(Y(!0),null===(i=null===(t=P.current)||void 0===t?void 0:(n=t.getToolbar()).focus)||void 0===i||i.call(n),[3,3]):[3,1];case 1:return(null==A?void 0:A.mode)===v.a.FreeText&&e.altKey&&e.ctrlKey&&"F"===e.key.toUpperCase()?[4,null===(o=null===(r=M.current)||void 0===r?void 0:r.getViewer())||void 0===o?void 0:o.addFreeText()]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})},[A,M,P]),be=d.useCallback(function(){Y(function(e){return!e})},[]),ge=d.useCallback(function(){null==T||T(),B(!0)},[T]),ve=d.useCallback(function(e){var t;null==U||U(e),z(!0),Y(!0),B(!1);var n=null===(t=M.current)||void 0===t?void 0:t.getViewer();n&&ie.a.read(ue.get("displayInfo",[n.getCurrentPageIndex()+1,n.scale,n.rotation]))},[U,M,ue]),ye=d.useCallback(function(){W(!0),B(!1)},[]),Se=d.useCallback(function(){se(!0)},[]);d.useEffect(function(){var e;if(-1!==le.current&&(V||1!==le.current)){te(!!h&&V);var t=null===(e=P.current)||void 0===e?void 0:e.getToastOperation();if(V&&K)null==t||t({type:p.b.Success,text:ue.get("previewToastFinishedText"),link:"",linkText:"",onClickClose:function(){t({type:p.b.Hidden})}}),le.current=-1;else if(K){var n=setInterval(function(){null==t||t({type:p.b.Running,text:ue.get("previewToastText")})},1e3);return le.current=1,function(){clearInterval(n)}}}},[K,de,E,V,P,ue,h]);var De=d.useCallback(function(e){null==F||F(e),Z(e)},[F]),Ie=d.useCallback(function(e,t){var n,a,i;null==H||H(e),t||null===(i=null===(n=P.current)||void 0===n?void 0:(a=n.getToolbar()).uncheckZoomMenu)||void 0===i||i.call(a)},[H,P]),xe=d.useCallback(function(){Y(!1)},[]);return d.createElement("div",{className:"main_72829470",style:{color:fe.palette.neutralPrimary},onMouseMove:_e,onClick:be,onKeyDown:he},d.createElement(ae.a,(0,a.q5)({},e,{ref:M,localeStrings:e.contentStrings,enableEdit:O,enablePreview:de,enableGripperContextualMenu:y,isRootFocusable:!1,annotParams:A,ariaHidden:r===Ue.a.Extract,onNeedPassword:ge,onDocumentLoaded:ve,onCurrentPageChanged:De,onScaleChanged:Ie,onDocumentPreviewed:ye,freeTextContainer:me&&Qe||void 0,onMipAuthFailed:Se})),M.current&&d.createElement(re.a,{contentViewer:M.current,docLoaded:V},V||K?d.createElement(Ve,{ref:P,enableToolbar:ee,enableThumbnailView:e.enableThumbnailView,enableToast:D,enableOpenMip:e.enableOpenMip,mode:r,darkMode:x,enableAnnotation:pe,mipAuthFailed:oe,toolbarProps:{visible:Q,disableSearch:m,currentIndex:X,defaultScale:s,onAutoHide:xe,showOpenInNewWindow:e.showOpenInNewWindow,shouldPlaceToolbarOnTop:e.shouldPlaceToolbarOnTop,dataAttributes:e.toolbarAttributes,onOpenInNewWindow:e.onOpenInNewWindow},mipDialogProps:e.mipDialogProps,inkingToolbarProps:e.inkingToolbarProps,encryptDialogProps:e.encryptDialogProps}):N?d.createElement(We,null):l?d.createElement(ce,null):void 0))}));Ye.displayName="PdfViewerAppMain";var Je=function(e){switch(e){case b.b.FreeText:return v.a.FreeText;case b.b.Pen:return v.a.Ink;case b.b.Highlighter:return v.a.Highlight;case b.b.Eraser:return v.a.Erase;case b.b.PointEraser:return v.a.PointErase;default:return v.a.None}},Xe=function(e){var t=e.tool,n=e.color,a=e.thickness,i=function(e,t){return(2*e+5)/5*(t===b.b.Highlighter?10:1)}(null!=a?a:3,t);return{width:i,color:{hex:null!=n?n:"#1f1f1f",alpha:t===b.b.Highlighter?.3:1}}},Ze=d.memo(function(e){var t,n,i=e.mode,r=e.filename,o=e.height,s=e.shouldExitEditModeAfterSave,c=void 0===s||s,l=e.allowUnloadPageWithEdits,m=e.mainRef,_=e.contentViewerRef,C=e.enableEdit,O=e.onDocumentLoaded,w=e.onEditStateChanged,E=e.execSave,A=e.updateMode,L=e.isFileVersionChanged,k=e.execExtract,M=e.onExitEditMode,P=(0,a.pM)(d.useState(!1),2),T=P[0],U=P[1],F=(0,a.pM)(d.useState(!1),2),H=F[0],R=F[1],N=(0,a.pM)(d.useState(!1),2),B=N[0],j=N[1],V=(0,a.pM)(d.useState(),2),z=V[0],G=V[1],K=(0,a.pM)(d.useState(),2),W=K[0],q=K[1],Q=(0,a.pM)(d.useState(!0),2),Y=Q[0],J=Q[1],X=d.useRef(),$=(0,u.c)(),ee=(0,f.c)(),te=(0,p.d)(),ae=d.useRef(new y.a),ie=null===(t=_.current)||void 0===t?void 0:t.getViewer(),re=d.useRef(null),oe=d.useRef(null),se=d.useMemo(function(){return $.get("editToastText")},[$]),ce=d.useRef(null);d.useEffect(function(){var e=function(e){var t,n,a;"Escape"===e.key&&e.target instanceof Node&&(null===(t=re.current)||void 0===t?void 0:t.contains(e.target))&&(null===(n=oe.current)||void 0===n||n.close(),null===(a=ce.current)||void 0===a||a.close())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[]);var de=d.useCallback(function(){var e=re.current;e&&!e.contains(document.activeElement)&&e.focus()},[]);d.useEffect(function(){i===Ue.a.Extract&&(de(),ee.toggle(!0))},[i,ee,de]),d.useEffect(function(){var e=b.b.Display;i===Ue.a.Edit?(de(),q({mode:Je(e)})):q({mode:v.a.None}),G(e)},[i,de]);var le=d.useCallback(function(e){null==O||O(e),U(!0),e.isAnnotAllowed||J(!1)},[O]),ue=d.useCallback(function(e){var t=e.dirty,n=e.annotTypeOfLatestEdit;t!==H&&(null==w||w({dirty:t}),R(t)),t&&i===Ue.a.View&&(null==A||A(Ue.a.Edit),te({type:p.b.Info,text:se,infoIconName:"EditSolid12",shouldAutoFocus:!1,onClickClose:function(){te({type:p.b.Hidden})}}),X.current=n)},[w,se,H,i,te,A]),fe=d.useCallback(function(){var e;null===(e=ae.current)||void 0===e||e.dispatch(Ue.b.ExitEditMode),j(!1),X.current=void 0,M?M():null==A||A(Ue.a.View)},[M,A]),pe=d.useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:if(!E)throw new S.c(S.b.UploadFileDataFailed,"Empty execSave callback from host");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,E(e)];case 2:return[2,n.sent()];case 3:if((t=n.sent())instanceof S.c)throw t;throw new S.c(S.b.UploadFileDataFailed,(null==t?void 0:t.message)||JSON.stringify(t),null==t?void 0:t.isExpected);case 4:return[2]}})})},[E]),me=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t,n,i,r,o,s,d,l;return(0,a.SO)(this,function(u){switch(u.label){case 0:R(!1),j(!0),e=D.a.createScenario({name:I.a.DocumentSave}),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,null==ie?void 0:ie.getCurrentFileData()];case 2:if(t=u.sent(),!(n=null==t?void 0:t.byteLength))throw new S.c(S.b.GetPdfStreamFailed,0===n?"Empty file data":"Undefined file data");return j(!1),c&&fe(),[4,pe(t)];case 3:return i=u.sent(),e.stop({extraData:(0,a.q5)({fileSize:n},(null==i?void 0:i.extraData)||{})}),o=(r=function(e){return!!e&&e.byteLength>0})(t)?t:null==i?void 0:i.fileData,s=function(e){return new S.c(void 0,"Fail to reload document after saving, reason: ".concat(e)).toCaughtError()},r(o)?null==ie||ie.reloadCurrentDocument(o).catch(function(e){D.a.logError(s(e.message))}):D.a.logError(s("No available file data")),[4,null==ie?void 0:ie.getTelemetryData()];case 4:return void 0!==(d=u.sent())&&D.a.logEngagement({name:"InteractWithForm",actionGesture:"Form",extraData:{telemetryExtraData:d}}),[3,6];case 5:return f=u.sent()||new S.c("Unknown"),l=f instanceof S.c?f.toQosError():{isExpected:!!f.isExpected,error:f,code:f.code||f.name},e.fail(l),[3,6];case 6:return[2]}var f})})},[ie,c,pe,fe]),_e=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,null==ie?void 0:ie.discardEdits()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),t="string"==typeof e?e:e.message,D.a.logError({error:{name:e.name,message:"Fail to discard, reason: ".concat(t),stack:e.stack}}),[3,3];case 3:return[2]}})})},[ie]),he=d.useCallback(function(){null==A||A(Ue.a.View)},[A]),be=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,null===(t=null===(e=_.current)||void 0===e?void 0:e.getViewer())||void 0===t?void 0:t.addFreeText()];case 1:return n.sent(),[2]}})})},[_]),ge=d.useCallback(function(e,t){q({mode:Je(e),inkAttributes:t?Xe(t):null==W?void 0:W.inkAttributes})},[null==W?void 0:W.inkAttributes]),ve=d.useCallback(function(e){q({mode:null==W?void 0:W.mode,inkAttributes:Xe(e)})},[W]),ye=d.useMemo(function(){var t,n;return{enableFreeText:null===(t=g.a.features)||void 0===t?void 0:t.enableFreeText,enablePointEraser:null===(n=g.a.features)||void 0===n?void 0:n.enableEnhancedInk,localeStrings:e.annotBarStrings,defaultToolType:z,onToolChange:ge,onInkingAttributesUpdate:ve,addNewFreeText:be}},[be,z,ve,ge,e.annotBarStrings]),Se=d.useCallback(function(){var e;switch(i){case Ue.a.Edit:return d.createElement(Z,{ref:oe,hasEdits:H,filename:r,allowUnloadPageWithEdits:l,inkingToolbarProps:(null===(e=g.a.features)||void 0===e?void 0:e.enableNewAnnotationBar)&&C&&Y?ye:void 0,onSave:me,onClose:fe,onDiscard:_e,isFileVersionChanged:L});case Ue.a.Extract:return d.createElement(ne,{ref:ce,viewerRef:_,onSave:k,onClose:he});default:return}},[i,H,r,l,C,Y,ye,me,fe,_e,L,_,k,he]),De=d.useMemo(function(){return T&&(i===Ue.a.Edit||i===Ue.a.Extract)},[T,i]),Ie=d.useMemo(function(){return De&&o?o-46:o},[o,De]);return d.createElement(x.a,{eventBus:ae.current,pdfViewer:ie,annotMode:null==W?void 0:W.mode},d.createElement("div",{className:"root_72829470",ref:re,tabIndex:0,"aria-label":r},De&&Se(),B&&d.createElement(h.a,{styles:{itemProgress:{padding:0}}}),d.createElement("div",{className:"mainWrapper_72829470"},d.createElement(Ye,(0,a.q5)({},e,{ref:m,height:Ie,annotParams:W,hasAnnotationPermission:Y,onDocumentLoaded:le,onEditStateChanged:ue,inkingToolbarProps:(null===(n=g.a.features)||void 0===n?void 0:n.enableNewAnnotationBar)?void 0:ye})),B&&d.createElement("div",{className:"saveModal_72829470"}))))});Ze.displayName="PdfViewerAppRenderer";var $e=d.forwardRef(function(e,t){var n=d.useRef(null),i=d.useRef(null),r=d.useRef(null);return d.useImperativeHandle(t,function(){return{getViewer:function(){var e;return(null===(e=i.current)||void 0===e?void 0:e.getViewer())||null},print:function(e,t){return(0,a.yv)(void 0,void 0,void 0,function(){var n;return(0,a.SO)(this,function(a){return[2,null===(n=r.current)||void 0===n?void 0:n.print(e,t)]})})},onMouseMove:function(e){var t;return null===(t=n.current)||void 0===t?void 0:t.getEventHandlers().onMouseMove(e)},getThumbnailView:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getThumbnailView()},getToastOperation:function(){var e;return null===(e=r.current)||void 0===e?void 0:e.getToastOperation()}}}),d.createElement(Ze,(0,a.q5)({},e,{mainRef:n,contentViewerRef:i,controlsRef:r}))});$e.displayName="PdfViewerAppInner";var et=d.forwardRef(function(e,t){var n=function(e){return d.useMemo(function(){var t,n;if(!e)return{appStrings:void 0,contentStrings:void 0,annotBarStrings:void 0};var i={},s={},c={};try{for(var d=(0,a.BW)(Object.entries(e)),l=d.next();!l.done;l=d.next()){var u=(0,a.pM)(l.value,2),f=u[0],p=u[1];(m.includes(f)||r.a.includes(f))&&(i[f]=p),o.includes(f)&&(s[f]=p),r.a.includes(f)&&(c[f]=p)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return{appStrings:i,contentStrings:s,annotBarStrings:c}},[e])}(e.localeStrings),l=n.appStrings,_=n.contentStrings,h=n.annotBarStrings,b=(0,a.pM)(d.useState(),2),g=b[0],v=b[1],y=d.useCallback(function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return e=v,(t=l)?[3,2]:[4,(0,u.b)()];case 1:t=n.sent(),n.label=2;case 2:return e.apply(void 0,[t]),[2]}})})},[l]);d.useEffect(function(){y()},[y]);var S=(0,c.a)(e.theme,e.darkMode);return d.createElement(i.a,{className:"root_58dd2d21",theme:(0,a.q5)({rtl:(0,s.a)()},S)},d.createElement(u.a,{strings:g},d.createElement(f.a,null,d.createElement(p.a,null,d.createElement($e,(0,a.q5)({},e,{contentStrings:_,annotBarStrings:h,ref:t}))))))});et.displayName="PdfViewerAppWithoutKey";var tt=d.forwardRef(function(e,t){return d.createElement(et,(0,a.q5)({key:e.url,ref:t},e))});tt.displayName="PdfViewerApp"}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>o,b:()=>r});var a=n("tslib_538"),i=n("react-lib"),r=i.createContext({}),o=function(e){var t=e.children,n=(0,a.dc)(e,["children"]);return i.createElement(r.Provider,{value:n},t)}}
,(e,t,n)=>{"use strict";e.exports=n(409)}
,(e,t,n)=>{"use strict";n(193);var a=n("react-lib"),i=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;i=r("react.element"),t.Fragment=r("react.fragment")}var o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var a,r={},d=null,l=null;for(a in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,a)&&!c.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:i,type:e,key:d,ref:l,props:r,_owner:o.current}}t.jsx=d,t.jsxs=d}
,,,,(e,t,n)=>{"use strict";n.r(t),n.d(t,{saveCommandKey:()=>s});var a=n("odsp.util_152"),i=n(100),r={actionProvider:n(323).a},o="saveCommand",s=new a.aF({name:"SaveCommand",factory:{dependencies:r,create:function(e){var t=e.actionProvider;return{instance:{id:o,name:i.Db,title:i.Ib,automationId:o,iconProps:{iconName:"Save"},evaluateAction:t.evaluateAction}}}}})}
,(e,t,n)=>{"use strict";e.exports=n(178)}
,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>ue,b:()=>ce});var a=n("tslib_538"),i=n("odsp.util_152"),r=n(128),o=[".accessToken",".callerStack",".correlationId",".driveAccessToken",".driveAccessTokenV21",".driveAccessCode",".driveAccessCodeV21",".driveUrl",".mediaBaseUrl",".officeBundleGenerate",".officeBundleGetFragment",".pdfConversionUrl",".pushChannelBaseUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl"];function s(e){var t={},n=e.ListSchema;if(n)for(var a=0,i=o;a<i.length;a++){var r=i[a],s=n[r];s&&".mediaBaseUrl"===r&&(s=s.replace("https://media.cloudapp.net",window.__mediaBaseUrl||"https://northcentralus1-medias.svc.ms")),t[r]=s}return t}var c=n(429),d=n(230),l=n(231),u=n(441),f=n(442),p=n(140),m=n(238),_=n(239),h=n(94),b=n(443),g=n(129),v=n(401),y=n(181),S=n(142),D=n(447),I=n(450),x=[".docm",".dotm",".dotx",".docx",".bmp",".jpg",".jpeg",".tiff",".tif",".png",".gif",".emf",".wmf",".psd",".svg",".ai",".pdf",".pptm",".pptx",".potm",".potx",".ppsm",".ppsx",".xlsm",".xlsx",".aspx"];function C(e){return!!e&&x.indexOf(e.toLowerCase())>=0}var O=n(240),w=n(95),E=n(7),A=n(451),L=n(55),k=n(143),M=n(21),P=n(121),T=n(49),U=n(40),F=n(5),H=n(54),R=n(452),N=n(241),B=n(12),j=n(137),V=!i.x9.isActivated("b8f99452-1739-40bb-a1bb-dd8b65e27ec6","07/13/2024","Fix image preview of remote item in Gallatin"),z=[".dcm",".dcm30",".dic",".dicm",".dicom"];function G(e){var t=(0,u.a)(e),n=t.endpoint,a=t.driveId,i=t.itemId;if(n)return{endpoint:n,driveId:a,itemId:void 0===i?"root":i}}function K(e){var t,n,i,r=e.pageContext,o=e.spItemIdentity,s=e.itemFromServer,c=e.oneUpUrlDataSource,d=e.navigation,l=e.itemUrlHelper,u=e.rootItemSet;if(u)n=function(e){var t,n=e.rootItemSet;return e.oneUpUrlDataSource.getKey(((t={})[U.a.queryTypeParamKey]=n.queryType,t))}({oneUpUrlDataSource:c,rootItemSet:u});else{var f=void 0;s&&(f=s.FileRef||s.ServerRelativeUrl),o&&(t=function(e){var t,n,i=e.spItemIdentity,r=e.folderPath,o=e.newTargetListViewUrl,s=e.itemUrlHelper,c=e.supportsOnePageNavigation,d=e.itemQueryParams,l=e.searchParams,u=e.oneUpUrlDataSource,f=(0,a.dc)(e,["spItemIdentity","folderPath","newTargetListViewUrl","itemUrlHelper","supportsOnePageNavigation","itemQueryParams","searchParams","oneUpUrlDataSource"]),p=s.getUrlParts({webUrl:i.webAbsoluteUrl,listUrl:i.listFullUrl,path:r||i.rootFolder});if(i.itemId&&!r)return{key:void 0,id:void 0};var m=!0;return c&&o&&!f.listUrl&&p.normalizedListUrl&&o.indexOf(p.normalizedListUrl)>-1&&(m=!1),{key:u.getKey((0,a.q5)((0,a.q5)((0,a.q5)((t={},t[U.a.idParamKey]=p.serverRelativeItemUrl||"",t),m&&p.normalizedListUrl?(n={},n[U.a.listUrlKey]=p.normalizedListUrl,n):{}),d||{}),l||{})),id:p.serverRelativeItemUrl||""}}({spItemIdentity:o,oneUpUrlDataSource:c,folderPath:f,itemUrlHelper:l,listUrl:r.listUrl,viewParams:d.viewParams}),n=t.key,i=t.id)}return{key:n,viewParams:d.viewParams,id:i}}function W(e){var t,n=e.itemFromServer,a=e.extension,i=e.mediaServiceFastMetadata,r=e.blockDownload,o=e.microServiceDataSource,s={fileExtension:e.extension,item:n,mediaServiceMetadata:i};if(t=r&&(0,m.b)(a)?o.getPassthroughUrl(s):o.getPdfConversionUrl(s))return{url:t}}function q(e){if(e&&"{}"!==e)try{return JSON.parse(e)}catch(e){return}}function Q(e){var t,n=e.siteId,a=e.webId,i=e.docId,r=e.webUrl,o=e.layoutsUrl,s=function(e){return r+"/"+o+"/getpreview.ashx?clientType=docLibGrid&guidFile="+i+"&guidSite="+n+"&guidWeb="+a+(e?"":"&resolution=Width1024")};return i&&(t={url:s(!1),width:0,height:0,getAligned:function(e,t){return{url:s(t.name===v.a.name),width:0,height:0}}}),t}function Y(e){return void 0!==e?e/1e4:NaN}function J(e){if(!e)return{};var t,n,a,r,o,s=e[".driveAccessTokenV21"],c=void 0===s?void 0:s,d=e[".driveAccessToken"],l=void 0===d?void 0:d,u=e[".driveUrl"],f=void 0===u?void 0:u,m=e[".driveUrlV21"],_=void 0===m?void 0:m,h=e[".driveAccessCode"],b=void 0===h?void 0:h,g=e[".driveAccessCodeV21"],v=void 0===g?void 0:g,S=!i.x9.isActivated("a6323fd0-da2e-4e48-a04c-b28869207ec4","07/03/2024","Add MeTA PAC tokens (driveAccessCode and driveAccessCodeV21) to sessionToken");return l&&(t={accessToken:(r=(0,y.a)(l)).access_token,proofToken:r.prooftoken,tokenUrl:f},S&&b&&(t.metaPac=b),f&&(o=G(f))&&(a=o.driveId)),c&&(n={accessToken:(r=(0,y.a)(c)).access_token,proofToken:r.prooftoken,tokenUrl:_},S&&v&&(n.metaPac=v),_&&!a&&(o=G(_))&&(a=o.driveId)),t&&(0,p.a)({authToken:t.accessToken,proofToken:t.proofToken})&&(t=void 0),n&&(0,p.a)({authToken:n.accessToken,proofToken:n.proofToken})&&(n=void 0),{driveId:a,sessionToken:t,sessionTokenV21:n}}var X=new i.aF({name:"ProcessOneUpItem",factory:{dependencies:{pageContext:F.a,oneUpUrlDataSource:l.a,microServiceDataSource:P.a,navigation:T.a,itemUrlHelper:M.c},create:function(e){var t=e.pageContext,n=e.oneUpUrlDataSource,o=e.microServiceDataSource,s=e.navigation,c=e.itemUrlHelper;return{instance:{processOneUpItem:function(e){return e.microServiceDataSource||delete e.microServiceDataSource,function(e){var t,n=e.pageContext,o=e.itemFromServer,s=e.mediaTransformListSchema,c=e.microServiceDataSource,l=e.itemUrlHelper,u=e.oneUpUrlDataSource,p=e.spItemIdentity,m=e.spParentItemIdentity,v=e.navigation,y=e.listContext,x=e.currentPageContext,M=n.listBaseTemplate,P=K({pageContext:n,spItemIdentity:p,itemFromServer:o,oneUpUrlDataSource:u,navigation:v,itemUrlHelper:l}),T=P.key,F={key:T||"",id:P.id};if(m){var X=K({pageContext:n,spItemIdentity:m,itemFromServer:o,oneUpUrlDataSource:u,navigation:v,itemUrlHelper:l}).key;X&&(F.parentKey=X)}var Z=J(s),$=Z.sessionToken,ee=Z.sessionTokenV21;if(F.graph={itemId:"",driveId:"",sessionToken:$,sessionTokenV21:ee},o){var te=o[".spItemUrl"],ne=te?G(te):void 0;if(ne){var ae=ne.itemId,ie=ne.driveId;F.itemId=ae,F.graph=(0,a.q5)((0,a.q5)({},F.graph),{itemId:ae||"",driveId:ie||""})}var re=o.PermMask?(0,b.a)(o.PermMask):void 0;re&&(F.permissions=re),F.displayName=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=void 0===n?g.a.documentLibrary:n,i=a&&(0,r.d)(a)||a===g.a.promotedLinks||(0,r.c)(a)?t.Title:t.FileLeafRef;return a===g.a.links&&(i=t["URL.desc"]||t.URL||i),i}({itemFromServer:o,listTemplateType:M});var oe=function(e){var t=e.File_x0020_Type,n=e.FileLeafRef,a=e.FileRef,i=e.RemoteItem,r=t&&!i?"."+t:"",o=n||a&&new E.a(a).segments.slice(-1)[0]||"",s=r&&o?o.toLowerCase().lastIndexOf(r.toLowerCase()):-1;return{name:s>-1?o.substring(0,s):o,extension:r}}(o),se=oe.name,ce=oe.extension;F.name=se,F.extension=ce;var de=Number(o.File_x0020_Size)||Number(o.FileSizeDisplay)||void 0;if(void 0!==de&&(F.size=de),F.totalSize=Number(o.SMTotalSize)||void 0,(0,B._)()){var le="Created_x0020_Date"in o,ue=null===(t=o.Created_x0020_Date)||void 0===t?void 0:t.split(";#").pop();if(le&&ue){var fe=new Date(ue).getTime();if(!isNaN(fe)){F.dateCreatedTime=new Date(fe);var pe=L.a.language||window.navigator.language;F.dateCreated=(0,D.c)(F.dateCreatedTime,pe)}}}var me="Modified."in o,_e=o["Modified."];if(me&&_e){var he=new Date(_e).getTime();isNaN(he)||(F.dateModifiedTime=new Date(he),pe=L.a.language||window.navigator.language,F.dateModified=(0,D.c)(F.dateModifiedTime,pe))}F.contentTypeId=o.ContentTypeId;var be=q(o.MediaServiceFastMetadata),ge=q(o.MediaServiceMetadata),ve=(0,N.a)()?{isTempAuthDeprecationEnabled:!0}:void 0,ye=function(e){var t=e.itemFromServer,n=e.extension,a=e.microServiceDataSource;if(e.pageContext.isSPO){var i=a.getFbxConversionUrl({fileExtension:n,item:t}),r=(0,_.b)(n)||!1;if(i||r)return{canConvert:!0,canRenderNative:r,conversionUrl:i&&i.replace("/bxf?","/glb?")}}}({pageContext:n,itemFromServer:o,extension:ce,microServiceDataSource:c});ye&&(F.model3d=ye);var Se=re&&H.a.hasPermission(re,H.a.openItems),De=W({itemFromServer:o,extension:ce,mediaServiceFastMetadata:be,blockDownload:n.blockDownloadsExperienceEnabled||n.viewOnlyExperienceEnabled||!Se,microServiceDataSource:c});De&&(F.pdfConversion=De);var Ie=function(e){var t=e.itemFromServer,n=e.listTemplateType,a=e.mediaServiceFastMetadata,i=e.hasPdfConversion,o=e.has3d,s=d.a.Unknown;if(t.folder)s=d.a.Folder;else if("1"===t.FSObjType||t.RemoteItem){var c=t["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],l=t["File_x0020_Type.mapapp"];s=l&&"onenote"===l.substring(0,7)||c&&-1!==c.indexOf("onenote")?d.a.OneNote:d.a.Folder}if(s===d.a.Unknown){var u=t.File_x0020_Type,f=u?".".concat(u):"";if(u&&A.a.isShortcutFileType(u))return d.a.Shortcut;if("pdf"===u||i)return d.a.Media;if(o)return d.a.Media;if("audio"===(0,S.a)(f))return d.a.Media;if(a)return d.a.Media;if((s=(0,S.c)(f))===d.a.Unknown)return void 0!==n&&(0,r.d)(n)?d.a.File:n===g.a.promotedLinks?d.a.Media:s}return s||d.a.File}({itemFromServer:o,mediaServiceFastMetadata:be,listTemplateType:M,hasPdfConversion:!!W({itemFromServer:o,extension:ce,mediaServiceFastMetadata:be,blockDownload:!0,microServiceDataSource:c}),has3d:!!ye});if((((0,B.qb)()?C(ce):(0,I.a)(ce))||".ai"===ce||".eps"===ce||".psd"===ce)&&c.getThumbnail({fileExtension:ce,item:o,itemKey:T||"",mediaServiceMetadata:be},ve)&&(Ie=d.a.Media),f.b(ce)?F.htmlConversion={}:f.a(ce)&&(xe=c.getHtmlConversionUrl({fileExtension:ce,item:o,mediaServiceMetadata:be},ve))&&(Ie=d.a.Media,F.htmlConversion={url:"".concat(xe,"&inlineImages=true")}),".zip"===ce||".rar"===ce){var xe=c.getZipMetaDataUrl({fileExtension:ce,item:o,mediaServiceMetadata:be},ve),Ce=c.getDownloadZipContentsUrl(o);xe&&Ce&&(Ie=d.a.Media,F.zip={zipMetaDataUrl:xe,downloadZipContentsUrl:Ce})}var Oe=be&&be.video,we=".ts"===ce&&void 0!==de&&de<1<<19&&!Oe;we&&(Ie=d.a.File);var Ee=void 0,Ae={},Le=c.getDownloadAsZipUrl(o),ke=c.getImmersiveReaderUrl({fileExtension:ce,item:o}),Me=u.getKeyParams(T),Pe=l.getUrlParts({path:o.id||o.FileRef||o.ServerRelativeUrl,listUrl:Me[U.a.listUrlKey]}),Te=Pe.fullItemUrl,Ue=Te?w.a(Te):void 0;Le&&(Ae[h.b.downloadAsZip]=Le),ke&&(Ae[h.b.immersiveReaderUrl]=ke),te&&(Ae[h.b.itemUrl]=te);var Fe=o["serverurl.progid"];(Fe=Fe?Fe.substring(1):M===g.a.links?o.URL:Ue)&&(Ae[h.b.original]=Fe),A.a.isShortcutItem({key:T||"",extension:ce})&&(Ie=d.a.Shortcut,F.shortcutInfo={shortcutLinkRewritten:!0},o._ShortcutUrl&&(Ae[h.b.shortcutTarget]=o._ShortcutUrl),o._ShortcutUniqueId&&(Ee=Q({siteId:o._ShortcutSiteId,webId:o._ShortcutWebId,docId:o._ShortcutUniqueId,webUrl:n.webAbsoluteUrl,layoutsUrl:n.layoutsUrl}))),Fe&&(Ae[h.b.open]=Fe);var He=o["File_x0020_Type.mapapp"];He||(He=o["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"])&&(He=He.split("|").slice(-1).join()),F.appMap=He,Ee||(Ee=function(e){if(e.type!==d.a.Folder){var t=e.itemFromServer;if(void 0!==e.listTemplateType&&(0,r.e)(e.listTemplateType))return{url:t.BackgroundImageLocation||"",width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===g.a.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata},{isTempAuthDeprecationEnabled:(0,N.a)()});if(n)return n;var a=e.pageContext,i=e.currentPageContext;if(((0,B.qb)()?C(e.extension):(0,I.a)(e.extension))&&a){var o=a.siteId,s=a.webId,c=a.webAbsoluteUrl,l=a.layoutsUrl;return Q({siteId:V&&(null==i?void 0:i.siteId)||o,webId:V&&(null==i?void 0:i.webId)||s,docId:t.UniqueId,webUrl:c,layoutsUrl:l})}}}({itemFromServer:o,listTemplateType:M,extension:ce,key:T||"",type:Ie,mediaServiceFastMetadata:be,microServiceDataSource:c,pageContext:n,currentPageContext:x})),F.openUrl=Fe,F.downloadUrl=o[".downloadUrl"]||void 0,F.downloadUrlNoAuth=o[".downloadUrlNoAuth"]||void 0,F.itemGeneratedTimeStamp=Date.now();var Re=o["IconOverlay.mapoly"];if(Re&&(F.overlayUrl="/"+n.layoutsUrl+"/images/"+Re),Ee&&(F.thumbnail=Ee),Ie===d.a.Folder){F.childCount=function(e){var t=e.FolderChildCount,n=e.ItemChildCount,a=e.RemoteItem;if(a)return JSON.parse(a).FolderChildCount;var i=n?parseInt(n,10):NaN,r=t?parseInt(t,10):NaN;return isNaN(i)&&isNaN(r)?void 0:isNaN(i)?r:isNaN(r)?i:i+r}(o);var Ne=Number(o.SMTotalFileCount);F.folder={totalCount:Ne>0?Ne:F.childCount,childCount:F.childCount}}var Be=o.ServerRedirectedEmbedUrl;Be&&(l.getUrlParts({path:Be}).isCrossDomain||(F.previewIFrameUrl=Be)),F.type=Ie;var je=o.ID,Ve=o.UniqueId,ze={};for(var Ge in ze.uniqueId=(0,i.VO)(Ve),ze.ID=je,o)o.hasOwnProperty(Ge)&&(ze[Ge]=o[Ge]);F.properties=ze;var Ke="ms-excel"===He,We="ms-powerpoint"===He,qe="ms-visio"===He,Qe="ms-word"===He,Ye=!0;if((0,B.tc)()&&ce){var Je=k.b[ce.replace(/^\./,"")];Ye=!!Je&&(Je===k.f||Je===k.c||Je===k.d||Je===k.e)}if(Fe&&(Qe||Ke||We||qe)&&Ye){var Xe=function(e){var t=e.isWord,n=e.extension,a=e.isPowerPoint,i=e.itemFromServer,r=e.microServiceDataSource,o=e.mediaServiceFastMetadata;if(!e.itemUrlParts.isCrossDomain){var s,c,d,l=t||a,u=(t||a?r.getOfficeBundleGenerateUrl({fileExtension:n,item:i,mediaServiceMetadata:o}):"")||"",f=r.getOfficeBundleGetFragmentUrl({fileExtension:n,item:i,mediaServiceMetadata:o})||"",p=!1,m="",_=i[".ctag"],h=o&&o.officeBundle;return h&&(s=h.ctag,d=h.version,p=h.fatalError||!1,h.generationTime&&(c=new Date(h.generationTime)),m=h.errorInfo||""),{officeBundleGenerateUrl:u,officeBundleGetFragmentUrl:f,bundleCTag:s||"",bundleVersion:d||"",hasBundleGenerationFailed:p,bundleErrorInfo:m,generationTime:c,cTag:_||"",enableDefaultClick:l}}}({isWord:Qe,extension:ce,itemUrlParts:Pe,isPowerPoint:We,itemFromServer:o,microServiceDataSource:c,mediaServiceFastMetadata:be});if(Xe&&!qe&&(F.officeBundle=Xe),Xe&&(Qe||We)){var Ze=c.getPdfConversionUrl({fileExtension:ce,item:o,mediaServiceMetadata:be},!0);Ze&&(Ae[h.b.viewInBrowser]=Ze)}F.wopiFrameUrl=Fe}var $e=c.getVideoUrl({fileExtension:ce,item:o,mediaServiceMetadata:be});$e&&(Ae[h.b.video]=$e);var et=c.getMediaBaseUrl({fileExtension:ce,item:o,mediaServiceMetadata:be});et&&(Ae[h.b.mediaBaseUrl]=et);var tt=c.getThumbnailSpriteBaseUrl({fileExtension:ce,item:o});tt&&(Ae[h.b.thumbnailSpriteBaseUrl]=tt),F.urls=Ae;var nt=void 0,at=z.indexOf(ce)>=0,it=void 0,rt=void 0,ot=void 0,st=void 0,ct=void 0;if(Ie===d.a.Folder)nt=!!o.ProgId&&"sharepoint.documentset"===o.ProgId.toLowerCase(),F.isDocSet=nt;else if(Ie!==d.a.Media&&!be||void 0!==M&&(0,r.e)(M))Ie===d.a.File&&y&&void 0!==y.isDocLib&&!y.isDocLib&&(ct={});else{var dt=S.a(ce),lt=be&&be.photo||(at||"photo"===dt?{}:void 0),ut=Oe||("video"===dt?{}:void 0),ft=be&&be.audio||("audio"===dt?{}:void 0);lt&&(it={originalUrl:"photo"===dt?Ue:void 0,width:lt.width||0,height:lt.height||0},ne&&ne.itemId&&(rt=function(e){var t,n=e.itemFromServer,a=e.mediaServiceFastMetadata,i=e.photoMetadata,r=e.fullMediaServiceMetadata,o=a&&a.panorama,s=!1;if(o&&"equirectangular"===o.projectionType?(t={projectionType:o.projectionType},s=!0):n.FileLeafRef&&-1!==n.FileLeafRef.indexOf(".360")?t={projectionType:"equirectangular"}:void 0!==i.width&&i.width>0&&void 0!==i.height&&i.height>0&&i.width/i.height==2&&(s=!0),s&&r){var c=r.panorama;if(c)t={projectionType:o&&o.projectionType||void 0,croppedAreaImageHeightPixels:c.croppedAreaImageHeightPixels||void 0,croppedAreaImageWidthPixels:c.croppedAreaImageWidthPixels||void 0,croppedAreaLeftPixels:c.croppedAreaLeftPixels||void 0,croppedAreaTopPixels:c.croppedAreaTopPixels||void 0,fullPanoHeightPixels:c.fullPanoHeightPixels||void 0,fullPanoWidthPixels:c.fullPanoWidthPixels||void 0,initialHorizontalFOVDegrees:c.initialHorizontalFOVDegrees||void 0,initialVerticalFOVDegrees:c.initialVerticalFOVDegrees||void 0,initialViewHeadingDegrees:c.initialViewHeadingDegrees||void 0,initialViewPitchDegrees:c.initialViewPitchDegrees||void 0,initialViewRollDegrees:c.initialViewRollDegrees||void 0,poseHeadingDegrees:c.poseHeadingDegrees||void 0,posePitchDegrees:c.posePitchDegrees||void 0,poseRollDegrees:c.poseRollDegrees||void 0};else{var d=r.photo;if(d&&d.cameraModel){var l=d.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(l)>=0&&(t={projectionType:"equirectangular"})}}}return t}({itemFromServer:o,mediaServiceFastMetadata:be,photoMetadata:lt,fullMediaServiceMetadata:ge})));var pt={mediaEdits:o.Edits?JSON.parse(o.Edits):void 0,previewThumbnailsQualitySets:!i.x9.isActivated("96f75f66-17fb-4071-9322-86e0db732994","07/04/2024","Get preview thumbnails information from RLDAS infromation for Seek bar thumbnails.")&&o.PreviewThumbnailsQualitySets?JSON.parse(o.PreviewThumbnailsQualitySets):void 0};F.media=pt;var mt=be&&be.media;if(ut){var _t=i.x9.isActivated("f0fc3265-1fce-4d4a-b67a-3b3dfa291a6f","09/27/2023","Get PremiumProcessingStatus from RLDAS for Premium Video in 1P 1.0")?void 0:ut.premiumProcessingStatus;ot={fourCC:ut.fourCC||(".mp4"===ce.toLowerCase()?"H264":void 0),bitrate:ut.encodingBitrate,width:ut.frameWidth||0,height:ut.frameHeight||0,duration:Y(mt&&mt.duration),audioFormat:ft&&ft.format,manifestMetadata:ut.manifestMetadata,altManifestMetadata:ut.altManifestMetadata,premiumProcessingStatus:_t}}ft&&(st={duration:Y(mt&&mt.duration)})}F.photo=it,F.image360=rt,F.video=ot,F.audio=st;var ht,bt=!n||"21"===n.webTemplate&&700===n.listBaseTemplate;ht=Number(o.PrincipalCount)>0?O.a.Shared:void 0===o.PrincipalCount?bt?void 0:O.a.Unknown:O.a.Private,F.sharingType=ht;var gt=S.b({extension:ce,isDocSet:nt,listItem:ct,sharingType:ht,type:Ie,textEditorMimeType:we?"text/typescript":void 0,panorama:rt,isMountPoint:!!o.RemoteItem});F.iconName=gt,F.isPlaceholder=!F.displayName&&!F.permissions;var vt=function(e){return{isMalwareDetected:(0,R.a)(e),isNew:(0,R.b)(e)}}(o);if(vt&&(F.lifeCycleStatus=vt),(0,j.a)()&&o[".mainLinkInfo"])try{F.mainLinkInfo=JSON.parse(o[".mainLinkInfo"])}catch(e){}}return F}((0,a.q5)({pageContext:t,oneUpUrlDataSource:n,microServiceDataSource:o,navigation:s,itemUrlHelper:c},e))},processOneUpListRootItem:function(e){return function(e){var t=e.pageContext,n=e.oneUpListInfo,a=e.itemUrlHelper,i=e.oneUpUrlDataSource,r=K({pageContext:t,spItemIdentity:e.spItemIdentity,oneUpUrlDataSource:i,navigation:e.navigation,itemUrlHelper:a}),o={key:r.key||"",id:r.id},s=n.mediaTransform,c=n.list,l=n.permissions,u=J(s),f=u.sessionToken,p=u.sessionTokenV21,m=u.driveId;return o.itemId=o.itemId||"root",o.graph={itemId:"root",driveId:m||"",sessionToken:f,sessionTokenV21:p},o.name=o.name||c.title,o.displayName=o.displayName||c.title,o.type=d.a.Folder,o.isRootFolder=!0,o.folder={},o.list=c,o.permissions=l,o}((0,a.q5)({pageContext:t,oneUpUrlDataSource:n,microServiceDataSource:o,navigation:s,itemUrlHelper:c},e))}}}}}}),Z=n(71),$=n(3),ee=n(431),te=n(134),ne=n(56);const ae=function(){function e(){this._pageContextMap=new Map}return e.prototype.add=function(e,t){this._pageContextMap.set(JSON.stringify(e),t)},e.prototype.get=function(e){return this._pageContextMap.get(JSON.stringify(e))},e}();var ie=n(745),re=n(454),oe=n(746),se=!i.x9.isActivated("cc69c4e8-4b22-45b5-9f19-caec58f399d7","04/30/2024","if url is not right, log url for ppe ");function ce(e){var t;try{var r=(0,re.a)(e),o=r.idViewParam,c=r.parentViewParam,d=r.parentViewViewParam,l=r.listUrlViewParam,f=r.viewViewParam,p=r.webAbsoluteUrl,m=r.fullListUrl,_=r.serverRelativeFocusItemUrl,h=r.serverRelativeParentUrl,g=r.listContext,v=r.pageContext,y=new $.a({name:te.h}),S=o&&_&&(c||l||d),D=(c||d)&&(o||l||f),I=!!se&&"spdf"===(null===(t=v.cloudType)||void 0===t?void 0:t.toLowerCase());if((0,B.hb)()?D:S)if(p&&m){var x=e.consume(oe.a),C=o?_:void 0,O=new $.a({name:te.l});x.getCurrentItem().then(function(t){if((0,B.Ob)()&&t&&t.BasePermissions&&!1===t.BasePermissions.OpenItems&&e.consume(ne.e).updateIsNoAccessScenarioState("fastOneUpAdapter",!0),t&&t.ListData&&t.ListData.Row&&t.ListData.Row.length>0&&t.ListSchema){e.consume(P.a).setBaseInfo({data:t.ListSchema,allowCookies:!1});var r=t.PageContextInfo?JSON.parse(t.PageContextInfo):void 0;if(r&&e.consume(ne.e).setSiteHidePeoplePreviewingFiles("fastOneUpAdapter",!!(null==r?void 0:r.hidePeoplePreviewingFiles)),(0,B.hb)()&&!C&&m){var o={focusItem:D=le({spGetFocusItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e}),parentItem:D,focusItemSet:[D],list:D,currentIndex:0};(l=e.consume(Z.b)).update(o,"fastOneUpRLDS"),y.end({resultType:$.b.Success})}else if(v){var c=(0,ee.a)({response:t,id:_,listContext:g,qosEvent:O});if(c.resultType===$.b.Success)try{var d=de({spGetItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e,currentPageContext:r});if(d){var l=e.consume(Z.b),f=t.ListData&&t.ListData.Row&&t.ListData.Row[0];f&&(function(e,t){return(0,a.yv)(this,void 0,void 0,function(){var i,r,o=this;return(0,a.SO)(this,function(s){return(0,B.wb)(B.ib)&&(i=new $.a({name:te.k}),r=function(){return(0,a.yv)(o,void 0,void 0,function(){return(0,a.SO)(this,function(a){switch(a.label){case 0:return[4,n.e(17).then(n.bind(n,668)).then(function(n){var a=n.favoritesDataManagerKey,r=e.consume(a);return r.populateFavorites().then(function(n){var a=null==t?void 0:t.UniqueId;if(a&&-1!==a.indexOf("{")&&(a=a.replace("{","").replace("}","").toLowerCase()),i.end({resultType:$.b.Success}),n&&a){var o=r.isFavorited(a);return e.consume(ne.e).setIsFocusItemFavorited("fastoneUpAdapater",o),o}}).catch(function(e){i.end({resultType:$.b.Failure,error:e.message,extraData:{rawError:e}})})}).catch(function(e){i.end({resultType:$.b.Failure,error:e.message,extraData:{rawError:e}})})];case 1:return[2,a.sent()]}})})},r().catch(function(e){i.end({resultType:$.b.Failure,error:e.message,extraData:{rawError:e}})})),[2]})})}(e,f).catch(function(e){}),function(e){return(0,a.yv)(this,void 0,void 0,function(){var t;return(0,a.SO)(this,function(n){switch(n.label){case 0:return[4,e.consumeAsync(ie.a)];case 1:return[4,n.sent().hasValidLicenseCached()];case 2:return t=n.sent(),e.consume(ne.e).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",t),[2]}})})}(e).catch(function(e){}));var S=function(e){var t,n,i=e.resourceScope,r=e.focusItemResponse,o=(0,re.a)(i),c=o.webAbsoluteUrl,d=o.fullListUrl,l=o.isRootFolder,f=o.listContext,p=o.serverRelativeParentUrl,m={key:"",isPlaceholder:!0},_=i.consume(X);if(c&&d)if(l&&r){var h={listFullUrl:d,rootFolder:"",webAbsoluteUrl:c},g=s(r),v=_.processOneUpItem({itemFromServer:void 0,spItemIdentity:h,listContext:f,mediaTransformListSchema:g}),y=r.ListData,S=(y||{}).FolderPermissions,D=void 0;S&&(D=(0,b.a)(S));var I=void 0,x="root",C=y&&y.Row&&y.Row[0];C&&C[".spItemUrl"]&&(I=(0,u.a)(C[".spItemUrl"]).driveId),(m=(0,a.q5)((0,a.q5)((0,a.q5)((0,a.q5)((0,a.q5)({},v),{itemId:x}),I?{graph:{itemId:x,driveId:I,sessionToken:null===(t=v.graph)||void 0===t?void 0:t.sessionToken,sessionTokenV21:null===(n=v.graph)||void 0===n?void 0:n.sessionTokenV21}}:{}),{folder:{}}),D?{permissions:D}:{})).isPlaceholder=!1}else g=s(r),v=_.processOneUpItem({itemFromServer:void 0,spItemIdentity:{itemId:"",listFullUrl:d,webAbsoluteUrl:c,rootFolder:p},listContext:f,mediaTransformListSchema:g}),m=(0,a.q5)((0,a.q5)({},v),{isPlaceholder:!0});return m}({resourceScope:e,focusItemResponse:t}),D=le({spGetFocusItemResponse:t,webAbsoluteUrl:p,listFullUrl:m,listContext:g,parentFolderPath:h,resourceScope:e}),I=l.pageContexts;if(r){var x={webAbsoluteUrl:r.webAbsoluteUrl,listUrl:r.listUrl};I?I.add(x,r):(I=new ae).add(x,r)}o={focusItem:d,focusItemSet:[d],parentItem:S,list:D,currentIndex:0,appLevelPageContext:e.consume(F.a),pageContexts:I},l.update(o,"fastOneUpRLDS"),y.end({resultType:$.b.Success})}else y.end({resultType:$.b.Failure,error:"missing focusItem"}),fe(e,new i.qt({code:"FastOneUp-NoFocusItem"}))}catch(t){y.end({resultType:$.b.Failure,error:t.message}),fe(e,new i.qt({code:"FastOneUp-getOneUpItemException",innerError:t}))}else y.end(c),O.end(c),fe(e,new i.qt({code:c.resultCode,extraData:c.extraData}))}else{var w="noPageContext";y.end({resultType:$.b.Failure,error:w}),O.end({resultType:$.b.Failure,error:w}),fe(e,new i.qt({code:"FastOneUp-noPageContext"}))}}else w="no Row Data from RLDS",y.end({resultType:$.b.Failure,error:w}),O.end({resultType:$.b.Failure,error:w}),fe(e,new i.qt({code:"FastOneUp-NoRowData"}))}).catch(function(t){y.end({resultType:$.b.Failure,error:t.message}),O.end({resultType:$.b.Failure,error:t.message}),fe(e,new i.qt({code:"FastOneUp-getSingleItemException",innerError:t}))})}else p?m||(y.end({resultType:$.b.Failure,error:"no listFullUrl"}),fe(e,new i.qt({code:"FastOneUp-noListFullUrl"}))):(y.end({resultType:$.b.Failure,error:"no webAbsoluteUrl"}),fe(e,new i.qt({code:"FastOneUp-noWebAbsoluteUrl"})));else y.end({resultType:$.b.Failure,error:"no id, parent, parentview or listurl"}),fe(e,c||d?new i.qt({code:"FastOneUp-noIdOrListurl",extraData:{url:I?window.location.href:void 0}}):new i.qt({code:"FastOneUp-noParent",extraData:{url:I?window.location.href:void 0}}))}catch(t){fe(e,new i.qt({code:"FastOneUp-useAdapterException",innerError:t}))}}function de(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,a=e.listContext,i=e.parentFolderPath,r=e.resourceScope,o=e.spGetItemResponse,c=e.currentPageContext,d=o.ListData&&o.ListData.Row&&o.ListData.Row[0];if(d){var l={itemId:d.ID,listFullUrl:n,rootFolder:"",webAbsoluteUrl:t},u=i?{itemId:"",listFullUrl:n,rootFolder:i,webAbsoluteUrl:t}:void 0,f=r.consume(X),p=s(o);return f.processOneUpItem({itemFromServer:d,spItemIdentity:l,spParentItemIdentity:u,listContext:a,mediaTransformListSchema:p,currentPageContext:c})}}function le(e){var t,n,a,o,c,d,l,u,f,p,m,_,h,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H=e.webAbsoluteUrl,R=e.listFullUrl,N=e.listContext,B=e.resourceScope,j=e.spGetFocusItemResponse,V=j.ListData&&j.ListData.Row&&j.ListData.Row[0],z=B.consume(X),G=j&&s(j),K=V&&V.PermMask?(0,b.a)(V.PermMask):void 0;if(j&&K){var W={list:(t=j,n=t.AllowGridMode,a=t.DisableGridEditing,o=t.ListTemplateType,c=t.BasePermissions,d=void 0===c?{}:c,l=d.ManageLists,u=void 0===l?void 0:l,f=d.ManagePersonalViews,p=void 0===f?void 0:f,m=d.OpenItems,_=void 0===m?void 0:m,h=d.UseClientIntegration,g=void 0===h?void 0:h,v=t.ListSchema,y=(void 0===v?{}:v).DefaultItemOpen,S=void 0===y?void 0:y,D=t.ExcludeFromOfflineClient,I=t.WebExcludeFromOfflineClient,x=t.ListData,C=t.listBaseType,O=t.Flags2,w=t.MachineLearningCaptureEnabled,E=t.MachineLearningExperienceEnabled,A=t.AIBuilderEnabled,L=t.AIBuilderDefaultPowerAppsEnvironment,k=t.Color,M=t.Icon,P=t.ListUrl,T=t.listUrlDir,U=P||T&&decodeURIComponent(T),F="string"==typeof S?"0"===S:void 0,{id:(0,i.VO)(t.listName),title:t.ListTitle,flags2:O,machineLearningCaptureEnabled:w,machineLearningExperienceEnabled:E,aiBuilderEnabled:A,aiBuilderDefaultPowerAppsEnvironment:L,allowGridMode:"boolean"!=typeof n||n,allowCreateFolder:t.AllowCreateFolder,disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof a&&a,enableMinorVersions:t.EnableMinorVersions,enableVersions:t.verEnabled,templateType:"string"==typeof o?Number(o):void 0,isDocumentLibrary:(0,r.b)(String(C)),isPromotedLinks:"string"==typeof o?(0,r.e)(o):void 0,isForceCheckout:t.isForceCheckout,isModerated:t.isModerated,enableRequestSignOff:t.EnableRequestSignOff,newWOPIDocumentEnabled:t.NewWOPIDocumentEnabled,newWOPIDocumentTypes:t.NewWOPIDocumentTypes,permissions:{manageLists:u,managePersonalViews:p,openItems:_,useClientIntegration:g},openInClient:F,excludeFromOfflineClient:"boolean"==typeof D||"boolean"==typeof I?D||I:void 0,contentTypesEnabled:t.ContentTypesEnabled,metadataNavFeatureEnabled:t.metadataNavFeatureEnabled,canUserCreateMicrosoftForm:t.canUserCreateMicrosoftForm,itemCount:t.ListSchema&&t.ListSchema.ItemCount,rowLimit:x&&x.RowLimit,canShareLinkForNewDocument:t.CanShareLinkForNewDocument,enableAttachments:"true"===t.EnableAttachments,createdFromExcel:t.CreatedFromExcel,createdFromExisting:t.CreatedFromExisting,icon:"string"==typeof M?Number(M):void 0,color:"string"==typeof k?Number(k):void 0,lastItemModifiedTime:t.lastItemModifiedTime,tick:t.tick,modernListTemplateTypeId:t.ModernListTemplateTypeId,readSecurity:t.ListSchema&&t.ListSchema.ReadSecurity,listUrlDir:U,hasPendingBusinessAppMigration:t.hasPendingBusinessAppMigration,modernTemplatesInfo:void 0!==t.IsModernTemplateLinked?{containsTemplates:t.IsModernTemplateLinked,containsListExclusiveTemplates:t.HasListExclusiveModernTemplates||!1}:void 0}),permissions:K,mediaTransform:G},q={itemId:"",listFullUrl:R,rootFolder:"",webAbsoluteUrl:H};return z.processOneUpListRootItem({spItemIdentity:q,listContext:N,oneUpListInfo:W})}}function ue(e){var t=new $.a({name:te.j}),n=e.consume(ne.e);try{var i=e.consume(Z.b),r=i.getOneUpProperties();if(r&&(!r.parentItem||r.parentItem.isPlaceholder)){var o=(0,re.a)(e),s=o.webAbsoluteUrl,d=o.fullListUrl,l=o.serverRelativeParentUrl,u=o.isRootFolder,f=o.listContext,p=o.pageContext;if(l&&s&&d&&!u){var m={pageContext:p,id:l,webAbsoluteUrl:s,listFullUrl:d,listContext:f};new c.a(m).getSingleItem(!0).then(function(o){if(o&&o.ListData&&o.ListData.Row&&o.ListData.Row.length>0&&o.ListSchema){if(e.consume(P.a).setBaseInfo({data:o.ListSchema,allowCookies:!1}),p&&(0,ee.a)({response:o,id:l||"",listContext:f,qosEvent:t}))try{var c=de({spGetItemResponse:o,webAbsoluteUrl:s,listFullUrl:d,listContext:f,parentFolderPath:void 0,resourceScope:e});c&&(i.update((0,a.q5)((0,a.q5)({},r),{parentItem:c}),"fastOneUpRLDS"),n.updateParentPermissionValidity("ensureParentItem",!0))}catch(e){var u=e instanceof Error?e:new Error(e);t.end({resultType:$.b.Failure,error:u.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}else t.end({resultType:$.b.Failure,error:"no Row Data from RLDS"}),n.updateParentPermissionValidity("ensureParentItem",!1)}).catch(function(e){t.end({resultType:$.b.Failure,error:e.message}),n.updateParentPermissionValidity("ensureParentItem",!1)})}}}catch(e){var _=e instanceof Error?e:new Error(e);t.end({resultType:$.b.Failure,error:_.message}),n.updateParentPermissionValidity("ensureParentItem",!1)}}function fe(e,t,n){var a=e.consume(ne.e);(0,B.Ob)()&&a.currentAppState.isNoAccessScenario?a.updateErrorState("fastOneUpAdapterException",{errorType:te.d.rldsApiErrorNoAccess,error:t,item:void 0,extraData:n}):a.updateErrorState("fastOneUpAdapterException",{errorType:te.d.rldsApiError,error:t,item:void 0,extraData:n})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a,i=n("tslib_538"),r=n(91),o=n(3),s=n(432),c=n(228),d=n(431),l=n(134);!function(e){e.preload="preload",e.callRLDS="callRLDS"}(a||(a={}));var u=function(e){function t(t){var n=e.call(this,{dataSourceName:"OneUpRLDS"},{pageContext:t.pageContext})||this;return n._id=t.id,n._retriever=new s.a({pageContext:t.pageContext}),n._listContext=t.listContext,n._extraLoggingData=t.extraLoggingData,n}return(0,i.e2)(t,e),t.prototype.getSingleItem=function(e){void 0===e&&(e=!1);var t=new o.a({name:l.m,extraData:(0,i.q5)({},this._extraLoggingData)});if(!this._listContext)throw new Error("no listContext");if(!e&&window.g_listData){if(this._id){if((0,d.a)({response:window.g_listData,id:this._id,listContext:this._listContext,qosEvent:t,extraData:{isRace:!1}}).resultType===o.b.Success)return Promise.resolve(window.g_listData);var n=new o.a({name:l.f,extraData:(0,i.q5)({},this._extraLoggingData)});return this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:n,qosName:l.f})}throw new Error("noItemId")}return this._racePrefetchAndRLDSAPI(t).then(function(e){return e.response})},t.prototype._racePrefetchAndRLDSAPI=function(e){var t=this,n=new Promise(function(e,n){window.DeferredListDataComplete=function(){if(!t._id||!window.g_listData)throw new Error("no g_listData");if((0,d.a)({response:window.g_listData,id:t._id,listContext:t._listContext}).resultType!==o.b.Success)throw new Error("incorrect g_listData");e({response:window.g_listData,type:a.preload})}}),r=new o.a({name:l.n,extraData:(0,i.q5)({},this._extraLoggingData)}),s=this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:r,qosName:l.n}).then(function(e){return{response:e,type:a.callRLDS}});return Promise.race([n,s]).then(function(t){return t.type===a.preload?e.end({resultType:o.b.Success,extraData:{isRace:!0}}):t.type===a.callRLDS&&e.end({resultType:o.b.Failure,extraData:{isRace:!0,reason:"callRLDAS wins"}}),t})},t.prototype._getContext=function(){return this._id?{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{disableAutoHyperlink:!1,isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needClientSideComponentManifest:!1,needUpdatePageContext:!0,needsContentTypeOrder:!0,needsContentTypes:!1,needsForms:!1,needsGridInitInfo:!1,needsListAvailableContentTypes:!0,needsMountPoint:!0,needsParentInfo:!0,needsQuickLaunch:!1,needsSchema:!0,needsSpotlight:!0,needsViewMetadata:!0,renderCustomActions:!0,renderSpfxCustomActions:!1,preAuthorizedDownloadUrl:!0,requireDownloadUrlNoAuth:!0,viewXml:c.b({sortField:void 0,itemIds:void 0,itemRefs:[this._id],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0,pageSize:1})}}:{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needsSchema:!0,needUpdatePageContext:!0,needsMountPoint:!0,requireFolderColoringFields:!0,viewXml:c.b({itemIds:void 0,itemRefs:void 0,pageSize:0,recurseInFolders:!0,fieldNames:["File_x0020_Type","FileRef","FileLeafRef","Editor","Author","PrincipalCount","Title"]})}}},t}(r.b)}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_538"),i=n(3),r=n(12);function o(e){var t,n,o,s,c=e.response,d=e.id,l=e.listContext,u=e.qosEvent,f=e.extraData;if(c&&c.ListData&&c.ListData.Row){var p=c.ListData.Row;if(1===p.length){var m=p[0];s=((0,r.bb)()?(null===(t=m.FileRef)||void 0===t?void 0:t.toLowerCase())===d.toLowerCase()&&(null===(n=c.ListUrl)||void 0===n?void 0:n.toLowerCase())===(null===(o=null==l?void 0:l.listUrl)||void 0===o?void 0:o.toLowerCase()):m.FileRef===d&&c.ListUrl===(null==l?void 0:l.listUrl))?{resultType:i.b.Success}:{resultType:i.b.Failure,resultCode:"idFileRefMismatch",extraData:(0,a.q5)((0,a.q5)({},f),{serverFileRef:m.FileRef,fileId:d,serverlistUrl:c.ListUrl,fileListUrl:null==l?void 0:l.listUrl})}}else s={resultType:i.b.Failure,resultCode:"wrongRowDataLength",extraData:(0,a.q5)((0,a.q5)({},f),{rowDataLength:p.length})}}else s={resultType:i.b.Failure,resultCode:"noRowData",extraData:(0,a.q5)({},f)};return null==u||u.end(s),s}}
,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>l});var a=n(21),i=n(40),r=n(49),o=n(5),s=n(7),c=n(12),d=n(455);function l(e){var t,n,l,u,f,p,m=e.consume(r.a),_=e.consume(o.a),h=m.viewParams,b=h[i.b.idParamKey],g=h[i.b.parentIdParamKey],v=h[i.b.parentQueryTypeParamKey],y=h[i.b.queryTypeParamKey],S=h[i.b.listUrlKey];if(!d.a&&(0,c.wb)(c.y)&&window.g_oneUpPathAndQueryString){var D=window.g_oneUpPathAndQueryString,I=new URL(D);if(I.searchParams&&I.searchParams.get("ga")){window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",D);var x=null===(t=I.searchParams)||void 0===t?void 0:t.get("id");x&&(b=x),(x=null===(n=I.searchParams)||void 0===n?void 0:n.get("parent"))&&(g=x),(x=null===(l=I.searchParams)||void 0===l?void 0:l.get("parentview"))&&(v=x),(x=null===(u=I.searchParams)||void 0===u?void 0:u.get("view"))&&(y=x),(x=null===(f=I.searchParams)||void 0===f?void 0:f.get("listurl"))&&(S=x)}}var C=g,O=e.consume(a.c),w=O.getUrlParts({path:b,listUrl:S}),E=w.fullItemUrl?new s.a(w.fullItemUrl):void 0;C?p=O.getUrlParts({path:p,listUrl:S}).fullItemUrl:(p=E?"".concat(E.authority).concat(E.segments.slice(0,-1).join("/")):void 0,C=O.getUrlParts({path:p,listUrl:S}).serverRelativeItemUrl);var A=O.getUrlParts({path:C,listUrl:S}),L=w.fullWebUrl,k=w.fullListUrl,M={listUrl:w.serverRelativeListUrl,needSchema:!0,urlParts:w},P=w.fullItemUrl,T=!(C=A.serverRelativeItemUrl!==A.serverRelativeListUrl&&A.fullItemUrl!==L&&"/"!==A.serverRelativeListUrl&&A.serverRelativeItemUrl||"")||!!C&&k===A.fullItemUrl;return{idViewParam:b,parentViewParam:g,parentViewViewParam:v,listUrlViewParam:S,viewViewParam:y,webAbsoluteUrl:L,fullListUrl:k,serverRelativeListUrl:w.serverRelativeListUrl,fullFocusItemUrl:P,serverRelativeFocusItemUrl:w.serverRelativeItemUrl,fullParentUrl:p,serverRelativeParentUrl:C,isRootFolder:T,listContext:M,pageContext:_}}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=!n("odsp.util_152").x9.isActivated("0A38B402-7796-4743-871F-FFEE5A9F48CF")}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>h,c:()=>_});var a,i=n("odsp.util_152"),r=n(147),o=n(125),s=n(83),c=n(5),d=n(250),l=n(256),u=n(12),f=n(263);!function(e){e.Error="Error",e.WAC="WAC",e.Html="Html",e.MSPdf="MSPdf",e.Pdf="Pdf",e.OnePlayerVideo="OnePlayerVideo",e.OnePlayerAudio="OnePlayerAudio",e.Panorama="Panorama",e.Image360="Image360",e.Zip="Zip",e.ThreeD="3d",e.TextFile="TextFile",e.Photo="Photo",e.Thumbnail="Thumbnail",e.FileHandler="FileHandler",e.Copilot="Copilot",e.Other="Other",e.Unknown="Unknown"}(a||(a={}));var p=[".opus",".url",".mht",".mhtml",".xltx",".xlt",".xltm"],m=[{extension:".opus"},{extension:".url"},{extension:".mht",originalViewer:a.Html},{extension:".mhtml",originalViewer:a.Html},{extension:".xltx",originalViewer:a.WAC},{extension:".xlt",originalViewer:a.WAC},{extension:".xltm",originalViewer:a.WAC}],_=new i.aF({name:"ViewerTypeHelper",factory:{dependencies:{platformDetection:s.a,pdfViewerHelper:d.b,fileHandlerHelper:l.a,pageContext:c.a},create:function(e){var t=e.platformDetection,n=e.pdfViewerHelper,i=e.fileHandlerHelper,s=e.pageContext,c=!t.isMobile;return{instance:{getValidViewerTypes:function(e){var t;if(!e||e.isPlaceholder)return a.Unknown;var d=function(e){if((0,u.Qb)()){if((0,u.Fb)()&&e.extension&&h(e).length>0)return a.Other}else if((0,u.Fb)()&&e.extension&&-1!==p.indexOf(e.extension))return a.Other}(e);return d||(e.error?a.Error:e.folder||e.itemStatus===r.b.ConditionalAccessBlocked||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected||(0,u.Sb)()&&"OneNote.Notebook"===(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.ProgId)?a.Other:e.officeBundle||e.wopiFrameUrl?a.WAC:e.htmlConversion?a.Html:n.isSupportedFileType(e)?a.MSPdf:e.video?a.OnePlayerVideo:e.audio?a.OnePlayerAudio:e.panorama?a.Panorama:c&&e.image360?a.Image360:e.model3d?a.ThreeD:e.zip?a.Zip:function(e,t){return(0,u.kb)(t)&&!!e.extension&&(e.extension===f.d||e.extension===f.c)}(e,s)?a.Copilot:function(e){return!!e.extension&&(0,o.b)(e.extension,e.type)}(e)?a.TextFile:e.photo?a.Photo:e.thumbnail?a.Thumbnail:i.hasFileHandler(e)?a.FileHandler:a.Other)}}}}}});function h(e){return m.filter(function(t){return t.extension===e.extension})}}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>d,c:()=>c});var a=n("tslib_538"),i=n(3),r=(0,n(264).a)(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.e2)(t,e),t}(i.a.withManager(r));function s(e,t){return new o({name:"OneUpLightSpeed.MeTA",extraData:(0,a.q5)({viewer:e},t)})}function c(e,t){null==e||e.end({resultType:i.b.Success,extraData:t})}function d(e,t,n){if(t)null==e||e.end(t);else if(n){var a=void 0;"code"in n&&(a=n);var r=(null==a?void 0:a.isExpected)?i.b.ExpectedFailure:i.b.Failure,o=(null==a?void 0:a.code)||n.name||n.message,s=(null==a?void 0:a.extraData)||{rawError:n};null==e||e.end({resultType:r,resultCode:o,extraData:s})}}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>u,c:()=>d});var a=n(35),i=n(6),r=n(24),o=n("odsp.util_152"),s=n(3);function c(e,t,n){return i.c.all([l(e),l(e,n)]).then(function(e){var n=e[0],a=e[1],i=a.length>n.length;return{text:i?n:a,mimeType:t,isSafeText:i||f(a)}},function(e){return e.filter(function(e){return!i.c.isCanceled(e)})[0]||e[0]})}function d(e,t){return l(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})}function l(e,t){var n=new a.b,i=new FileReader,r=new s.a({name:"FileContentHelper.parseFile"});return i.onload=function(){n.complete(i.result||""),r.end({resultType:s.b.Success})},i.onerror=function(e){var t,n=new o.qt({code:"FileContentHelperParseBlobFailure",innerError:i.error,message:(null===(t=i.error)||void 0===t?void 0:t.message)||"FileContentHelperParseBlobGenericFailure"});r.end({resultType:s.b.Failure,extraData:{error:n}})},i.readAsText(e,t),n.getPromise()}function u(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0||t.indexOf(":/content?")>=0?t:"".concat(t.indexOf("/content?format=")>=0?"".concat(t):"".concat(t,":/content?")).concat((0,r.a)(e))}function f(e){for(var t=0;t<e.length;t++)if(!((n=e.charCodeAt(t))<127||p[n]))return!1;var n;return!0}var p={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}}
,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_152"),i={Modified:"modified",ExitEdit:"exitEdit"},r=new a.aF({name:"PdfEmbedHelper.key",loader:new a.xT(function(){return n.e(52).then(n.bind(n,683)).then(function(e){return e.resourceKey})})})}
,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>p,b:()=>m,c:()=>h,d:()=>_});var a=n("tslib_538"),i=n("react-lib"),r=n.n(i),o=n(478),s=n(182),c=n(268),d=n(58),l=n(267),u=n(149),f=n("odsp.util_152"),p=function(){return r().useContext(o.a)},m=function(){return r().useContext(o.b)},_=function(e){var t=r().useCallback(function(t,n){var a,i=null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getToastOperation();null==i||i({type:s.b.Running,text:t,percentComplete:n/100})},[e]),n=r().useCallback(function(t,n,a){var i;void 0===a&&(a=!1);var r=null===(i=null==e?void 0:e.current)||void 0===i?void 0:i.getToastOperation();null==r||r({type:s.b.Success,text:t,link:n,linkText:u.d,disableAutoHide:a,onClickClose:function(){null==r||r({type:s.b.Hidden})}})},[e]),i=r().useCallback(function(t){var n,a=null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.getToastOperation();null==a||a({type:s.b.Error,text:t,onClickClose:function(){null==a||a({type:s.b.Hidden})}})},[e]);return r().useCallback(function(e){return(0,a.yv)(void 0,void 0,void 0,function(){var r,o,s,p,m,_,h,b,g,v,y,S;return(0,a.SO)(this,function(a){switch(a.label){case 0:r=0,o=0,s=new c.d({name:e.scenarioName}),a.label=1;case 1:return a.trys.push([1,3,4,5]),r=window.setInterval(function(){if(100-o>10)return o+=10,void t(e.runningText,o);o=Math.floor((100-o)/4)+o,t(e.runningText,o)},200),null===(b=e.telemetryHandler)||void 0===b||b.logQosStart(s),null===(g=e.before)||void 0===g||g.call(e),[4,e.runner()];case 2:return p=a.sent(),clearInterval(r),n(e.successText,p,e.disableAutoHide),null===(v=e.telemetryHandler)||void 0===v||v.logQosEnd(new c.c(s.payload.id,e.scenarioName,d.b.Succeed,{})),[3,5];case 3:return m=a.sent(),clearInterval(r),_=!1,h=e.failedText,m instanceof l.c&&m.type===l.b.ExceedsMaximumLength&&(_=!0,h=f.PN(u.t,m.url.length)),i(h),null===(y=e.telemetryHandler)||void 0===y||y.logQosEnd(new c.c(s.payload.id,e.scenarioName,d.b.Fail,{isExpected:_,error:m})),[3,5];case 4:return null===(S=e.after)||void 0===S||S.call(e),[7];case 5:return[2]}})})},[t,n,i])},h=function(e){return r().useCallback(function(t,n){return(0,a.yv)(void 0,void 0,void 0,function(){var i,r,o,s,c,d,u,f;return(0,a.SO)(this,function(a){switch(a.label){case 0:if(!e)throw new l.a("Manipulator is not ready in PDF engine");i=t.newFileName,r=t.items,(0,l.f)(i,r[0]),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n()];case 2:return o=a.sent(),[3,4];case 3:throw s=a.sent(),new l.a("Manipulator runtime error: ".concat(s.message));case 4:if(!o)throw new l.a("Manipulator is not ready in PDF engine");if(c=o[0],d=o[1],0!==c)throw new l.a("Fail to manipulate PDF from PDF Parser, code=".concat(c));return u=new Blob([d],{type:"application/pdf"}),f=new File([u],"".concat(i,".pdf"),{type:"application/pdf"}),[2,e(f,r[0])]}})})},[e])}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("react-lib"),i=(0,a.createContext)(function(){throw new Error("closeFilePickerCtx call out of context scope")}),r=(0,a.createContext)(function(){throw new Error("confirmFilePickerCtx call out of context scope")})}
,(e,t,n)=>{"use strict";var a;n.d(t,{a:()=>d});var i=new Uint8Array(16);function r(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}for(var o=n(480),s=[],c=0;c<256;++c)s.push((c+256).toString(16).substr(1));const d=function(e,t,n){var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!(0,o.a)(n))throw TypeError("Stringified UUID is invalid");return n}(a)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,i=function(e){return"string"==typeof e&&a.test(e)}}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=["ToolButtonPenLabel","ToolButtonPenDescription","ToolButtonPenOrHighlitActiveAriaSuffix","ToolButtonFreeTextActiveAriaSuffix","ToolButtonFreeTextLabel","ToolButtonFreeTextText","ToolButtonFreeTextTooltip","ToolButtonHighlighterLabel","ToolButtonHighlighterDescription","ToolButtonEraserTooltip","ToolButtonEraserLabel","ToolButtonEraserText","ToolButtonEraserDescription","ToolButtonPointEraserTooltip","ToolButtonPointEraserLabel","ToolButtonPointEraserText","ToolButtonPointEraserDescription","ToolButtonDisplayTooltip","ToolButtonDisplayTooltipNew","ToolButtonDisplayLabel","ToolButtonDisplayLabelNew","ToolButtonDisplayText","ToolButtonSelectedText","ToolButtonDisplayDescription","ToolButtonMoreLabel","ToolbarThickness","ToolbarButtonFormatString","ToolbarStylePickerTriggerNotice","inkToolbarLabel","PenThicknessSliderLabel","HighlighterThicknessSliderLabel","ColorPickerColorDarkYellow","ColorPickerColorLightOrange","ColorPickerColorOrange","ColorPickerColorRed","ColorPickerColorDarkPurple","ColorPickerColorPurple","ColorPickerColorMagenta","ColorPickerColorDarkRed","ColorPickerColorLightBlue","ColorPickerColorBlue","ColorPickerColorDarkBlue","ColorPickerColorLightGreen","ColorPickerColorGreen","ColorPickerColorLightGrey","ColorPickerColorGrey","ColorPickerColorBlack","ColorPickerTable"]}
,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=function(){function e(){}return e.getTempAuthLogFields=function(e,t){if(!e)return{};var n=function(e){try{var t=new URL(e.toLowerCase()).searchParams,a=t.get("tempauth"),i=t.get("access_token"),r=t.get("docid");return!!(a&&"false"!==a||i&&"false"!==i)||!!r&&n(decodeURI(r))}catch(e){return}},a=n(e);return void 0!==a?{noTempAuth:!a,useToken:!!t}:{useToken:!!t}},e}()}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>o});var a=n(73),i=n(305),r=function(e){var t=new a.a(e.origin.x,e.origin.y);return{image:e.image,origin:t.scale(1/(0,i.a)()),triggerType:e.triggerType}},o=function(e,t,n,i,r){return new a.b(e,t,n-e,i-t).scale(r||1)}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("tslib_538");const i=()=>(0,a.yv)(void 0,void 0,void 0,function*(){return Promise.all([n.e("odsp.react.lib"),n.e(25)]).then(n.bind(n,697))})}
,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>V,b:()=>G,c:()=>N,d:()=>j,e:()=>z,f:()=>R,g:()=>B});var a=n(529),i=n(319);function r(e){return c(e)?(e.nodeName||"").toLowerCase():"#document"}function o(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function s(e){var t;return null==(t=(c(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function c(e){return e instanceof Node||e instanceof o(e).Node}function d(e){return e instanceof Element||e instanceof o(e).Element}function l(e){return e instanceof HTMLElement||e instanceof o(e).HTMLElement}function u(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof o(e).ShadowRoot)}function f(e){const{overflow:t,overflowX:n,overflowY:a,display:i}=g(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+n)&&!["inline","contents"].includes(i)}function p(e){return["table","td","th"].includes(r(e))}function m(e){const t=h(),n=g(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(e=>(n.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(n.contain||"").includes(e))}function _(e){let t=y(e);for(;l(t)&&!b(t);){if(m(t))return t;t=y(t)}return null}function h(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function b(e){return["html","body","#document"].includes(r(e))}function g(e){return o(e).getComputedStyle(e)}function v(e){return d(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function y(e){if("html"===r(e))return e;const t=e.assignedSlot||e.parentNode||u(e)&&e.host||s(e);return u(t)?t.host:t}function S(e){const t=y(e);return b(t)?e.ownerDocument?e.ownerDocument.body:e.body:l(t)&&f(t)?t:S(t)}function D(e,t,n){var a;void 0===t&&(t=[]),void 0===n&&(n=!0);const i=S(e),r=i===(null==(a=e.ownerDocument)?void 0:a.body),s=o(i);return r?t.concat(s,s.visualViewport||[],f(i)?i:[],s.frameElement&&n?D(s.frameElement):[]):t.concat(i,D(i,[],n))}function I(e){const t=g(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=l(e),o=r?e.offsetWidth:n,s=r?e.offsetHeight:i,c=(0,a.r)(n)!==o||(0,a.r)(i)!==s;return c&&(n=o,i=s),{width:n,height:i,$:c}}function x(e){return d(e)?e:e.contextElement}function C(e){const t=x(e);if(!l(t))return(0,a.b)(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:o}=I(t);let s=(o?(0,a.r)(n.width):n.width)/i,c=(o?(0,a.r)(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),c&&Number.isFinite(c)||(c=1),{x:s,y:c}}const O=(0,a.b)(0);function w(e){const t=o(e);return h()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:O}function E(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),s=x(e);let c=(0,a.b)(1);t&&(i?d(i)&&(c=C(i)):c=C(e));const l=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==o(e))&&t}(s,n,i)?w(s):(0,a.b)(0);let u=(r.left+l.x)/c.x,f=(r.top+l.y)/c.y,p=r.width/c.x,m=r.height/c.y;if(s){const e=o(s),t=i&&d(i)?o(i):i;let n=e.frameElement;for(;n&&i&&t!==e;){const e=C(n),t=n.getBoundingClientRect(),a=g(n),i=t.left+(n.clientLeft+parseFloat(a.paddingLeft))*e.x,r=t.top+(n.clientTop+parseFloat(a.paddingTop))*e.y;u*=e.x,f*=e.y,p*=e.x,m*=e.y,u+=i,f+=r,n=o(n).frameElement}}return(0,a.q)({width:p,height:m,x:u,y:f})}const A=[":popover-open",":modal"];function L(e){let t=!1,n=0,a=0;if(A.forEach(n=>{!function(n){try{t=t||e.matches(n)}catch(e){}}(n)}),t){const t=_(e);if(t){const e=t.getBoundingClientRect();n=e.x,a=e.y}}return[t,n,a]}function k(e){return E(s(e)).left+v(e).scrollLeft}function M(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=o(e),a=s(e),i=n.visualViewport;let r=a.clientWidth,c=a.clientHeight,d=0,l=0;if(i){r=i.width,c=i.height;const e=h();(!e||e&&"fixed"===t)&&(d=i.offsetLeft,l=i.offsetTop)}return{width:r,height:c,x:d,y:l}}(e,n);else if("document"===t)i=function(e){const t=s(e),n=v(e),i=e.ownerDocument.body,r=(0,a.o)(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=(0,a.o)(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let c=-n.scrollLeft+k(e);const d=-n.scrollTop;return"rtl"===g(i).direction&&(c+=(0,a.o)(t.clientWidth,i.clientWidth)-r),{width:r,height:o,x:c,y:d}}(s(e));else if(d(t))i=function(e,t){const n=E(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,o=l(e)?C(e):(0,a.b)(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:r*o.x,y:i*o.y}}(t,n);else{const n=w(e);i={...t,x:t.x-n.x,y:t.y-n.y}}return(0,a.q)(i)}function P(e,t){const n=y(e);return!(n===t||!d(n)||b(n))&&("fixed"===g(n).position||P(n,t))}function T(e,t,n,i){const o=l(t),c=s(t),d="fixed"===n,u=E(e,!0,d,t);let p={scrollLeft:0,scrollTop:0};const m=(0,a.b)(0);if(o||!o&&!d)if(("body"!==r(t)||f(c))&&(p=v(t)),o){const e=E(t,!0,d,t);m.x=e.x+t.clientLeft,m.y=e.y+t.clientTop}else c&&(m.x=k(c));let _=u.left+p.scrollLeft-m.x,h=u.top+p.scrollTop-m.y;const[b,g,y]=L(i);return b&&(_+=g,h+=y,o&&(_+=t.clientLeft,h+=t.clientTop)),{x:_,y:h,width:u.width,height:u.height}}function U(e,t){return l(e)&&"fixed"!==g(e).position?t?t(e):e.offsetParent:null}function F(e,t){const n=o(e);if(!l(e))return n;let a=U(e,t);for(;a&&p(a)&&"static"===g(a).position;)a=U(a,t);return a&&("html"===r(a)||"body"===r(a)&&"static"===g(a).position&&!m(a))?n:a||_(e)||n}const H={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:o}=e;const c=s(i),[d]=t?L(t.floating):[!1];if(i===c||d)return n;let u={scrollLeft:0,scrollTop:0},p=(0,a.b)(1);const m=(0,a.b)(0),_=l(i);if((_||!_&&"fixed"!==o)&&(("body"!==r(i)||f(c))&&(u=v(i)),l(i))){const e=E(i);p=C(i),m.x=e.x+i.clientLeft,m.y=e.y+i.clientTop}return{width:n.width*p.x,height:n.height*p.y,x:n.x*p.x-u.scrollLeft*p.x+m.x,y:n.y*p.y-u.scrollTop*p.y+m.y}},getDocumentElement:s,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const s="clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let a=D(e,[],!1).filter(e=>d(e)&&"body"!==r(e)),i=null;const o="fixed"===g(e).position;let s=o?y(e):e;for(;d(s)&&!b(s);){const t=g(s),n=m(s);n||"fixed"!==t.position||(i=null),(o?!n&&!i:!n&&"static"===t.position&&i&&["absolute","fixed"].includes(i.position)||f(s)&&!n&&P(e,s))?a=a.filter(e=>e!==s):i=t,s=y(s)}return t.set(e,a),a}(t,this._c):[].concat(n),c=[...s,i],l=c[0],u=c.reduce((e,n)=>{const i=M(t,n,o);return e.top=(0,a.o)(i.top,e.top),e.right=(0,a.p)(i.right,e.right),e.bottom=(0,a.p)(i.bottom,e.bottom),e.left=(0,a.o)(i.left,e.left),e},M(t,l,o));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}},getOffsetParent:F,getElementRects:async function(e){const t=this.getOffsetParent||F,n=this.getDimensions;return{reference:T(e.reference,await t(e.floating),e.strategy,e.floating),floating:{x:0,y:0,...await n(e.floating)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=I(e);return{width:t,height:n}},getScale:C,isElement:d,isRTL:function(e){return"rtl"===g(e).direction}},R=i.h,N=i.d,B=i.i,j=i.e,V=i.a,z=i.f,G=(e,t,n)=>{const a=new Map,r={platform:H,...n},o={...r.platform,_c:a};return(0,i.b)(e,t,{...r,platform:o})}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>l,b:()=>s,c:()=>u,d:()=>b,e:()=>g,f:()=>p,g:()=>_,h:()=>v,i:()=>S,j:()=>m,k:()=>D,l:()=>I,m:()=>h,n:()=>f,o:()=>r,p:()=>i,q:()=>x,r:()=>o,s:()=>a});const a=["top","right","bottom","left"],i=Math.min,r=Math.max,o=Math.round,s=(Math.floor,e=>({x:e,y:e})),c={left:"right",right:"left",bottom:"top",top:"bottom"},d={start:"end",end:"start"};function l(e,t,n){return r(e,i(t,n))}function u(e,t){return"function"==typeof e?e(t):e}function f(e){return e.split("-")[0]}function p(e){return e.split("-")[1]}function m(e){return"x"===e?"y":"x"}function _(e){return"y"===e?"height":"width"}function h(e){return["top","bottom"].includes(f(e))?"y":"x"}function b(e){return m(h(e))}function g(e,t,n){void 0===n&&(n=!1);const a=p(e),i=b(e),r=_(i);let o="x"===i?a===(n?"end":"start")?"right":"left":"start"===a?"bottom":"top";return t.reference[r]>t.floating[r]&&(o=D(o)),[o,D(o)]}function v(e){const t=D(e);return[y(e),t,y(t)]}function y(e){return e.replace(/start|end/g,e=>d[e])}function S(e,t,n,a){const i=p(e);let r=function(e,t,n){const a=["left","right"],i=["right","left"],r=["top","bottom"],o=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:a:t?a:i;case"left":case"right":return t?r:o;default:return[]}}(f(e),"start"===n,a);return i&&(r=r.map(e=>e+"-"+i),t&&(r=r.concat(r.map(y)))),r}function D(e){return e.replace(/left|right|bottom|top/g,e=>c[e])}function I(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function x(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}}
,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var a=n("react-lib"),i=n(536),r=n("fui.util_867"),o=n("odsp.util_152"),s=n(537);function c(e){var t=e.allowInfectedFileDownload?i.c:i.f,n=(0,r.kF)();return a.createElement(s.a,null,o.BC(t,a.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank",rel:"noreferrer"},a.createElement("span",{style:{color:n.palette.themePrimary}},i.e))))}}
,,,(e,t,n)=>{"use strict";e.exports=n.p+"images/ic_fluent_copilot_20_color_03a0b840.svg"}
,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152"),i=new a.aF({name:"SaveActionExecutor.key",loader:new a.xT(function(){return n.e(58).then(n.bind(n,709)).then(function(e){return e.saveActionExecutorKey})})})}
,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>f,c:()=>d,d:()=>p,e:()=>a,f:()=>l,g:()=>m,h:()=>_});var a,i=n("tslib_538"),r=n("react-lib"),o=n(20),s=n(81),c=n(244),d="CollabOneUp",l="Viewer",u="Command",f="Component";!function(e){e.success="Success",e.unexpectedFailure="UnexpectedFailure",e.expectedFailure="ExpectedFailure"}(a||(a={}));var p=r.createContext({});function m(e,t){var n=0===e.indexOf(d)?e:"".concat(d,".").concat(e),a=null==t?void 0:t.engagementContext;t&&t.engagementContext&&(t.engagementContext=void 0);var r={name:n,extraData:(0,i.q5)((0,i.q5)({},t),a)};o.a.logData(r)}function _(){return(0,s.c)().consume(c.a)}}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>R});var a=n(100),i=n("odsp.util_152"),r=n("tslib_538"),o=n(12),s=n(93),c=n(3),d=n(51),l=n(5),u=n(30),f=new i.aF({name:"isCopilotEnabledOnSite",factory:{dependencies:{pageContext:l.a},create:function(e){var t=e.pageContext;return{instance:function(){var e=!0;return i.x9.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7","11/20/2023","enables the msit site disallow list logic")||((0,u.a)({ODB:61346})?e=!0:(e=0===(0,d.c)(90214,t))||new c.a({name:"CopilotDisabledOnSite_OD_90214"}).end({resultType:c.b.Success})),(0,s.a)().availability.isSiteAllowed=e,e}}}}}),p=n(194),m=new i.aF({name:"ECSDataSource.key",loader:new i.xT(function(){return n.e(11).then(n.bind(n,711)).then(function(e){return e.ecsDataSourceKey})})}),_={ODB:61598};function h(){var e=i.ov.isFeatureEnabled(_);return(0,s.a)().availability.enableCopilotMochaSegmentation=e,e}function b(e){return"mocha_".concat(e)}var g=!1,v={pageContext:l.a,getECSDataSource:m.async.lazy},y=new i.aF({name:"isMochaBypassEnabled",factory:{dependencies:v,create:function(e){var t=e.pageContext,n=e.getECSDataSource,a=!1;if(h()){var i=t.aadUserId||"";a=function(e){var t,n=(0,s.a)(),a="true"===(null===(t=window.localStorage)||void 0===t?void 0:t.getItem(b(e)));return n.availability.aadUserId=e,n.availability.isUserInMochaSegmentation=a,a}(i),function(e,t){h()&&!g&&e&&(g=!0,t().then(function(e){return e.getECSSMochaSegmentation()}).then(function(t){var n,a=b(e);null===(n=window.localStorage)||void 0===n||n.setItem(a,t.toString())}))}(i,n)}return{instance:function(){return a}}}}}),S=n(11),D=n(353),I=!1,x=n(71),C=new i.aF({name:"showCopilotPaneAsync.key",loader:new i.xT(function(){return Promise.all([n.e("ondemand.resx"),n.e(5)]).then(n.bind(n,712)).then(function(e){return e.showCopilotPaneKey})})}),O=n(56),w=n(564),E=n(565),A=!i.x9.isActivated("362E5C67-02CF-4C98-AE96-22103CD0A622"),L={resources:i.XQ,oneUpStateStore:O.e,getExecutor:C.async.lazy,oneUpStore:x.b,pageContext:l.a},k=new i.aF({name:"onClickCopilotPaneAction",factory:{dependencies:L,create:function(e){return{instance:{evaluateAction:(t=e,function(e){var n=t.resources,a=t.pageContext,s=(0,o.wb)(o.k);!s&&A&&(s=n.consume(y)());var c=s&&n.consume(p.a)()&&n.consume(f)(),d=!!e.item.extension&&function(e,t){var n=t;try{var a=(0,w.b)(w.a),i=(0,E.b)(a);if(i){var r=e.replace(".","");n=n&&!!i.map.get(r)}else n=!1}catch(e){n=!1}return n}(e.item.extension,c);return!I&&c&&(I=!0,D.a.logData({name:"ChatODSP.EntryPointRendered"})),{isAvailable:d,id:"openCopilotPaneAction",onExecute:function(){return(0,r.yv)(void 0,void 0,void 0,function(){var n,s,c,d,l,u,f,p,m,_,h;return(0,r.SO)(this,function(r){switch(r.label){case 0:return t.oneUpStateStore.currentAppState.rightPane.type!==O.d.copilotPane?[3,1]:(t.oneUpStateStore.updateRightPaneState("closeCopilotPane",{type:O.d.none}),[3,4]);case 1:return n=void 0,(0,o.eb)()&&(s=t.oneUpStore.getOneUpProperties(),c=new S.b({context:a}),d=(0,i.Ho)(e.item.key),l=d.id,u=d.listurl,f=c.getUrlParts({listUrl:u,path:l}),p=f.fullWebUrl,m={webAbsoluteUrl:p,listUrl:f.serverRelativeListUrl},n=null===(h=null==s?void 0:s.pageContexts)||void 0===h?void 0:h.get(m)),_={currentPageContext:n,loadConversationHistory:!!(window.event&&window.event instanceof MouseEvent&&window.event.shiftKey)},[4,t.getExecutor()];case 2:return[4,r.sent().showCopilotPane(_)];case 3:r.sent(),r.label=4;case 4:return[2]}})})}}})}};var t}}}),M=n(170),P={actionProvider:k},T="CopilotPaneCommand",U=window.require,F=U.toUrl?U.toUrl("odsp-media/images/copilot/svg/ic_fluent_copilot_16_color.svg"):void 0,H=(0,M.a)(),R=new i.aF({name:"CopilotCommand",factory:{dependencies:P,create:function(e){var t=e.actionProvider;return{instance:{id:T,title:a.k,automationId:T,iconProps:{imageProps:{src:F}},evaluateAction:t.evaluateAction,buttonStyles:H}}}}})}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>s,b:()=>o});var a=n("react-lib"),i=n(71),r=n(81);function o(e,t){var n=(0,r.c)(),o=[];(0,a.useEffect)(function(){return function(){var a=n.consume(i.b);for(var r in e)if(e.hasOwnProperty(r)){var s=r,c=e[s];c&&o.push(a.subscribe(s,c,t))}}(),function(){for(var e;e=o.pop();)e()}},[])}function s(e){var t=(0,a.useState)(),n=t[0],r=t[1];return o({updateOneUpStatus:function(t){if("update"in t.detail&&t.detail.update&&"publisher"in t.detail){var n=t.detail.update,a=e?e(n):n;r(a)}}},i.a.oneUpItemCacheUpdate||i.a.oneUpSpartanUpdate),n}}
,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var a=n("tslib_538"),i=n("fui.util_867");function r(){var e=(0,i.kF)();return(0,a.q5)((0,a.q5)({},e),{palette:(0,a.q5)((0,a.q5)({},e.palette),{neutralPrimary:"transparent",themeTertiary:"#0F6CBD",themeLight:"#115EA3",themeLighter:"#0F6CBD"})})}}
,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>r,b:()=>i});var a=n(143);function i(e){var t=e&&e.replace(/^\./,"");return!(!t||!a.b[t])}function r(e){return!(!e||!e.extension||i(e.extension))}}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>r});var a,i=n(20);function r(e,t){i.a.logData({name:e,scenario:"OneUp Universal Annotation",isIntentional:!0,extraData:{itemType:t}})}"".concat("OneUpUniversalAnnotation",".UACommentsPane"),function(e){e.UACommentsPane="OneUpUniversalAnnotation.UACommentsPane",e.OpenCommentsFromCommandBar="OneUpUniversalAnnotation.UACommentsPane.OpenFromCommandBar",e.CloseCommentsFromCommandBar="OneUpUniversalAnnotation.UACommentsPane.CloseFromCommandBar",e.DeleteComment="OneUpUniversalAnnotation.UACommentsPane.DeleteComment"}(a||(a={}))}
,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>d});var a=n("tslib_538"),i=n("react-lib"),r=n("odsp.util_152"),o=n(148),s="presenceCommand";function c(e){return{id:s,isAvailable:!0,isDisabled:!0}}var d=new r.aF({name:"PresenceCommand",factory:{dependencies:{},create:function(){var e=(0,o.a)(function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(42).then(n.bind(n,731))];case 1:return[2,e.sent().PresenceHeaderAsyncDeferred]}})})});return{instance:{id:s,automationId:s,onRender:function(t){return i.createElement(e,null)},evaluateAction:c}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>I});var a=n(100),i=n("odsp.util_152"),r=n(335),o={actionProvider:r.d},s="shareCommand",c=new i.aF({name:"ShareCommand",factory:{dependencies:o,create:function(e){var t=e.actionProvider;return{instance:{id:s,name:a.Ob,title:a.wb,automationId:s,iconProps:{iconName:"Share"},evaluateAction:t.evaluateAction}}}}}),d={actionProvider:r.b},l="copyLinkCommand",u=new i.aF({name:"CopyCommand",factory:{dependencies:d,create:function(e){var t=e.actionProvider;return{instance:{id:l,name:a.l,title:a.l,automationId:l,iconProps:{iconName:"Link"},evaluateAction:t.evaluateAction}}}}}),f={actionProvider:r.c},p="manageAccessCommand",m=new i.aF({name:"ManageAccessCommand",factory:{dependencies:f,create:function(e){var t=e.actionProvider;return{instance:{id:p,name:a.X,title:a.X,automationId:p,iconProps:{iconName:"Contact"},evaluateAction:t.evaluateAction}}}}}),_=n(170),h={actionProvider:r.a},b="addAgentToTeamsCommand",g=new i.aF({name:"AddAgentToTeamsCommand",factory:{dependencies:h,create:function(e){var t=e.actionProvider;return{instance:{id:b,name:a.c,title:a.d,automationId:b,iconProps:{iconName:"Link"},evaluateAction:t.evaluateAction}}}}}),v=n(12),y={shareCommand:c,copyCommand:u,manageAccessCommand:m,addAgentToTeamsCommand:g},S="shareCommandGroup",D=function(e){return{isAvailable:!0}},I=new i.aF({name:"ShareGroupCommand",factory:{dependencies:y,create:function(e){var t=e.addAgentToTeamsCommand,n=e.shareCommand,i=e.copyCommand,r=e.manageAccessCommand;return{instance:{id:S,name:a.Ob,automationId:S,subCommands:(0,v.nb)()?[t,n,i,r]:[n,i,r],evaluateAction:D,buttonStyles:(0,_.a)(),iconProps:{iconName:"Share"}}}}}})}
,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var a=n("tslib_538"),i=n(614);function r(e){return{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:e}}}var o=(0,a.q5)((0,a.q5)({},i.a),{Pivot:{styles:function(e){var t=e.linkFormat,n=e.theme,i=n.effects,r=n.semanticColors,o=n.palette,s="tabs"===t,c={border:"2px solid transparent",borderRadius:i.roundedCorner4,height:"44px",lineHeight:"20px",marginRight:0,".ms-Fabric--isFocusVisible &:focus":{border:"2px solid ".concat(r.focusBorder),borderRadius:i.roundedCorner4,inset:0,outline:"none"}},d={color:s?r.primaryButtonText:o.themePrimary};return{link:(0,a.q5)((0,a.q5)({},c),{backgroundColor:"transparent","&:hover::before":{borderRadius:i.roundedCorner4,height:"3px",backgroundColor:s?"transparent":o.neutralQuaternary},"&:hover":{".ms-Pivot-icon":d}}),icon:{height:"14px",width:"14px"},linkIsSelected:(0,a.q5)((0,a.q5)({},c),{"&::before":{borderRadius:i.roundedCorner4,height:"3px"},".ms-Pivot-icon":d})}}},CommandBarButton:{styles:function(e){var t=e.theme,n=t,i=n.semanticColors,o=n.effects,s={borderRadius:0,borderTopRightRadius:o.roundedCorner6,borderBottomRightRadius:o.roundedCorner6},c={borderRadius:0,borderTopLeftRadius:o.roundedCorner6,borderBottomLeftRadius:o.roundedCorner6},d=function(e){var t=e.effects,n=e.semanticColors,i={borderRadius:0,borderTopRightRadius:t.roundedCorner6,borderBottomRightRadius:t.roundedCorner6},r={borderRadius:0,borderTopLeftRadius:t.roundedCorner6,borderBottomLeftRadius:t.roundedCorner6};return{splitButtonContainer:{borderRadius:t.roundedCorner6,color:n.buttonText,".ms-Button:first-child":(0,a.q5)((0,a.q5)({},r),{height:"100%"}),".ms-Button--primary:hover":{border:"none"}},splitButtonMenuButton:(0,a.q5)((0,a.q5)({},i),{height:"100%",padding:"0px",width:20}),splitButtonContainerFocused:{":focus::after":{inset:"0px",outline:"none",borderRadius:t.roundedCorner6,border:"2px solid ".concat(n.focusBorder)}},splitButtonMenuFocused:{":focus::after":(0,a.q5)({inset:"0px",outline:"none",border:"2px solid ".concat(n.focusBorder)},i)},splitButtonDivider:{display:"none"},splitButtonDividerDisabled:{display:"none"}}}(t);return(0,a.q5)((0,a.q5)({root:{backgroundColor:"transparent",height:"100%",minWidth:"20px",padding:"0px",margin:"0px 2px",borderRadius:o.roundedCorner6,".ms-Fabric--isFocusVisible &:focus::after":{top:4,right:0,bottom:4,left:0,outline:"none",borderRadius:o.roundedCorner6,border:"2px solid ".concat(i.focusBorder)}},rootHovered:r(i.buttonBackgroundHovered),rootPressed:r(i.buttonBackgroundPressed),rootExpanded:(0,a.q5)((0,a.q5)({},r("transparent")),{color:"inherit"}),rootChecked:r(i.buttonBackgroundChecked),rootCheckedHovered:r(i.buttonBackgroundCheckedHovered),rootCheckedPressed:r(i.buttonBackgroundPressed),rootExpandedHovered:r(i.buttonBackgroundHovered),flexContainer:{height:32,width:32,paddingLeft:0,paddingRight:0,borderRadius:o.roundedCorner6},icon:{color:"inherit"},menuIcon:{color:"inherit",fontSize:"10px"},rootDisabled:{backgroundColor:"transparent"},textContainer:{height:16}},d),{splitButtonContainer:{borderRadius:o.roundedCorner6,color:i.buttonText,".ms-Button:first-child":{".ms-Button-flexContainer":(0,a.q5)((0,a.q5)({},c),{width:"auto",height:30,border:"1px solid ".concat(i.buttonBorder),backgroundColor:i.buttonBackground}),".ms-Button-textContainer":{width:"auto",minWidth:25,maxWidth:100,marginTop:2}}},splitButtonMenuButton:(0,a.q5)((0,a.q5)({},s),{height:"100%",padding:"0px",width:20,marginLeft:"-2px",backgroundColor:"transparent",".ms-Button-flexContainer":(0,a.q5)((0,a.q5)({},s),{height:32,width:32,paddingLeft:4,paddingRight:4}),"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundHovered}}}),splitButtonContainerFocused:{":focus::after":{inset:"4px 0px",outline:"none",borderRadius:o.roundedCorner6,border:"2px solid ".concat(i.focusBorder)}},splitButtonMenuButtonExpanded:{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundChecked},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:i.buttonBackgroundCheckedHovered}}},splitButtonFlexContainer:{borderTop:"1px solid ".concat(i.buttonBorder),borderRight:"1px solid ".concat(i.buttonBorder),borderBottom:"1px solid ".concat(i.buttonBorder),backgroundColor:i.buttonBackground,height:"30px !important",width:"auto !important",".ms-Button-textContainer":{marginTop:2}}})}},TeachingBubble:{styles:function(e){var t,n=e.theme.palette;return{root:{color:n.black,backgroundColor:n.themePrimary},subText:{color:n.black},headline:{color:n.black},footer:(t={color:n.black},t["& > .ms-StackItem"]={display:"flex",flexDirection:"row-reverse"},t["& > .ms-StackItem > .ms-Button:not(:first-child)"]={margin:"0 15px 0 0"},t),subComponentStyles:{callout:{borderRadius:"6px",beak:{borderRadius:0}}},primaryButton:{backgroundColor:n.black,color:n.white,borderColor:n.black,borderRadius:"4px",":hover":{borderColor:n.black,backgroundColor:n.black,color:n.white},":focus":{borderColor:n.black,backgroundColor:n.black,color:n.white}},secondaryButton:{borderColor:n.black,".ms-Button-label":{color:n.black},":hover":{borderColor:n.black,backgroundColor:n.themeSecondary}},closeButton:{backgroundColor:n.themePrimary,color:n.black,":hover":{backgroundColor:n.themeSecondary+"!important",color:n.black}}}}}})}
,,,,,,,,,,,,,(e,t)=>{"use strict";var n=60103,a=60106,i=60107,r=60108,o=60114,s=60109,c=60110,d=60112,l=60113,u=60120,f=60115,p=60116;if("function"==typeof Symbol&&Symbol.for){var m=Symbol.for;n=m("react.element"),a=m("react.portal"),i=m("react.fragment"),r=m("react.strict_mode"),o=m("react.profiler"),s=m("react.provider"),c=m("react.context"),d=m("react.forward_ref"),l=m("react.suspense"),u=m("react.suspense_list"),f=m("react.memo"),p=m("react.lazy"),m("react.block"),m("react.server.block"),m("react.fundamental"),m("react.debug_trace_mode"),m("react.legacy_hidden")}function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case r:case l:case u:return e;default:switch(e=e&&e.$$typeof){case c:case d:case p:case f:case s:return e;default:return t}}case a:return t}}}t.a=function(e){return _(e)===c},t.b=function(e){return _(e)===d}}
,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";function a(e){var t=e.viewParams,n=e.clientName,a=t.app,i=t.scenario,r=!0;try{r=window.parent!==window.self||!!window.opener}catch(e){}return{Scenario:i||(r?"Unknown":"Default"),ClientName:"".concat(a?"".concat(a,"."):"").concat(n)}}function i(e){var t=e.viewParams,n=e.clientName;return n&&t?a({viewParams:t,clientName:n}).ClientName:null!=n?n:null==t?void 0:t.app}n.d(t,{a:()=>a,b:()=>i})}
,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i,b:()=>r});var a=n("odsp.util_152"),i=new a.aF("onRenderOneUpPlayerHost"),r=new a.aF("OneUpPlayerHost")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("oneUpPlayerHostInitResourcesKey")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("oneUpOnePlayerEnabled")}
,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>u,b:()=>s,c:()=>r,d:()=>d,e:()=>c,f:()=>o,g:()=>l});var a=n("tslib_538"),i=n(31),r=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,689))];case 1:return[2,e.sent().PdfPrintService]}})})},o=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,690))];case 1:return[2,e.sent().PdfThumbnailService]}})})},s=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,691))];case 1:return[2,e.sent().PdfDocumentLoaderByQueue]}})})},c=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,692))];case 1:return[2,e.sent().PdfRotateService]}})})},d=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,693))];case 1:return[2,e.sent().PdfProgressiveLoadingService]}})})},l=function(){return(0,a.yv)(void 0,void 0,void 0,function(){var e,t;return(0,a.SO)(this,function(a){switch(a.label){case 0:return(null===(t=i.a.features)||void 0===t?void 0:t.enableOptimizedPinch)?[4,n.e(32).then(n.bind(n,694))]:[3,2];case 1:return e=a.sent().Pinchable,[3,4];case 2:return[4,n.e(32).then(n.bind(n,695))];case 3:e=a.sent().Pinchable,a.label=4;case 4:return[2,e]}})})},u=function(){return(0,a.yv)(void 0,void 0,void 0,function(){return(0,a.SO)(this,function(e){switch(e.label){case 0:return[4,n.e(32).then(n.bind(n,696))];case 1:return[2,e.sent().FontProvider]}})})}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var a=n("odsp.util_152"),i=new a.aF({name:"UniversalPrintDataSourceAsync.key",loader:new a.xT(function(){return n.e(68).then(n.bind(n,673)).then(function(e){return e.universalPrintDataSourceKey})})})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n(49),i=n(42),r=n(11),o=n("odsp.util_152"),s=n(429),c=n(244),d=n(454),l={resourceScope:o.XQ,navigation:a.a,engagementContext:c.a},u=new o.aF({name:"ListItemRetrieverHelper",factory:{dependencies:l,create:function(e){var t=e.resourceScope,n=e.navigation,a=e.engagementContext,o=(0,d.a)(t),c=o.idViewParam,l=o.webAbsoluteUrl,u=o.fullListUrl,f=o.serverRelativeFocusItemUrl,p=o.listContext,m=o.pageContext,_=new i.a({},{pageContext:m});return{instance:{getCurrentItem:function(e){var t=_.getItemUrlParts(window.location.href),i=t.isCrossList,o=t.isCrossDomain,d=t.geoRelation,h=l&&u?{pageContext:m,id:c?f:void 0,webAbsoluteUrl:l,listFullUrl:u,listContext:p,extraLoggingData:{isCrossList:i,isCrossDomain:o,isCrossGeo:d!==r.a.sameGeo,correlationId:m.CorrelationId,engagementContext:a,isShareLinkRedeeming:void 0!==n.viewParams.ga}}:void 0;return h?new s.a(h).getSingleItem(e):Promise.resolve(void 0)}}}}}})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var a=new(n("odsp.util_152").aF)("people")}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>c,b:()=>s});var a=n(53),i=n(5),r=n(86),o=n(189),s=(0,n("odsp.util_152").Gd)("DataRequestor",a.b,{pageContext:i.a,offlineDetection:r.a,noRedirect:o.a});const c=a.b}
,,(e,t,n)=>{"use strict";function a(){return window.location!==window.parent.location}function i(){var e=window;return e.parent===e&&!e.opener&&void 0!==e.external&&("messageToHost"in e.external||"notify"in e.external)}n.d(t,{a:()=>a,b:()=>i})}
,(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var a=n("tslib_538"),i=n("fui.util_867"),r={neutralLight:"#edebe9",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralTertiary:"#616161",white:"#ffffff"},o={bodyBackground:"#faf9f8",menuBackground:"#ffffff",menuItemBackgroundHovered:"#f3f2f1",menuItemBackgroundPressed:"#f3f2f1",menuDivider:"#c8c6c4",menuIcon:"#605e5c",menuItemText:"#323130",inputBackground:"#ffffff",inputBorder:"#bebbb8",inputText:"#323130",inputPlaceholderText:"#605e5c",cardStandoutBackground:"#ebf3fc",cardShadowHovered:"#b4d6fa",listText:"#242424",disabledBorder:"#707070",messageLink:"#115ea3",messageLinkHovered:"#0f548c"},s={neutralDark:"#f3f2f1",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",neutralPrimary:"#f3f2f1",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralSecondaryAlt:"#979693",themeDark:"#faf9f8",themePrimary:"#0F6CBD",white:"#1b1a19"},c={bodyBackground:"#201f1e",menuBackground:s.neutralLighter,menuItemBackgroundHovered:s.neutralQuaternaryAlt,menuItemBackgroundPressed:s.neutralQuaternary,menuDivider:"#BEBBB8",menuIcon:"#FFFFFF",menuItemText:"#F3F2F1",menuItemTextHovered:"#F3F2F1",inputBackground:"#292929",inputBorder:"#bebbb8",inputText:"#F3F2F1",inputPlaceholderText:"#999999",primaryButtonBackgroundDisabled:"#252423",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#FFFFFF",primaryButtonTextHovered:"#FFFFFF",primaryButtonTextPressed:"#FFFFFF",disabledText:"#A19F9D",bodySubtext:"#A19F9D",buttonBackgroundPressed:"#292827",buttonBackgroundHovered:"#424242",buttonTextDisabled:"#797775",cardStandoutBackground:"#082338",cardShadowHovered:"#0e4775",listText:"#ffffff",disabledBorder:"#999999",messageLink:"#479ef5",messageLinkHovered:"#62abf5"},d=(0,i.es)({palette:r,semanticColors:o}),l=(0,i.es)({palette:s,semanticColors:c,isInverted:!0}),u=function(e,t){if(void 0===t&&(t=!1),!e)return t?l:d;var n=e.palette,u=e.semanticColors,f=(0,a.dc)(e,["palette","semanticColors"]),p=(0,a.q5)({palette:t?(0,a.q5)((0,a.q5)({},s),n):(0,a.q5)((0,a.q5)({},r),n),semanticColors:t?(0,a.q5)((0,a.q5)({},c),u):(0,a.q5)((0,a.q5)({},o),u),isInverted:(null==e?void 0:e.isInverted)||t},f);return(0,i.es)(p)}}
],t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e;var a=document.currentScript,i=window,r=i.require;function o(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var s,c,d,l,u,f=o(a&&a.src||r&&r.toUrl("")),p=o(i.__backupBaseUrl),m=r&&r.s.contexts._,_=i.__odspSriHashes;_&&0===Object.keys(_).length&&(_=void 0),n.amdO={},s=[],n.O=(e,t,a,i)=>{if(!t){var r=1/0;for(l=0;l<s.length;l++){for(var[t,a,i]=s[l],o=!0,c=0;c<t.length;c++)(!1&i||r>=i)&&Object.keys(n.O).every(e=>n.O[e](t[c]))?t.splice(c--,1):(o=!1,i<r&&(r=i));if(o){s.splice(l--,1);var d=a();void 0!==d&&(e=d)}}return e}i=i||0;for(var l=s.length;l>0&&s[l-1][2]>i;l--)s[l]=s[l-1];s[l]=[t,a,i]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},d=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var a=Object.create(null);n.r(a);var i={};c=c||[null,d({}),d([]),d(d)];for(var r=2&t&&e;"object"==typeof r&&!~c.indexOf(r);r=d(r))Object.getOwnPropertyNames(r).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,n.d(a,i),a},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,a)=>(n.f[a](e,t),t),[])),n.u=e=>"odsp.1ds.lib"===e?"odsp.1ds.lib.js":({"ondemand.resx":1,"odsp.1ds.lib":1}[e]?self.__odsp_culture+"/":"")+e+".js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l={},u="__webpack_result__:",n.l=(e,t,a,r)=>{if(l[e])l[e].push(t);else{var o,s;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var f=c[d];if(f.getAttribute("src")==e||f.getAttribute("data-webpack")==u+a){o=f;break}}if(!o){s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",u+a),o.setAttribute("fetchpriority","high"),o.src=e,0!==o.src.indexOf(window.location.origin+"/")&&(o.crossOrigin="anonymous");var p=function(e){var t;return _&&(t=_[i.__odsp_culture+"/"+e]||_[e]||"sha256-Missing+Integrity+Hash+For+Script+Aborting="),t}(r);p&&(o.integrity=p)}l[e]=[t];var m=(t,n)=>{o.onerror=o.onload=null,clearTimeout(h);var a=l[e];if(delete l[e],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach(e=>e(n)),t)return t(n)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),s&&document.head.appendChild(o)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var i=a.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=a[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{n.b=document.baseURI||self.location.href;var e={oneuplightspeedwebpack:0};n.f.j=(t,a)=>{var r=t.toString(),o=m&&m.config.paths[r]&&m.nameToUrl(r)||n.p+n.u(t);function s(t){var a=n.o(e,t)?e[t]:void 0;if(0!==a){if(a)return a;var i=new Promise((n,i)=>a=e[t]=[n,i]);a[2]=i,a[3]=o;var r=new Error;return n.l(o,i=>{if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",r.name="ChunkLoadError",r.type=o,r.request=s,r.chunkId=t,a[1](r)}},"chunk-"+t,t),a}}var c=s(t);c&&a.push(c[2].catch(function(e){var n=i.__integrityViolationCallBack;n&&n(e.request);var a=c[3],r=p&&a.replace(f,p);if(r&&r!==a){o=r;var d=s(t);return d&&d[2]}return Promise.reject(e)}))},n.O.j=t=>0===e[t];var t=(t,a)=>{var i,r,[o,s,c]=a,d=0;if(o.some(t=>0!==e[t])){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var l=c(n)}for(t&&t(a);d<o.length;d++)r=o[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},a=self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var h=n.O(void 0,["odsp.react.lib","tslib","odsp.util","fui.util","fui.core","initial.resx","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"],()=>n(397));h=n.O(h),__webpack_result__=h})(),define("oneuplightspeedwebpack",[],{});